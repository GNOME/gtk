2002-01-14  Sven Neumann  <sven@gimp.org>

	* gtk/gtkrc.c: g_getenv() returns a const string.

2002-01-14  Hasbullah Bin Pit  <sebol@ikhlas.com>

        * configure.in: Added ms at ALL_LINGUAS.
	* po/ms.po: Added Malay Translation.

2002-01-14  Matthias Clasen  <matthiasc@poet.de>

	* gtk/gtkitemfactory.c: Documentation.

2002-01-13  Sven Neumann  <sven@gimp.org>

	* gdk/gdkwindow.c: documentation cleanups.

Sun Jan 13 01:15:45 2002  Kristian Rietveld  <kris@gtk.org>

	* gtk/gtktreemodelsort.c: various cleanups,
	(get_child_iter_from_elt): removed,
	(gtk_tree_model_sort_elt_get_path): rewritten to be a lot cleaner
	and especially faster,
	(gtk_tree_model_convert_iter_to_child_iter): use
	gtk_tree_model_sort_elt_get_path

Sat Jan 12 16:57:31 2002  Kristian Rietveld  <kris@gtk.org>

	* gtk/gtktreeview.c (gtk_tree_view_real_start_interactive_search):
	revert Owen's change (using a strdupped string as object data), so
	the interactive search works again

2002-01-11  Havoc Pennington  <hp@pobox.com>

	* gtk/gtklabel.c: put in more links to Pango markup format docs
	(gtk_label_set_justify): mention gtk_misc_set_alignment

2002-01-12  Tor Lillqvist  <tml@iki.fi>

	Fixes contributed by Archaeopteryx Software: This is a first small
	part of their changes. Will commit more later.
	
	* gdk/win32/*.c: Add some more checks for failed GDI calls. If a
	call fails, don't use bogus values.

	 gdk/win32/gdkcursor-win32.c (_gdk_win32_data_to_wcursor): Plug
	memory leak: g_free() the AND and XOR bitmaps after use.
	(_gdk_cursor_destroy): If we are destroying the current Windows
	cursor, set the Windows cursor to none first.

	* gdk/win32/gdkgc-win32.c (predraw_set_foreground): Delete the old
	brush that was in the DC, like the win32-procution branch does. I
	guess this plugs a resource leak? With the HDC cache, the old
	brush might be something we created ourselves, and not a stock
	brush. And it doesn't do any harm to call DeleteObject on stock
	brushes.

	* gdk/win32/gdkwindow-win32.c (gdk_window_impl_win32_finalize): If
	the window has a cursor which is the current Windows cursor,
	before destroying it set the current Windows cursor to none.
	(gdk_window_set_cursor): Also here, if destroying the current
	Windows cursor, set the current Windows cursor to none first.
	(gdk_window_get_pointer): Revamp logic.
	
2002-01-10  jacob berkman  <jacob@ximian.com>

	* gtk/gtkwidget.c (gtk_widget_add_events): actually iterate
	through the list rather than infinitely loop

2002-01-08  Matthias Clasen  <matthiasc@poet.de>

	* gtk/gtkwidget.c (gtk_widget_set_style_recurse): Rename to
	reset_rc_styles_recurse(). (#68084)

2002-01-10            Vitaly Tishkov       <tvv@sparc.spb.su>
        * gtk/gtkimage.c
	* gtk/gtkimcontext.c
	* gtk/gtktreemodel.c
	* gtk/gtktreemodelsort.c
	* gtk/gtkwindow.c
	fix docs	

Wed Jan  9 20:56:42 2002  Jonathan Blandford  <jrb@redhat.com>

	* gdk/x11/gdkkeys-x11.c (get_xkb): get the types as well as the
	symbols because we need them in MyEnhancedXkbTranslateKeyCode.

2002-01-10  Tor Lillqvist  <tml@iki.fi>

	Apply the same fixes and improvements as to the
	gtk-1-3-win32-production branch: Bug fixes and cleanup of
	selection and DND functionality. Still doesn't work as well as the
	win32-production branch, though, but getting closer.

	After this, need to add Archaeopteryx Software's OLE2 DND support.

	* gdk/win32/gdkselection-win32.c (gdk_selection_owner_set,
	gdk_selection_send_notify, generate_selection_notify): Don't use
	SendMessage() to generate events for the same app, instead use
	gdk_event_put().

	* gdk/win32/gdkprivate-win32.h
	* gdk/win32/gdkglobals-win32.c
	* gdk/win32/gdkmain-win32.c
	* gdk/win32/gdkevents-win32.c: Thus, remove declaration, definition,
	initialisation and handling of gdk_selection_notify_msg,
	gdk_selection_request_msg and gdk_selection_clear_msg. 

	* gdk/win32/gdkselection-win32.c (gdk_text_property_to_text_list,
	gdk_free_text_list, gdk_string_to_compound_text,
	gdk_free_compound_text): Implement trivially, witrh a text_list
	always having a single element, and a compound text always
	consisting of just a single (UTF-8!) string. Let's see how well
	this works.

	* gdk/win32/gdkselection-win32.c (gdk_selection_convert): Fix
	non-ASCII paste from the clipboard: Try getting the same formats
	from the Windows clipboard that gdk_property_change() puts there:
	CF_UNICODETEXT, UTF8_STRING or CF_TEXT+CF_LOCALE.

	* gdk/win32/gdkproperty-win32.c (gdk_property_change): When
	storing text on the clipboard, handle non-ASCII text
	correctly. The logic is as follows:

	If we have only ASCII characters, use CF_TEXT.

	Else, if we are on NT, use CF_UNICODETEXT.

	Else (we are on Win9x), if all the characters are present in the
	code page of some installed locale, use CF_TEXT and also set
	CF_LOCALE to that locale.

	Else (still on Win9x) store as RTF. We use a very simple RTF
	string, just the text, no fonts or other crap, with the non-ASCII
	characters as Unicode \uN keywords. Additionally, also store the
	UTF-8 string as such, under the format "UTF8_STRING", so that GDK
	can also paste from the Clipboard what it has copied there. (Thus
	no need to implement any RTF parser.)
	
	(find_common_locale): New function, implements the search for a
	locale for case 3 above.

	* gdk/win32/gdkglobals-win32.c: New global variables
	compound_text, text_uri_list, utf8_string, cf_rtf and
	cf_utf8_string.

	* gdk/win32/gdkim-win32.c (_gdk_ucs2_to_utf8): New function,
	converts from a wchar_t string to UTF-8.
	(_gdk_utf8_to_ucs2): Rename from _gdk_win32_nmbstowchar_ts.
	(_gdk_utf8_to_wcs): Rename from gdk_nmbstowchar_ts.

	* gdk/win32/gdkevents-win32.c (build_keypress_event): Use
	_gdk_ucs2_to_utf8().

	* gdk/win32/gdkselection-win32.c: Remove some unnecessary logging.

	* gdk/win32/gdkdnd-win32.c: Plug memory leaks, the
	gdk_drag_context_ref() was called unnecessarily in a couple of
	places, meaning drag contexts were never freed. The same memory
	leaks seem to be present in gdk/linux-fb/gdkselection-fb.c, BTW.

	(gdk_drop_reply): For WIN32_DROPFILES drops, free the temporarily
	stored file list.

	* gdk/win32/gdkselection-win32.c: Clarify the use of the
	sel_prop_table. Now it is used only for storing the GDK_SELECTION
	"properties".

	The file names dropped with WM_DROPFILES -style DND is stored
	temporarily (between the drop and the target picking them up) in a
	separate place.

	Have a separate hash table to map selection atoms to owner
	windows. This used to be quite mixed up.

	(_gdk_dropfiles_store): New function, to store the dropped file
	list for the drop target to possibly fetch, and clear it
	afterwards, from gdk_drop_reply().

	(gdk_selection_owner_get): Much simplified now.

2002-01-09  jacob berkman  <jacob@ximian.com>

	* gtk/gtklayout.c (gtk_layout_style_set): set the background of
	our bin window also (fixes #58957)

Wed Jan  9 19:10:07 2002  Jonathan Blandford  <jrb@redhat.com>

	* gtk/gtktreeselection.c
	(_gtk_tree_selection_internal_select_node): Now we test we can
	unselect nodes before selecting new ones.
	(gtk_tree_selection_real_select_node): be careful comparing booleans.

Wed Jan  9 21:31:44 2002  Kristian Rietveld  <kris@gtk.org>

	* gtk/gtkliststore.c (gtk_list_store_sort): pass NULL to
	gtk_tree_model_rows_reordered and not an iter with user_data
	set to NULL (which is an invalid liststore iter, so
	iter_n_children failed, etc)

2002-01-09  Sven Neumann  <sven@gimp.org>

	* tests/prop-editor.c: declared internal functions static.
	
Wed Jan  9 11:13:12 2002  Owen Taylor  <otaylor@redhat.com>

	* gtk/gtkmenuitem.c (_gtk_menu_item_refresh_accel_path): 
	Fix problem with menus without accel groups, such as the
	menus for option menus.

	* gtk/gtkpaned.c (gtk_paned_expose): Only conditionalize
	drawing of handle on whether both children are visible,
	not the drawing of the other child!. (#68325, Diego Gonzalez)

Wed Jan  9 10:20:16 2002  Owen Taylor  <otaylor@redhat.com>

	* gdk/x11/gdkdrawable-x11.c gdk/x11/gdkgc-c11.c: Check for
	RENDER before trying to use it... XRenderFindFormat() prints
	warnings if called when extension isn't present.

Wed Jan  9 15:20:40 2002  Tim Janik  <timj@gtk.org>

	* gtk/gtkmenuitem.c (gtk_menu_item_parent_set): update the accel
	path upon parent changes.

Wed Jan  9 13:20:14 2002  Tim Janik  <timj@gtk.org>

	* gtk/gtkviewport.c (gtk_viewport_size_allocate): small but important
	fix to force vadjustments at size_alocate time from Xavier Ordoquy
	<mcarkan@users.sourceforge.net>.

Wed Jan  9 11:23:39 2002  Tim Janik  <timj@gtk.org>

	* gtk/gtklayout.c (gtk_layout_get_property): 
	* gtk/gtkspinbutton.c (gtk_spin_button_get_property): 
	* gtk/gtktreeview.c (gtk_tree_view_get_property): 
	* gtk/gtkwidget.c (gtk_widget_get_property): 
	* gtk/gtkfontsel.c (gtk_font_selection_get_property): 
	* gtk/gtkrange.c (gtk_range_get_property):
	* gtk/gtkviewport.c (gtk_viewport_get_property):
	* gtk/gtkprogressbar.c (gtk_progress_bar_get_property): don't cast a
	possible NULL pointer.

2002-01-08  Mike Kestner  <mkestner@speakeasy.net>

	* gtk/gtkcelleditable.h : Use G_TYPE_INSTANCE_GET_INTERFACE.
	* gtk/gtktreednd.h : ditto.
	* gtk/gtktreemodel.h : ditto.
	* gtk/gtktreesortable.h : ditto.
	* gtk/gtkwidget.h : Don't reference incomplete _GdkRectangle type.

2002-01-08  Matthias Clasen  <matthiasc@poet.de>

	* gtk/gtkplug.c, gtk/gtksocket.c: Speak of window IDs rather 
	than XIDs in the docs.

	* gtk/gtkclipboard.c (gtk_clipboard_clear): Fix docs.

Tue Jan  8 18:39:23 2002  Jonathan Blandford  <jrb@redhat.com>

	* gtk/gtktreedatalist.c (gtk_tree_data_list_compare_func): wow!
	Am I a moron or what 0 < 1 is not equivalent to strcmp ("a", "b")

Tue Jan  8 18:04:01 2002  Owen Taylor  <otaylor@redhat.com>

	* gtk/gtktoolbar.c (gtk_toolbar_set_icon_size):
	Handle TOGGLE/RADIOBUTTON as well. (#68201,
	Damon Chaplin.)

	* gtk/gtktoolbar.c (get_first_child): Fix stupid 
	bug, just introduced.

Tue Jan  8 15:53:28 2002  Owen Taylor  <otaylor@redhat.com>

	* gtk/gtkdnd.c (gtk_drag_find_widget): Fix coordinate
	translations, once and for all.

	* gtk/gtktextbuffer.c (paste_from_buffer): Free
	the ClipboardRequest structure. (#66198, HideToshi
	Tajima)

2002-01-08  jacob berkman  <jacob@ximian.com>

	* gtk/gtklayout.c (gtk_layout_move_internal): queue a resize on
	the child rather than the layout. see bug #68263

Tue Jan  8 14:51:19 2002  Owen Taylor  <otaylor@redhat.com>

	* gtk/gtkpaned.c (gtk_paned_expose): Don't draw
	the handle if we aren't showing both children.
	(#68135, Diego Gonzalez)

Tue Jan  8 14:45:43 2002  Owen Taylor  <otaylor@redhat.com>

	* gtk/gtkwidget.c (gtk_widget_add_events): Fix
	leak of result of gtk_container_get_children().

Tue Jan  8 14:42:19 2002  Owen Taylor  <otaylor@redhat.com>

	* gtk/gtktoolbar.c: Fix leaks of results of
	gtk_container_get_children(). (#68199, Damon Chaplin)

Tue Jan  8 14:19:43 2002  Owen Taylor  <otaylor@redhat.com>

	* gtk/gtkcheckbutton.c (gtk_check_button_size_allocate): 
	Fix problem where child->requisition was accessed
	directly instead of calling get_child_requisition()
	(#68199, Damon Chaplin)

2001-01-08  James Henstridge  <james@daa.com.au>

	* gtk/gtkstyle.c: add trailing */ on doc comment.

Mon Jan  7 22:19:32 2002  Owen Taylor  <otaylor@redhat.com>

	* gdk/x11/gdkdrawable-x11.c (draw_with_pixmaps): Fix a
	problem where were the offset into the image was passed
	into convert_to_format() wrong.

	* gdk/x11/gdkdrawable-x11.c (gdk_x11_draw_pixbuf): Call
	gdk_x11_drawable_update_picture_clip () before using
	the picture; allow update_picture_clip() to take a NULL gc
	to mean no clipping.

2002-01-07  Matthias Clasen  <matthiasc@poet.de>

	* gtk/gtksocket.c (gtk_socket_get_id): Doc typo fix. (#68172)

	* gtk/gtktreemodel.c (gtk_tree_path_is_descendant): Fix docs.

	* gtk/gtktreemodel.c (gtk_tree_model_rows_reordered): Document.

	* gtk/gtkwindow.c (gtk_window_remove_accel_group): Fix docs.

	* gtk/gtkrc.c (gtk_rc_get_style_by_paths),
	gtk/gtkwidget.c (gtk_widget_get_toplevel, 
	gtk_widget_push_composite_child), gtk/gtkdialog.c 
	(gtk_dialog_new_with_buttons, gtk_dialog_run): Keep gtk-doc
	from messing up the indentation of inline examples.	

	* gtk/gtkmain.c, gtk/gtkrc.c: Consistently call g_getenv() 
	instead of getenv().

	* gtk/gtktreemodel.c, gtk/gtkaccelgroup.c, gtk/gtkclipboard.c,
	gtk/gtkdnd.c, gtk/gtkiconfactory.c, gtk/gtkrc.c,
	gtk/gtkstyle.c, gtk/gtkselection.c: Doc fixes.

	* gtk/gtkaccelmap.c (gtk_accel_map_add_filter,
	gtk_accel_map_foreach_unfiltered, gtk_accel_map_load_scanner):
	Document.

2002-01-07  Anders Carlsson  <andersca@gnu.org>

	* gtk/gtkcellrendererpixbuf.c (gtk_cell_renderer_pixbuf_render): Remove
	unused pixels and rowstride variables.
	(gtk_cell_renderer_pixbuf_get_size): Check for non-NULL width.

Mon Jan  7 08:48:23 2002  Tim Janik  <timj@gtk.org>

	* gtk/gtkdnd.c (gtk_drag_find_widget): don't forget to offset
	the pointer by x/y_offset into the new window when we found
	the drag destination.

	* gtk/gtkaccelmap.c (internal_change_entry): fix return code
	for simulation when the entry already contains the required
	accel key and mod.

2002-01-06  Matthias Clasen  <matthiasc@poet.de>
 
	* docs/debugging.txt: Replace GTK_NO_CHECK_CASTS by 
	G_DISABLE_CAST_CHECKS.

	* gtk/gtkaccelgroup.c (gtk_accel_group_from_accel_closure,
	gtk_accel_group_query, gtk_accel_group_find,
	gtk_accel_groups_from_object): Document.

	* gtk/gtkaccellabel.c (gtk_accel_label_set_accel_closure): Document.

2002-01-04  Hans Breuer  <hans@breuer.org>

	* gdk/gdkdraw.c gdk/gdkpixbuf-drawable.c : 
	need to cast image->mem away from void* to avoid 
	'error C2036: 'void *' : unknown size'. Doing pointer 
	arithmetics on void pointers is a GCCism afaik.

	* gdk/gdkpixbuf-render.c : #include "gdkinternals.h" for
	_gdk_draw_pixbuf ()

	* gdk/makefile.msc gdk/win32/makefile.msc 
        gdk/gtk/makefile.msc.in : use -FI msvc_recommended_pragmas.h

	* gdk/win32/gdkdrawable-win32.c : use _gkd_win32_copy_to_image
	and take care of image->visual possibly NULL.

	* gdk/win32/gdkimage-win32.c : implement _gdk_image_new_for_depth(),
	_gdk_win32_copy_to_image() and _gdk_windowing_bits_for_depth().
	Again take care of image->visual possibly NULL.

	* gdk/win32/gdkprivate-win32.h : declare _gdk_win32_copy_to_image()

	* gdk/win32/gdkevents-win32.c : use gdk_drawable_get_colormap
	instead of private field access

	* gdk/win32/gdkpixmap-win32.c (gdk_pixmap_new) : adapt
	colormap setting to the gdk-X behaviour

2001-01-04  Matthias Clasen  <matthiasc@poet.de>

 	* gtk/gtkwidget.c: Documentation additions.

2001-01-04  Matthias Clasen  <matthiasc@poet.de>

	* gtk/gtkobject.c (gtk_object_dispose): Fix a comment.

	* gtk/gtkwidget.c (gtk_widget_set_sensitive): tiny docs change

2002-01-04  Havoc Pennington  <hp@pobox.com>

	* gtk/gtkwidget.c (gtk_widget_set_sensitive): tiny docs change
	
Fri Jan  4 13:05:15 2002  Owen Taylor  <otaylor@redhat.com>

	* gtk/gtkdnd.c (gtk_drag_find_widget): At least
	don't infinite loop if the widget and window heirarchies
	don't correspond.

	* gtk/gtkdnd.c (gtk_drag_find_widget): Handle changes
	in heirarchy in ::drag_motion, ::drag_drop callbacks
	by referencing child widget lists. (Patch from Tim)

	* gtk/gtkdnd.c (gtk_drag_find_widget): Fix a problem
	with widgets where window.x != widget->allocation.x

Fri Jan  4 01:36:48 2002  Owen Taylor  <otaylor@redhat.com>

	* gdk/x11/gdkdrawable-x11.c (convert_to_format): Optimize
	a little bit. (More for consistency than because it
	makes much of a difference.)

Thu Jan  3 22:18:15 2002  Owen Taylor  <otaylor@redhat.com>

	* gdk/x11/gdkdrawable-x11.c gdk/x11/gdkprivate-x11.h
	(_gdk_x11_have_render): Private function to tell if we have RENDER
	extension.

	* gdk/x11/gdkgc-x11.c (_gdk_x11_gc_get_fg_picture): Return
	None if we don't have RENDER extension.

	* gdk/x11/gdkpango-x11.c (gdk_pango_context_get): Don't
	use Xft unless we have render extension.

	* gdk/x11/gdkdrawable-x11.c (gdk_x11_drawable_get_picture):
	Handle missing render extension.

	* gdk/gdkdraw.c gdk/gdkdrawable.h gdk/gdkpixmap.c gdk/gdkwindow.c
	gdk/gdkinternals.h: Add a private copy_to_image() virtual function
	to the GdkDrawable vtable that extends get_image() to allow
	copying onto existing images.  Make the default implementation of
	get_image() use this so that backends don't have to implement
	both. Add private wrapper _gdk_drawable_copy_to_image().

	* gdk/x11/gdkimage-x11.c gdk/x11/gdkprivate-x11.c
	gdk/x11/gdkdrawable-x11.c (_gdk_x11_copy_to_image): Implement
	copy_to_image() semantics, speed up by using ShmPixmaps and
	XCopyArea when possible, XFlush() after ungrabbing the server,
	generally redo the logic once again.

	* gdk/gdkinternals.h gdk/x11/gdkimage-x11.c
	_gdk_windowing_bits_per_depth(): Function to convert from depth to
	bits-per-pixel. (We assume only one bpp per depth - X requires
	this.)

	* gdk/gdkinternals.h gdk/gdkrgb.c gdk/gdkimage.c: Move the GdkRGB
	scratch image code into a generic _gdk_image_get_scratch() chunk
	of code that we can use other places we need scratch images.

	* gdk/gdkimage.c gdk/x11/gdkimage.c gdk/gdkinternals.h:
	Add _gdk_image_new_for_depth() as the backend 
	to _gdk_image_new() to allowing creating images with
	a depth and no visual.

	* gdk/gdkpixbuf-drawable.c: Fix so that getting 
	parts of images not at 0,0 actually works.

	* gdk/gdkdrawable.h gdk/gdkinternals.h gdk/gdkdraw.c
	gdk/gdkwindow.c gdk/gdkpixmap.c gdk/gdkpixbuf-render.c: 
	 - Add a new GdkDrawableClass vfunc _draw_pixbuf, and 
	  _gdk_draw_pixbuf() [ will be made public later ], to allow 
	  backends to accelerate drawing pixbufs. 
	 - Move the implementation of gdk_pixbuf_render_to_drawable_alpha()
	   to be the default implementation. 
	 - Update docs for gdk_pixbuf_render_to_drawable_alpha(). 
	 - Optimize the default implementation by using 
	   _gdk_image_copy_to_pixmap() and scratch shared images, and
	   special casing the compositing.

	* gdk/x11/gdkdrawable-x11.c: Accelerate _gdk_draw_pixbuf()
	with alpha using the RENDER extension.

        * gdk/gdkpixbuf-drawable.c (gdk_pixbuf_get_from_drawable):
	Optimize by _gdk_image_copy_to_pixmap() and scratch images.

	* tests/testrgb.c: Add test for speed of alpha composition,
	reduce the number of iterations since alpha composition
	can be a bit slow.

	* gdk/x11/gdkimage-x11.c gdk/gdkprivate-x11.h (_gdk_x11_image_get_shm_pixmap): 
	Private function to get a ShmPixmap for an image, if possible.

2002-01-04  Anders Carlsson  <andersca@gnu.org>

	* tests/testtreesort.c: Add my cool list of integers.

Thu Dec 27 18:12:55 2001  Owen Taylor  <otaylor@redhat.com>

	* gdk/x11/gdkproperty-x11.c (gdk_property_get): Fix
	problem where retrieved atoms weren't properly returned.

2002-01-03  Anders Carlsson  <andersca@gnu.org>

	* gtk/gtktextview.c (gtk_text_view_key_press_event): When
	tab is pressed and the text view isn't editable, 
	move the focus instead.

	* gtk/gtkstyle.c (gtk_default_draw_focus): Free dash list if
	necessary.

	* gtk/gtkhsv.c (gtk_hsv_get_focus_gc): Free dash list.

	* gtk/gtkcolorsel.c (get_focus_gc): Free dash list.

	* gtk/gtkdnd.c (set_icon_stock_pixbuf): Don't unref the mask
	if it's NULL.

	* gtk/gtktreeview.c: Rename gtk_tree_view_queue_draw_node to
	_gtk_tree_view_queue_draw_node.
	(gtk_tree_view_row_has_child_toggled): Only redraw one node.

	* gtk/gtktreesortable.c (gtk_tree_sortable_set_sort_func): 
	sort_column_id can be 0.

	* gtk/gtktreeselection.c (gtk_tree_selection_real_select_node):
	Only redraw one the node being selected.

	* gtk/gtktreeprivate.h: Add _gtk_tree_view_queue_draw_node.
	
Wed Jan  2 23:09:06 2002  Tim Janik  <timj@gtk.org>

	* gtk/gtkcontainer.c (_gtk_container_queue_resize): don't ignore
	realized but visible && !mapped resize containers (which is
	possible with unset CHILD_VISIBLE now).

2002-01-02  jacob berkman  <jacob@ximian.com>

	* gtk/Makefile.am (LDFLAGS): automake still doesn't support
	libsomething_la_LDFLAGS, so fix the build again

2002-01-01  Havoc Pennington  <hp@pobox.com>

	* gtk/gtktextview.c (gtk_text_view_expose_event): propagate
	exposes to no window children not in the buffer window.
	(gtk_text_view_class_init): add move_focus bindings for Ctrl-Tab
	- is this the right way to do it?
	(gtk_text_view_focus): add focus method, just chains up for now, 
	I'm not sure why the GtkContainer implementation doesn't work

	* gtk/gtktextbtree.c (_gtk_text_btree_insert_child_anchor): fill
	in the text line for the child anchor segment

	* tests/testtext.c (do_add_focus_children): add another test
	example (to put focusable buttons into the widget)

2002-01-01  Havoc Pennington  <hp@pobox.com>

	* docs/README.linux-fb: note that this file is obsolete

	* docs/Changes-2.0.txt, docs/Changes-1.2.txt: Add notes to these
	files that they should not be edited and look in the reference 
	manual instead. Probably these files should just be replaced by 
	the note, and their main contents deleted.

	* gtk/gtktextview.c: docs

	* gtk/gtktextmark.c: docs

	* gtk/gtktextchild.c: docs

	* gtk/gtktextbuffer.c: docs stuff

	* gtk/gtkclipboard.c (gtk_clipboard_get): fool with docs to maybe
	give people more leads in sorting out PRIMARY vs. CLIPBOARD

2002-01-01  Tor Lillqvist  <tml@iki.fi>

	* demos/Makefile.am (test-inline-pixbufs.h): Append EXEEXT to
	../gdk-pixbuf/gdk-pixbuf-csource.

2001-12-31  Tor Lillqvist  <tml@iki.fi>

	* gdk/win32/gdkgc-win32.c (predraw_set_foreground): Improved error
	handling.
	(gdk_win32_hdc_get,gdk_win32_hdc_release): Silence gcc -Wall.

	* gdk/win32/gdkimage-win32.c (_gdk_win32_get_image): Silence gcc
	-Wall.  Use GDK_IS_PIXMAP_IMPL_WIN32 instead of GDK_IS_PIXMAP in
	one more place.

	* gdk/win32/gdkinput-win32.c (_gdk_input_other_event): Silence gcc
	-Wall.

	* gtk/Makefile.am (libgtk_win32_1_3_la_LDFLAGS): Add -lwsock32.

2002-01-01  Havoc Pennington  <hp@pobox.com>

	* gtk/gtktextview.c (gtk_text_view_get_default_attributes): doc 
	fix
	
2002-01-01  Havoc Pennington  <hp@pobox.com>

	* gtk/gtktextview.c (changed_handler): Replace call to
	gtk_widget_size_request() that expected to actually compute the
	request with a direct use of widget_class->size_request, so we get
	our size request right; fixes remaining part of #63065 reported by
	Matthias Clasen

2001-12-31  Havoc Pennington  <hp@pobox.com>

	* tests/testtext.c (do_insert_and_scroll): remove backward_char
	since we no longer have bogus newline
	(dialog_response_callback): remove another backward_char horkage, 
	reported by Matthias Clasen #63065

2001-12-31  Havoc Pennington  <hp@pobox.com>

	* gtk/gtktextbtree.c (gtk_text_btree_node_view_check_consistency):
	fix an incorrect assertion that the "valid" flag is always correct
	in a node and add explanatory comment. This keeps me from 
	reproducing #59101, but I'm remembering that 59101 was actually 
	about incorrect pixel totals, so I'm not sure 59101 is actually 
	fixed. May just have stopped happening due to some change in 
	how C-k works.

2001-12-31  Havoc Pennington  <hp@pobox.com>

	* gtk/gtktextview.c (gtk_text_view_start_selection_drag): extend
	selection if shift is down, bug #50939
	(gtk_text_view_button_press_event): add double/triple click
	selection to the current selection if shift is down

2001-12-31  Havoc Pennington  <hp@pobox.com>

	* gtk/gtktextiter.c (gtk_text_iter_get_visible_line_index): fix 
	to use ensure_byte_offsets not ensure_char_offsets, patch 
	from Padraig O'Briain bug #67356
	
2001-12-30  Havoc Pennington  <hp@pobox.com>

	* gtk/gtkdialog.h (GtkDialogFlags): fix GtkDialogFlags to have 
	the right values, reported by Jeff Franks

2001-12-30  Matthias Clasen  <matthiasc@poet.de>

	* gtk/gtkwindow.c, gtk/gtkimcontextsimple.c: Minor documentation tweaks.

2001-12-28  Matthias Clasen  <matthiasc@poet.de>

	* gdk/x11/gdkproperty-x11.c, gdk/x11/gdkselection-x11.c: 
	Minor documentation tweaks.

2001-12-28  Tor Lillqvist  <tml@iki.fi>

	* gdk/win32/gdkfont-win32.c: Use G_N_ELEMENTS().
	(unicode_classify): Don't return -1 on encountering an
	unclassified character, but play it safe and return U_BASIC_LATIN.

Thu Dec 27 16:05:30 2001  Owen Taylor  <otaylor@redhat.com>

	* gtk/gtkarrow.c gtk/gtkimage.c gtkpixmap.c: Make interpretation
	of misc->xpad/ypad consistent with GtkLabel. Do 
	directional flipping when interpreting misc->xalign/yalign.
	Fix off-by-one error for negative x,y. (#67472, reported
	by Mathieu Lacage)

Thu Dec 27 15:45:41 2001  Owen Taylor  <otaylor@redhat.com>

	* gtk/gtkwidget.c (gtk_widget_set_style_internal):
	Remove optimization that was causing problems because
	we called gtk_widget_size_request() before we called
	gtk_widget_queue_resize() so RESIZE_NEEDED was not
	set. Optimization shouldn't mattter now that we
	are smart about needlessly size requesting or allocating
	widgets. (#67598, reported by Jacob Berkman)

Thu Dec 27 15:38:20 2001  Owen Taylor  <otaylor@redhat.com>

	* gtk/gtkmenu.c (gtk_menu_stop_navigating_submenu_cb):
	Call gdk_window_get_pointer() on menu->bin_window not
	menu->window, so we get the correct window for the
	menu item. (#65213, Guillermo S. Romero)

Thu Dec 27 15:13:44 2001  Owen Taylor  <otaylor@redhat.com>

	* gtk/gtkmenu.c (gtk_menu_set_title): Allow unsetting
	the title by setting to NULL. Move docs inline. 
	Update the title if the tearoff window already
	exists. Code cleanup. (Fixes #65190, reported by
	Vitaly Tishkov.)

Thu Dec 27 14:04:22 2001  Owen Taylor  <otaylor@redhat.com>

	* gtk/gtksocket.c (gtk_socket_key_press_event): 
	gtk/gtkplug.c (gtk_plug_key_press_event): Don't do
	special handling of key presses unless we are doing 
	iter-app embedding. (Fixes #67590, Anders Carlsson)

Thu Dec 27 16:37:04 2001  Kristian Rietveld  <kris@gtk.org>

	* gtk/gtktreemodelsort.c (gtk_tree_model_sort_row_deleted),
	(gtk_tree_model_sort_sort_level),
	(gtk_tree_model_sort_insert_value): fix a few places where
	I was confused between modelsort iters and other iters. This was
	really going to happen someday ;)

Wed Dec 26 23:41:41 2001  Kristian Rietveld  <kris@gtk.org>

	* gtk/gtktreeview.c (gtk_tree_view_rows_reordered): ensure
	we are unprelighted before reordering

	* gtk/gtktreemodel.c (gtk_tree_row_ref_reordered_callback): we
	need to break out of the for loop, not return (this fixed
	the 'selection freeze' bug).

	* gtk/gtktreemodelsort.c: more fixage and cleanups. It seems to
	be pretty stable now, though it still needs some more code
	cleanups.

Wed Dec 26 12:32:31 2001  Owen Taylor  <otaylor@redhat.com>

	* docs/Changes-2.0.txt: Document the fact that
	gtk_paned_set_handle_size() has been removed.

	* gtk/gtkpaned.h Remove gtk_paned_handle_size() compat macro, 
	since it pointed to gtk_paned_set_handle_size(), which
	was removed. (#66760, Matt Wilson)

Wed Dec 26 12:28:24 2001  Owen Taylor  <otaylor@redhat.com>

	* gtk/gtkdnd.c (gtk_drag_highlight): Connect 
	gtk_drag_hightlight_expose _after_, so it works with
	widgets that paint there entire background. (#66735)

Wed Dec 26 12:17:06 2001  Owen Taylor  <otaylor@redhat.com>

	* gtk/gtkplug.c (gtk_plug_size_allocate): Assign the
	allocation to widget->allocation. (Fixes #67290,
	Chris Phelps.)

Wed Dec 26 11:49:01 2001  Owen Taylor  <otaylor@redhat.com>

	(#67542, reported by Anders Carlsson)
	
	* gtk/gtkstyle.c (gtk_style_real_init_from_rc): Merge
	rc_style->font_desc with defaul style instead of replacing
	it.

	* gtk/gtkrc.c (gtk_rc_style_real_merge): Allow partial
	font descriptions in RC styles by calling
	pango_font_description_merge(). 

2001-12-24  James Henstridge  <james@daa.com.au>

	* gtk/gtkdialog.h (doc comment): s/<!>/<!-- -->/ to make the doc
	valid with both SGML and XML.

Sat Dec 22 12:38:03 2001  Owen Taylor  <otaylor@redhat.com>

	* configure.in: 1.3.12, interface, binary age 0.

	* configure.in: Require new versions of Glib, Pango, ATK.

	* NEWS: Updated.

	* configure.in: Make explicit what libtool we are executing.
	(Tomas Ogren)

	* gdk/gdkcolor.c gdk/gdkgc.c gdk/gdkwindow.c: Doc fixes.

	* gtk/gtkwidget.c (gtk_widget_[class]path) gtkrc.h : Fix 
	parameter names for docs.

Sat Dec 22 22:35:29 2001  Owen Taylor  <otaylor@redhat.com>

	* gtk/gtkwindow.c (gtk_window_realize) 
	  gtk/gtkplug.c (gtk_plug_realize): Include GDK_KEY_RELEASE_MASK.

	* gtk/gtkentry.c (gtk_entry_key_release)
	  gtk/gtktextview.c (gtk_text_view_key_release_event): Pass
	key release events to the input method.

	* gtk/gtkimcontextsimple.c (gtk_im_context_simple_filter_keypress): 
	Handle release of Control/Shift to end hex sequence.

	* modules/input/gtkimcontextxim.c (gtk_im_context_xim_filter_keypress): 
	Handle key releases as well as presses.

2001-12-21  Matthias Clasen  <matthiasc@poet.de>

	* gtk/gtktoolbar.c (gtk_toolbar_insert_element): Trivial doc adjustment.

	* gtk/gtklabel.c (gtk_label_new_with_mnemonic),
	gtk/gtkbutton.c (gtk_button_new_with_mnemonic): More precise
	documentation about underscores and mnemonics. (#66380)

	* gtk/gtktextiter.c (gtk_text_iter_backward_word_starts): Fix
	cyclic reference in docs.

	* gtk/gtklabel.c (gtk_label_set_justify): Correct documentation
	of default value. (#65402)

	* gtk/gtkmain.c (gtk_set_locale, gtk_disable_set_locale): 
	Markup fixes.

2001-12-20  Anders Carlsson  <andersca@gnu.org>

	* gtk/gtktreeview.c (gtk_tree_view_realize): Don't call
	map here.

Tue Dec 18 16:15:55 2001  Owen Taylor  <otaylor@redhat.com>

	* gdk/gdkgc.h: Explicitely deprecate gdk_gc_set_font()
	(reported by Jeff Franks.)

Tue Dec 18 16:07:28 2001  Owen Taylor  <otaylor@redhat.com>

	* gdk/gdkkeys.h (struct _GdkKeymapClass): Fix 
	prototype for direction_changed. (Reported by
	Jeff Franks.)

2001-12-18  Padraig O'Briain <padraig.obriain@sun.com>

	* gtk/gtktreeview.c (gtk_tree_view_get_expander_column):
	Fix typo (list->data becomes list->next)

2001-12-06  Havoc Pennington  <hp@redhat.com>

        Add Unicode control char menu, based on patch from Dov.
	Bug #63495
	
	* gtk/gtkentry.c (gtk_entry_commit_cb): share code via
	gtk_entry_enter_text
	(gtk_entry_enter_text): function to do "typing in text"
	(popup_targets_received): add the Unicode menu items

	* gtk/gtktextview.c (popup_targets_received): add missing mnemonic
	on Input Methods item, and add the unicode menu items.

	* gtk/gtktextutil.h, gtk/gtktextutil.c: private utilities to be
	used in GtkEntry and GtkTextView - may become public later.	

2001-12-16  Kjartan Maraas  <kmaraas@gnome.org>

	* gtk/gtkprogressbar.c: Fix a typo.
	* gtk/gtkpaned.c: Fix a typo.
	
2001-12-15  Darin Adler  <darin@bentspoon.com>

	Fix some warnings.

	* gdk/x11/gdkproperty-x11.c: (gdk_property_get): Fix wrong type in
	g_new -- bug if sizeof (GtkAtom) != sizeof (GtkAtom *).
	* gdk/x11/gdkwindow-x11.c: (create_moveresize_window): FALSE -> NULL
	* gtk/gtkaccellabel.c: (gtk_accel_label_refetch): Remove unused local.
	* gtk/gtklistitem.c: (gtk_list_item_expose): Remove unused local.
	* gtk/gtktextiter.c: (_gtk_text_iter_backward_indexable_segment):
	Restructure loop to get rid of uninitialized variable warning. Also
	gives a tiny efficiency gain.

2001-12-15  Murray Cumming  <murrayc@usa.net>

	* Fixed first arg type of GtkScale's "format_value" signal's
	function pointer.

2001-12-14            Vitaly Tishkov       tvv@sparc.spb.su
        docs/reference/gtk/tmpl/gtkcelleditable.sgml
                gtkcelleditable -> GtkCellEditable
        docs/reference/gtk/tmpl/gtktreesortable.sgml
                gtktreesortable -> GtkTreeSortable

2001-12-13  Sebastian Wilhelmi  <wilhelmi@ira.uka.de>

	* demos/testpixbuf-drawable.c, demos/testpixbuf-save.c,
	demos/testpixbuf-scale.c, demos/testpixbuf.c: Call g_object_ref
	and g_object_unref instead of gdk_pixbuf_ref and gdk_pixbuf_unref
	resp.

Thu Dec 13 22:02:41 2001  Kristian Rietveld   <kris@gtk.org>

	* gtk/gtktreeview.c (validate_visible_area): free path
	at the end

2001-12-13  Matthias Clasen  <matthiasc@poet.de>

	* gtk/gtkdialog.c, gtk/gtkrc.c, gtk/gtkwidget.c: Markup fixes.

Thu Dec 13 20:37:27 2001  Kristian Rietveld  <kris@gtk.org>

	* gtk/gtktreeview.c (gtk_tree_view_button_press): do not try
	to find the clicked node in the tree when tree == NULL

2001-12-13  Anders Carlsson  <andersca@gnu.org>

	* gtk/gtktreeview.c (gtk_tree_view_button_press): Compare 
	event->state with the default mod mask. 

2001-12-12  jacob berkman  <jacob@ximian.com>

	* gtk/gtk*.h (GTK_IS_*_CLASS): s/obj/klass/ where appropriate

Wed Dec 12 17:22:45 2001  Owen Taylor  <otaylor@redhat.com>

	* gtk/gtkimmulticontext.c (gtk_im_multicontext_set_slave):
	Reset the existing slave before removing it to give
	it a chance to commit and emit "preedit_changed" 
	in case there was still a preedit string.

2001-12-12  Matthias Clasen  <matthiasc@poet.de>
	
	* gtk/gtktextlayout.c: Typo fixes
	* gtk/gtkwindow.c (gtk_window_set_position): Typo fix. (#66746)

	* gtk/gtkwidget.c (gtk_widget_send_expose, gtk_widget_get_toplevel, 
	gtk_widget_get_default_direction): Doc fixes. (#66727, #66737, #66744)

	* gtk/gtkstyle.h (GTK_STYLE_NUM_STYLECOLORS): Remove. (#66467)

Wed Dec 12 16:43:10 2001  Jonathan Blandford  <jrb@redhat.com>

	* gtk/gtktreeview.c (gtk_tree_view_unrealize): Remove
	validate_rows_timer in unrealize.  Reported by Matthew Wilson.

Wed Dec 12 16:18:26 2001  Owen Taylor  <otaylor@redhat.com>

	* gtk/gtkmenu.c (gtk_menu_realize): Remove support for
	"prepainting" the menu before realizing other than
	via gtk_style_set_background() - this was broken when
	we added menu scroll support.

	* gtk/gtkmenu.c (gtk_menu_paint): Pay attention to the
	window in the expose event -- fixes problem with border
	flashing during scrolling.

Wed Dec 12 15:11:49 2001  Owen Taylor  <otaylor@redhat.com>

	* gtk/gtksettings.c (gtk_settings_get_property): Support
	using names/nicks for the gdk_settings values for enum valued
	types. (#57678, reported by Anders Carlsson)

Wed Dec 12 15:01:33 2001  Jonathan Blandford  <jrb@redhat.com>

	* gtk/gtknotebook.c (gtk_notebook_set_tab_label): keep in sync
	with insert_page_menu.  Code duplication is bad.

	* gtk/gtklabel.c (gtk_label_mnemonic_activate): Whoops -- got the
	wrong fix yesterday.

Wed Dec 12 14:27:30 2001  Owen Taylor  <otaylor@redhat.com>

	* gtk/gtkmenubar.c (window_key_press_handler): Fix check for
	modifiers.

2001-12-12  James Henstridge  <james@daa.com.au>

	* gtk/gtkmenu.c (gtk_menu_key_press): check GTK_MENU_ITEM
	(menu_item)->accel_path first when looking up the accel path.

Tue Dec 11 19:18:21 2001  Owen Taylor  <otaylor@redhat.com>

	* tests/testgtk.c (layout_expose_handler): Only draw
	for events on the bin window.

Tue Dec 11 18:55:16 2001  Jonathan Blandford  <jrb@redhat.com>

	* gtk/gtklabel.c (gtk_label_mnemonic_activate): Small fix to let
	mnemonics work with notebooks.

Tue Dec 11 15:25:06 2001  Jonathan Blandford  <jrb@redhat.com>

	* gtk/gtktreeview.c (gtk_tree_view_size_allocate): Change
	bin_window to be located at y=TREE_VIEW_HEADER_HEIGHT(tree_view).
	Makes some flicker while scrolling go away.

2001-12-11  Michael Natterer  <mitch@gimp.org>

	* demos/testpixbuf-save.c: added new keyboard shortcut 'a' which
	adds alpha to the pixbuf; re-load the saved pixbuf and
	pixel-by-pixel compare it with the original one.

Tue Dec 11 15:39:08 2001  Soeren Sandmann  <sandmann@daimi.au.dk>

	* ChangeLog: Fix wrong ChangeLog entry
	* gtk/gtkstyle.c (gtk_default_draw_shadow_gap): Fix drawing of top
	right corner

2001-12-10  jacob berkman  <jacob@ximian.com>

	* gdk/x11/gdkinput-xfree.c (_gdk_input_grab_pointer): 
	* gdk/x11/gdkmain-x11.c (gdk_pointer_grab): 
	(gdk_keyboard_grab): do not grab things if the nograb debug flag
	is set

	* gdk/gdkinternals.h: 
	* gdk/gdk.c: add nograbs debug flag to disable grabs of the
	keyboard / mouse

Mon Dec 10 19:42:29 2001  Jonathan Blandford  <jrb@redhat.com>

	* gtk/gtktreeview.c (validate_rows_handler): stupid bug where I
	didn't reset the timer.

2001-12-10  Matthias Clasen  <matthiasc@poet.de>

	* gtk/gtkcontainer.c (gtk_container_child_type): Close comment.

2001-12-09  Matthias Clasen  <matthiasc@poet.de>

	* gtk/gtkviewport.c: Add docs.

Mon Dec 10 16:21:38 2001  Jonathan Blandford  <jrb@redhat.com>

	* gtk/gtkrbtree.c (_fixup_parity): New function to fixup parity.
	RBTree corruption bug--

2001-12-10  Anders Carlsson  <andersca@gnu.org>

	* gtk/gtktreeview.c (gtk_tree_view_remove_widget): Return
	if edited_column is NULL, also grab focus before removing
	the cell_editable.

Sun Dec 09 15:06:51 2001  George Lebl <jirka@5z.com>

	* gtk/gtkrange.c (gtk_range_calc_layout): check for 0 value on the
	  denominator in the horizontal case just like we do in the vertical
	  case (why I didn't notice that there were two cases the first time
	  around is beyond me:).  Also fix indentation in the vertical case.

2001-12-09  Anders Carlsson  <andersca@gnu.org>

	* gdk/x11/gdkevents-x11.c: Update xsettings name.

	* gtk/gtkdnd.c (gtk_drag_check_threshold): Use the
	gtk-dnd-drag-threshold GtkSetting.

	* gtk/gtksettings.c (gtk_settings_class_init): Add 
	setting for dnd drag threshold.

2001-12-09  Matthias Clasen  <matthiasc@poet.de>

	* gtk/gtkcontainer.c: Add docs.

2001-12-08  Matthias Clasen  <matthiasc@poet.de>

	* gtk/gtkwidget.c: Doc markup fix. 

	* gtk/gtktreeviewcolumn.c: Markup fixes. (#66447)

	* gtk/gtktreestore.c: Typo fixes. (#66445)

	* gtk/gtkaccelgroup.c: Misc doc markup. (#66425) 

	* gtk/gtkclipboard.c (gtk_clipboard_get_owner): Fix reference
	to gtk_clipboard_set_with_owner(). (#66424)
 
Sat Dec  8 16:12:10 2001  Christopher Blizzard  <blizzard@redhat.com>

	* gdk/gdk.c (gdk_init_check): Fallback to setting the prgname to
	"<unknown>" if someone doesn't pass in a valid argc.  (Patch from
	Fabrice Bellet <fabrice@gnu.org>, #54127).

Sat Dec  8 10:04:54 2001  Jonathan Blandford  <jrb@redhat.com>

	* gtk/gtkrbtree.c (_gtk_rbtree_debug_spew): Add debug spew to lots
	of places, so that people with crashy trees can just run their
	program with GTK_DEBUG=TREE.

Sat Dec  8 20:57:24 2001  Kristian Rietveld  <kristian@planet.nl>

	* gtk/gtkliststore.c (gtk_list_store_remove): nuke the stamp++,
	per jrb's request

2001-12-08  Anders Carlsson  <andersca@gnu.org>

	* tests/testgtk.c (layout_expose_handler): Don't return TRUE
	since then the default GtkLayout expose handler won't be called.

Fri Dec  7 23:42:50 2001  Jonathan Blandford  <jrb@redhat.com>

	* gtk/gtktreeview.c (validate_rows_handler): remove
	g_return_if_fail.

	* gtk/gtktreeview.c (validate_visible_area): Patch from Manish
	Singh <yosh@gimp.org> to fix bug when rendering Tree with an
	empty model.

Fri Dec  7 20:06:14 2001  Jonathan Blandford  <jrb@redhat.com>

	* gtk/gtktreeview.c (validate_visible_area): get logic right,
	#66249

	* gtk/gtkrbtree.c (_gtk_rbtree_remove_node): fix bug where
	removing a node ended up with a corrupt tree.  Really really nasty
	bug.
	(_gtk_rbtree_debug_spew): new debug helper function
	(_fixup_validation): new inline function to clean up code
	readability a lot. 

Fri Dec  7 19:34:51 2001  Owen Taylor  <otaylor@redhat.com>

	* gtk/gtktoolbar.c (gtk_toolbar_insert_element):
	Close comment.

2001-12-07  Matthias Clasen  <matthiasc@poet.de>

	* gtk/gtkstyle.h: Typo fixes.

	* gtk/gtkstyle.c, gtk/gtktoolbar.c: Add docs.

	* gtk/gtkrc.c (gtk_rc_find_pixmap_in_path): Fix docs.

Fri Dec  7 16:05:22 2001  Owen Taylor  <otaylor@redhat.com>

	* modules/input/gtkimcontextxim.c: Display the XIM
	status callbacks with a popup window. (Patch from
	HideToshi Tajima, #50628, somewhat modified.)

Fri Dec  7 12:07:15 2001  Tim Janik  <timj@gtk.org>

	* gtk/Makefile.am: each source generation rule needs to use its own
	temporary file, to avoid clashes for parallel builds. fixed rules
	for gtkmarshalers.h and gtkmarshalers.c to use their own temp files.

2001-12-07  Havoc Pennington  <hp@pobox.com>

	* gdk/x11/gdkcursor-x11.c (gdk_cursor_new): fix up my list of
	"cursors that are actually useful" in gdk_cursor_new() docs

Thu Dec  6 23:09:21 2001  Owen Taylor  <otaylor@redhat.com>

	* gtk/gtk[hv]paned.c (gtk_[hv]paned_size_allocate): Fix errors
	in computing the size of the second child.

Thu Dec  6 16:50:17 2001  Owen Taylor  <otaylor@redhat.com>

	* gtk/gtkrange.c: Make button 1 clicks on the trough
	do pages, button 3 steps. (Patch from Hans Breuer
	#63735)

2001-12-06  Matthias Clasen  <matthiasc@poet.de>

	* gtk/gtklabel.c: Fix docs. (#66383)

	* gtk/gtkbbox.c (gtk_button_box_set_child_secondary): Fix docs. 
     	(#66278, #66280)
	
	* gdk/gdkwindow.h (gdk_window_get_deskrelative_origin),
	gdk/gdkimage.h (gdk_image_get): Deprecate. (#66208)

	* gtk/gtkcolorsel.c (gtk_color_selection_set_update_policy):
	Don't emit a g_warning() about being deprecated. (#66208)	

	* gtk/gtkaccellabel.c (gtk_accel_label_set_accel_widget): Add docs.

	* gtk/gtkcontainer.c: Doc fixes.
	
	* gtk/gtkliststore.c (gtk_list_store_clear): Add docs; misc doc fixes.

	* gtk/gtkstyle.c (gtk_style_attach): Add docs.

2001-12-05  Sven Neumann  <sven@gimp.org>

	* gtk/gtkwidget.c (gtk_widget_reset_shapes): close comment.

	* gtk/queryimmodules.c: g_dir_read_name() returns const.

Tue Dec  4 21:46:13 2001  HideToshi Tajima  <hidetoshi.tajima@sun.com>

	* gtk/gtktreeprivate.h: restore the else case of #ifdef __GNUC__
	#66225
	
2001-12-04  Manish Singh  <yosh@gimp.org>

	* gtk/gtkmain.c
	* gtk/queryimmodules.c: g_module_symbol takes a gpointer *, not just
        a gpointer.

	* gtk/gtkwidget.c (gtk_widget_push_composite_child): minor cosmetic
	correction to docs.

	* demos/gtk-demo/item_factory.c: add GTK_WINDOW() cast

2001-12-04  Havoc Pennington  <hp@redhat.com>

	* gtk/gtktextbtree.c (gtk_text_btree_remove_tag_info): remove
	g_assert_not_reached() that was bogus, since we demand-create the
	tag info. reported by Chris Phelps

        Jump through assorted hoops to fix bug from Chris Phelps where 
	removing tags from the table resulted in btree trying to 
	access tag->table
	
	* gtk/gtktextbuffer.c: set up mechanics of adding/removing 
	ourselves to the tag table

	* gtk/gtktexttagtable.c (_gtk_text_tag_table_add_buffer) 
	(_gtk_text_tag_table_remove_buffer): private cruft to 
	let us notify buffer of disappearing tags

	* gtk/gtktexttag.h: remove BTreeNode typedef from this public
	header, put it in tagprivate	

	* gtk/gtktextbtree.c (_gtk_text_btree_new): don't connect to
	tag_removed; it's emitted too late.
	(_gtk_text_btree_notify_will_remove_tag): rename tag_remove_cb to
	this

	Padding for ABI-compat expansion
	
	* gtk/gtktexttag.h (struct _GtkTextAttributes): pad this
	(struct _GtkTextAppearance): one pad in here too

	* gtk/gtktextlayout.h (struct _GtkTextLayoutClass): padding here

	* gtk/gtktextview.h (struct _GtkTextViewClass): more padding,
	since action signals etc. seem pretty likely

	* gtk/gtktextbuffer.h (struct _GtkTextBufferClass): padding

	* gtk/gtktexttag.h (struct _GtkTextTagClass): padding

	* gtk/gtktexttagtable.h (struct _GtkTextTagTableClass): padding

2001-12-04  Matthias Clasen  <matthiasc@poet.de>

        * gdk/gdkcolor.h (gdk_colormap_change): Deprecate. (#65851)

        * gdk/gdktypes.h (GdkKeyInfo): Remove. (#66025)

	* gtk/gtkwindow.c, gtk/gtkwidget.c: Add docs, markup fixes.

Tue Dec  4 18:51:44 2001  Jonathan Blandford  <jrb@redhat.com>

	* gtk/gtktreeviewcolumn.h: remove gtk_tree_view_column_cell_event,
	#62084.

Tue Dec  4 18:38:35 2001  Jonathan Blandford  <jrb@redhat.com>

	* demos/gtk-demo/main.c: (create_tree): Minor fix.

	* docs/tree-column-sizing.txt: Update

	* gtk/gtkrbtree.[ch]: Massive work to support validation.

	* gtk/gtktreemodel.c: Doc fixes.

	* gtk/gtktreeview.c: Incremental reflow added.
	* gtk/gtktreeviewcolumn.c: ditto
	* gtk/gtktreeviewcolumn.h: ditto

2001-12-04  Havoc Pennington  <hp@redhat.com>
	
	* gtk/gtktexttag.c (gtk_text_tag_set_property): add a warning for
	"invisible" property, #65999

2001-12-04  Matt Wilson  <msw@redhat.com>

	* gtk/gtktreestore.c (gtk_tree_store_insert): fixed docs

Tue Dec  4 12:16:31 2001  Owen Taylor  <otaylor@redhat.com>

	* gtk/gtksettings.c (gtk_settings_set_property_value):
	Simplify, make more efficient and fix memory leak
	when turning quark into a string. (#66103, HideToshi
	Tajima)

	* gtk/gtkcolorsel.c: Ref and sink priv->tooltips in
	init() and unref priv->tooltips in destroy rather
	than calling gtk_object_destroy() which has no
	effect on memory management. (#66104, HideToshi
	Tajima)

	* gtk/gtkcolorsel.c (palette_set_color): Use g_object_set_data_full()
	so we free the when the object is freed. (Fixes memory
	leak, #66096, HideToshi Tajima)

	* gdk/gdkevents.c (gdk_synthesize_window_state): Use 
	a full GdkEvent structure to avoid reads of uninitialized/
	invalid memory in gdk_event_put() (#65877, patch
	from Hidetoshi Tajima)

Tue Dec  4 11:06:54 2001  Owen Taylor  <otaylor@redhat.com>

	* gtk/gtkmenuitem.c: Revert my last mistaken change - 
	toggle-size-request doesn't take a requisition.

	* gtk/gtkmenuitem.c (gtk_menu_item_class_init): Fix
	reference to marshaler that no longer exists.

Mon Dec  3 16:39:17 2001  Owen Taylor  <otaylor@redhat.com>

	Patch from Bill Haneman (with many modifications) to make
	the focus color work on dark themes and to make the
	focus line width configurable. (#61079, #63074)

        * gtk/gtkwidget.c: Add style properties, 
	::focus-widget, ::focus-line-width, and ::focus-padding.

	* gtk/gtkstyle.[ch]: Make gtk_paint_focus() take a 
	state argument as well so we can use fg[STATE] to
	draw instead of always drawing with black. 
	Cange paint_focus() to respect GtkWidget::focus-width
	and GtkWidget::focus-line-pattern. Fix continuity
	problem where the default 1-1 stipple had a blob
	in one corner and a gap in the other. Change the
	interpretation of x/y/width/height to be the bounding
	box of the focus rect instead of the rectangle
	passed to gdk_draw_rectangle.

	* gtk/gtkcheckbutton.c gtk/gtklistitem.c gtk/gtknotebook.c 
	gtk/gtkoptionmenu.c gtk/gtkradiobutton.c gtk/gtkspinbutton.c 
	gtk/gtktextview.c gtk/gtktreeview.c: Handle ::focus-width 
	and ::focus-line-padding.

	* gtk/gtkentry.c: Handle :;focus-width property; cleanup
	and remove duplicated code; fix drawing of focus rectangle
	when interior-focus = FALSE. (#63072, #63073)

	* gtk/gtkrange.c gtk/gtktext.c gtk/gtktreeitem.c
	gtk/gtktreeviewcolumn.c: Basic fixups to make compile;
	Range and TreeViewColumn will need more extensive fixing.

	* gtk/gtkcolorsel.c: Honor focus line attributes when
	drawing the focus on the color swatches. (#63071)

	* gtk/gtkhsv.c: Honor focus line attributes when
	drawing the focus for the ring and triangle.

	* docs/widget_geometry.txt: Start at documenting how 
	various widgets are drawn.

	* gtk/gtkbutton.c (_gtk_button_paint): Export 
	_gtk_button_paint() librarywide, so we don't have 
	duplicate a bunch of code in gtktogglebutton.c.

	* gtk/gtktogglebutton.c: Use _gtk_button_paint().

Mon Dec  3 21:04:13 2001  Jonathan Blandford  <jrb@redhat.com>

	* gtk/gtkmarshalers.list: remove VOID:BOXED,POINTER and
	NONE:POINTER.

2001-12-03  Alex Larsson  <alexl@redhat.com>

	* gtk/gtkaccellabel.c:
	* gtk/gtkarrow.c:
	* gtk/gtkcolorsel.c:
	* gtk/gtkcontainer.c:
	* gtk/gtklabel.c:
	* gtk/gtktextview.c:
	* gtk/gtktogglebutton.c:
	* gtk/gtktreeview.c:
	* gtk/gtkwindow.c:
	Return FALSE from expose handlers.

Mon Dec  3 21:15:59 2001  Kristian Rietveld  <kris@gtk.org>

	* gtk/gtktreedatalist.c (_gtk_tree_data_list_value_to_node): if
	we use pointers, we should free the previous pointer first (if
	it exists), before we set a new pointer. (#64726)

	* gtk/gtktreeprivate.h: get rid of cursor_drag

	* gtk/gtktreeview.c (gtk_tree_view_unrealize): remove check	
	for cursor_drag
	(gtk_tree_view_bin_expose): don't directly return in the while
	loop
	(gtk_tree_view_class_init): indentend expanders by default
	(gtk_tree_view_header_focus): only give the button focus
	if it's clickable, visible and the column is reorderable
	(#65539)

	* gtk/gtktreeviewcolumn.c (_gtk_tree_view_column_realize_button):
	create and free cursor

Mon Dec  3 10:23:07 2001  Owen Taylor  <otaylor@redhat.com>

	* gtk/gtkcalendar.c (gtk_calendar_size_request): Fix
	some bugs with size requisition. (From Bill Haneman)

	* gtk/gtkcalendar.c: Draw headers and selection in 
	base/text[SELECTED] instead of fg/bg[SELECTED].

	* gtk/gtkcalendar.c: Miscellaneous cleanups to drawing
	code and formatting.

2001-12-03  Havoc Pennington  <hp@pobox.com>

	* gtk/gtktextview.c (set_window_height): 
	(set_window_width): Hmm, setter functions normally assign the new
	value to the object field. Reported by Chris Phelps.

2001-11-30  jacob berkman  <jacob@ximian.com>

	* gtk/gtknotebook.c (gtk_notebook_remove_tab_label): set the
	signal id to 0 after we disconnect from it

2001-11-30  Matthias Clasen  <matthiasc@poet.de>

	* gdk/gdkdrawable.h (gdk_drawable_ref, gdk_drawable_unref),
	gdk/gdkcolor.h (gdk_colormap_ref, gdk_colormap_unref),
	gdk/gdkdnd.h (gdk_drag_context_ref, gdk_drag_context_unref),
	gdk/gdkgc.h (gdk_gc_ref, gdk_gc_unref):	 Deprecate.

	* gdk/gdkvisual.h: Use GDK_DISABLE_DEPRECATED, not 
	GTK_DISABLE_DEPRECATED.

	* gdk/gdkcolor.c (gdk_colormap_ref, gdk_colormap_unref),
	gdk/gdkgc.c (gdk_gc_ref, gdk_gc_unref): Document.

Fri Nov 30 16:37:01 2001  Owen Taylor  <otaylor@redhat.com>

	* gtk/gtkcombo.c (gtk_combo_popup_list): Sanitize
	move/resize code, removing various bad, non-functional
	hacks. (Fixes #65048, reported by Damon Chaplin.)

Fri Nov 30 16:12:21 2001  Owen Taylor  <otaylor@redhat.com>

	* gdk/gdkpango.c: Patch from Hidetoshi Tajima to fix 
	bad match error when target drawable is not the 
	same depth as the root window. (#65841)

	* HACKING: Update.

2001-11-29  Matthias Clasen  <matthiasc@poet.de>

	* gdk/gdkwindow.c: Typo fix.

Thu Nov 29 21:35:56 2001  Kristian Rietveld  <kristian@planet.nl>

	* gtk/gtkmenu.c (gtk_menu_motion_notify): add checks for
	empty menu items to behave like insensitive items (#59456)

	* gtk/gtkmenuitem.c (gtk_real_menu_item_activate_item): select
	next item if the first item in the menu is a tear off item
	(#59456-2, suggestion by Matthias Clasen)

	* gtk/gtkmenushell.c (gtk_menu_shell_button_press),
	(gtk_menu_shell_button_release), (gtk_menu_shell_entry_notify),
	(gtk_menu_shell_leave_notify), (gtk_real_menu_shell_move_current),
	(gtk_real_menu_shell_activate_current): add check, so empty
	menu items behave like insensitive items (#59456)
        
	* gtk/gtkmenuitem.[ch]: add _gtk_menu_item_is_selectable to make
	the checks more readable ...
	
	* gtk/gtkmenushell.c (gtk_menu_shell_button_press),
	(gtk_menu_shell_button_release): causes the menu to dropdown if the
	caption is clicked again (#64977)

2001-11-29  Havoc Pennington  <hp@redhat.com>

	* gtk/gtktextiter.c (_gtk_text_iter_forward_indexable_segment):
	assertion here that we were at the end iterator was not correct;
	change code to move us to the end iterator. bug #65731

Wed Nov 28 20:05:44 2001  Owen Taylor  <otaylor@redhat.com>

	* gtk/gtkaccellabel.c (gtk_accel_label_refetch): Remove 
	improper use of g_locale_to_utf8() to convert from
	latin-1, and do it the easy way by building the string
	correctly in the first place.

Wed Nov 28 19:34:15 2001  Owen Taylor  <otaylor@redhat.com>

	* gdk/x11/gdkproperty-x11.c (gdk_property_change, gdk_property_get): 
	Convert atoms to and from atoms for properties of type XA_ATOM.
	(#65555, patch from Hidetoshi Tajima)

Wed Nov 28 18:37:04 2001  Owen Taylor  <otaylor@redhat.com>

	* gtk/gtksocket.[ch] (gtk_socket_add_id): Rename 'id' parameter 
	to avoid problems with Objective C.

2001-11-28  Matthias Clasen  <matthiasc@poet.de>
	
	* gtk/gtkaccelmap.c: Typo fixes. (#65607)

	* gtk/gtkfixed.c (gtk_fixed_set_has_window, gtk_fixed_get_has_window):
	Fix docs. (#65505)

	* gtk/gtkwindow.c (gtk_window_set_mnemnonic_modifier): Document.

Wed Nov 28 18:19:12 2001  Owen Taylor  <otaylor@redhat.com>

	* gtk/gtkmenu.c (gtk_menu_set_tearoff_hints): Move
	accounting of menu->tearoff_scrollbar width to here
	and make sure we have the correct requisition.

	* gtk/gtkmenu.c (gtk_menu_position): Fix fixme
	by using gtk_window_move().

	* gtk/gtkmenu.c (gtk_menu_set_tearoff_state): Force
	the requisition to be updated by calling
	gtk_widget_size_request() (#65440)

	* gtk/gtktearoffmenuitem.c (gtk_tearoff_menu_item_activate): 
	queue resize before calling gtk_menu_set_tearoff_state().

Wed Nov 28 22:20:44 2001  Kristian Rietveld  <kristian@planet.nl>

	* demos/gtk-demo/editable_cells.c: fix typo

	* demos/gtk-demo/list_store.c (add_columns): remove call to
	gtk_tree_view_column_set_clickable which didn't make sense

2001-11-28  Havoc Pennington  <hp@redhat.com>

	* gtk/gtktextview.c (gtk_text_view_paint): put the warning
	explaining the validation error in front of the G_BREAKPOINT

	* gtk/gtkrange.c (gtk_range_adjustment_value_changed): call
	process updates with include_children = FALSE instead of TRUE, so
	we redraw the range only, not the whole darn window.  Making
	GtkRange a NO_WINDOW widget had weirdly caused the text widget
	Trace/breakpoint trap bug to become much easier to trigger.

Wed Nov 28 14:12:03 2001  Owen Taylor  <otaylor@redhat.com>

	* gdk/Makefile.am (gdk_public_h_sources): Remove reference
	to gdkcursors.h.

2001-11-28  Matthias Clasen  <matthiasc@poet.de>

	* gtk/gtkwindow.c (gtk_window_move): Add markup to docs.

	* gdk/gdkcursor.h: Directly include the contents
	of gdkcursors.h in the GdkCursorType enum.

	* gdk/gdkcursors.h: Deleted.

	* gdk/gdkkeysyms.h: Remove XFree86-specific keysyms, add 
	header boilerplate.

	* gdk/Makefile.am: Remove the X-derived-headers rule.

Tue Nov 27 20:17:55 2001  Owen Taylor  <otaylor@redhat.com>

	* gtk/gtkcheckmenuitem.c (gtk_check_menu_item_activate):
	Notify on the ::active property _here_, not in
	gtk_check_menu_item_set_active.

Mon Nov 26 19:11:18 2001  Jonathan Blandford  <jrb@redhat.com>

	* gtk/gtkcellrendererpixbuf.c
	(gtk_cell_renderer_pixbuf_class_init): add 2 properties
	(PIXBUF_EXPANDER_OPEN and PIXBUF_EXPANDER_CLOSED)

Sun Nov 25 21:19:02 2001  Owen Taylor  <otaylor@redhat.com>

	* gdk/x11/gdkgeometry-x11.c: Add long, but horribly sketchy
	comment about what is going on in this file.

	* gdk/x11/gdkgeometry-x11.c (gdk_window_compute_position): Fix 
	x/y problem.

Sun Nov 25 18:59:19 2001  Owen Taylor  <otaylor@redhat.com>

	* gtk/gtkoptionmenu.c (gtk_option_menu_calc_size): 
	Calculate size based on the _child_ of the menu item,
	not the menuitem. (#65005, Damon Chaplin)

	* gtk/gtklistitem.c (gtk_list_item_new_with_label): Add
	some extra vertical padding to the label widget ... restores
	GTK+-1.2 spacing. (#65085, Damon Chaplin.)

2001-11-26  Tor Lillqvist  <tml@iki.fi>

	* demos/pixbuf-demo.c
	* demos/gtk-demo/pixbufs.c: M_PI -> G_PI.

	* demos/gtk-demo/main.c (read_line): No flockfile() or
	getc_unlocked() on Win32.

2001-11-25  Tor Lillqvist  <tml@iki.fi>

	* configure.in
	* acconfig.h: As we now use GDir, no need to check for dirent.h.

Sun Nov 25 23:18:39 2001  Kristian Rietveld  <kristian@planet.nl>

	* gtk/gtktexttag.c (gtk_text_tag_set_property): free font_desc
	when finished (#65266)

Sun Nov 25 23:16:29 2001  Kristian Rietveld  <kristian@planet.nl>

	* gdk/x11/gdkwindow-x11.c (gdk_window_set_icon_list): free
	data after we set the property. (#65264)

Sun Nov 25 23:14:06 2001  Kristian Rietveld  <kristian@planet.nl>

	* gtk/gtkbutton.c: add destroy method so label_text gets freed
	if it has been allocated (#65268)

Sat Nov 24 13:39:51 2001  Manish Singh  <yosh@gimp.org>

	* gdk/linux-fb/gdkdrawable-fb2.c
	* gdk/linux-fb/gdkpango-fb.c: update to latest Pango API

	* gdk/linux-fb/gdkwindow-fb.c: implement gdk_window_show_unraised

	* gdk/linux-fb/gdkfont-fb.c (gdk_font_load): plug memleak on
	set_family
	
	* gdk/linux-fb/gdkfbswitch.c: minor cleanups

Sat Nov 24 22:05:27 2001  Kristian Rietveld  <kristian@planet.nl>

	* gtk/gtkmenushell.c (gtk_menu_shell_button_release): don't
	deactivate menu when menu_item isn't sensitive (#61389)

Sat Nov 24 15:35:26 2001  Kristian Rietveld  <kristian@planet.nl>

	* gtk/gtktreemodel.c (gtk_tree_model_foreach): free path before
	we return (in case of a failure here)

Fri Nov 23 19:22:50 2001  Owen Taylor  <otaylor@redhat.com>

	* gtk/gtknotebook.c: Handle events in windows other
	than widget->event_window properly. (#65079, reported
	by Damon Chaplin)

	* gdk/gdkevents.c (gdk_event_get_coords): Fix x/y bug.

Fri Nov 23 18:57:46 2001  Owen Taylor  <otaylor@redhat.com>

	* gtk/gtkmessagedialog.c (gtk_message_dialog_init): Align
	the image at the top. (#65020, request from Seth Nickell)

Fri Nov 23 18:49:53 2001  Owen Taylor  <otaylor@redhat.com>

	* gtk/{gtkclist,gtkctree.c} (draw_row): Remove some strange
	arithmetic that was resulting in rows being drawn too low.
	(#65001, reported by Damon Chaplin)

Fri Nov 23 18:36:42 2001  Owen Taylor  <otaylor@redhat.com>

	* gtk/gtkrange.c (gtk_range_button_press): Offset 
	invalidated range correctly.

	* gtk/gtkclist.c (hadjustment_value_changed): Fix scrolling 
	of title window. (#65001, reported by Damon Chaplin)

	* gtk/gtkcombo.c (gtk_combo_button_event_after): Replace
	horrible hack with use of ::event_after.

Thu Nov 22 15:01:03 2001  Owen Taylor  <otaylor@redhat.com>

	* Version 1.3.11

	* configure.in (ATK_REQUIRED_VERSION): Require
	GLib-1.3.11, Pango-0.22, ATK-0.7.

	* tests/prop-editor.c (property_widget): Restore
	to working as well as it did before.

	* gtk/gtklistitem.h: Mark deprecated since it is
	an integral part of GtkList.

 	* demos/gtk-demo/demo-common.h: New header file,
	for a common functions not important to the meat
	of the demos.
	
	* demos/gtk-demo/main.c (demo_ifind_file): Add a utility
	function to search for a file used by the demo.

	* demos/*.c: Use demo_find_file.

2001-11-23  Matthias Clasen  <matthiasc@poet.de>

	* gtk/gtktextbuffer.c (gtk_text_buffer_create_tag),
	gtk/gtkruler.c (gtk_ruler_get_metric): Actually commit typo 
	fixes already mentioned in ChangeLog entry on 2001-11-14.

	* docs/reference/gtk/tmpl/drawing.sgml: Minor markup fixes.

2001-11-23  Hans Breuer  <hans@breuer.org>

	* gdk/win32/gdkfont-win32.c (gdk_font_from_description) : 
	reflect Pango API change

	* gtk/gtk.def : updated externals

	* gtk/gtkfixed.c (gtk_fixed_get_has_window) : use 
	g_return_val_if_fail() to avoid 'function must return a value'

	* gtk/gtkrc.c : added spaces to fix small coding style issues
	* gtk/gtkwidget.c : ... and linebreaks. Also a static for
	'static correctness'

	* gtk/makefile.msc.in : temporary(?) disable gtk<plug|socket>
	because they only can be build on win32 after applying my patch

Wed Nov 21 22:55:37 2001  Tim Janik  <timj@gtk.org>

	* gtk/gtkbutton.c (gtk_button_map): raise event window afte
	children, in order for the input pnly window to stay *above*
	children.

Wed Nov 21 22:44:27 2001  Tim Janik  <timj@gtk.org>

	* tests/testtreeview.c: make hackery worse ;) by checking fundamental
	type walks againts G_TYPE_FUNDAMENTAL_MAX.
	
	* tests/prop-editor.c: disable type hackery.

Wed Nov 21 17:41:39 2001  Owen Taylor  <otaylor@redhat.com>

	* gdk/gdkimage.c (gdk_image_get): Fix problem with
	lost parameter.

Wed Nov 21 17:01:25 2001  Owen Taylor  <otaylor@redhat.com>

	* gtk/gtkcellrenderer.h gtk/gtktreemodel.h 
	gtk/gtktreeprivate.h gtk/gtktreesortable.h: Remove
	trailing commas in enum declarations.

Wed Nov 21 15:21:26 2001  Owen Taylor  <otaylor@redhat.com>

	* configure.in (GTK_MICRO_VERSION): Version 1.3.11, 
	interface, binary age 0.

	* NEWS: Updates

	* gtk/gtktreemodel.c gtk/gtkrc.c gtk/gtkentry.c: SGML
	fixes in docs.

	* gtk/gtkmain.h: Remove unused and misnamespaced
	get_gtk_win32_directory() prototype.

	* gdk/gdkimage.c (gdk_image_get): Fix parameter names
	to match header.

	* gdk/gdkwindow.h: Fix parameters to gdk_window_shape_combine_mask(),
	gdk_window_set_transient_for(), gdk_window_set_geometry_hints(),
	to match docs.

	* gdk/gdkevents.c (gdk_event_get_coords)
	  gtk/gtkcellrenderertoggle.c (gtk_cell_renderer_toggle_get_active)
	  gtk/gtkdnd.c (gtk_drag_set_icon_stock):
	Fix parameter names in docs.
	
	* docs/faq/Makefile.am (FAQ_FILES): Add missing files.
	(#64961, Akira Tagoh)

Wed Nov 21 11:41:29 2001  Owen Taylor  <otaylor@redhat.com>

	* tests/testgtk.c (create_tooltips): Ref-sink the tooltips object.

	* gtk/gtktoolbar.c (gtk_toolbar_init): Ref-sink the tooltips object.

	* gtk/gtkfilesel.c (open_new_dir): Fix some constness warnings.

	* gtk/gtkaccelgroup.c: Rename gtk_accel_groups_from_acceleratable()
	back to gtk_accel_groups_from_object(), change @acceleratable
	parameter to gtk_accel_groups_activate() accordingly.

	* gtk/gtkaccelmap.c (gtk_accel_map_lookup_entry): Remove
	left-over comment about quark return.

	* gtk/gtkaccelmap.h: Fix spelling of gtk_accel_map_foreach_unfiltered().

 	* gtk/gtk-boxed.defs (GtkIconSource): added as a boxed type.
        (Patch from Matt Wilson)

	* gtk/gtkobject.c (gtk_object_finalize): Warn if a floating
	object is finalized.

Tue Nov 20 21:25:08 2001  Tim Janik  <timj@gtk.org>

	* applied patch from owen to get rid of accel map notifiers.
	changed things to fix reentrancy and API as discussed on gtk-devel.

	* gtk/gtkaccelgroup.[hc]:
	(gtk_accel_group_finalize): unregister this accel group from all
	accel map paths.
	(accel_closure_invalidate): handle invalidation of closures by
	disconnecting their accelerators.
	(quick_accel_add): move closure connection and changed notification
	into this function to reduce code duplication. don't emit change
	notification on closurers without accelerators.
	(quick_accel_remove): rewrite, do the exact opposite of quick_accel_add
	for a GtkAccelGroupEntry.
	(gtk_accel_group_connect): get rid of the accel_path_quark argument.
	(gtk_accel_group_connect_by_path): new function to add accelerators
	with an accel path.
	(gtk_accel_group_disconnect_closure): new function, disconnect a
	closure from of an accel group.
	(gtk_accel_group_disconnect): loop over all closure for a accel_ley,
	accel_mods pair and remove them.
	(_gtk_accel_group_reconnect): new function that basically does
	gtk_accel_group_disconnect_closure() and
	gtk_accel_group_connect_by_path() once an accel path changed.
	(gtk_accel_groups_disconnect_closure): remove this, there's
	gtk_accel_group_disconnect_closure().
	
	* gtk/gtkaccelmap.[hc]: keep list of accel groups per entry now,
	nuke notifiers.
	(_gtk_accel_path_is_valid): make this non-static for
	gtkwidget.c and gtkaccelgroup.c assertions.
	(gtk_accel_map_add_notifer): removed this function.
	(gtk_accel_map_remove_notifer): same.
	(_gtk_accel_map_add_group):
	(_gtk_accel_map_remove_group): (un-)register accel groups, with
	accel paths for correct propagation.
	(gtk_accel_map_add_entry): return void.
	(gtk_accel_map_lookup): return gboolean instead of GQuark.
	
	* gtk/gtkitemfactory.c (gtk_item_factory_add_foreign): always
	set accel_path on widgets.
	
	* gtk/gtkwidget.[hc]:
	(accel_path_changed): got rid of this, changes are handled by
	accel maps internally now.
	(_gtk_widget_set_accel_path): get things to work without notifiers.
	(gtk_widget_list_accel_closures): list accel closures of a widget.
	
	* gtk/gtkwindow.[hc]: rename ::accels_changed, to ::keys_changed.

2001-11-20  Matthias Clasen  <matthiasc@poet.de>

	* gtk/gtkcontainer.c (gtk_container_propagate_expose): Typo fix.

Tue Nov 20 23:01:01 2001  Kristian Rietveld  <kristian@planet.nl>

	* gtk/gtktreemodel.c (gtk_tree_row_reference_unref_path):
	replace gboolean free_last in the function parameters with
	gint depth. Changes to reflect new situation.

	* gtk/gtktreemodel.c (gtk_tree_row_reference_unref_path_helper):
	replace gboolean free_last, with gint depth, add gint current_depth.
	Changes to reflect new situation.

	* gtk/gtktreemodel.c (gtk_tree_row_ref_deleted_callback): changes
	to reflect new situation

	* gtk/gtktreemodel.c (gtk_tree_row_reference_free): ditto

Tue Nov 20 12:37:10 2001  Owen Taylor  <otaylor@redhat.com>

	* gtk/gtknotebook.c (gtk_notebook_paint): Fix problem
	where notebook gap was double shifted by allocation.x/y

	* gtk/gtknotebook.c (gtk_notebook_unmap): Chain up
	to unmap children.

Tue Nov 20 14:49:59 2001  Tim Janik  <timj@gtk.org>

	* gtk/gtkvpaned.c (gtk_vpaned_size_allocate): fix
	allocation to be relative to paned->allocation, now
	that this is a NO_WINDOW widget.
	* gtk/gtkhpaned.c (gtk_hpaned_size_allocate): same here.

	* gtk/gtkaccellabel.c (gtk_accel_label_class_init): ::closure
	needs to be a boxed property.

Mon Nov 19 17:34:40 2001  Owen Taylor  <otaylor@redhat.com>

	* gtk/gtkradiobutton.c (gtk_radio_button_draw_indicator):
	Use the widget's state when drawing the indicator, as
	in GtkCheckButton. This gives us color changes for
	un-prelighted checkbuttons. (#63308, Matt Wilson)

Mon Nov 19 17:11:23 2001  Owen Taylor  <otaylor@redhat.com>

	(Fixes related to #64428, Michael Meeks)

	* gtk/gtkplug.c (gtk_plug_set_is_child): Unmap the
	widget, so it gets mapped again properly when we
	add to a parent.

	* gtk/gtkplug.c (_gtk_plug_add_to_socket): Set
	plug->socket_window. 

	* gtk/gtkplug.c (_gtk_plug_remove_from_socket): Set
	socket_window to NULL, not FALSE.

	* gtk/gtkplug.c (_gtk_plug_add_to_socket): Set
	socket->same_app to TRUE. (#64612)

Mon Nov 19 15:50:41 2001  Owen Taylor  <otaylor@redhat.com>

	* gtk/gtkfixed.[ch] docs/Changes-2.0.txt: Add 
	gtk_fixed_set/get_has_window() to remove criticism
	about GTK_WIDGET_SET_FLAGS() hacks.

2001-11-19  Michael Natterer  <mitch@gimp.org>

	* gtk/gtknotebook.c: show notebook->event_window with
	gdk_window_show_unraised(), so it doesn't catch the events which
	should go to the tab widgets first.

Mon Nov 19 15:30:51 2001  Jonathan Blandford  <jrb@redhat.com>

	* gtk/gtktreeviewcolumn.c (gtk_tree_view_column_class_init): Add a
	"resizable" property, to get rid of the
	GTK_TREE_VIEW_COLUMN_RESIZABLE sizing flag.
	(gtk_tree_view_column_set_resizable): New function to set resizable.
	(gtk_tree_view_column_set_resizable): getter.

	* tests/testtreecolumns.c (add_clicked): modify for above change.

	* Makefile.am (install-data-hook): remove old .pc files before
	installing the new one.  We used to symlink this, and it will
	break old installs.

2001-11-19  Havoc Pennington  <hp@pobox.com>

	* tests/testtext.c (fill_example_buffer): put in a test for
	negative indentation values

Mon Nov 19 14:08:18 2001  Owen Taylor  <otaylor@redhat.com>

	* gtk/gtklabel.c (gtk_label_init): Change default for
	justify to GTK_JUSTIFY_LEFT. Assuming that multiline
	labels are most often wrapped labels, this gives better
	compatibility with GTK+-1.2, where justification was
	ignored for wrapped labesl and is a more sensible
	default in any case. (#64489)

	* gtk/gtklabel.c (gtk_label_class_init): Fix default
	for wrap property to FALSE.

2001-11-19  jacob berkman  <jacob@ximian.com>

	* gtk/Makefile.am (gtk_extra_sources): add gtkmarshal.list

Mon Nov 19 13:56:45 2001  Owen Taylor  <otaylor@redhat.com>

	* gdk/x11/gdkwindow-x11.c (gdk_window_focus): Use 
	RevertToParent, not RevertToNone. (#64613, 
	Matthias Clasen)

Mon Nov 19 12:28:02 2001  Owen Taylor  <otaylor@redhat.com>

	* gtk/gtkframe.c (gtk_frame_class_init): label_xalign
	and label_yalign need to be float properties to
	correspond to GTK+-1.2, to gtk_frame_set_label_align,
	and to the types of the xalign and yalign properties of GtkMisc.
	(#63484, Vitaly Tishkov)

Mon Nov 19 12:24:30 2001  Owen Taylor  <otaylor@redhat.com>

	* gtk/gtksocket.h (struct _GtkSocketClass): Fix return
	of plug_added vfunc. (#64408, Jeff Franks)

Mon Nov 19 12:07:20 2001  Owen Taylor  <otaylor@redhat.com>

	* configure.in (deps): Undef HAVE_STDLIB_H before
	checking for jpeg, because jconfig.h has this
	in it too (%#$@!). Fix from Matthias Clasen, #64500.

Mon Nov 19 11:30:03 2001  Owen Taylor  <otaylor@redhat.com>

	* gdk/x11/gdkproperty-x11.c (get_atom_name): Fix a 
	memory leak when retrieving atom names. (Michael Meeks,
	#64508)

2001-11-18  Alex Larsson  <alexl@redhat.com>

	* gdk/x11/gdkfont-x11.c (gdk_font_from_description):
	Update to new Pango API.
	
Sun Nov 18 19:47:29 2001  Owen Taylor  <otaylor@redhat.com>

	* gtk/gtkobject.h docs/Changes-2.0.txt: Rename the
	GTK_DESTROYED flag to GTK_IN_DESTRUCTION, remove the
	GTK_OBJECT_DESTROYED() check macro.

	* gtk/gtkbindings.c (gtk_bindings_activate): Remove
	instances of GTK_OBJECT_DESTROYED() that weren't
	needed any more.

	* gtk/gtkdialog.c: Exchange use of GTK_OBJECT_DESTROYED
	for a connection to ::destroy.

Sun Nov 18 18:18:11 2001  Owen Taylor  <otaylor@redhat.com>

	* gtk/gtkfixed.c: Make a NO_WINDOW widget, as it should
	have been since the beginning, but as special hack,
	allow clearing the NO_WINDOW flag to get a window widget.

Sun Nov 18 22:01:36  Kristian Rietveld  <kristian@planet.nl>

	* gtk/gtktreestore.c: return TRUE when value changed, so
	row_changed is being emitted

2001-11-18  Hans Breuer  <hans@breuer.org>

	* gtk/gdkaccelmap.c : make it compile with msvc: !HAVE_UNISTD_H;
	no label without op, even if it's a no-op.

	* gtk/gtk.def :
	* gtk/makefile.msc.in : reflect marshaler split, some clean-up	

	* config.h.win32.in : remove definition of HAVE_DIRENT_H
	* gtk/gtkfilesel.c : due to GDir (new in glib) DIR isn't
	required anymore, replace it.
	* gtk/queryimmodules.c : DIR -> GDir replacement, also
	getcwd() -> g_get_current_dir()

	* gdk/win32/gdkgeometry-win32.c : adapt to refactored gdkgeometry-x11.c
	Even 'noisy laugh' scolling appears to work, though I still can't
	claim to have fully understood what it is supposed to do ...

Sat Nov 17 21:07:46 2001  Owen Taylor  <otaylor@redhat.com>

	* gtk/gtkenums.h: Include glib-object.h instead of
	gobject/gsignal.h

	* gdk/{gdkinternals.h,gdkwindow.c,gdkwindow.[ch],
	  x11,{fb,win32,x11/gdkwindow-*.c}: Add a dummy GdkScreen
	argument to the window_at_pointer() field of
	GdkPointerHooks. (Patch from Erwann Chenede)

	* gdk/gdkdrawable.h (struct _GdkDrawableClass ): Up
	to 6 pointers.

2001-11-17  Matt Wilson  <msw@redhat.com>

	* gtk/gtkenums.h: must include glib-object.h only

Sat Nov 17 19:26:20 2001  Owen Taylor  <otaylor@redhat.com>

	* gtk/gtkwindow.c (gtk_window_key_press_event): Reprioritize
	key bindings in order of visibility - mnemonics, then 
	accelerators, then send key to the focus widget, then
	bindings on the GtkWindow.

	* gtk/gtklayout.h docs/Changes-2.0.txt tests/testgtk.c: 
	Removed the xoffset, yoffset fields of GtkLayout which were
	identically zero for compat with 1.2, but were no longer 
	compatible with	all uses of these fields in 1.2.

	* gtk/gtkwindow.c (gtk_window_set_default): Remove 
	unused variable.

Sat Nov 17 19:08:13 2001  Owen Taylor  <otaylor@redhat.com>

	* tests/testtreeview.c (gtk_tree_model_types_get_type): 
	We no longer need to create the signals here ... they
	come from the interface.

	* gtk/maketypes.awk: Use GType, not GtkType in output.

	* gtk/gtktypeutils.h: Mark virtually all of this
	file deprecated.

	* gtk/gtkcontainer.h: Deprecate gtk_container_foreach_full;
	the only use of this function is the GtkArg using
	GtkCallbackMarshal, since destroy notification is
	silly here.

Sat Nov 17 18:26:45 2001  Owen Taylor  <otaylor@redhat.com>

	* gtk/Makefile.am gtk/gtkmarshal.list gtk/gtkmarshalers.list
	gtk/*.c gtk/gtksignal.h: Make gtkmarshal.list/gtkmarshal.h
	only for compatibility with GTK+-1.2; and deprecate it; 
	put all marshalers we actually use into gtkmarshalers.list 
	and use the _gtk_marshal_ prefix for these marshalers.

2001-11-17  Murray Cumming  <murrayc@usa.net>

	* gtk/gtktexttagtable.c (gtk_text_tag_table_class_init):
	The first parameters of the signals are now registered as
	GTK_TYPE_TEXT_TAG instead of G_TYPE_OBJECT.
	
2001-11-17  Tor Lillqvist  <tml@iki.fi>

	* gtk-zip.sh.in: Build separate runtime and developer
	packages.

	* gtk/gtk.def: Reflect recent accelerator-related changes.

Fri Nov 16 19:44:35 2001  Owen Taylor  <otaylor@redhat.com>

	* gtk/gtkwindow.c (gtk_window_set_default): Move 
	notification of "has_default" to here, so it
	is safe to call gtk_window_set_default() instead
	of gtk_widget_grab_default().

	* gtk/gtkwindow.c (gtk_window_set_focus): Make it call
	gtk_widget_grab_focus(), which then calls 
	_gtk_widget_internal_set_focus(). This makes 
	gtk_window_set_focus() a safe way of both setting
	and unsetting the focus widget.

	* gtk/gtkwidget.c (gtk_widget_propagate_state): Use
	gtk_widget_get_toplevel(), instead of gtk_widget_ancestor
	to find the toplevel.

	* gtk/gtkwindow.h: Move gtk_window_set_focus/default
	from the "internal functions" section.

2001-11-16  jacob berkman  <jacob@ximian.com>

	* tests/testgtk.c (create_radio_buttons): add some no-indicator
	radio buttons

	* gtk/gtkradiobutton.c (gtk_radio_button_init): since we are
	initially active, also initially be depressed
	(gtk_radio_button_clicked): also update our depressed state

Thu Nov 15 12:54:36 2001  Owen Taylor  <otaylor@redhat.com>

	* gtk/gtkwindow.c (gtk_window_key_press_event): Propagate
	key press events not just to focus/window but also to
	intermediate widgets.

	* gtk/gtknotebook.c: Handle Ctrl-PageUp/Ctrl-PageDown
	to switch pages. (Needs some work on handling focus
	when switching pages.)

Fri Nov 16 14:06:31 2001  Owen Taylor  <otaylor@redhat.com>

	* gtk/gtknotebook.c: Fix child allocations to be relative to 
	widget position and some drawing bugs.

	* gtk/gtkmenuitem.c (gtk_menu_item_paint): Fix problem
	with reading uninitialized variable.

Fri Nov 16 00:16:40 2001  Owen Taylor  <otaylor@redhat.com>

	* gtk/{gtkmenuitem.[ch],gtkcheckmenuitem.c,gtkimagemenuitem.c,
	gtkradiomenuitem.c,gtktearoffmenuitem.c}: Make Menu items
	NO_WINDOW widgets.

	* gtk/gtk{h,v,}paned.[ch]: Make NO_WINDOW widgets, some
	cleanup.

	* gtk/gtkstyle.c (gtk_default_draw_handle): Don't assume
	we are drawing in a window when drawing the paned handle.

2001-11-16  Sven Neumann  <sven@gimp.org>

	* demos/gtk-demo/appwindow.c
	* demos/gtk-demo/menus.c: reduce compiler warnings

Thu Nov 15 19:47:09 2001  Owen Taylor  <otaylor@redhat.com>

	* demos/gtk-demo/main.c (button_press_event_cb): Remove 
	unused callback to make things compile with 
	gtk_tree_view_path_at_pos_change().

Thu Nov 15 18:44:33 2001  Jonathan Blandford  <jrb@redhat.com>

	* gtk/gtktreedatalist.c (_gtk_tree_data_list_free): maybe fix #64160

2001-11-15  Matthias Clasen  <matthiasc@poet.de>

	* gtk/gtkwindow.c (gtk_window_new): Move '.' out of quote. (#64407)
 
Thu Nov 15 16:24:55 2001  Jonathan Blandford  <jrb@redhat.com>

	* gtk/gtktreeview.c (gtk_tree_view_get_bin_window): New function
	to get a GdkWindow to compare event->window to.

	* gtk/gtktreeview.c (gtk_tree_view_move_cursor_left_right): emit
	the signal for lateral motion too, #64361

	* gtk/gtktreeview.c (gtk_tree_view_get_path_at_pos): remove window
	arg as it is useless, #64137

Thu Nov 15 16:07:42 2001  Owen Taylor  <otaylor@redhat.com>

	* gtk/gtknotebook.c: Some small drawing fixes for scroll arrows.

Thu Nov 15 14:19:34 2001  Owen Taylor  <otaylor@redhat.com>
 
 	* gdk/gdkwindow.c (gdk_window_invalidate_maybe_recurse): Cal
 	gdk_window_invalidate_maybe_recurse() for recursion.
 	(Soeren Sandmann)

 	* gtk/gtkviewport.c: Make !redraw_on_allocate. (Soeren Sandmann)
 
	* gtk/gtkcontainer.c (gtk_container_expose): Call
	gtk_container_forall() not _foreach() to propagate,
	since we need to propagate exposes to internal children
	as well.

	* gtk/gtkwidget.c (gtk_widget_set_events, gtk_widget_add_events): 
	Remove the restriction of only being able to call these
	on window widgets, since we have lots of NO_WINDOW widgets
	with windows now; for add events, recurse over the children
	of widget->window to find one owned by the widget.

	* gtk/gtkbutton.[ch]: Make a NO_WINDOW widget, using an input-only
	window to catch events.

	* gtk/gtktogglebutton.[ch]: Remove the code for switching
	between NO_WINDOW and WINDOW widgets based on the mode.

	* gtk/gtkcheckbutton.c gtk/gtkoptionmenu.c gtk/gtkclist.c
	gtk/gtktreeview.c: Adopt to NO_WINDOW change for GtkButton.

	* gtk/gtkrange.[ch]: Make into a NO_WINDOW widget.

	* gtk/gtkhscale.c, gtk/gtkvscale.c: Adopt to NO_WINDOW
	change for range.

	* gtk/gtknotebook.[ch]: Make into a NO_WINDOW widget.
 
	* docs/Changes-2.0.txt: Add a note about the NO_WINDOW changes.

Thu Nov 15 11:59:35 2001  Owen Taylor  <otaylor@redhat.com>

	* gtk/gtkmessagedialog.c: Patch from Murray Cumming to add
	"message_type" and "buttons" CONSTRUCT properties. (#64069)

	* tests/testsocket.c: Expand tests to add a "local passive
	child" (Test case for #64428)

2001-11-14  jacob berkman  <jacob@ximian.com>

	* gtk/gtkgamma.c (button_clicked_callback): create the label with
	a mnemonic

2001-11-15  Sven Neumann  <sven@gimp.org>

	* tests/testgtk.c: make it compile without warnings.

2001-11-14  Alex Larsson  <alexl@redhat.com>

	* gtk/gtklabel.c:
	Don't recalculate the layout on each gkt_label_ensure_layout () for
	wrapped labels.

Wed Nov 14 17:40:23 2001  Jonathan Blandford  <jrb@redhat.com>

	* gtk/gtktreeview.c (gtk_tree_view_get_expander_column): Return
	the currently selected column when we get the column, #64380

	* gtk/gtkentry.c (gtk_cell_editable_key_press_event): Handle Esc
	to cancel CellRendererText editting, #63613

	* gtk/gtkcellrenderertext.c: ditto

	* gtk/gtkcellrenderertext.h: formatting changes

2001-11-14  Matthias Clasen  <matthiasc@poet.de>

	* gtk/gtkbutton.c (gtk_button_get_label): Rearrange docs (#64566)

	* gtk/gtktextbuffer.c (gtk_text_buffer_create_tag): Typo fix (#64474)

	* gtk/gtkruler.c (gtk_ruler_get_metric): Typo fix (#64470)

	* gtk/gtknotebook.c (gtk_notebook_prepend_page): Typo fix (#64467)

	* gtk/gtklabel.c: Documentation fixes (#64452)

2001-11-14  Daniel Egger  <degger@fhm.edu>

	* gdk-pixbuf/io-xpm.c: 
	(xpm_skip_whitespaces): Remove unused static function.
	(xpm_skip_string): Dito.	
	(xpm_extract_color): Declare const variable const to avoid warnings. 

	* gtk/gtkfixed.c: (gtk_fixed_map): Remove unused static function.
	
	* gtk/gtkplug.c: #if 0'ed prototype for #if 0'ed code.
	
	* gtk/gtksocket.c: Change type of mask to g_message to %ld for 
	a long.

Wed Nov 14 15:14:48 2001  Owen Taylor  <otaylor@redhat.com>

	* gtk/gtkcontainer.c (gtk_container_idle_sizer): Back
	out accidental commit of debugging timing code.

2001-11-14  Havoc Pennington  <hp@redhat.com>

	* gtk/gtktextview.c (gtk_text_view_move_cursor): fix Control-E so
	it doesn't move to a new line each time you press it

	* gtk/gtktextiter.c (gtk_text_iter_forward_to_line_end): fix
	return value, #62987

2001-11-14  Havoc Pennington  <hp@redhat.com>

	* tests/testtextbuffer.c (main): bulk of the tests were commented
	out, oops.

	* gtk/gtktextiter.c (find_paragraph_delimiter_for_line): make this 
	function work, should resolve #63426
	(gtk_text_iter_ends_line): return TRUE for the end iterator

	* gtk/gtktextiter.h: put padding back in GtkTextIter, I thought of
	a couple things that might get cached in here.

Tue Nov 13 21:00:59 2001  Jonathan Blandford  <jrb@redhat.com>

	* gtk/gtktreemodelsort.c (gtk_tree_model_sort_class_init): new
	"model" construct property for language bindings.

	* gtk/gtktreestore.c (gtk_tree_store_set_column_types): New
	function to let you set the column types of a GtkTreeStore for
	language bindings.

	* gtk/gtkliststore.c (gtk_list_store_set_column_types): ditto.

2001-11-13  Havoc Pennington  <hp@redhat.com>

	* gtk/gtktextview.c (gtk_text_view_add_child_in_window): docs
	including reference to bugzilla bug about how we should have 
	a better way of positioning children

	* gtk/gtktextview.h (struct _GtkTextViewClass): add some padding

	* gtk/gtktextview.c (gtk_text_view_size_allocate): assign zero
	size to side rects if they don't exist, #63438

2001-11-13  Havoc Pennington  <hp@redhat.com>

	* gtk/gtktextview.c (gtk_text_view_key_press_event): fix to
	properly replace selection with Return or Tab

	* gtk/gtktextdisplay.c (gtk_text_layout_draw): fix broken code
	that didn't locate the end of the line correctly, should fix #63800

2001-11-13  Havoc Pennington  <hp@redhat.com>

	* gtk/gtktextview.c (gtk_text_view_size_request): add border width
	to requisition, request non-anchored children
	(gtk_text_view_size_allocate): handle border width, allocate
	non-anchored children
	(text_view_child_new_window): set the child as object data
	(gtk_text_view_move_child): allow children at negative
	coordinates, no reason why not
	(gtk_text_view_forall): make it copy the list of children before
	walking it, to avoid reentrancy issues	
	(gtk_text_view_move_child): short-circuit if position is unchanged
	(changed_handler): only queue_resize if requisition has changed
	(gtk_text_view_init): don't redraw_on_allocate, since we can do 
	a better job of invalidation ourselves

	* tests/testtext.c: add tests for the fixed-position children

Tue Nov 13 19:51:43 2001  Tim Janik  <timj@gtk.org>

	* gtk/gtkwindow.c (handle_accels_changed): protect idle handle
	with gdk threads macro.

Mon Nov 12 23:08:37 2001  Tim Janik  <timj@gtk.org>

	* gtk/maketypes.awk: fix type utils generation on unix.

	* gtk/gtkaccelmap.[hc]: new files, implementing a global accelerator
	registry.

	* gtk/gtkaccelgroup.[hc]: major API/implementation revamp:
	removed GTK_ACCEL_SIGNAL_VISIBLE, gtk_accel_group_get_default,
	gtk_accel_group_get_entry, gtk_accel_group_(un)lock_entry,
	gtk_accel_group_add/remove, gtk_accel_group_handle_add/remove,
	gtk_accel_group_create_add/remove, gtk_accel_group_entries_from_object.
	introduced ::accel_changed signal for change notification, and
	gtk_accel_group_connect/disconnect to connect closures to accel groups.
	made gtk_accel_group_attach/detach and gtk_accel_group_activate private
	functions.
	deprecated gtk_accel_group_ref/unref.

	* gtk/gtkaccellabel.[hc]: changes to make accellabels pay attention
	to accel group changed notification and basically operate on closures.
	removed gtk_accel_label_get_accel_object and
	gtk_accel_label_set_accel_object.
	introduced gtk_accel_label_set_accel_closure, and for convenience,
	gtk_accel_label_set_accel_widget.

	* gtk/gtkitemfactory.[hc]: removed accelerator propagation code
	which mostly moved into gtkaccelmap.[hc].
	removed gtk_item_factory_parse_rc*, gtk_item_factory_dump_*
	and gtk_item_factory_print_func.

	* gtk/gtkmain.c: call _gtk_accel_map_init().

	* gtk/gtkmenuitem.[hc]: introduced gtk_menu_item_set_accel_path(),
	that associates an accelerator path with menu items, through which
	persistent accelerator settings on menu items are enabled.

	* gtk/gtkmenu.[hc]: added gtk_menu_set_accel_path() so accelerator
	paths of menu item can be default constructed to allow installation
	of accelerators on menu items that don't come with an accelerator
	binding by default.

	* gtk/gtksettings.c: fix STRING type rc settings by special casing
	them appropriately in the parser.

	* gtk/gtksignal.[hc]: allow a class function offset of 0 for
	gtk_signal_newv().

	* gtk/gtkwidget.[hc]: accelerator API revamp.
	removed ::accelerator_add/remove signals, gtk_widget_accelerator_signal,
	gtk_widget_accelerators_locked, gtk_widget_remove_accelerators and
	gtk_widget_(un)lock_accelerators.
	accelerators maintained through gtk_widget_add/remove_accelerator()
	are not runtime changable now, the correct sequence to setup a
	widget for runtime changable accelerators is now:
	  gtk_accel_map_add_entry(accel_path, key, mods);
	  _gtk_widget_set_accel_path(widget, accel_path, accel_group);

	* gtk/gtkwindow.[hc]: accelerator changes, proxy and coalesce accel
	group changes (as well as mnemonic changes) through the new signal
	::accels_changed.

Sat Nov 10 12:08:56 2001  Tim Janik  <timj@gtk.org>

	* gtk/gtksettings.c (_gtk_settings_parse_convert): properly handle
	GString->string conversions.

Mon Nov 12 19:33:52 2001  Owen Taylor  <otaylor@redhat.com>

	* gtk/gtkmessagedialog.c (gtk_message_dialog_new): Warn
	if GTK_DIALOG_NO_SEPARATOR is passed in and ignore it.

2001-11-12  Matthias Clasen  <matthiasc@poet.de>

	* gtk/gtktreeview.c: Documentation fixes. (#64377)
	
	* gtk/gtktreestore.c: Documentation fixes. (#64376)

2001-11-11  Matthias Clasen  <matthiasc@poet.de>

	* gtk/gtkiconfactory.c, gtk/gtktextbuffer.c, gtk/gtktreemodel.c,
	gtk/gtkwindow.c, gtk/gtknotebook.c, gtk/gtkradiobutton.c, 
	gtk/gtktextiter.c, gtk/gtkdialog.c: Mass fixing of trivial doc bugs.  
	(#63544, #57007, #64141, #63472, #57108, #60818, #61562)

2001-11-10  Hans Breuer  <hans@breuer.org>

	* gdk/win32/gdkevents-win32.c (gdk_event_translate) : make sure 
	we know what we are talking about when asked for MINMAXINFO.
	Also some cleaning for !HAVE_DIMM_H etc.

2001-11-10  Matthias Clasen  <matthiasc@poet.de>

	* gtk/gtktreeviewcolumn.c: Fix docs for 
	gtk_tree_view_column_set_sort_order. (#62647)
	
	* gtk/gtkcontainer.c: Fix docs for 
	gtk_container_set_border_width. (#64139)

	* gtk/gtkcolorsel.c: Documentation fixes.

2001-11-10  Hans Breuer  <hans@breuer.org>

	* gtk/gtkfontsel.c : use g_strcasecmp(), some poor platforms
	don't have strcasecmp()

	* gtk/gtktextview.c : to fix crashing on e.g. TextView::find need 
	to remove the idle funcs in gtk_text_view_destroy (). To reduce 
	code duplication wrap it in its own function and use it in 
	gtk_text_view_unrealize () and gtk_text_view_destroy_layout ()

	* gdk/win32/gdkdrawable-win32.c : implement the finalize
	method like the X11 version does, allow to set_colormap NULL
	* gdk/win32/gdkwindow-win32.c : adapt GdkWindowImplWin32::
	set_colormap, also some adaption to X11 version :
	(gdk_window_hide) call _gdk_window_clear_update_area
	(gdk_window_reparent) call _gdk_window_init_position

	* gdk/win32/gdkwindow-win32.c (gdk_window_set_geometry_hints) : 
	call gdk_window_resize() after all hints are set, because the
	window resizing process (WM_GETMINMAXINFO) takes all of them into 
	account

	* gdk/win32/gdkfont-win32.c : make gdk_font_equal return a gboolean

	* gdk/win32/gdkvisual-win32.c : register GdkVisual with 
	sizeof (GdkVisualPrivate)

	* gdk/gdk.def gtk/gtk.def : upated externals

	* gdk/makefile.msc gdk/win32/makefile.msc gdk-pixbuf/makefile.msc
	  gdk-pixbuf/pixops/makefile.msc gtk/makefile.msc.in tests/makefile.msc :
	from now on use make.msc from $(TOP)/glib/build/win32

	* gtk/stock-icons/makefile.msc : add stock_missing_image

2001-11-08  Tor Lillqvist  <tml@iki.fi>

	* README.win32: Add headers. Add section about ActiveIMM.

	* configure.in: Add --with-ie55 flag to specify the location of
	the "IE55 libs and headers" package downloadable from Microsoft,
	which contains, among other things, the Active IMM header dimm.h
	and UUID library uuid.lib. Use test -f instead of AC_CHECK_FILE.
	Require GLib 1.3.10.
	
	* config.h.win32.in: New version, produced by merging two
	configure-generated ones (for gcc and MSVC). Hopefully #defines
	the same flags that the previous, hand-written one, did.

	* gdk/Makefile.am
	* gdk/win32/Makefile.am: Handle the uuid library from the IE55 lib.

	* gdk/win32/gdkevents-win32.c: Conditionalize ActiveIMM
	stuff. Remove unused GdkIOClosure.

	* gdk/win32/surrogate-dimm.h: Remove, use real dimm.h instead (if
	available).

	* gdk/win32/libie55uuid.la: New file, handwritten libtool wrapper
	for uuid.lib. (Does it really have to be this hard to use an
	existing library with libtool? Probably I am missing something.)

2001-11-08  Darin Adler  <darin@bentspoon.com>

	* gtk/gtklabel.c: (gtk_label_ensure_layout): Fix an obvious
	typo where it says LEFT instead of CENTER.

2001-11-07  Darin Adler  <darin@bentspoon.com>

	* gtk/gtkdialog.c: (gtk_dialog_set_response_sensitive),
	(gtk_dialog_set_default_response): Add g_return_if_fail.

Mon Nov  5 22:34:29 2001  Owen Taylor  <otaylor@redhat.com>

	* gtk/gtktreednd.[ch] (struct _GtkTreeDragSourceIface): 
	Add row_draggable() vfunc, and wrapper function.

	* gtk/gtktreednd.[ch] (struct _GtkTreeDragDestIface): Make
	row_drop_possible take a GtkSelectionData, rather than
	model/row pair.

	* gtk/gtktreestore.c gtk/gtkliststore.c: Update for 
	new DND interfaces.

	* gtk/gtktreeview.[ch]: Remove the row_draggable_func
	location_dropable_func from gtk_tree_view_set_rows_drag_source/dest.
	and rename them to enable_model_drag_source/dest.

	* gtk/treeviewcolumn.c: Add DND of columns between rows.
	Still can't drop _to_ the left tree, but other places
	work.

	* gtk/gtktreeview.c (unset_reorderable): Unset the
	reorderable property if unset/enable_model_drag_source/dest
	are called manually.

	* gtk/gtktreestore.c (gtk_tree_store_row_drop_possible): 
	Correct for change in depth count handling.

	* gtk/gtktreeview.c (gtk_tree_view_create_row_drag_icon):
	Pass in a expose area to gtk_tree_view_column_cell_render()

2001-11-06  Havoc Pennington  <hp@redhat.com>

	* demos/gtk-demo/textview.c (easter_egg_callback): wacky easter egg

Tue Nov  6 10:13:16 2001  Owen Taylor  <otaylor@redhat.com>

	* gdk/x11/gdkgc-x11.c: Fix misplaced HAVE_XFT.

2001-11-05  Havoc Pennington  <hp@redhat.com>

	* gtk/gtktextview.c (gtk_text_view_paint): expose the child
	widgets in here
	(gtk_text_view_realize): set parent window of child widgets
	(gtk_text_view_size_request): use child req to decide whether
	to invalidate layout, not widget->requisition

	* gtk/gtktextdisplay.c (render_layout_line): set
	shaped_width_pixels for NULL shape objects, so that we properly
	draw the "missing pixbuf/widget" thing
	(render_layout_line): don't draw the widget here
	(gtk_text_layout_draw): pass out a list of widgets that need exposing

	* demos/gtk-demo/textview.c (insert_text): add demo of child
	widgets

	* gtk/gtktextlayout.c (add_child_attrs): remove debug spew

	* gtk/gtktextdisplay.c (render_layout_line): remove debug spew

	* gtk/gtktextview.c (gtk_text_view_update_child_allocation): add
	scroll offsets
	(gtk_text_view_value_changed): poke new X and Y into child allocations

2001-11-06  Tor Lillqvist  <tml@iki.fi>

	* gtk/gtkmain.c (find_module): Do search GTK_BINARY_VERSION
	-specific directory on Windows, too (#63759).

Mon Nov  5 12:46:44 2001  Owen Taylor  <otaylor@redhat.com>

	* gdk/x11/gdkdrawable-x11.[ch] gdk/x11/gdkgc-x11.c
	gdk/x11/gdkpixmap-x11.c gdk/x11/gdkprivate-x11.h
	gdk/x11/gdkwindow-x11.c: Redo Xft support to go
	directly to Picture objects instead of using XftDraw.
	This fixes the problem where we weren't able to 
	properly destroy XftDraw objects before destroying
	the accompanying windows, and probably improves
	efficiency a bit too. (#50214)

Mon Nov  5 10:01:49 2001  Owen Taylor  <otaylor@redhat.com>

	* gdk/x11/gdkgeometry-x11.c (gdk_window_compute_position): 
	Clamp max window width/height to 32767, not 32768 since
	we have to be able to deal with a dx/y of -32768 without
	getting a width of 65536 when guffaw scrolling.

	* gdk/x11/gdkgeometry-x11.c: Implement gdk_window_scroll()
	for the guffaw scrolling case, fixing some problems with
	copy-area case as well. Fix BadValue bug with moving windows
	by large amounts.

	* gdk/x11/gdkgeometry-x11.c (gdk_window_clip_changed): Update
	clip in window structue before calling gdk_window_invalidate_region
	since that trims new invalidations to the window's visible
	region.

	* gdk/x11/gdkwindow-x11.c (gdk_window_set_static_gravities): 
	Really set the static window gravity on the children, not
	repeatedly on the window.

	* gtk/testgtk.c: Add a torture test for big windows and 
	gdk_window_scroll().

Sun Nov  4 17:36:08 2001  Manish Singh  <yosh@gimp.org>

	* acconfig.h configure.in: sigsetjmp is macroized in some places,
	so use AC_TRY_LINK instead of AC_CHECK_FUNCS for the check.

Sun Nov  4 19:16:23 2001  Owen Taylor  <otaylor@redhat.com>

	* gdk/gdkcolor.c (gdk_color_parse): Implement gdk_color_parse()
	in terms of pango_color_parse().

	* gdk/{linux-fb,win32,x11}/gdkcolor-*.c: Remove port-specific
	gdk_color_parse() implementations.

Sun Nov  4 18:39:43 2001  Owen Taylor  <otaylor@redhat.com>

	* gtk/gtksizegroup.c (gtk_size_group_set_mode): 
	queue_resize_on_group with both the old and new mode, not
	just the new mode. (#60171, Nicolas Setton). Also, notify
	the "mode" property.
	
Sun Nov  4 16:02:08 2001  Owen Taylor  <otaylor@redhat.com>

	* gdk/gdkwindow.[ch]: Add a function gdk_window_invalidate_maybe_recurse() 
	for use in "shallow invalidation" of a widget. (Windows belonging
	to the widget, but not to the widget's children)

        * gtk/gtkprivate.h gtk/gtkwidget.c gtk/gtksizegroup.c: Add private
	flags GTK_ALLOC_NEEDED, GTK_REQUEST_NEEDED.  These flags are set
	up on ancestors up to the resize container on queue_resize. Size
	requests only actually take place if GTK_REQUEST_NEEDED, size
	allocations only take place if GTK_ALLOC_NEEDED or the size
	changed.

        * gtk/gtkcontainer.c gtk/gtkwidget.c: Remove
	container->resize_widgets and the RESIZE_NEEDED flag since the
	above flags are sufficient to figure out what needs to be
	resized/reallocated. Remove code manipulating
	container->resize_widget.

        * gtk/gtkwidget.[ch]: Add gtk_widget_set_redraw_on_alloc(); this
	allows widgets to turn off being automatically invalidated is when
	they are resized.

	* gtk/gtkwidget.[ch] (gtk_widget_size_allocate): Invalidation when
	a widget is resized or moved is "shallow" as described above -
	only the windows that need to be invalidated are invalidated.

	* gtk/gtkbox.c gtk/gtktable.c gtk/gtkalignment.c docs/Changes-2.0.txt: 
	Make these widget's init functions call 
	gtk_widget_set_redraw_on_allocate(widget,FALSE).

	* gtk/gtkwindow.c (gtk_window_configure_event): Call 
	_gtk_container_queue_resize(), since we don't want
	redrawing. (Probably could be done for other 
	calls to gtk_widget_queue_resize() in gtkwindow.c,
	but this is the most important one.)

	* gtk/gtkwindow.c (gtk_window_move_resize): Don't call
	gtk_widget_queue_draw() - size_allocate() handles
	that as appropriate.

	* gtk/gtkframe.c (gtk_frame_size_allocate): Invalidate instead
	of queue_clear() to avoid invalidating children.

2001-11-04  jacob berkman  <jacob@ximian.com>

	* gtk/gtkmain.c (find_module): don't free the module name until
	after we load the module

Sat Nov  3 13:57:21 2001  Owen Taylor  <otaylor@redhat.com>
 
 	* gtk/gtkctree.c: Convert GTK_TYPE_CTREE_NODE to pointer
 	derivation instead of boxed derivation.
 
 	* gtk/gtkmarshal.list: Remove some now unused marshallers.
 
2001-11-04  Tor Lillqvist  <tml@iki.fi>

	* gtk/gtkimmodule.c: Can't include gtkprivate.h (I added the
	include yesterday, without really thinking), as that defeats the
	working of correct_libdir_prefix() (it becomes a no-op.). Add
	comment mentioning that. Thanks to Hans Breuer for noticing.
	
2001-11-03  Daniel Elstner  <daniel.elstner@gmx.net>

	* gtk/gtkwindow.h (frame_event): Use GtkWindow* as first
	signal argument (was GtkWidget*).

	* gtk/gtkwindow.c (gtk_window_frame_event),
	  gtk/gtkwindow-decorate.c (gtk_decorated_window_frame_event):
	Fixed argument types as above, removed GTK_WINDOW casts and
	added some GTK_WIDGET casts instead.

2001-11-03  Hans Breuer  <hans@breuer.org>

	* gtk/gtkfilesel.c (gtk_file_selection_finalize) : chain
	finalize to parent class to get removed from the toplevel_list.
	Should fix 'random' crashes of #63474.

	* gtk/gtktreemodelsort.c : chain finalize() to parent class

2001-11-03  Tor Lillqvist  <tml@iki.fi>

	* modules/input/Makefile.am: Use -no-undefined on Windows. Look
	for .dll or .so as appropriate as module suffix.

	* gtk-zip.sh.in: Use correct import library names.

	* gtk/gtk.def: Add a couple of missing entry points. (#63585)

	* gtk/gtkimmodule.c (correct_libdir_prefix): New function, used on
	Windows to turn build-time paths from a gtk.immodules distributed
	as part of a binary package into runtime ones in the
	end-user-chosen installation directory.
	(gtk_im_module_init): Use it for module path and domain
	directory.

2001-11-02  Tor Lillqvist  <tml@iki.fi>

	* gtk/gtkrc.c (gtk_rc_make_default_dir): Fix typo: extraneous
	comma.  Include gtkprivate.h for GTK_LIBDIR etc definitions on
	Windows.

2001-10-30  Tor Lillqvist  <tml@iki.fi>

	* Makefile (install-data-hook): Use cp, not $(LN_S) on the .pc
	files. Configure on Win32 (running on Cygwin) thinks symlinks
	exist, but pkg-config is not necesarily a Cygwin program, and
	doesn't understand them.

Fri Nov  2 16:45:17 2001  Jonathan Blandford  <jrb@redhat.com>

	* gtk/gtkrbtree.c (_gtk_rbtree_remove_node): Clean up height code
	a bit.  I don't think it's completely correct yet, but it's
	getting there.

Fri Nov  2 16:14:15 2001  Owen Taylor  <otaylor@redhat.com>

	* gtk/gtkviewport.c (gtk_viewport_size_request): Remove
	random + 5 for width and height. If people want padding,
	they should add padding. (Note the +5 isn't padding
	that will always appear - it just appears in the case
	where the widget is allocated it's requisition.)
	(#51018, Janet Davis)

Fri Nov  2 15:53:23 2001  Owen Taylor  <otaylor@redhat.com>

	* gtk/gtkimcontext.h (struct _GtkIMContextClass): Pad
	the structure for future expansion.

Fri Nov  2 15:30:34 2001  Owen Taylor  <otaylor@redhat.com>

	Patch from HideToshi Tajima (#51922)
	
	* gtk/gtkimmulticontext.c: Proxy set_use_preedit().

	* gtk/modules/input/gtkimcontextxim.[ch]: Implement
	set_use_preedit().
	
	* gtk/modules/input/gtkimcontextxim.[ch]: If we have
	to destroy the input context because we change the
	client window or use_preedit, make sure we empty
	the preedit string.

Fri Nov  2 14:55:53 2001  Owen Taylor  <otaylor@redhat.com>

	* gtk/{gtkcolorseldialog.c,gtkfilesel.c,gtkfontsel.c,
	gtkgamma.c,gtkmessagedialog.c}: Go to the GUP
	proposed ordering of buttons with [OK] in the lower
	right hand corner. Patch from Gregory Merchan,
	#56331.

Fri Nov  2 11:51:49 2001  Jonathan Blandford  <jrb@redhat.com>

	* gtk/gtklabel.c (gtk_label_select_region_index): remove
	extraneous gtk_label_clear_layout (label)

2001-11-02  Sebastian Wilhelmi  <wilhelmi@ira.uka.de>

	* tests/makefile.msc, gtk/makefile.msc.in: Removed
	-DGTK_DISABLE_COMPAT_H.

	* docs/Changes-2.0.txt:
	s/GDK_DISABLE_COMPAT_H/GDK_DISABLE_DEPRECATED/

	* gtk/gtkcompat.h.in, gdk/gdkcompat.h: Removed from CVS.

Fri Nov  2 10:21:03 2001  Owen Taylor  <otaylor@redhat.com>

	* examples/**/Makefile.am: Convert to use pkg-config
	rather than gtk-config. (#53375, Skip Montanaro)

2001-11-02  Matt Wilson  <msw@redhat.com>

	* gtk/gtkdialog.c (find_child_by_response_id): remove totally
	broken unused, non-compiling, static function.

Fri Nov  2 08:17:06 2001  Owen Taylor  <otaylor@redhat.com>

	* gtk/gtkdialog.c (gtk_dialog_set_response_sensitive): 
	Iterate through children of the action area, not of
	the vbox. (#58278, Sergey Kuzminov)

2001-11-01  Havoc Pennington  <hp@pobox.com>

	* gtk/gtktext.c (gtk_text_set_position): handle -1 argument in
	order to remove a workaround in Nautilus that forced
	GTK_ENABLE_BROKEN

	* gtk/gtkwidget.c (gtk_widget_modify_style): fix typos in the docs

Thu Nov  1 20:09:31 2001  Owen Taylor  <otaylor@redhat.com>

	* gtk/gtkrange.c: Patch from George Lebl to 
	fix division by zero for full scroll bars. (#62114)

Thu Nov  1 19:56:40 2001  Owen Taylor  <otaylor@redhat.com>

	* gtk/gtkmain.c (gtk_main_do_event): ref/unref
	around gtk_widget_event() if we are going to
	set a flag afterwards. (#63464)

Thu Nov  1 19:44:48 2001  Owen Taylor  <otaylor@redhat.com>

	* gtk/gtkiconfactory.c gtk/stock-icons/Makefile.am: 
	Actually add the missing/broken image icon as the
	image for the "missing image" stock icon.

Thu Nov  1 19:18:34 2001  Owen Taylor  <otaylor@redhat.com>

	* demos/gtk-demo/stock_browser.c (do_stock_browser): 
	Set a reasonable default height for the window.

	* demos/gtk-demo/stock_browser.c (id_to_macro): Fix
	bug where subsequent '-' weren't converted to '_'.
	(#59550, Matthias Clasen)

	* demos/gtk-demo/appwindow.c (menu_items): Don't right 
	justify the Help menu - just include a comment on
	how to do it. (#63539, 	Marius Andreiana)

	* gtk/gtkiconfactory.c (gtk_icon_set_get_sizes): Don't 
	list GTK_ICON_SIZE_INVALID.

	* demos/gtk-demo/stock_browser.c: Show the biggest available
	size, not a fixed size. (Often reported, including #63539, 
	Marius Andreiana)

Thu Nov  1 19:11:35 2001  Jonathan Blandford  <jrb@redhat.com>

	* gtk/gtkrbtree.c (gtk_rbtree_reorder_fixup): Fix reorder_fixup,
	#59583

	* gtk/gtktreeselection.c (gtk_tree_selection_set_mode): fix
	warning.

Thu Nov  1 16:54:00 2001  Owen Taylor  <otaylor@redhat.com>

	* gtk/gtktypeutils.h: Make GtkFunction return boolean, not gint.
	(Daniel Elstner).

Thu Nov  1 16:20:56 2001  Owen Taylor  <otaylor@redhat.com>

	* gtk/gtkimcontext.[ch]: Add:
	  - A ::retrieve_surrounding signal that asks the widget for
	    context around the insertion point.
	  - A ::delete_surrounding signal that asks the widget to 
	    delete context aroudn the insertion point.
	  - gtk_im_context_set_context() for widgets to set context
	    around the insertion point in response to ::retrieve_context.
	  - gtk_im_context_get_context() for context to get context
	    around the insertion point

	* gtkmarshal.list: Add BOOL:INT,INT

	* gtk/gtkimmulticontext.c: Proxy the get_surrounding() /
	set_surrounding() methods, and the ::retrieve_surrounding /
	::delete_surrounding signals.

	* gtk/gtkentry.c gtk/gtktreeview.c: Hook up to the
	GtkIMContext::retrieve_surrounding / ::delete_surrounding
	signals.

Thu Nov  1 15:45:04 2001  Jonathan Blandford  <jrb@redhat.com>

	* gtk/gtktreemodelsort.c (gtk_tree_model_sort_rows_reordered):
	it's amazing how well things work sometimes, even when they're
	completely wrong.

	* gtk/gtktreeview.c (gtk_tree_view_real_collapse_row): Fix bug
	where you could try to collapse a node w/o it having children.

	(gtk_tree_view_class_init): remove Shift L<->R as they already
	existed for expand/collapse.

Thu Nov  1 12:21:31 2001  Jonathan Blandford  <jrb@redhat.com>

	* gtk/gtktreeview.c (gtk_tree_view_focus_to_cursor): Fix crash
	found by Matt Wilson.

Thu Nov  1 00:44:50 2001  Jonathan Blandford  <jrb@redhat.com>

	* gtk/gtktreeview.c (gtk_tree_view_class_init): Support Shift,
	Control, and Shift|Control L<->R, #63475

Wed Oct 31 18:53:51 2001  Jonathan Blandford  <jrb@redhat.com>

	* gtk/gtktreemodel.c (gtk_tree_row_ref_deleted_callback): fix
	infinite loop noticed by yosh.

2001-11-01  Michael Meeks  <michael@ximian.com>

	* gtk/gtksocket.c (gtk_socket_unrealize): unset the
	GTK_REALIZED flag so we don't re-enter when we are
	destroyed from the plug side.

Wed Oct 31 18:23:47 2001  Owen Taylor  <otaylor@redhat.com>

	* gtk/gtkoptionmenu.c (gtk_option_menu_detacher): 
	Add a "menu" property and notify on it. (#62798,
	Padraig O'Briain)

	* gtk/gtkselection.[ch] gtk/{gtkentry.c, gtkfilesel.c,
	gtkoldeditable.c, gtktextbuffer.c, gtktextview.c}: 
	Fix set_text to take a gchar, not a guchar, and to have 
	a len argument.

Wed Oct 31 15:31:13 2001  Manish Singh  <yosh@gimp.org>

	* gtk/gtkstock.c: fix typo to make it compile

Wed Oct 31 17:27:20 2001  Jonathan Blandford  <jrb@redhat.com>

	* gtk/gtkcellrenderertext.c (gtk_cell_renderer_text_render): if
	the widget is insensitive, draw the text insensitively, #63306

2001-10-31  Matthias Clasen  <matthiasc@poet.de>

	* gtk/gtkstock.c: Add stock items for most stock icons. (#61757)

Wed Oct 31 16:53:48 2001  Jonathan Blandford  <jrb@redhat.com>

	* gtk/gtktreednd.c (gtk_tree_set_row_drag_data): rename
	gtk_selection_data_set_tree_row, #60218
	(gtk_tree_get_row_drag_data): rename
	gtk_selection_data_get_tree_row, #60218

	* gtk/gtktreemodel.c (gtk_tree_row_ref_deleted_callback): Actually
	get this right, after the third try, #63122.

2001-10-31  jacob berkman  <jacob@ximian.com>

	* gdk/gdkselection.h (GDK_TARGET_STRING): 
	(GDK_SELECTION_TYPE_STRING): these should be 31, not 3.  Hooray
	for Xatoms (and not using the XA_* macros)!

Wed Oct 31 15:38:14 2001  Owen Taylor  <otaylor@redhat.com>

	* gtk/gtkwindow.[ch] (gtk_window_get_focus): Add a
	gtk_window_get_focus() getter to determine the currently
	focused widget within the window. (#63145, request
	from Damian Ivereigh)

Wed Oct 31 14:45:08 2001  Jonathan Blandford  <jrb@redhat.com>

	* gtk/gtkenums.h (enum): Add GTK_SELECTION_NONE enum, #61695

	* gtk/gtktreeselection.c (gtk_tree_selection_set_mode): Handle new
	GTK_SELECTION_NONE enum.
	(_gtk_tree_selection_internal_select_node): ditto

	* gtk/gtkcellrenderer.h (struct _GtkCellRendererClass): add
	constness.

	* gtk/gtkcellrenderertoggle.c: more yummy constness.

	* gtk/gtkclist.c (gtk_clist_set_selection_mode): g_return_if_fail
	if mode == GTK_SELECTION_NONE

Wed Oct 31 14:05:17 2001  Jonathan Blandford  <jrb@redhat.com>

	* gtk/gtktreeview.c (gtk_tree_view_class_init): Added a
	"cursor_changed" signal, #62850.

2001-10-31  Matt Wilson  <msw@redhat.com>

	* gtk/gtktreedatalist.c (_gtk_tree_data_list_alloc): after
	allocating the treedatalist, zero it to make sure the values are
	cleared from any garbage that was in this chunk.

2001-10-31  Murray Cumming  <murrayc@usa.net>

	* gtk/cellrenderertext.h: "edited" default signal handler
	gchar* args are now const.
	gtk/cellrenderertoggle.h: "toggled" default signal handler
	gchar* arg is now const.
	Also changed other signal handlers for "edited" and "toggled" to
	have the same signature.

Tue Oct 30 19:17:57 2001  Jonathan Blandford  <jrb@redhat.com>

	* gtk/gtktreemodelsort.c (gtk_tree_model_sort_sort_level): massize
	rewrite.  Static models now totally work.  I'm not 100% sure about
	row_inserted and row_changed, but I'll get those later.

2001-10-30  Sven Neumann  <sven@gimp.org>

	* configure.in: use GLIB_AC_DIVERT_BEFORE_HELP() so we get proper
	output for configure --help.

2001-10-30  Havoc Pennington  <hp@pobox.com>

	* gtk/gtktextview.c (changed_handler): Update the IM spot location
	here, if text was invalidated in the visible area, because the
	scroll offset doesn't normally change in that case, and the mark
	isn't set, just implicitly moved over as text is added/removed
	
Mon Oct 29 19:18:35 2001  Jonathan Blandford  <jrb@redhat.com>

	* gtk/gtkseparatormenuitem.c: Code cleanup.
	(gtk_separator_menu_item_class_init): Fix bugs in this code.

2001-10-29  jacob berkman  <jacob@ximian.com>

	* gdk/Makefile.am (LDFLAGS): 
	* gtk/Makefile.am (LDFLAGS): automake doesn't support conditionalized
	LDFLAGS, so put win32 flags in here

Mon Oct 29 15:41:58 2001  Jonathan Blandford  <jrb@redhat.com>

	* gtk/gtktreemodelsort.c (gtk_tree_model_sort_sort_level): Darn.
	I can't believe this took this long to fix.

Mon Oct 29 13:54:49 2001  Jonathan Blandford  <jrb@redhat.com>

	* gtk/gtktreemodelsort.c (gtk_tree_model_sort_rows_reordered): fix
	reordered signal.

Mon Oct 29 12:27:51 2001  Owen Taylor  <otaylor@redhat.com>

	* gtk/gtkfilesel.c (gtk_file_selection_rename_file): Grab
	the focus to the fileop entry for create dir / rename
	file. (#62838)

Mon Oct 29 12:21:49 2001  Owen Taylor  <otaylor@redhat.com>

	* configure.in: Don't use AC_CHECK_FILE to check for a 
	file since it always spits warnings about cross compilation,
	use -f instead. It's not like we cross compile properly
	anyways.

	* configure.in (gtktargetlib): Move call to AC_PROG_CC
	to suppress autoconf warning.

	* acconfig.h: Add some missing #undefs from recent
	Win32 additions.

Mon Oct 29 11:31:40 2001  Owen Taylor  <otaylor@redhat.com>

	* m4macros/gtk-2.0.m4: Don't try to use pkg-config
	when we didn't find it. (#62944, Eric Lemings)

	* m4macros/gtk-2.0.m4: Fix problem with spaces around =
	sign in assignment. (#63209, Arkadiusz Miskiewicz)

2001-10-29  Anders Carlsson  <andersca@gnu.org>

	* gtk/gtktreeview.c (gtk_tree_view_size_request): Calculate
	the buttons size request before using it. Fixes #61696.

2001-10-29  Tor Lillqvist  <tml@iki.fi>

	* README.win32: Updates.

	* gtk-zip.sh.in: New file, used to build distribution package for
	Windows.

	* gdk/gdkglobals.c: Mark gdk_threads_mutex for DLL export when
	applicable with GDKVAR.

	* gdk/win32/libwntab32x.la: New file, hand-written wrapper for the
	Wintab library.

	* gdk/win32/gdkwin32.h
	* gdk/win32/gdkprivate-win32.h: Reorganise to match corresponding
	X11 headers better, and to enable gdkwin32.h to be installed and
	included from applications, but not the *-win32.h headers.

	* gdk/win32/*.c: Corresponding small changes, simplifications of
	#includes.
	
	* gdk/win32/gdkregion-win32.c: Remove.

	* gdk/win32/gdkevents-win32.c (print_event): Add GDK_SETTING.

	* gdk/win32/gdkfont-win32.c
	* gdk/win32/gdkgeometry-win32.c: Remove unused variables.

	* gdk/win32/gdkproperty-win32.c (gdk_atom_intern): Don't insert
	GDK_NONE values into hash table.

	* gtk/gtk.def: Update.

	* gtk/gtkfilesel.c: Include <winsock.h> (if available) for
	gethostname().

	* gtk/gtkmain.c 
	* gtk/gtkrc.c: (Win32) Save actual DLL name for later use in DLL
	entry function. Avoid hardcoded paths GTK_LIBDIR, GTK_SYSCONFDIR,
	GTK_DATA_PREFIX and GTK_LOCALEDIR, instead add functions that call
	g_win32_get_package_installation_subdirectory() with the actual
	DLL name saved above. Redefine above directory name macros to call
	these functions. Remove some ifdefs.

	* gtk/maketypes.awk: Output GTKTYPEBUILTINS_VAR (that marks
	variable for export on Win32) also to the _vars file.

	Changes for autoconfiscated build on Win32, and addition of Win32
	backend to the related files:
	
	* configure.in: Like in GLib, set LT_CURRENT_MINUS_AGE for use
	when forming DLL name in some files. Set MS_LIB_AVAILABLE is
	lib.exe is available. Call AC_LIBTOOL_WIN32_DLL. Set
	PLATFORM_WIN32, OS_WIN32 and USE_WIN32 automake conditionals. Add
	win32 target, using pangowin32. Don't use the
	-export-symbols-regex option on Win32, we use .def files to list
	exported symbols. Check <winsock.h> (for gethostname() in
	gtkfilesel.c). Enclose nested AC_CHECK_* macros in brackets to
	prevent premature m4 expansion.

	* acconfig.h: Add HAVE_WINTAB.

	* gdk/Makefile.am: Add libgdk-win32-1.3.la target and associated
	macros and rules. Use -no-undefined on Win32. Use gdk.def file. If
	MS_LIB_AVAILABLE, build MS import library. Install the import
	libraries. If HAVE_WINTAB, link with the Wintab library.

	* gdk/win32/Makefile.am: Actually enable building the win32
	objects here, not just list all files in EXTRA_DIST. Link in the
	compiled resource file from rc/gdk-win32res.lo. If HAVE_WINTAB,
	copy the Wintab library into the .libs directory. 

	* gdk/win32/gdkwindow-win32.c (RegisterGdkClass): Don't assume the
	name of the GDK DLL when fetching the icon. Use the HMODULE saved
	in gdk_dll_hinstance by DllMain.

	* gdk/win32/rc/Makefile.am: Build gdk-win32res.lo using the
	build/win32/lt-compile-resource script.

	* gdk/win32/rc/gdk.rc.in
	* gtk/gtk-win32.rc.in: Use the DLL name that libtool would use.

	* gtk/Makefile.am: Add libgtk-win32-1.3.la target and associated
	macros and rules. Use -no-undefined on Win32. Use gtk-win32.def
	file. Install import libraries.

2001-10-29  Anders Carlsson  <andersca@gnu.org>

	* gtk/gtkiconfactory.c (get_default_icons): Fix build.

2001-10-28  Hans Breuer  <hans@breuer.org>

	* gdk/gdk.c gdk/gdkevents.c
	  gdk/win32/gdkcolor-win32.c gdk/win32/gdkdnd-win32.c
	  gdk/win32/gdkdrawable-win32.c gdk/win32/gdkevents-win32.c
	  gdk/win32/gdkfont-win32.c gdk/win32/gdkgc-win32.c
	  gdk/win32/gdkim-win32.c gdk/win32/gdkmain-win32.c
	  gdk/win32/gdkprivate-win32.h gdk/win32/gdkproperty-win32.c
	  gdk/win32/gdkselection-win32.c gdk/win32/gdkwin32.h
	  gdk/win32/gdkwindow-win32.c gdk/win32/gdkwindow-win32.h :
	static correct-ness, underscore prefixing of library internal 
	functions
	(applied the undisputed and the win32 part. Of the latter 
	 I'm probably the one who will change it back again, if Owen
	 decides that the Gdk*Impl types should not be private to Gdk)

	* gdk/gdk.def : added the remaining exported functions

2001-10-28  Matthias Clasen  <matthiasc@poet.de>

	* gtk/gtkcellrenderertoggle.c, gtk/gtkimcontextsimple.c,
	gtk/gtkimmulticontext.c, gtk/gtkimagemenuitem.c,
	gtk/gtkiconfactory.c, gtk/gtkwindow.c: Documentation updates.

2001-10-28  jacob berkman  <jacob@ximian.com>

	* gtk/gtkcolorsel.c (gtk_color_selection_class_init): do not call
	gtk_settings_get_default() here as that requires an X connection
	(which breaks doc building with no X connection) and is not
	multihead safe
	(gtk_color_selection_init): delay palette loading until realize
	time
	(gtk_color_selection_realize): load the palette, and initialize
	the global palette if it hasn't been already

	* gtk/gtkpreview.c (gtk_preview_class_init): don't initialize the
	visual/cmap fields of klass->info since they are gone
	(gtk_preview_get_visual): just return gdk_rgb_get_visual ()
	(gtk_preview_get_cmap): just return gdk_rgb_get_colormap ()
	(gtk_preview_realize): don't set VISUAL and COLORMAP attributes

	* gtk/gtkpreview.h (struct _GtkPreviewInfo): remove visual and
	cmap fields
	(gtk_preview_get_visual):
	(gtk_preview_get_cmap): mark as deprecated

	* docs/Changes-2.0.txt: add a little note about the GtkPreviewInfo
	changes

Sun Oct 28 09:15:39 2001  Owen Taylor  <otaylor@redhat.com>

	* gtk/gtkimcontext.h (struct _GtkIMContext): Fixed
	structure to have GObject not GtkObject as
	parent_instance. (Jeff Franks.)

2001-10-27  Matthias Clasen  <matthiasc@poet.de>

	* gdk/x11/gdkinput.c: Typo fix.

2001-10-26  Havoc Pennington  <hp@pobox.com>

	* gtk/gtktextview.c (gtk_text_view_mark_set_handler): Call
	update_im_spot_location here explicitly
	(gtk_text_view_reset_im_context): don't update the spot location
	here

2001-10-27  Anders Carlsson  <andersca@gnu.org>

	* gtk/gtktreemodel.c (gtk_tree_model_get): Fix typo in docs.
	This fixes #62942.

	* gtk/gtkspinbutton.c (gtk_spin_button_new_with_range): 
	Clarify that we're returning a spin button in the _new function.
	This fixes #54097.
	
Fri Oct 26 20:55:57 2001  Owen Taylor  <otaylor@redhat.com>

	* gtk/gtkbutton.c: Revert changes to GTK_RUN_LAST. 
	Unfortunately, people apparently erroneously connect
	to ::clicked for GtkToggleButton and expect
	they know what happened in the default signal handler
	instead of appropriately connecting to notification
	signal ::toggled. When the revolution comes, such
	people will be first against the wall.

	We'll just have to go back to the old less-reliable
	set-it-back hacks for handling model-view check
	buttons and radio buttons. :-(. 

2001-10-27  Hans Breuer  <hans@breuer.org>

	* gtk/gtkbbox.c gtk/gtkctree.c gtk/gtkhbbox.c
	  gtk/gtkimmulticontext.c gtk/gtklabel.c gtk/gtkliststore.c
	  gtk/gtkmenu.c gtk/gtkpaned.c gtk/gtkrc.c gtk/gtkscale.c
	  gtk/gtkstyle.c gtk/gtktextbuffer.c gtk/gtktextlayout.c
	  gtk/gtktexttag.c gtk/gtktexttagtable.c gtk/gtktextview.c
	  gtk/gtktreestore.c gtk/gtkvbbox.c : 
	to simplify parsing for exported functions:
	- made implementation signature static, when the local 
	  prototype already was
	- put the functions return value on it's own line
	- added as space between the function name and the 
	  opening bracket

	* gtk/gtk.def : added the remaining exported functions

2001-10-27  Anders Carlsson  <andersca@gnu.org>

	* gtk/gtktreeviewcolumn.c (gtk_tree_view_column_set_fixed_width): 
	Add note about width having to be greater than 0. This fixes
	#55574. 

	* gtk/gtktextiter.c (gtk_text_iter_backward_sentence_start): 
	Fix docs to say previous instead of next.
	(gtk_text_iter_backward_word_start): Likewise.
	This fixes bug #62980.

	* gtk/gtkcontainer.c (gtk_container_set_border_width): Mention
	that the valid width is in range 0-65535 pixels. Fixes bug 
	#56754.

	* gtk/gtksizegroup.c (gtk_size_group_set_mode): Remove
	a dot in the documentation. Fixes bug #62632.

	* gdk/x11/gdkmain-x11.c: Replace int and guint with
	long and gulong in some places to make the code 64-bit
	clean.
	(_gdk_windowing_init_check): Replace gint with gulong.
	This patch was made by George Lebl and fixes bug #62113.

	* tests/testgtk.c (create_range_controls): Don't set a 
	fixed height on the hscale widget. This fixes "bug" 
	#55840.
	(create_window_states): Set up destroy signals so that
	all windows will be destroyed when one is. This fixes 
	bug #58133.

2001-10-26  Anders Carlsson  <andersca@gnu.org>

	* gtk/gtktreeview.c: 
	(gtk_tree_view_class_init): Create new "indent_expander"
	style property.

	(gtk_tree_view_get_arrow_xrange): Add a tree argument
	to the function since the xrange can change depending
	on where in the tree we are. 
	
	(coords_are_over_arrow): Update function call to
	gtk_tree_view_get_arrow_xrange.
	(gtk_tree_view_draw_arrow): Likewise.
	
	(gtk_tree_view_real_expand_collapse_cursor_row):
	Call real_{expand|collapse}_row, so that we'll have an
	animation.

Fri Oct 26 20:13:36 2001  Kristian Rietveld  <kristian@planet.nl>

	* tests/Makefile.am: fixed a small typo

Fri Oct 26 18:27:11 2001  Kristian Rietveld  <kristian@planet.nl>

	* demos/gtk-demo/list_store.c (create_model): Anders
	Carlsson suggested to use G_N_ELEMENTS here

2001-10-26  Sven Neumann  <sven@gimp.org>

	* gtk/gtkbutton.[ch]
	* gtk/gtkdnd.c: fixed inline comments
	
	* gtk/gtkgamma.c: gtk_entry_get_text() returns a const gchar.

2001-10-26  Hans Breuer  <hans@breuer.org>

	* gdk-pixbuf/gdk_pixbuf.def : 
	* gdk/gdk.def : 
	* gtk/gtk.def : updated externals

	* gdk/win32/gdkpixmap-win32.c : removed duplicate of
	gdk_window_lookup implementation. It already was in
	gdk/win32/gdkwindow-win32.c

	* gdk/win32/gdkproperty-win32.c : made it compile again
	after GdkAtom API change

	* gtk/gtk/makefile.msc.in : updated

Wed Oct 24 11:36:33 2001  Owen Taylor  <otaylor@redhat.com>

	* configure.in (GTK_MICRO_VERSION): Version 1.3.10,
	require GLib 1.3.10.

	* NEWS: updates.

Thu Oct 25 16:27:29 2001  Jonathan Blandford  <jrb@redhat.com>

	* gtk/gtkrbtree.c (_gtk_rbnode_rotate_left): Add support for
	invalid nodes.
	 (_gtk_rbnode_rotate_right): Ditto.
	 (_gtk_rbtree_node_mark_invalid): New function.
	 (_gtk_rbtree_node_mark_valid): New function.

	* gtk/gtktreemodelsort.c (gtk_tree_model_sort_class_init): We're a
	GObject, not a GtkObject.
	(gtk_tree_model_sort_row_has_child_toggled): Rewrote to be more
	correct.
	(gtk_tree_model_sort_row_deleted): ditto.
	(gtk_tree_model_sort_{un,}ref_node): Fix.

	* gtk/gtktreeview.c: Protean incremental reflow support (commented
	out)

	* gtk/gtktreeview.h (GtkTreeViewSearchEqualFunc): change char *key
	to const char *key.

	* gtk/gtktreemodel.c (gtk_tree_row_reference_unref_path_helper):
	Important 1 line fix to fix a lot of refcounting woes.

2001-10-25  Matt Wilson  <msw@redhat.com>

	* gtk/gtktextview.c (gtk_text_view_destroy): call
	gtk_text_view_destroy_layout after gtk_text_view_set_buffer (which
	now invalidates) so that we remove our idle functions.
	(gtk_text_view_destroy_layout): remove the first_validate_idle as
	well.

	* gtk/gtktexttag.c (gtk_text_tag_class_init): the valid range for
	the 'indent' property is G_MININT to G_MAXINT.  Don't use
	-G_MAXINT for the minimum of the 'rise' property, use G_MININT
	instead.

2001-10-24  Anders Carlsson  <andersca@gnu.org>

	* gtk/gtktreeview.c: 
	(gtk_tree_view_real_expand_row): add an animate argument
	(gtk_tree_view_real_collapse_row): likewise
	
	(gtk_tree_view_button_press), (gtk_tree_view_button_release), 
	(gtk_tree_view_collapse_all), (gtk_tree_view_expand_row),
	(gtk_tree_view_collapse_row): update functions that call
	real_{expand|collapse}_row to set the animate argument 
	accordingly.
	
2001-10-24  Alex Larsson  <alexl@redhat.com>

	* gdk/linux-fb/gdkfont-fb.c:
	Update to new Pango APIs

	* gdk/linux-fb/gdkproperty-fb.c:
	Update to new GdkAtom APIs

	* gdk/linux-fb/gdkwindow-fb.c:
	Remove warnings

Mon Oct 22 20:07:21 2001  Jonathan Blandford  <jrb@redhat.com>

	* gtk/gtktreestore.c (gtk_tree_store_prepend): Fix docs, #62808

Wed Oct 24 22:54:07 2001  Kristian Rietveld  <kristian@planet.nl>

	* gtk/gtktreemodelsort.c (gtk_tree_model_sort_row_inserted): treat
	s_path as a child path

Wed Oct 24 20:29:47 2001  Kristian Rietveld  <kristian@planet.nl>

	* gtk/gtktreemodelsort.c: more changes in an attempt to get
	it right. It's not yet ready for general consumption.

	* tests/treestoretest.c: add a button and entry for the new
	iter_change function
	(iter_change): new function, to test
	the row_changed signal implementation of the GtkTreeModelSort

	* tests/testtreesort.c: cleanups, changes to test more features
	of the GtkTreeModelSort at once

2001-10-24  Havoc Pennington  <hp@redhat.com>

	* gtk/gtktextbuffer.c (clipboard_clipboard_buffer_received):
	remove hack to strip off the bogus newline, since we killed the
	bogus newline; fixes #61779

2001-10-24  Havoc Pennington  <hp@redhat.com>

	* gtk/gtktextview.c (gtk_text_view_update_adjustments): don't
	create layout if we didn't have one
	(gtk_text_view_set_buffer): invalidate so we get the idle handlers
	as appropriate, avoids blanking the screen 
	(gtk_text_view_invalidate): new function to do invalidation,
	containing old guts of invalidated_handler

Wed Oct 24 10:29:47 2001  Owen Taylor  <otaylor@redhat.com>

	* gtk/gtkalignment.c (gtk_alignment_class_init): Improve
	dreadful tooltips.

Tue Oct 23 17:31:42 2001  Owen Taylor  <otaylor@redhat.com>

	* gdk/x11/gdkwindow-x11.c gdk/win32/gdkwindow-win32.c: Always 
	set window->parent (except or the root window itself); if 
	the window's parent is not a GdkWindow, or is a window of 
	type GDK_WINDOW_FOREIGN, set window->parent to the root parent.

	* gdk/gdkwindow.c (gdk_window_get_toplevels): Don't include
	windows of type GDK_WINDOW_FOREIGN.

2001-10-24  Havoc Pennington  <hp@pobox.com>

	* gtk/gtktextiter.c (gtk_text_iter_backward_chars): if we move to
	the front of a segment, use the "slow" technique for moving
	backward, so we don't mess up the any_segment field in the iter. 
	Fixes #57707

	* tests/testtextbuffer.c: add code to detect #57707, to avoid
	regression

2001-10-23  Havoc Pennington  <hp@redhat.com>

	* gtk/gtktextview.c (popup_targets_received): only sensitize Cut
	if selection contains some editable text, #60975
	(gtk_text_view_scroll_to_iter): remove warning about scrolling
	prior to map; it should actually be OK to do so in many cases, 
	it would be nice to warn about scrolling when many lines have
	height 0, but I don't know what to do about that. Perhaps 
	move part of flush_scroll into this function? comment added 
	to consider this.

2001-10-23  Havoc Pennington  <hp@redhat.com>

	* gtk/gtktextview.c (changed_handler): Correctly keep the same
	text on the top of the screen, considering that the changed region
	may have overlapped the first paragraph. Should fix msw's "text
	widget scrolled to wrong place on map" bug, and probably some
	other scrolling cases as well.
	(gtk_text_view_set_scroll_adjustments): start adjustments at 0.0, 
	instead of some random value

	* gtk/gtktextview.c (gtk_text_view_class_init): actually override
	grab_focus, so #59708 is really fixed

2001-10-24  Anders Carlsson  <andersca@gnu.org>

	* gtk/gtkentry.c: (append_action_signal): Use an image menu item here
	(popup_targets_received): Call append_action_signal with stock items
	
	* gtk/gtklabel.c: (append_action_signal): Use an image menu item here
	(gtk_label_do_popup): Call append_action_signal with stock items
	
	* gtk/gtktextview.c: (append_action_signal): Use an image menu item here
	(popup_targets_received): Call append_action_signal with stock items

2001-10-23  Havoc Pennington  <hp@redhat.com>

	* gtk/gtktextview.c (changed_handler): queue a resize here; will
	temporarily slow down the widget a lot, until we figure out how to
	optimize to avoid full redraw everytime we queue a resize.

2001-10-23  Havoc Pennington  <hp@redhat.com>

	* gtk/gtktextiter.c (test_log_attrs): handle case where offset ==
	0 and char_len == 0, bug #61729

2001-10-23  Havoc Pennington  <hp@redhat.com>

	* gtk/gtktextiter.c (gtk_text_iter_forward_cursor_positions): fix
	return value, #61714 (Vitaly Tishkov)
	(gtk_text_iter_backward_sentence_starts): ditto
	(gtk_text_iter_backward_word_starts): ditto
	(gtk_text_iter_forward_word_ends): ditto
	(gtk_text_iter_forward_sentence_ends): ditto
	(gtk_text_iter_backward_cursor_positions): ditto

2001-10-23  Havoc Pennington  <hp@redhat.com>

	* gtk/gtktextlayout.c (gtk_text_layout_get_iter_at_pixel): Apply
	fix from Dov Grobgeld, #61858

2001-10-23  Havoc Pennington  <hp@redhat.com>

	* gtk/gtktextview.c (gtk_text_view_update_im_spot_location): 
	Update IM spot location at appropriate times, #50626
        (Hidetoshi Tajima)

2001-10-23  Havoc Pennington  <hp@redhat.com>

	* gtk/gtktextview.c (gtk_text_view_grab_focus): scroll to cursor
	on grab focus, unless it's caused by button click, #59708

Tue Oct 23 11:53:00 2001  Owen Taylor  <otaylor@redhat.com>

	* gtk/Makefile.am (INCLUDES): Remove G_DISABLE_CONST_RETURNS.

	* gtk/gtkfontsel.[ch]: Make gtk_font_selection_get_font()
	G_CONST_RETURN. (Murray Cumming)	

	* gtk/gtkfontsel.c (gtk_font_selection_dialog_get_preview_text):
	Make G_CONST_RETURN.

	* gtk/gtkfilesel.c (open_user_dir): Fix bug with freeing
	results of g_get_home_dir().

	* gtk/gtkfilesel.c: Make filesel->fileop_file a duplicated 
	copy. Storing the return from gtk_entry_get_text() is evil.

	* gtk/gtkcombo.c gtk/gtkcellrenderertext.c gtk/gtkbindings.c 
	gtk/gtkfilesel.c gtk/gtkfontsel.c gtk/gtkimmodule.c 
	gtk/gtkobject.c gtk/gtkoldeditable.c gtk/gtktreedatalist.c
	gtk/gtksignal.c: Add const.

	* gdk/x11/gdkkeys-x11.c (get_direction): Add missing const.

	* gtk/gtktreeview.c: Namespace object data keys to be safe, even 
	if we are setting them on private widgets.

	* gtk/gtktreeview.c (gtk_tree_view_real_start_interactive_search): 
	Duplicate entry->text before setting it as object data.

2001-10-22  Havoc Pennington  <hp@redhat.com>

	* gtk/gtktextbuffer.c (gtk_text_buffer_place_cursor): don't back
	up a char from the end iterator, fixes #61859 ("can't put cursor
	at the end of the buffer")

	* gtk/gtktextiter.c (gtk_text_iter_forward_to_line_end): fix this
	to work with delimiters other than newline.

	* tests/testtextbuffer.c: add some tests for get_chars_in_line,
	get_bytes_in_line

	* gtk/gtktextiter.c (gtk_text_iter_get_chars_in_line): fix for the
	last line, since the newline is no longer counted.
	(gtk_text_iter_get_bytes_in_line): ditto

2001-10-22  Havoc Pennington  <hp@redhat.com>

	* gtk/gtktextbtree.c (_gtk_text_btree_insert): add assertion that 
	#58290 would trigger if it reappeared, I think

2001-10-22  Havoc Pennington  <hp@redhat.com>

	* gtk/gtktextiter.c (_gtk_text_iter_forward_indexable_segment):
	add temporary code to dump btree contents on assertion failure
	described in #62656
	
	* gtk/gtktextbtree.c (ensure_end_iter_segment): add some
	assertions that we're getting the right end iter segment

	* gtk/gtktextiter.c (_gtk_text_iter_forward_indexable_segment):
	verify that we aren't on the end iterator after moving 
	forward one segment - fixes return value in an obscure case. 
	Also, some trivial code cleanup/rearranging.
	
2001-10-22  Havoc Pennington  <hp@redhat.com>

	* gtk/gtktextlayout.h: add a #error unless you define
	GTK_TEXT_USE_INTERNAL_UNSUPPORTED_API, so people don't use this accidentally

        * gtk/gtktext*.c: #define GTK_TEXT_USE_INTERNAL_UNSUPPORTED_API as appropriate.
	
2001-10-22  Havoc Pennington  <hp@redhat.com>

	* gtk/gtktextview.c (gtk_text_view_get_border_window_size): fix 
	#62365

2001-10-22  Havoc Pennington  <hp@redhat.com>

	* gtk/gtktextview.c (gtk_text_view_get_window_type): fix 
	#62436

2001-10-22  Havoc Pennington  <hp@redhat.com>

	* gtk/gtktextview.c (gtk_text_view_set_border_window_size): Fix 
	#62366

Mon Oct 22 11:47:47 2001  Owen Taylor  <otaylor@redhat.com>

	* gtk/gtklabel.c: Add cursor-position, selection-bound 
	properties. (#62148, reported by Padraig O'Briain)

	* gtk/gtkentry.c (gtk_entry_class_init): Rename text_position
	to cursor_position. (1.3.x addition, text_position is an awful
	name.) Make cursor_position read-only to avoid sticky questions
	of interaction with selection_bound. (#62636, reported by
	Padraig O'Briain)

Mon Oct 22 16:25:12 2001  Owen Taylor  <otaylor@redhat.com>

	Fixing popup menus to have "Paste" sensitized correctly. Original
	patches from Damian Ivereigh, much mangled.

	* gtk/gtkselection.c: Add functions gtk_selection_data_get_targets(),
	gtk_selection_data_targets_include_text(). (#60854)

	* gtk/gtkclipboard.c: Add a simple do-it-all non-async "check if
	the clipboard has text" function gtk_clipboard_wait_is_text_available.
	(#60854)

	* gtk/gtkentry.c: Only enable the paste item if the clipboard
	contains text. (#60973)

	* gtk/gtktextview.c: Only enable the paste item if the clipboard
	contains text. (#60975)

2001-10-22  Havoc Pennington  <hp@redhat.com>

	* gtk/gtktextview.c (gtk_text_view_class_init): rip out
	"height_lines" and "width_columns" properties, it doesn't make
	sense to set the size request on a text view really. #62103

Mon Oct 22 15:17:05 2001  Jonathan Blandford  <jrb@redhat.com>

	* gtk/gtktreestore.c (gtk_tree_store_iter_depth): Realized
	g_node_depth is broken, and that it's not worth being consistent
	with it.

2001-10-22  Havoc Pennington  <hp@redhat.com>

	* gtk/gtktextiter.c (gtk_text_iter_set_line): Clarify behavior in
	docs, #61777
	(gtk_text_iter_forward_search) (gtk_text_iter_backward_search):
	change the two boolean args to a flags field, so we can extend 
	to add case insensitive, regexp searches later. #61852

Mon Oct 22 15:07:17 2001  Jonathan Blandford  <jrb@redhat.com>

	* gtk/gtktreestore.c (gtk_tree_store_iter_depth): update docs to
	reflect reality, #62810

Mon Oct 22 14:08:26 2001  Jonathan Blandford  <jrb@redhat.com>

	* demos/gtk-demo/appwindow.c: Remove handle_box from App demo.

	* gtk/gtktreeview.c (size_allocate): Move to a different drawing
	system.  Instead of having a window the size of the tree, we have
	a window the size of widget->allocation, and simply draw with the
	offset.
	(coords_are_over_arrow): ditto.  Move to window coordinates.
	(do_prelight): ditto
	(do_unprelight): ditto

	* gtk/gtktreemodelsort.c (gtk_tree_model_sort_rows_reordered):
	Minor fix from Kristian Rietveld to fix unsorted case.

2001-10-22  jacob berkman  <jacob@ximian.com>

	* gtk/gtkclist.c (cell_size_request): don't cast a PIXTEXT cell to
	a PIXMAP cell (fixes crash when using PIXTEXT cells)

Sat Oct 20 18:58:25 2001  Owen Taylor  <otaylor@redhat.com>

	* gtk/gtkentry.h: Deprecate gtk_entry_set_editable.
	(#58768, Vitaly Tishkov)
	
	* gtk/gtkobject.h: Deprecate with abandon. 
	(#61942, Vitaly Tishkov, Matthias Clasen)

	* gtk/gtksignal.h: Deprecate everything.

	* gtk/gtkmain.h (GTK_PRIORITY_INTERNAL): Deprecate
	all GTK_PRIORITY_* defines other than GKT_PRIORITY_RESIZE>
	(#61942, Matthias Clasen)

	* gtk/gtkstyle.h: Deprecate gtk_draw_*. (#61140,
	Havoc Pennington)

	* gtk/gtkitemfactory.h: Deprecate compat functions
	for GtkMenuFactory code. (#62071)

	* gdk/gdkdrawable.h: Deprecate gdk_draw_string,
	gdk_draw_text,gdk_draw_text_wc. (#62071)

Mon Oct 22 10:12:08 2001  Owen Taylor  <otaylor@redhat.com>

	* gdk/gdk.c docs/Changes-2.0.txt (gdk_threads_init): Don't call
	g_thread_init(), we don't want to link to -lgthread if we don't
	have to.

Mon Oct 22 08:51:02 2001  Owen Taylor  <otaylor@redhat.com>

	* gdk/gdk.[ch] (gdk_threads_init) docs/Changes-2.0.txt: 
	Add a function, gdk_threads_init() that must be explicitely 
	called to enable the GDK thread mutex.

2001-10-22  Jakub Steiner <jimmac@ximian.com>

	* gtk/stock-icons/stock_stop.png: no body parts
	
Sun Oct 21 23:27:00 2001  Owen Taylor  <otaylor@redhat.com>

	* gtk/gtkwidget.c (gtk_widget_translate_coordinates): Fix
	problem with g_return_if_fail return value.

 	* gdk/x11/gdkproperty-x11.c docs/Changes-2.0.txt: Move over the 
	virtual atom code from the gdk-multihead branch, removing the per-display
	part. Virtualizing atoms needs to be done now to prevent compat
	breakage in direct Xlib accessing code in the future. (#62208)
 
 	* gdk/x11/gdkx.h: gdk/gdk/x11/gdkproperty-x11.c: Export
 	gdk_x11_xatom_to_atom, gdk_x11_atom_to_xatom().
 
	* gdk/gdktypes.h docs/Changes-2.0.txt: Make GdkAtom
	an opaque pointer type so the compiler catches attempts
	to mingle it with X atoms.

	* gdk/x11/{gdkdnd-x11.c,gdkevents-x11.c,gdkglobals-x11.c,
	  gdkkeys-x11.c, gdkmain-x11.c, gdkprivate-x11.c, 
	  gdkproperty-x11.c, gdkselection-x11.c, gdkwindow-x11.c}
	  gtk/{gtkclist.c,gtkctree.c,gtkdnd.c,gtkplug.c,gtksocket.c}
	  tests/testdnd.c,tests/testselection.c: 
	Fix up for above atom changes.

	* gdk/gdkselection.h (GDK_SELECTION_CLIPBOARD): Add, since we
	now have the ability to add custom predefines.

	* gtk/{gtkentry.c,gtklabel.c,gtkoldeditable.c,gtktextview.c}:
	Use GDK_SELECTION_CLIPBOARD instead of GDK_NONE in calls
	to gtk_clipboard_get().

	* gdk/win32/gdkproperty-win32.c: Add CLIPBOARD, fix up
	for GdkAtom => pointer change.

	* gdk/linux-fb/gdkproperty-fb.c: Fix handling of predefined
	atoms, fix for GdkAtom => pointer change.

Mon Oct 22 00:26:46 2001  Kristian Rietveld  <kristian@planet.nl>

	* gtk/gtkspinbutton.c: remove ARROW_SIZE constant, use
	new function spin_button_get_arrow_size() instead.

	* gtk/gtkstyle.c (gtk_default_draw_arrow): actual size of
	arrow was hardcoded, it's now variable.

	Fixes bug #50200

Sat Oct 20 18:16:04 2001  Manish Singh  <yosh@gimp.org>

	* gtk/gtktreeview.c (gtk_treeview_get_property): PROP_MODEL and
	PROP_EXPANDER_COLUMN can be NULL, so don't do a object cast check
	for those

Sat Oct 20 19:38:16 2001  Owen Taylor  <otaylor@redhat.com>

	* demos/*.c demos/gdk-pixbuf/*.c: Eliminate gtk_signal_*
	in favor of g_signal_*, gtk_object_* in favor of 
	g_object_*.

Fri Oct 19 18:35:22 2001  Manish Singh  <yosh@gimp.org>

	* gtk/{gtkentry.c,gtktextview.c}: since GtkIMContext derives directly
	from GObject now, we have to use the g_object_* functions, not
	gtk_object_*.

Fri Oct 19 22:46:54 2001  Kristian Rietveld  <kristian@planet.nl>

	* gtk/gtktreemodelsort.[ch]: we probably have rows_reordered
	nailed down now (this code is not yet ready for general consumption)

Fri Oct 19 13:44:51 2001  Manish Singh  <yosh@gimp.org>

	* gtk/gtktreeview.c (gtk_treeview_scroll_to_cell): correct docs
	for use_align

Fri Oct 19 15:34:06 2001  Owen Taylor  <otaylor@redhat.com>

	* gtk/gtk.h gtk/Makefile.am: Export GtkIMContextSimple publically. (#61862)

Fri Oct 19 15:08:30 2001  Owen Taylor  <otaylor@redhat.com>

	* gtk/{gtkimcontext.c,gtkimcontextsimple.c,gtkimmulticontext.c}
	modules/input/{gtkimcontextxim.c,imcyrillic-translit.c,iminuktitut.c,
	imipa.c,imthai-broken.c,imviqr.c}: Make GtkIMContext derive from
	GObject, not GtkObject. (#62621)

Fri Oct 19 12:49:12 2001  Owen Taylor  <otaylor@redhat.com>

	* tests/testsocket.c: Remove now useless include of unistd.h,
	fix wrong argument gtk_socket_steal. (Hans Breuer, #58541)
	
Fri Oct 19 12:24:32 2001  Owen Taylor  <otaylor@redhat.com>

	* gdk/linux-fb/gdkfont-fb.c: Fix up for change to 
	Pango font API. #61933. (Untested, even for compilation.)

Fri Oct 19 11:24:58 2001  Owen Taylor  <otaylor@redhat.com>

	* gtk/gtkmain.[ch] (gtk_disable_setlocale): Actually
	export gtk_disable_setlocale(). (Caught by Sven Neumann)

2001-10-18  Havoc Pennington  <hp@redhat.com>

	* gdk/x11/gdkpixmap-x11.c (gdk_pixmap_lookup): fix compilation

2001-10-18  Havoc Pennington  <hp@redhat.com>

	* gtk/gtkbutton.c (gtk_button_class_init): Change button signals
	to GTK_RUN_LAST, #50239

2001-10-18  HideToshi Tajima  <hidetoshi.tajima@sun.com>

	* gtk/gtkimmodule.c (match_locale):
	Support "*" for all locales with least priority
	when to select default im module, #58201

2001-10-18  Matthias Clasen  <matthiasc@poet.de>

	* gtk/gtktreeselection.c (gtk_tree_selection_set_mode): 
	Fix docs. (#61976)
 
	* gtk/gtkplug.c (gtk_plug_get_id) : Fix docs. (#62144)

	* gtk/gtkliststore.c: Fix docs. (#61672, #61675)

        * gdk/gdkwindow.h, gdk/gdkpixmap.h, gdk/x11/gdkx.h,
        gdk/x11/gdkwindow-x11.c, gdk/x11/gdkpixmap-x11.c,
        gdk/win32/gdkwin32.h, gdk/win32/gdkwindow-win32.c,
        gdk/win32/gdkpixmap-win32.c, gdk/linux-fb/gdkfb.h,
        gdk/linux-fb/gdkwindow-fb.c, gdk/linux-fb/gdkpixmap-fb.c:
        Add gdk_window_lookup, gdk_window_foreign_new, gdk_pixmap_lookup
        and gkd_pixmap_foreign_new to the gdk frontend api. (#62063)

        * gtk/gtkselection.c: Remove gdk backend dependencies. (#62063)

	* gtk/gtkspinbutton.c (gtk_spin_button_size_request): 
	Don't restrict the width of the spinbutton entry field 
	to 10 digits. (#58681)

Thu Oct 18 14:58:14 2001  Jonathan Blandford  <jrb@redhat.com>

	* tests/testtreeflow.c: new test program for the tree.

Thu Oct 18 14:22:10 2001  Jonathan Blandford  <jrb@redhat.com>

	* gtk/gtktreestore.c (gtk_tree_store_remove): fix small bug
	reported by (Oleg Maiboroda), #62600

2001-10-18  Michael Meeks  <michael@ximian.com>

	* gtk/gtkentry.c (gtk_entry_set_property),
	(gtk_entry_get_property): impl 'text'
	(gtk_entry_class_init): add the 'text' prop.
	(gtk_entry_insert_text): notify 'text' changed.
	(gtk_entry_delete_text): ditto.

2001-10-17  Matthias Clasen  <matthiasc@poet.de>

	* gtk/gtkdnd.c, gtk/gtkclipboard.c, gdk/x11/gdkmain-x11.c:
	Documentation updates.

Wed Oct 17 15:17:20 2001  Owen Taylor  <otaylor@redhat.com>

	* gtk/gtkentry.c (gtk_entry_real_insert_text): Fix mistake
	in truncating length of text to MAX_SIZE. (Found by 
	Padraig O'Briain, #62055)

Tue Oct 16 17:04:44 2001  Owen Taylor  <otaylor@redhat.com>

	* gtk/gtkwidget.c: Rename ACTIVATE_MNEMONIC enum to
	MNEMONIC_ACTIVATE; signal was changed a long time
	ago.

	* gdk/x11/gdkim-x11.c (_gdk_x11_initialize_locale): 
	Fix wrong return statement. (Reported by HideToshi
	Tajima and others.)

	* gtk/gtklabel.h (struct _GtkLabelClass): Remove
	left over select_all vfunc.

Tue Oct 16 15:50:03 2001  Owen Taylor  <otaylor@redhat.com>

	* gtk/gtkwidget.c (gtk_widget_translate_coordinates): Add
	a utility function to translate coordinates relative to
	one widget's allocation to coordinates relative to another
	widget's allocation.

	* gtk/gtkradiobutton.c: Add a special ->focus() implementation
	that:
	 - only accepts external focus if there is no active
   	   member of the group or the button is active.
	 - makes arrow keys move the active button as well
	   as the focus
	 - make tab tab out directly.
	This makes a radio button group act as a single focus location.
	(#53577).
	
	* gtk/gtkcontainer.c (gtk_container_focus): Remove prefiltering -
	it was only a small optimization that didn't matter and made
	things more complicated.

	* gtk/gtkcontainer.c (gtk_container_focus_tab): Get rid of custom
	sorter for FOCUS_TAB as we did for the other focus directions,
	sort by center of widgets, not upper-left corner. (Shouldn't
	matter in general.)

	* gtk/gtkcontainer.c: Restructure code to remove duplicate code
	from the different types of focusing: encapsulate sorting the
	widgets for the focus direction into one routine
	(gtk_container_focus_sort()) and then share the work of moving the
	focus between the different focus directions.

	* gtk/gtkcontainer.c: Fix bug where arrow navigation might not
	work correctly with focus chains containing non-immediate
	children. Sorting was being done using allocation coordinates for
	each widget in the focus chain, and if there were intermediate
	window-widgets, these allocations would not be in the same
	coordinate system.

Tue Oct 16 15:12:26 2001  Jonathan Blandford  <jrb@redhat.com>

	* gtk/gtkoptionmenu.c (gtk_option_menu_mnemonic_activate): add a
	mnemonic_activate function to option menu.

2001-10-15  Murray Cumming <murrayc@usa.net>

	* gtk/gtkinputdialog.c, gtk/gtktoolbar.c,  gtk/gtkwidget.c:
	  Corrected the type names used in some calls to g_signal_new().
	
Sat Oct 13 07:09:30 2001  Tim Janik  <timj@gtk.org>

	* gtk/gtkbindings.c (gtk_binding_set_add_path): to compare pattern
	specs, use g_pattern_spec_equal() instead of direct field accesses.
	upon compressing two equal paths of the same type, the resulting
	priority has to be the maximum.
	* gtk/gtkenums.h (enum): take GTK_PATH_PRIO_MASK out of the
	GtkPathPriorityType enum and make it a macro.

2001-10-12  Matthias Clasen  <matthiasc@poet.de>

	* gtk/gtkwidget.c: Fix some doc comments.

Fri Oct 12 11:39:20 2001  Joshua N Pritikin  <vishnu@pobox.com>

	* gtk/gtktreeview.c (gtk_tree_view_get_path_at_pos): Fix to work
	on empty models.

2001-10-11  Matthias Clasen  <matthiasc@poet.de>

	* gtk/gtkcolorsel.c, gtk/gtkwidget.c, gtk/gtktreeview.c:
	Remove stale gdk backend includes.
 
2001-10-10  Michael Meeks  <michael@ximian.com>

	* gtk/gtkcombo.c (gtk_combo_class_init): add enable_empty
	and value_in_list properties.
	(gtk_combo_set_value_in_list): notify change.
	(gtk_combo_set_property, gtk_combo_get_property): impl. prop.

2001-10-11  James Henstridge  <james@daa.com.au>

	* configure.in: add AS=CC and ASFLAGS=CFLAGS substitutions so
	that gtk+ can be built with automake 1.5 while not breaking
	things for automake 1.4.

Wed Oct 10 12:48:38 2001  Owen Taylor  <otaylor@redhat.com>

	* gtk/gtkmain.c (gtk_init_check): Call setlocale (LC_ALL, "").
	(#60606)

	* gtk/gtkmain.c (gtk_disable_setlocale): Add function
	to disable calling setlocale (LC_ALL, "").

	* gtk/gtkmain.c (gtk_set_locale): Indicate in the 
	docs that this function is not typically useful.

	* gdk/x11/{gdkim-x11.c,gdkmain-x11.c,gdkprivate-x11.h}: 
	Automatically initialize GDK for the current locale
	on gdk_init(). Don't reset locale to C when
	XSupportsLocale() fails.

	* gdk/linux-fb/gdkim-fb.c (gdk_set_locale): Remove
	useless checks for UTF-8 locale breakage that mattered
	only for X.

	* examples/calendar/calendar.c
	tests/{testgtk.c,testtext.c,testcalendar.c}: Remove calls to 
	gtk_set_locale().

	* gtk/gtkiconfactory.c gtk/gtkitemfactory.c:
	gdk_pixbuf_new_from_stream => gdk_pixbuf_new_from_inline.

Wed Oct 10 21:13:46 2001  Kristian Rietveld  <kristian@planet.nl>

	* gtk/gtktreemodel.[ch]: added gtk_tree_model_get_iter_from_string().

	Fixes bug #61904

Wed Oct 10 01:19:04 2001  Jonathan Blandford  <jrb@redhat.com>

	* gtk/gtktreeselection.c (gtk_tree_selection_iter_is_selected):
	new function, #61923
	(gtk_tree_selection_path_is_selected): Ditto

Tue Oct  9 17:40:24 2001  Jonathan Blandford  <jrb@redhat.com>

	* gtk/gtktreestore.c (gtk_tree_store_finalize): We're a gobject,
	not a GtkObject.  Thanks andersca.

	* gtk/gtkliststore.c (gtk_list_store_finalize): ditto

Tue Oct  9 14:50:51 2001  Jonathan Blandford  <jrb@redhat.com>

	* gtk/gtktreeviewcolumn.c
	(gtk_tree_view_model_sort_column_changed): fix broken code.

2001-10-08  Matthias Clasen  <matthiasc@poet.de>

	* gtk/gtkselection.c: s/succesfully/successfully/g

2001-10-08  Havoc Pennington  <hp@pobox.com>

	* demos/gtk-demo/stock_browser.c: remove unused enum

	* gtk/gtktreeselection.c (gtk_tree_selection_real_select_node):
	pass the current selection state of the node in to the user
	selection func

2001-10-06  Matthias Clasen  <matthiasc@poet.de>

	* gdk/x11/gdkx.h (GDK_CURSOR_XCURSOR): Replace reference to 
	non-existent function gdk_x11_cursor_get_xid 
	by gdk_x11_cursor_get_xcursor.

Fri Oct  5 20:50:00 2001  Jonathan Blandford  <jrb@redhat.com>

	* gtk/gtktreestore.c (gtk_tree_store_iter_has_child): improve
	warning.

	* gtk/gtktreemodel.c (gtk_tree_row_reference_new_proxy): ref and
	unref nodes, #okay61676

	* gtk/gtktreeviewcolumn.c (gtk_tree_view_column_sort): we listen
	to the property; no need to clear the other columns.  Also, we go
	to 'unsorted' if the model supports it.

2001-10-05  Sven Neumann  <sven@gimp.org>

	* demos/testpixbuf-save.c
	* demos/testpixbuf-scale.c: simple tests for the new PNG tEXt chunk 
	feature.

Fri Oct  5 19:06:07 2001  Kristian Rietveld  <kristian@planet.nl>

	* gtk/gtktreeview.c (gtk_tree_view_leave_notify): should
	destroy the search dialog

	* gtk/gtktreeview.c (gtk_tree_view_real_start_interactive_search):
	added check to prevent creation of a search dialog if there's
	already one around

	* gtk/gtktreeview.c: Define GTK_TREE_VIEW_SEARCH_DIALOG_KEY, and use
	it instead of "search-dialog" (when getting/setting the search dialog
	widget).

2001-10-05  Jakub Steiner <jimmac@ximian.com>

	* gtk/stock-icons/stock_broken_image.png: broken images icon

2001-10-04  Havoc Pennington  <hp@pobox.com>

        Fix #56586
	
	* gtk/gtksettings.c (gtk_settings_class_init): move the F10
	accelerator setting here...

	* gtk/gtkmenubar.c (gtk_menu_bar_class_init): ...from over here,
	because we try to use it when a menu bar hasn't necessarily been 
	initialized.

2001-10-03  Havoc Pennington  <hp@redhat.com>

	* tests/testtextbuffer.c (logical_motion_tests): fix test case, 
	it previously verified incorrect behavior

        Fixes for #61565
	
	* gtk/gtktextiter.c (gtk_text_iter_set_line): don't return lines
	off the end
	(_gtk_text_btree_get_iter_at_line_char): don't return lines off
	the end
	(_gtk_text_btree_get_iter_at_line_byte): don't return lines off
	the end
	(gtk_text_iter_forward_lines): if on the last line, move to end of
	it

	* gtk/gtktextbtree.c (_gtk_text_btree_last_could_contain_tag):
	don't return a line off the end

Wed Oct  3 23:47:25  Kristian Rietveld  <kristian@planet.nl>

	* gtk/gtkeditable.[ch]: move insert_text and delete_text virtual
	functions to do_insert_text and do_delete_text, add signals
	insert_text, delete_text and changed

	* gtk/gtkentry.[ch]: remove signals insert_text, delete_text
	and changed. Updates to match new situation.

	* gtk/gtkspinbutton.c: updates to match new situation

	* gtk/gtkoldeditable.h: remove signals changed, insert_text
	and delete_text

	* gtk/gtkoldeditable.c: updates to match new situation

	* gtk/gtktext.c: updates to match new situation

	Fixes bug #59803

2001-10-03  Havoc Pennington  <hp@redhat.com>

	* gtk/gtktextiter.c (test_log_attrs): allow testing the end 
	position

	* gtk/gtktextbuffer.c (compute_log_attrs): update for pango
	changes

	* tests/testtextbuffer.c (logical_motion_tests): updates

2001-10-03  jacob berkman  <jacob@ximian.com>

	* gtk/gtkwidget.c (gtk_widget_style_get_property): 
	* gtk/gtkstyle.c (_gtk_style_peek_property_value): 
	* gtk/gtksettings.c (apply_queued_setting): 
	* gtk/gtkmain.c (gtk_init_check): 
	* gtk/gtkcontainer.c (gtk_container_child_get_property):
	s/retrive/retrieve/

Wed Oct  3 20:29:29 2001  Kristian Rietveld  <kristian@planet.nl>

	* gtk/gtktreemodelsort.[ch]: preparation for surgery
	* tests/testtreesort.c: ditto

2001-10-02  Havoc Pennington  <hp@redhat.com>

        Throughout: assorted docs
	
	* gdk/gdkwindow.h: deprecate gdk_window_set_hints(), it's broken,
	gdk_window_set_geometry_hints() should be used instead.

	* gdk/gdkimage.h: deprecate gdk_image_ref, gdk_image_unref, and
	document them

	* gdk/x11/gdkx.h: remove gdk_get_client_window() since it doesn't
	seem to exist in any .c files

	* gdk/x11/gdkcolor-x11.c (gdk_colormap_query_color): docs, 
	g_return_if_fail (pixel < colormap->size).

Wed Oct  3 10:42:54 2001  Owen Taylor  <otaylor@redhat.com>

	* gtk/gtkdnd.c (gtk_drag_dest_find_target): Allow
	NULL for @target_list to mean, use
	gtk_drag_dest_get_target_list (widget).

	* gtk/gtkdnd.c (gtk_drag_finish): Fix problem where
	drop could hang when calling gtk_drag_finish with 
	success == FALSE and del == TRUE.

	* gtk/gtkdnd.c (gtk_drag_dest_drop): Fix problem where
	drops without a matching target found would propagate
	to the parent widget rather than being rejected.

	* gtk/gtktextview.c (gtk_text_view_drag_data_received): 
	Use text_view->dnd_mark instead of mark name to be
	consistent with the rest of the code.

	* gtk/gtktextview.c (gtk_text_view_drag_motion): Make
	pendantically correct for a drop-only-in-some-places
	widget. (Check whether you can insert in drag_drop,
	not just in drag_motion ... matters in theory, and
	for Motif drag and drop in practice.)

	* gtk/gtkentry.c (gtk_entry_drag_drop): Patch from 
	Damian Ivereigh to not allow drops on non-editable
	entries. (#61124)

	* gtk/gtkentry.c (gtk_entry_motion_notify): Don't allow
	text to be moved from a non-editable entry.
	
2001-10-03  James Henstridge  <james@daa.com.au>

	* gtk/gtktreeviewcolumn.c (gtk_tree_view_column_set_fixed_width):
	s/width/fixed_width/ in order to get things to compile.

Wed Oct  3 00:37:09 2001  Jonathan Blandford  <jrb@redhat.com>

	* gtk/gtkcelleditable.c: docs

	* gtk/gtktreemodel.h: more docs.

2001-10-02  Havoc Pennington  <hp@redhat.com>

	* gdk/x11/gdkwindow-x11.c: docs

	* tests/testtextbuffer.c (logical_motion_tests): add sentence
	boundary tests

Tue Oct  2 20:18:32 2001  Kristian Rietveld  <kristian@planet.nl>

	* demos/gtk-demo/Makefile.am: add editable_cells.c,
	list_store.c and tree_store.c

	* demos/gtk-demo/appwindow.c: remove tearoff item from
	File menu, put menubar and toolbar in handle boxes.

	* demos/gtk-demo/genincude.pl: various changes to support trees

	* demos/gtk-demo/main.c: various changes to support trees

	* demos/gtk-demo/stock_browser.c: changed name of demo
	to Stock Item and Icon Browser, so geninclude.pl doesn't see
	it as child

	* demos/gtk-demo/editable_cells.c: new file/demo
	* demos/gtk-demo/list_store.c: new file/demo
	* demos/gtk-demo/tree_store.c: new file/demo

Mon Oct  1 16:05:44 2001  Owen Taylor  <otaylor@redhat.com>

	* gtk/gtkrc.c gtk/gtksettings.c: 
	g_string_printfa => g_string_append_printf.

Mon Oct  1 16:08:23 2001  Jonathan Blandford  <jrb@redhat.com>

	* gtk/gtkliststore.c (gtk_list_store_class_init): add a finalize
	and destroy handler.

	* gtk/gtktreestore.c (gtk_list_store_class_init): ditto, #59963

	* gtk/gtktreeview.h (struct _GtkTreeViewClass): Add
	'start_editing' flag to select_cursor_row.  Bug spotted by Manish
	Singh <yosh@gimp.org>.

2001-10-01  Matthias Clasen  <matthiasc@poet.de>

	* gtk/gtkitemfactory.c (gtk_item_factory_parse_rc_scanner): replace
	g_scanner_add/remove_symbol by g_scanner_scope_add/remove_symbol.

	* gtk/gtkrc.c (gtk_rc_parse_any): here as well.

Mon Oct  1 14:07:02 2001  Jonathan Blandford  <jrb@redhat.com>

	* gtk/gtktreeview.c (gtk_tree_view_size_allocate): change
	scroll_to_cell delayed code to happen in size_allocate.

	* gtk/gtkstyle.c (gtk_default_draw_expander): change
	prelight/normal arrow drawing.

	* gtk/gtktreedatalist.c: Change compare func to use g_utf8_collate

	* gtk/gtktreestore.c: refactor.

Sun Sep 30 22:15:52 2001  Manish Singh  <yosh@gimp.org>

	* gtk/gtkcheckbutton.c (gtk_check_button_size_allocate): Applied
	patch from Soeren Sandmann <sandmann@daimi.au.dk>. Vertically
	centers the child in relation to the to indicator height.

Sun Sep 30 15:11:59 2001  Jonathan Blandford  <jrb@redhat.com>

	* gtk/gtktreestore.c (gtk_tree_store_remove): Make ITERS_PERSIST
	correct

Sun Sep 30  07:01:42 2001 CEST <mikeh@bahnhof.se>

	* gtk/gtkcellrenderertext.c: I reverted back to old "weight"
	property code using g_param_spec_int and changed from
	g_value_get_enum to g_value_get_int instead. Probably a better way
	to fix the problem :-)

Sun Sep 30  05:31:32 2001 CEST Mikael Hermansson <tyan@linux.se>

    * gtk/gtkcellrenderertext.c changed "weight" property type from 
      g_param_spec_int to g_param_spec_enum.

Sat Sep 29 12:25:26 2001  Manish Singh  <yosh@gimp.org>

	* gtk/gtktreeviewcolumn.c (gtk_tree_view_column_class_init): typo
	fix: s/Wether/Whether/ in reorderable property description

Thu Sep 27 16:46:36 2001  Jonathan Blandford  <jrb@redhat.com>

	* gtk/gtktreeview.c (gtk_tree_view_real_select_cursor_row): only
	start editing when you select with a keyboard.

	(gtk_tree_view_button_press_event): much more graceful now.

	* gtk/gtkstyle.c: Draw togglebutton better.

2001-09-26  Havoc Pennington  <hp@redhat.com>

	* demos/gtk-demo/dialog.c (interactive_dialog_clicked): add demo
	of passing non-stock label in to gtk_dialog_new_with_buttons

	* gtk/gtktextview.c (cursor_blinks): disable cursor blink when
	debugging updates

	* gtk/gtktextiter.h: comment about how GtkTextIter struct contents
	are private

	* gtk/gtkbutton.c (gtk_button_new_from_stock): if stock ID doesn't
	exist, fall back to mnemonic label, not plain label, bug #61184
	
Wed Sep 26 19:48:01 2001  Jonathan Blandford  <jrb@redhat.com>

	* gtk/gtktreestore.c (gtk_tree_store_set_valist): Stop being
	stupid and emitting the signal every time.

	* gtk/gtkliststore.c (gtk_list_store_set_valist): ditto

Wed Sep 26 16:35:59 2001  Owen Taylor  <otaylor@redhat.com>

       Patch from Mark McLoughlin <mark@skynet.ie> (#61233)

       * contrib/gdk-pixbuf-xlib/Makefile.am: install
       gdk-pixbuf-xlib-2.0.pc.

Wed Sep 26 16:15:25 2001  Owen Taylor  <otaylor@redhat.com>

	* gtk/gtknotebook.c (gtk_notebook_set_tab_label): Fix
	problem where menmonic wasn't removed properly when
	setting a label when there already is a label.
	Also, handle setting the tab label back to the same
	value. (#61160, #61161)

	* gtk/gtkentry.c (paste_received): Patch from 
        Damian Ivereigh to replace selection if there is 
	one. (#61121)

2001-09-25  Darin Adler  <darin@bentspoon.com>

	* tests/.cvsignore: Ignore new test program.

2001-09-25  Havoc Pennington  <hp@redhat.com>

	* gtk/gtktextview.c: fix for #50317
	
2001-09-25  Havoc Pennington  <hp@redhat.com>

	* gtk/gtktextview.c (gtk_text_view_key_press_event): use 
	gtk_text_iter_can_insert
	
	* gtk/gtktextbuffer.c: use gtk_text_iter_can_insert

	* gtk/gtktextiter.c (find_line_log_attrs): fixes, #57611, #57613
	 (gtk_text_iter_can_insert): new function to fix #60282, should
	also fix msw's "can paste into empty buffer" bug.

	* gtk/gtktexttag.c (gtk_text_tag_event): change type check for 
	"event object,"  #59091

	* gtk/gtktextbtree.c: indentation fixes

	* gtk/gtktextiter.c (find_by_log_attrs): fixes

Tue Sep 25 12:41:17 2001  Owen Taylor  <otaylor@redhat.com>

	* configure.in: Version 1.3.9, interface age 0, binary age 0.

	* configure.in: Require GLib-1.39, Pango 0.20, Atk 0.5.

	* NEWS: Updates.

Mon Sep 24 11:59:09 2001  Owen Taylor  <otaylor@redhat.com>

	* gtk/gtkstyle.[ch] (_gtk_draw_insertion_cursor): Shared
	function for drawing cursors between gtkentry/gtklabel/gtktextview.
	Should this be public? It has a bit of an odd interface, but
	custom editing widgets probably should be using it.
	Function will draw with wider width for taller cursors, and
	draws a little indicator arrow to indicate directoin for split 
	cursors.

	* gtk/gtktextview.c: Add a "cursor_color" property.

	* gtk/gtktextdisplay.[ch]: Add a cursor_gc parameter to
	gtk_text_layout_draw().

	* gtk/gtkentry.c gtk/gtklabel.c gtk/gtktextdisplay.c: Use
	_gtk_draw_insertion_cursor().

Tue Sep 25 11:22:23 2001  Owen Taylor  <otaylor@redhat.com>

	* gtk/gtkcellrenderertext.c gtk/gtktexttag.c: Restore
	the behavior where you could turn family_set (etc) back on
	and get back the values you had before.

	* demos/gtk-demo/stock_browser.c (id_to_macro): Use
	g_string_ascii_up() rather than looping through the
	string ourself.

Tue Sep 25 15:32:44 2001  Jonathan Blandford  <jrb@redhat.com>

	* gtk/gtktreeviewcolumn.c
	(gtk_tree_view_column_set_cell_renderer): Removed
	(gtk_tree_view_column_set_alignment): xalign = CLAMP (xalign, 0.0, 1.0);  Fixes 61012.

	* gtk/gtktreestore.c (gtk_tree_store_sort_helper): Fixed #61012
	Patch from Detlef Reichl

2001-09-25  Havoc Pennington  <hp@redhat.com>

	* tests/testtextbuffer.c (line_separator_tests): Add tests for
	line separators, addresses bug #57428

Tue Sep 25 12:34:42 2001  Jonathan Blandford  <jrb@redhat.com>

	* gtk/gtkentry.c: Make a GtkCellEditable
	(get_widget_window_size): Change to let it honor size_allocate
	when a CellEditable.

	* gtk/gtktreeview.c: M-x clean-line-ends.  Lots of focus and
	editable changes.
	(gtk_tree_view_set_cursor): Now you can set the cursor
	horizontally, as well as start editing.

	* gtk/gtkstyle.c (gtk_default_draw_check): changing toggle drawing
	code to look more like the other check buttons.

	* gtk/gtkcellrenderertoggle.c (gtk_cell_renderer_toggle_get_size):
	Change the way we calculate cell size.

	* gtk/gtkmarshal.list (VOID:STRING,STRING): new marshaller.

	* demos/gtk-demo/sizegroup.c: Add mnemonics.

	* gtk/gtkcellrenderer.c (gtk_cell_renderer_get_size): Fix docs.
	Fix logic.

	* gtk/gtkcellrenderertext.c: Change to be editable.

	* gtk/gtkcellrenderertoggle.c: Change to be activatable.

	* test/testtreesort.c: Fix misspelling

	* test/testreecolumns.c: Add mnemonics.

	* test/testreeedit.c: New test program.

2001-09-25  Havoc Pennington  <hp@pobox.com>

	* gtk/gtkwindow.c: Put notes in gtk_window_set_has_frame(),
	etc. docs about how these are not going to do what you want for 
	the X/win32 ports. Futile attempt to avoid a FAQ...

2001-09-24  James Henstridge  <james@daa.com.au>

	* gtk/gtkmarshal.list (VOID): add marshal function types.

	* gtk/gtkctree.c (gtk_ctree_class_init): make arguments have type
	GTK_TYPE_CTREE_NODE|G_SIGNAL_TYPE_STATIC_SCOPE rather than
	GTK_TYPE_POINTER.
	(gtk_ctree_node_get_type): implement boxed type for GtkCTreeNodes
	with no-op copy/free functions.

	* gtk/gtkctree.h (gtk_ctree_node_get_type): add prototype for
	GtkCTreeNode get_type function.

2001-09-24  Havoc Pennington  <hp@redhat.com>

	* gtk/gtktextiter.c, gtk/gtktextbuffer.c, gtk/gtktextbtree.c,
	gtktextlayout.c:
	Get rid of the newline-that-could-not-be-deleted; buffers may 
	now be zero-length. Much easier to fix than expected, once 
	I figured out the right way to do it. However, there are 
	various subtle bugs introduced by this that will have to get 
	sorted out. Please use bugzilla.

Mon Sep 24 15:09:08 2001  Owen Taylor  <otaylor@redhat.com>

	* gtk/gtkwindow.c (gtk_window_move_resize): Don't wait for a
	response back from the window manager if our size hasn't changed 
	since we won't get a response back from the window manager;
	there was code in there to do this, but it was in the wrong
	place so if the hints change and the size didn't we'd expect
	a response.

	Also, optimize the position-only-changed case by running
	the resize queue immediately, and clean up some comments
	for the changes.

Mon Sep 24 12:48:25 2001  Owen Taylor  <otaylor@redhat.com>

	* gtk/gtknotebook.h: Add a compat macro that got lost.

	* gtk/gtktreestore.c: Doc fixes.

	* gdk/x11/gdkevents-x11.c (gdk_event_translate): Fix reference
	leak for windows that receive events after being destroyed.
	(#60863, Joshua N. Pritikin)

	* gtk/gtktable.c (gtk_table_remove): Use gtk_widget_queue_resize
	rather than gtk_container_queue_resize().

	* gtk/{gtkcontainer.c,gtkwidget.c,gtkwindow.c}: _gtk prefix
	gtk_container_queue_resize, gtk_container_queue_resize_widgets,
	gtk_container_child_composite_name. (#60217.)

2001-09-22  Hans Breuer  <hans@breuer.org>

	* gtk/gtkmenu.h : fix compat macros for gtk_menu_<prepend|insert>

Sat Sep 22 16:50:34 2001  Kristian Rietveld  <kristian@planet.nl>

	* gtk/gtktexttag.c (gtk_text_tag_set_property): (case PROP_WEIGHT):
	weight value should be an int

Sat Sep 22 15:17:41 2001  Kristian Rietveld  <kristian@planet.nl>

	* gtk/gtkmenu.c (gtk_menu_select_item): move most code
	to gtk_menu_scroll_item_visible(). Only call
	gtk_menu_scroll_item_visible() if the menu widget has been
	realized. Fixes bug #55310.

2001-09-21  Havoc Pennington  <hp@redhat.com>

	* gtk/gtktextview.c (gtk_text_view_key_press_event): don't pass
	key press to IM context if cursor isn't in an editable location;
	bug #58425, patch from Hidetoshi Tajima

2001-09-21  Havoc Pennington  <hp@redhat.com>

        Bug #60862
	
	* gtk/gtktextbtree.c (gtk_text_btree_node_destroy): 
	(_gtk_text_btree_unref): fix up mark memory management

	* gtk/gtktextmark.c (mark_segment_delete_func): ditto

2001-09-20  Havoc Pennington  <hp@redhat.com>

	* gtk/gtktextlayout.c (gtk_text_layout_get_line_display): don't
	try to handle alignment here, because it's done by PangoLayout
	after we set the layout width. Fix from Dov.

2001-09-21  Hans Breuer  <hans@breuer.org>

	* gdk/gdk.def :
	* gtk/gtk.def : updated externals

	* gtk/gtkmain.h : define get_gtk_win32_directoty () 
	* gtk/gtkmain.c (find_module) : don't use module_name after freeing it.
	Also handle that Win32 pathes cann't be hard-coded	

	* gtk/gtkrc.c : use get_gtk_win32_directoty () to cleanup the various
	module, themes etc directory calculations

	* gdk/win32/gdkgeometry-win32.c : some more hacking to get coordinates
	>16 bit right. The size limit within Win9x appears _not_ to be 32767
	but slightly smaller ...

	* gdk/win32/gdkwindow-win32.c : use impl->position_info to avoid 
	>16 bit clipping. Added dummy body for gdk_window_set_icon_list ()

	* gdk/win32/gdkdrawable-win32.c : implement gdk_win32_drawable_get_handle ()

	* gdk/win32/gdkevents-win32.c : some tweaking to get better expose
	handling. I'm not sure if it is better now, but at least not worse

	* gdk/win32/makefile.msc : define INSIDE_GDK_WIN32, some cleanup

	* gdk/win32/gdkwin32.h : reflect recent API restrictions

2001-09-21  Matt Wilson  <msw@redhat.com>

	* gtk/gtkradiomenuitem.c (gtk_radio_menu_item_destroy): set
	radio_menu_item->group to NULL after removing it from the list, as
	it is no longer in the group. (#60869)

	* gtk/gtkradiobutton.c (gtk_radio_button_destroy): likewise

2001-09-20  Havoc Pennington  <hp@pobox.com>

	* configure.in (PANGO_REQUIRED_VERSION)
	(ATK_REQUIRED_VERSION): add variables and checks for specific 
	versions of dependencies. Previously we didn't verify the 
	Pango or ATk versions.

2001-09-09  Havoc Pennington  <hp@pobox.com>

	* gtk/gtktextiter.c: fool with indentation
	(gtk_text_iter_in_range): add g_return_if_fail

Thu Sep 20 17:45:54 2001  Joshua N Pritikin  <vishnu@pobox.com>

	* gtk/gtktextbuffer.c (gtk_text_buffer_create_tag): Fix
	ref count on new tag to be 1.  Update doc.  (#60836)

Thu Sep 20 16:20:47 2001  Owen Taylor  <otaylor@redhat.com>

	* gdk/gdkrgb.c (gdk_rgb_allocate_images): Remove unnecessary
	call to gdk_image_new_bitmap(). (#59094, reported by
	by Sven Neumann)

Thu Sep 20 15:31:35 2001  Owen Taylor  <otaylor@redhat.com>

	* gtk/gtkcalendar.c (gtk_calendar_init): Use the current
	day, as well as the current month and year.
	(#59047, reported by Vitaly Tishkov)

Thu Sep 20 15:10:30 2001  Owen Taylor  <otaylor@redhat.com>

	* gtk/gtkdialog.c (gtk_dialog_init): Automatically set
	set dialogs to GTK_WIN_POS_CENTER_ON_PARENT. (#60554)
	
Thu Sep 20 18:00:56 2001  Kristian Rietveld  <kristian@planet.nl>

	* tests/testgtk.c (struct OptionMenuItem): get rid of it,

	(build_option_menu): add func argument, connect ::changed
	signal to option menu instead of connecting the ::activate
	signal to the menu items,

	(toplevel): get rid of RADIOMENUTOGGLED macro,

	(list_toggle_sel_mode), (clist_toggle_sel_mode),
	(ctree_toggle_line_style), (ctree_toggle_expander_style),
	(ctree_toggle_justify), (ctree_toggle_sel_mode),
	(progressbar_toggle_orientation), (progressbar_toggle_bar_style):
	use gtk_option_menu_get_history() instead of RADIOMENUTOGGLED,

	(notebook_type_changed): merged standard_notebook(),
	notabs_notebook(), scrollable_notebook() and borderless_notebook()
	into notebook_type_changed()

	(create_list), (create_ctree), (create_notebook),
	(create_progress_bar): changed OptionMenuItem arrays into
	gchar * arrays. Removed "Extended" item where used.

	Fixes bug #59885

2001-09-20  Sven Neumann  <sven@gimp.org>

	* configure.in
	* gdk/Makefile.am
	* gtk/Makefile.am
	* gtk/gtkselection.c
	* gtk/gtktreeview.c
	* gtk/gtkwindow.c: removed remaining traces of nanox GDK backend.

Thu Sep 20 11:19:42 2001  Owen Taylor  <otaylor@redhat.com>

	* gdk/gdkpango.c (gdk_pango_layout_line_get_clip_region): Add
	a missing pango_layout_iter_free ().

Thu Sep 20 11:03:51 2001  Owen Taylor  <otaylor@redhat.com>

	* gtk/gtkobject.c gtk/gtklist.c gtk/gtkplug.c gtk/gtksocket.c
	gtk/gtktreemodelsort.c gtk/gtktreeview.c: Small warning cleanups.

	* gtk/gtkradiomenuitem.c (gtk_radio_menu_item_get_group): Change
	the function definition so we don't accidentally rely on
	the compat #define from gtk_radio_menu_item_group.
	(#60782, Jeff Franks)

Thu Sep 20 16:51:02 2001  Kristian Rietveld  <kristian@planet.nl>

        * gtk/gtkwindow.c (gtk_window_get_frame_dimensions): returned
        incorrect values for top, right and bottom due to cut-and-paste
        bug. Pointed out by Vitaly Tishkov, fixes bug #59008

Wed Sep 19 17:59:27 2001  Owen Taylor  <otaylor@redhat.com>

	* gdk/x11/gdkwindow-x11.c (gdk_window_new): Set
	_NET_WM_PID and WM_CLIENT_MACHINE properties on each
	window, not just on the client leader. (#58463)

Wed Sep 19 17:28:47 2001  Owen Taylor  <otaylor@redhat.com>

	* gtk/gtkwidget.c (gtk_widget_new): Add missing cast.

	* gtk/gtkmenuitem.[ch] gtk/gtkmenushell.c: Underscore prefix
	non-public _gtk_menu_item_set_placement.

	* gtk/gtktooltips.h: Deprecate gtk_tooltips_set_delay().

Wed Sep 19 16:16:38 2001  Owen Taylor  <otaylor@redhat.com>

	* gdk/win32/gdkcolor-win32.c gdk/x11/gdkcolor-x11.c 
	  gdk/linux-fb/gdkcolor-fb.c:
	Fix propagated (flags && GDK_COLOR_WRITEABLE) typo.
	(#59723)

Wed Sep 19 16:12:16 2001  Owen Taylor  <otaylor@redhat.com>

	* gdk/gdkpixbuf-render.c: Allow -1 for width/height
	to mean "width/height of pixbuf" (Patch from Matthias Clasen,
	#59723)

Wed Sep 19 16:01:27 2001  Owen Taylor  <otaylor@redhat.com>

	Patch from Frank Belew #59037 for Solaris compilation.

	* gtk/maketypes.awk: Change syntax slightly for a call
	to sub(), apparently making awk on Solaris happier.

	* gtk/gtktreeview.c: Remove C++ comments.

Wed Sep 19 15:46:29 2001  Owen Taylor  <otaylor@redhat.com>

	* gtk/gtkwindow.c: Add xgettext:no-c-format comment to
	to handle '99% of the time. (#60473, reported by Christian Rose)

	* gtk/gtkwidget.h: Remove prototype for gtk_widget_get_usize()
	which no longer exists. (#60379, reported by Vitaly Tishkov)

Wed Sep 19 11:06:24 2001  Tim Janik  <timj@gtk.org>

	* Released 1.3.8.

	* gdk/Makefile.am: kill EXTRA_DIST clearing.
	
Wed Sep 19 02:50:40 2001  Tim Janik  <timj@gtk.org>

	* demos/Makefile.am ($(testpixbuf_OBJECTS)): don't use BUILT_SOURCES
	as its broken in automake 1.4, add explicit object rule to
	generate this.
	
	* gdk-pixbuf/Makefile.am: fix maintainer and normal cleanfiles.
	get rid of uneccessary stamps, group stuff more logically, and build
	sources due to object rules. fix srcdir!=builddir.

Tue Sep 18 20:47:16 2001  Owen Taylor  <otaylor@redhat.com>

	* gtk/gtkspinbutton.c (gtk_spin_button_size_request): Fix 
	incorrect parameter to compute_double_length
	(#58680, patch from Matthias Clasen)

	Fixes for compilation with Forte cc. (#59734, Derek Rafter)

	* gtk/gtkwindow.h gtk/gtksizegroup.h: Remove extra ;.

	* gdk/gdktypes.h (GdkModifierType): Write 1u << 31
	for GDK_RELEASE_MASK to avoid warnings with Forte.

	* gtk/gtktexttag.c gtk/gtkcellrendertext.c: Add some missing
	break; statements.

2001-09-18  Alex Larsson  <alexl@redhat.com>

        * gtk/gtkcheckbutton.c:
	* gtk/gtkradiobutton.c:
	Don't draw with GTK_STATE_ACTIVE.

	* gtk/gtkclist.c:
	* gtk/gtkctree.c:
	Draw lines between rows with base_gc[GTK_STATE_NORMAL].

	* gtk/gtktextdisplay.c:
	Focused selection is drawn with base_gc [GTK_STATE_SELECTED] and
	unfocused with base_gc [GTK_STATE_ACTIVE].
	
	* gtk/gtkentry.c:
	Add select all menu-item.
	Default cursor color is red.
	Focused selection is drawn with base_gc [GTK_STATE_SELECTED] and
	unfocused with base_gc [GTK_STATE_ACTIVE].

	* gtk/gtklabel.[ch]:
	Add keynav + menu to selectable lables.
	Focused selection is drawn with base_gc [GTK_STATE_SELECTED] and
	unfocused with base_gc [GTK_STATE_ACTIVE].

	* gtk/gtkfilesel.c:
	Add drag and drop support.

	* gtk/gtkstyle.c:
	(This was checked in earlier)
	New default values for text/base SELECTED and ACTIVE
	
Tue Sep 18 23:51:49 2001  Tim Janik  <timj@gtk.org>

	* configure.in: up version to 1.3.8, interface age 0,
	binary age 0, depend on glib 1.3.8.

	* NEWS: 1.3.8 updates.

Tue Sep 18 18:46:54 2001  Jonathan Blandford  <jrb@redhat.com>

	* gtk/gtktreeview.c (gtk_tree_view_start_editing): centralize all
	the editing code

	* gtk/gtkcelleditable.c: Got rid of stop_editing, as there was no
	reason to call it beyond emiting the two signals.

	* gtk/gtkentry.c (gtk_entry_class_init): add "has_frame" property
	to GtkEntry.

Wed Sep 12 11:21:14 2001  Owen Taylor  <otaylor@redhat.com>

	* gtk/gtkcellrenderertext.[ch] gtk/gtktexttag.[ch]
	  gtk/gtktextview.c tests/testgtk.c: Fix up for changes to 
	PangoFontDescription.

	* gtk/gtkentry.c gtk/gtkclist.c gtk/gtkcellrenderertext.c
	gtk/gtkspinbutton.c: Fix up for change to PangoMetrics
	structure.
  
	* gtk/gtkfontsel.c: Fix up for new Pango font listing API.

	* gtk/gtkstyle.[ch]: Add gtk_style_get_font/set_font to replace
  	direct access to style->font. Deprecate gtk_style_ref/unref.
  
 	* gtk/gtkclist.c gtk/gtkctree.c gtk/gtkstyle.c gtk/gtkwidget.c:
  	Remove gtk_style_ref/unref with g_object_ref/unref.
  
  	* gtk/gtkcalendar.c: Remove leftover macros accessing
  	style->font.
  
  	* gtk/gtkhruler.c (gtk_hruler_draw_ticks): Remove unused
  	variable.
  
  	* gtk/gtktext.c gtk/gtklabel.c: Use gtk_style_get_font() instead of 
	style->font.

Tue Sep 18 13:51:35 2001  Jonathan Blandford  <jrb@redhat.com>

	* gtk/gtkcellrenderer.h (enum): Get rid of broken "can_edit" and
	"can_activate" properties in favor of
	GTK_CELL_RENDERER_MODE_INERT, GTK_CELL_RENDERER_MODE_ACTIVATABLE,
	and GTK_CELL_RENDERER_MODE_EDITABLE

Tue Sep 18 12:12:43 2001  Jonathan Blandford  <jrb@redhat.com>

	* gtk/gtktreeview.c (gtk_tree_view_put): Add put for use with
	editable widgets.  This function is private, and should only be
	used by GtkTreeView.

2001-09-18  Matt Wilson  <msw@redhat.com>

	* docs/Makefile.am (EXTRA_DIST): don't use += before =

	* docs/faq/Makefile.am (EXTRA_DIST): likewise

	* docs/tutorial/Makefile.am (EXTRA_DIST): likewise
	
	* gdk/Makefile.am (MAINTAINERCLEANFILES): likewise
	(EXTRA_HEADERS): likewise

	* gtk/Makefile.am (MAINTAINERCLEANFILES): likewise
	(EXTRA_HEADERS): likewise
	(EXTRA_DIST): likewise
	(CLEANFILES): likewise

	* gtk/stock-icons/Makefile.am (CLEANFILES): likewise

	* tests/Makefile.am (EXTRA_DIST): likewise
	
	* Makefile.am (install-data-local): changed to use
	install-data-hook, which runs after install-pkgconfigDATA, so that
	the pkgconfigdir will have been created and populated first.

Mon Sep 17 17:39:52 2001  Jonathan Blandford  <jrb@redhat.com>

	* gtk/gtkcelleditable.[ch]: Add editable interface.  This should
	be the last big GtkTreeView API change.

	* gtk/gtkcellrenderer.[ch]: Get rid of the "event" vfunc, and
	replace with "activate" and "start_editing".  Also, added a
	"can_activate" and "can_edit" property.

	* gtk/gtktreeviewcolumn.c: modify to use above.

2001-09-16  Alexander Larsson  <alla@lysator.liu.se>

	* gtk/gtkoptionmenu.c:	Handle scroll wheel events.

Fri Sep 14 22:31:25 2001  Matthias Clasen  <matthiasc@poet.de>

	* demos/gtk-demo/main.c (setup_default_icon): Use a shaped
	icon instead of one with ugly white background.

Fri Sep 14 22:26:01 2001  Matthias Clasen  <matthiasc@poet.de>

	* demos/gtk-demo/stock_browser.c (id_to_macro): make
	the uppercasing work. (#59550)

2001-09-14  Jakub Steiner <jimmac@ximian.com>

	* gtk/stock-icons/dialog_error.png:
	* gtk/stock-icons/dialog_question.png: more road signs

2001-09-13  Jakub Steiner <jimmac@ximian.com>

	* gtk/stock-icons/dialog_question.png:
	* gtk/stock-icons/dialog_warning.png: anders and jonathan seem to
	  like a road sign.

Wed Sep 12 19:01:05 2001  Jonathan Blandford  <jrb@redhat.com>

	* gtk/gtktreemodel.h (struct _GtkTreeModelIface): Rename interface
	signals to make them more clear.  Also, change ::range_changed to
	::row_changed.
	* gtk/gtktreemodel.c: Adjust to interface change
	* gtk/gtktreemodel.h: ditto
	* gtk/gtktreemodelsort.c: ditto
	* gtk/gtktreestore.c: ditto
	* gtk/gtkliststore.c: ditto
	* gtk/gtktreeview.c: ditto
	* tests/testtreecolumns.c: ditto
	* gtk/gtkmarshal.list: Actually remove a marshaller!

2001-09-12  Padraig O'Briain <padraig.obriain@sun.com>

	* gtk/gtktextview.c
	Add support for Ctrl+Up/Down arrow to move cursor to beginning
	of previous/next paragraph. If within a paragraph cursor moves to
	beginning of that paragraph.

2001-09-12  Jakub Steiner <jimmac@ximian.com>

	* gtk/stock-icons/dialog_question.png: replacing the shaky
	  question mark with a sans-serif one.
	* gtk/stock-icons/stock_top.png, stock_bottom.png,
     stock_first.png, stock_last.png: using the new style arrows
	* gtk/stock-icons/stock_font.png: simple one to replace the ugly
     colors.
	* gtk/stock-icons/stock_refresh.png: anti-aliased and changed
     color.
	* gtk/stock-icons/stock_zoom*: anti-aliased
	* gtk/stock-icons/dialog_error.png, dialog_warning.png: confused
     '-' with a '_', removed the wrong files

Sat Sep  8 16:19:02 2001  Owen Taylor  <otaylor@redhat.com>
 
 	* gtk/gtkmain.c: Implement a search path for GTK+ modules.
 
 	* configure.in gtk/gtkrc.c gtk/Makefile.am: Look for modules
 	in gtk-2.0/<type>/major.minor.(micro-binary_age) rather
 	than in gtk-2.0/major.minor.micro/<type>/. This
 	works better for a search path for modules.
 
 	* gtk+-2.0.pc.in gtk+-2.0-uninstalled.pc.in: Add
 	gtk_binary_version variable holding major.minor.(micro-binary_age).
 
 	* modules/input/Makefile.am (moduledir): Fix installation
 	directory to match change in lookup location.
 
 	* gtk/gtkmain.c (gtk_init_check): Remove OS/2 code for dll 
 	suffixes. Needs to be handled in g_module_build_path().

	* gtk/gtkrc.c gtk/queryimmodules.c: Use g_build_filename() where
	appropriate.
 
Tue Sep 11 13:59:12 2001  Owen Taylor  <otaylor@redhat.com>

	* gtk/gtkrc.c (insert_rc_property): Fixed reversed comparison
	causing RC properties not to work.

2001-09-11  Jakub Steiner <jimmac@ximian.com>

	* gtk/stock-icons/dialog-error.png: less drastic
	* gtk/stock-icons/dialog-warning.png: no body parts. (I hope
	  "STOP" is international enough.
	* gtk/stock-icons/stock_dnd*.png: get rid of the cursor
	* gtk/stock-icons/stock_menu_properties.png: 16x16 version

Mon Sep 10 21:26:24 2001  Joshua N Pritikin  <vishnu@pobox.com>

	* gtk/gtktextview.c (gtk_text_view_set_buffer): Make
	(add|remove)_selection_clipboard symmetric. (bug #59836)

	* gtk/gtktreeview.c (gtk_tree_view_unref_and_check_selection_tree): 
	Avoid SEGV for empty tree. (bug #60243)

Mon Sep 10 20:47:22 2001  Tim Janik  <timj@gtk.org>

	* tests/testgtk.c (create_idle_test): slight fix for
	g_object_set() not usable for nesting anymore.

	* gtk/gtkhandlebox.c (gtk_handle_box_class_init): 
	* gtk/gtkframe.c (gtk_frame_class_init): deprecate ::shadow
	properties, supply ::shadow_type properties instead as most
	other widgets do.

2001-09-10  Alex Larsson  <alexl@redhat.com>

	* demos/gtk-demo/stock_browser.c:
	* gdk/gdkcolor.c:
	* gdk/gdkfont.c:
	* gdk/gdkcursor.c:
	* gdk/gdkevents.c:
	* gdk/gdkrectangle.c:
	* gtk/gtktypeutils.c:
	Update to use the new g_boxed_type_register_static API.

2001-09-10  Padraig O'Briain <padraig.obriain@sun.com>

	* gtk/gtktreestore.c:
	Fix looping in gtk_tree_store_init() waiting for zero random int.

Mon Sep 10 16:55:49 2001  Tim Janik  <timj@gtk.org>

	* gtk/gtkalignment.c (gtk_alignment_init): fix xscale and yscale
	behaviour which havoc broke. they have to default to 1.0 for
	expand behaviour.

	* gtk/gtkwindow.c (gtk_window_get_property): don't cast NULL objects.

2001-09-10  Padraig O'Briain <padraig.obriain@sun.com>

	* gtk/gtkstyle.c (_gtk_style_peek_property_value)
	Amend previous change to avoid runtime error in g_param_spec_ref()

Mon Sep 10 06:58:56 2001  Owen Taylor  <otaylor@redhat.com>

	* gtk/gtkrc.c (insert_rc_property): Fix blank line
	in the wrong place.

Mon Sep 10 06:50:39 2001  Owen Taylor  <otaylor@redhat.com>

	* gtk/gtkstyle.c (_gtk_style_peek_property_value): Don't
	do a lookup immediately after creating style->property_cache,
	since bsearch crashes on zero length for Solaris.
	(Found by Padraig O'Briain.)

2001-09-09  Alexander Larsson  <alla@lysator.liu.se>

	* gtk/gtkwidget.c (_gtk_widget_peek_colormap):
	Really return NULL if not set.
	(gtk_widget_init): Remove unused varaible.
	
2001-09-09  Alexander Larsson  <alla@lysator.liu.se>

	* configure.in:
	Remove gdk/nanox/Makefile from AC_OUTPUT(), since it is no longer
	in cvs.

2001-09-08  Havoc Pennington  <hp@pobox.com>

	* gtk/gtkaccelgroup.c: add docs to functions that I can imagine 
	people might want to use

2001-09-08  Havoc Pennington  <hp@pobox.com>

	* gtk/gtkalignment.c (gtk_alignment_class_init): default
	xscale/yscale to 0.0, not 0.5, 0.5 isn't useful

	* tests/testtextbuffer.c: fix usage of gtk_text_iter_spew

	* gtk/gtktextiter.c: fix docs
	(gtk_text_iter_spew): get rid of this

	* gtk/gtklayout.c: docs

	* gtk/gtkbutton.c (gtk_button_construct_child): add an alignment
	to center image and label together, instead of having image on
	left and label centered, patch/suggestion from Jacob

	* gtk/gtkdialog.c: docs

Sat Sep  8 14:19:49 2001  Jonathan Blandford  <jrb@redhat.com>

	* gtk/gtkliststore.c: Write documentation
	* gtk/gtktreestore.c: Write documentation

Sat Sep  8 13:53:09 2001  Owen Taylor  <otaylor@redhat.com>

	* gtk/gtkrc.[ch] gtk/gtkstyle.[ch]: Replace uses of GBSearchArray
	with GArray and bsearch(), to remove dependency on a still
	evolving interface that we want to keep private to glib/gobject. 

2001-09-08  Havoc Pennington  <hp@pobox.com>

	* gtk/gtktreeviewcolumn.c (gtk_tree_view_column_add_attribute):
	docs fixes

	* gtk/gtktable.c (gtk_table_get_col_spacing): docs fixes

	* gtk/gtkspinbutton.c (gtk_spin_button_get_increments): docs fixes

	* gtk/gtksocket.c (gtk_socket_steal): docs fixes

	* gtk/gtkscrolledwindow.h: docs fixes

	* gtk/gtkimage.c (gtk_image_new): docs fixes

Sat Sep  8 01:49:22 2001  Owen Taylor  <otaylor@redhat.com>

	* gdk/x11/gdkmain-x11.c (_gdk_windowing_init_check): Prevent a 
	false alarm  constness warning with a cast.

	* gdk/x11/gdkx.h: Undefine GDK_ROOT_PARENT before redefining it
	for the inside-gdk case.

Sat Sep  8 01:44:18 2001  Jonathan Blandford  <jrb@redhat.com>

	* gtk/gtktreeviewcolumn.c (gtk_tree_view_column_cell_set_dirty):
	remove g_print.

	* gtk/gtktreeview.c (gtk_tree_view_set_model): unref model when we
	change models, #59899

2001-09-07  Havoc Pennington  <hp@pobox.com>

	* gtk/gtkmain.c: move some docs inline

2001-09-07  Havoc Pennington  <hp@pobox.com>

	* gtk/gtk.h: tsk tsk, jrb broke the build

Fri Sep  7 20:45:29 2001  Jonathan Blandford  <jrb@redhat.com>

	* gtk/gtktreeviewcolumn.c (gtk_tree_view_column_pack_{start,end}):
	Removed 'fill' attribute.  It was silly b/c that was a property of
	the cell renderer, anyway.
	(gtk_tree_view_column_render): Actually render the packed
	renderers.
	* doc/tree-column-sizing.txt: initial devel documentation.
	* gtk/gtktreeview.c (gtk_tree_view_expand_all): Fix bug.
	* gtk/gtkcellrenderertextpixbuf.[ch]: removed.

	* tests/testtreefocus.c: fix up to reflect above changes.
	* tests/testtreeview.c: ditto
	* demos/gtk-demo/stock_browser.c: ditto

2001-09-07  Alex Larsson  <alexl@redhat.com>

	* gdk/linux-fb/gdkcolor-fb.c:
	Removed unused function.
	
	* gdk/linux-fb/gdkdrawable-fb2.c
	* gdk/linux-fb/gdkfont-fb.c:
	Use PangoLanguage functions.

	* gdk/linux-fb/gdkinput.c:
	* gdk/linux-fb/gdkselection-fb.c:
	Fix const warnings.
	
	* gdk/linux-fb/gdkwindow-fb.c:
	Fix warning. Implement gdk_window_set_icon_list() and
	gdk_window_get_frame_extents(). (No icon support yet though.)

	* gtk/gtkwindow.c (gtk_window_get_position):
	If window->frame is set get the extents of it instead.
	
Fri Sep  7 18:50:59 2001  Owen Taylor  <otaylor@redhat.com>

	* gtk/gtkwidget.c (gtk_widget_get_default_colormap): 
	Make the default default colormap the GdkRGB colormap,
	not the system colormap.

	* gtk/gtkinvisible.c (gtk_invisible_init) 
	  gtk/gtkwindow.c (gtk_window_init): Set the current
	colormap, as returned by _gtk_widget_peek_colormap()
	on the widget.

	* gtk/gtkwidget.[ch]: Export _gtk_widget_peek_colormap
	to GTK+. Make it return %NULL instead of the default
	colormap if no colormap has explicitely been pushed.

	* gtk/gtkwidget.c (gtk_widget_get_colormap): Check for
	colormaps on ancestral widgets before defaulting the
	the system default colormap.

	* docs/Changes-2.0.txt: explain colormap changes.

2001-09-07  Havoc Pennington  <hp@redhat.com>

	* gtk/gtktextiter.c: add some lame code to handle G_MININT, fixes 
	#57424

Fri Sep  7 18:17:47 2001  Owen Taylor  <otaylor@redhat.com>

	* gdk/gdk.h gdk/x11/gdkmain-x11.c: Deprecate gdk_set/get_use_xshm, 
	make gdk_set_use_xshm a noop. Remove --no-xshm command line
	option. If we aren't autodetecting properly, we need
	to fix the problem, or at least make it an environment
	variable setting, to avoid problems with propagating
	to embedded children, plugins, etc.

	* gdk/gdkcolor.h: Deprecate gdk_colormap_get_system_size().

	* gdk/gdkpixbuf-render.c gdk/gdkpixbuf.h
	(gdk_pixbuf_render_pixmap_and_mask_for_colormap):
	New function to render a pixmap and mask for a particular colormap.

	* gtk/gtkwindow.c (get_pixmap_and_mask): Change to use
	gdk_pixbuf_render_pixmap_and_mask_for_colormap () instead
	of internal implementation of the same.

2001-09-07  Havoc Pennington  <hp@redhat.com>

	* gtk/gtktextlayout.c (gtk_text_layout_get_lines): remove some
	debug code that seems to have caused a breakpoint in valid cases
	
	* gtk/gtktextbtree.c (_gtk_text_btree_add_view): set the prev
	pointer on the first view when adding the second view, fixes
	crash when closing gtk-demo text test with active selection

	* gtk/gtktextbuffer.c
	(gtk_text_buffer_remove_selection_clipboard): don't leave dead
	clipboards in the list of clipboards - probably fixes #59836

Fri Sep  7 11:51:44 2001  Owen Taylor  <otaylor@redhat.com>

      Make gdkx.h the only installed header from gdk/x11.
      All structures in gdk/x11 are opaque.

	* gdk/x11/Makefile.am gdk/x11/gdkx.h gdk/x11/gdkprivate-x11.h:
	Don't install gdk{drawable,pixmap,window}-x11.h.

	* gdk/x11/{gdkcolormap-x11.c, gdkfont-x11.c, gdkx.h, gdkvisual-x11.c: 
	Move GdkColormapPrivateX11, GdkFontPrivateX GdkImagePrivateX11, 
	GdkVisualClass into C files.

	* gdk/gdkpixmap-x11.[ch]: Make gdk_pixmap_impl_get_type() static.

	* gdk/x11/{gdkcolor-x11.c, gdkcursor-x11.c, gdkdrawable-x11.c,
	gdkfont-x11.c, gdkgc-x11.c, gdkx.h, gdkimage-x11,gdkvisual-x11.c}
	Add public functions to replace previously exported direct
	structure access.
	gdk_x11_colormap_get_{xdisplay,xcolormap} 
	gdk_x11_cursor_get_{xdisplay,xcursor},
	gdk_x11_drawable_get_{xdisplay,xcursor,gdk_x11_visual_get_xvisual, 
	gdk_x11_font_get_{xdisplay,xfont}, gdk_x11_image_get_{xdisplay,ximage},
	gdk_x11_gc_get_{xdisplay,ximage}
	
	* gdk/gdkprivate.h gdk/gdkinternals.h: Move GdkColorInfo,
	GdkEventFilter, GdkClientFilter, GdkFontPrivate to gdkinternals.

      Fix a number of variables and functions that were exported
      "accidentally" from GDK.

	* gdk/**.[ch]: gdk => _gdk for gdk_visual_init,
	gdk_events_init, gdk_input_init, gdk_dnd_init, gdk_image_exit, 
	gdk_input_exit,	gdk_windowing_exit, gdk_event_func, gdk_event_data,
	gdk_event_notify, gdk_queued_events, gdk_queued_tail,
	gdk_event_new, gdk_events_queue, gdk_events_unqueue,
	gdk_event_queue_find_first, gdk_event_queue_remove_link,
	gdk_event_queue_append, gdk_event_button_generate,
	gdk_debug_flags, gdk_default_filters, gdk_parent_root.

	* gdk/x11/{gdkevents-x11.c, gdkglobals-x11.c, gdkimage-x11.c, 
	   gdkmain-x11.c, gdkprivate-x11.h, gdk/x11/gdkwindow-x11.c}:
	gdk => _gdk for gdk_event_mask_table, gkd_nevent_masks, 
	gdk_wm_window_protocols, gdk_leader_window, gdk_xgrab_window,
	gdk_use_xshm, gdk_input_ignore_core.

	* gdk/x11/xsettings-common.h (xsettings_list_insert): Add
	#defines to namespace functions into the private _gdk_ 
	namespace.

	* gdk/gdkwindow.[ch] gdk/x11/gdkx.h: Add gdk_get_default_root_window ()
	to replace gdk_parent_root exported variable. Adjust and
	deprecate GDK_ROOT_PARENT().

	* demos/{testpixbuf-drawable.c,testpixbuf-save.c}: Fix
	GDK_ROOT_PARENT usage, remove includes of port-specific
	headers.

	* gdk/{win32,x11,fb}/gdkinput*.[ch]: s/gdk/_gdk/ for 
	_gdk_input_gxid_host, _gdk_input_gxid_port, _gdk_input_ignore_core, 
	gdk_input_devices, _gdk_input_windows, gdk_init_input_core.

	* gdk/x11/{gdkevents-x11.,c gdkglobals-x11.c, gdkmain-x11.c}
	docs/Changes-2.0.txt: Remove gdk_wm_protocols, 
	gdk_wm_delete_window functions, gdk_wm_take_focus, 
	use gdk_atom_intern() instead.

	* gdk/linux-fb/{gdkselection-fb.c, gdkmain-fb.c, gdkprivatefb.h}
	  gdk/win32/{gdkselection-win32.c, gdkmgdkwin32.h, gdkprivate-win32.h} 
	  gdk/x11/{gdkselection-x11.c gdkx.h, gtkprivate-x11.h}
	  gtk/gtkselection.c 
        Unexport gdk_selection_property, just use 
	gdk_atom_intern ("GDK_SELECTION").

	* gdk/x11/{gdkprivate-x11.h,gdkdrawable-x11h,gdkgc-x11.c,gdkx.h}: 
	Unexport gdk_drawable_impl_x11_get_type, gdk_gc_x11_get_type, 
	GDK_GC_X11 cast macros, GdkGCX11 structures, GdkCursorPrivate, 
	GdkVisualprivate, gdk_x11_gc_flush.

      Make a number of public exports of variables into functions
      to increase encapsulation.

	* gdk/gdkinternals.h gdk/gdkinput.h gdk/gdkevents.h 
	gdk/linux-fb/gdkmouse-fb.c: gdk_core_pointer => _gdk_core_pointer, 
	move to gdkinternals.h. Add gdk_device_get_core_pointer ().	

	* gdk/gdkprivate.h gdk/gdkpango.c gdk/gdkinternals.h
	docs/Changes-2.0.txt: Unexport gdk_parent_root, gdk_error_code, 
	gdk_error_warnings.

	* gdk/x11/{gdkcolormap-x11.c, gdkmain-x11.c, gdkx.h}
	  docs/Changes-2.0.txt: 
	s/gdk_screen/_gdk_screen/, add gdk_x11_get_default_screen()
	s/gdk_root_window/_gdk_root_window/, add gdk_x11_get_default_root_xwindow()
	Add gdk_x11_get_default_xdisplay().

	* gdk/gdk.h gdk/gdk.c linux-fb/gdkfb.h linux-fb/gdkglobals-fb.c 
	win32/gdkwin32.h x11/gdkglobals-x11.c gdk/x11/gdkmain-x11.c 
	gdk/x11/gdkx.h: gdk/gdk.def: Add gdk_get/set_program_class, 
	Don't export gdk_progclass, move --class command line
	option and handling to common portion of GDK.

      Miscellaneous fixes:

	* gdk/x11/gdkwindow-x11.c (gdk_window_set_icon_list): Fix
	g_return_val_if_fail that should have been g_return_if_fail.

	* gdk/gdkinternals.h gdk/gdkprivate.h: Move
	gdk_synthesize_window_state() to the semi-public gdkprivate.h.

	* gtk/gtkdnd.c (_gtk_drag_source_handle_event): Remove uneeded
	X11 dependency.

	* gdk/linux-fb/gdkmain-fb.c gdk/win32/gdkmain-win32.c gdk/TODO: 
	Remove unused gdk_key_repeat_disable/restore.

	* linux-fb/gdkglobals-fb.c win32/gdkglobals-win32.c 
	x11/gdkglobals-x11.c x11/gdkprivate-x11.h gdk/gdk.def:
	Remove unused gdk_null_window_warnings variable.

	* gdk/Makefile.am (DIST_SUBDIRS) nanox/*: cvs remove nanox;
	it can be retrieved from the repository; it is too far
	from functional to be worth having people check out;
	it would be easier to start from scratch, I suspect.

	* gdk/x11/gdkpixmap-x11.c: Fix lvalue usage of GDK_PIXMAP_XID().

	* gdk/x11/gdkkeys-x11.c gdk/gdkrgb.c gdk/gdkwindow.c 
	gdk/x11/gdkpango-x11.c gdk/x11/gdkselection-x11.c: 
	Fix some accidentally global variables and unused global variables.

	* gdk/x11/gdkkeys-x11.c gdk/gdkrgb.c gdk/gdkwindow.c 
	gdk/x11/gdkpango-x11.c gdk/x11/gdkselection-x11.c: 
	Fix some accidentally global variables and unused global variables.

      Add some space for future expansion to multihead.

	* gdk/gdkdrawable.h: Add four reserved function pointers
	for future expansion of GdkDrawableClass.

	* gtk/gtkwindow.h gtk/gtkinvisible.h: Add reserved pointer
	where we can put a GdkScreen * later.

2001-09-07  Havoc Pennington  <hp@redhat.com>

	* gtk/gtktextview.c (gtk_text_view_flush_scroll): update
	adjustments after validating destination yrange; fixes #53918
	(This may cause other issues, but I hope it won't)
	
2001-09-05  Havoc Pennington  <hp@redhat.com>

	* gtk/gtktextbtree.c (_gtk_text_btree_delete): when merging end
	line into start line, update the character counts in parent nodes; 
	caused a bug when end and start line had different parent nodes.

2001-08-30  Havoc Pennington  <hp@redhat.com>
	
	* gtk/gtktexttag.c (_gtk_text_attributes_fill_from_tags): add
	assertion that tag is in a table

Fri Sep  7 12:48:56 2001  Matthias Clasen  <matthiasc@poet.de>

	* gdk/x11/gdkkeys-x11.c (get_direction): Don't call
	g_strcasecmp on NULL strings. (#59058)

2001-09-06  Alex Larsson  <alexl@redhat.com>

	* gtk/gtkbin.c:
	* gtk/gtkfontsel.c:
	* gtk/gtkspinbutton.c:
	* gtk/gtktipsquery.c:
	Use GtkType/GType instead of uint.

Tue Sep  4 18:13:43 2001  Jonathan Blandford  <jrb@redhat.com>

	* gtk/gtkliststore.c (gtk_list_store_init): fix initial val for
	sort column.

	* gtk/gtktreestore.c (gtk_list_store_init): ditto

	* gtk/gtktreesortable.c: add docs.

Tue Sep  4 09:37:19 2001  Owen Taylor  <otaylor@redhat.com>

	* Version 1.3.7

	* configure.in docs/Makefile.am docs/gtk-config.1.in: Remove 
	docs for gtk-config

	* modules/input/Makefile.am (install-data-local): Don't
	run gtk-query-immodules if DESTDIR is set.

	* NEWS: Various additions.

Tue Sep  4 03:12:25 2001  Tim Janik  <timj@gtk.org>

	* NEWS: updates for 1.3.7 release.

Mon Sep  3 18:03:56 2001  Jonathan Blandford  <jrb@redhat.com>

	* gtk/gtktreestore.c (gtk_tree_store_set_default_sort_func):
	handle default sort feature

	* gtk/gtktreesortable.c (gtk_tree_sortable_set_default_sort_func):
	new function to handle default sort.
	(gtk_tree_sortable_has_default_sort_func): check if default sort
	is set.

	* gtk/gtkliststore.c (gtk_list_store_set_default_sort_func): 
	handle default sort feature

Sun Sep  2 20:32:36 2001  Jonathan Blandford  <jrb@redhat.com>

	* gtk/gtktreeview.c (gtk_tree_view_scroll_to_cell): patch from
	vishnu@pobox.com (Joshua N Pritikin) to fix math and an assertion,
	#59731

Sun Sep  2 17:38:42 2001  Jonathan Blandford  <jrb@redhat.com>

	* gtk/gtktreeview.c (gtk_tree_view_deleted): Patch from
	vishnu@pobox.com (Joshua N Pritikin) to emit signal at the correct
	time, #59727

	* gtk/gtkbutton.c (gtk_button_update_state): Get depressed
	correctly.

Sun Sep  2 21:41:21 2001  Owen Taylor  <otaylor@redhat.com>

	* gdk/x11/gdkkeys-x11.c (update_keymaps): Set current serial
	so that we don't eternally update the keymap after we
	get a change notification.

	* gtk/gtkmenuitem.c (gtk_menu_item_set_right_justified): Fix
	incorrect cast.

Sun Sep  2 23:27:16 2001  Kristian Rietveld  <kristian@planet.nl>

	* gtk/gtktreemodelsort.[ch]: much changes in an attempt to make
	it working. It mostly works now, although there're still a few issues
	to be worked out.

	* tests/testtreesort.c (main): changes to have a better test
	application for the GtkTreeModelSort.

Sun Sep  2 23:19:07 2001  Kristian Rietveld  <kristian@planet.nl>

	* gtk/gtktreeview.c (gtk_tree_view_search_iter): code cleaup,
	fix for bug #59222.

	* gtk/gtktreeview.c (gtk_tree_view_search_equal_func): add
	gpointer search_data argument to function definition and
	prototype, to match GtkTreeViewSearchEqualFunc typedef.

Sat Sep  1 21:57:27 2001  Kristian Rietveld  <kristian@planet.nl>

	* gtk/gtkrbtree.c (_gtk_rbtree_reorder): add warnings
	per jrb's request.

Fri Aug 31 20:01:23 2001  Jonathan Blandford  <jrb@redhat.com>

	* gtk/gtktreeview.c (gtk_tree_view_search_iter): pass in user data.

	* gtk/gtktreeview.c (gtk_tree_view_destroy): destroy search_data.

Wed Aug 29 20:40:58 2001  Owen Taylor  <otaylor@redhat.com>

	* gtk/gtktextbuffer.[ch] (gtk_text_buffer_add/remove_selection_clipboard): 
	Instead of always mirroring the selection to a single PRIMARY
	selection, allow it to be mirrored to any number of clipboards.

	* gtk/gtktextbuffer.[ch] (gtk_text_buffer_paste_primary): Remove, 
	just use gtk_text_buffer_paste_clipboard with the appropriate clipboard.

	* gtk/gtktextbuffer.[ch] (gtk_text_buffer_cut/copy/paste_clipboard): Add a
	GtkClipboard argument, and for paste_clipboard, the
	@override_location argument from @paste_primary.

	* gtk/gtktextview.c: Adapt to above change.
	
2001-08-30  Havoc Pennington  <hp@redhat.com>

	* gtk/gtktextview.c (invalidated_handler): put validate idle at
	resize - 2 just for flexibility

2001-08-30  Havoc Pennington  <hp@redhat.com>

	* gtk/gtktextdisplay.c (render_layout_line): handle NULL shaped
	object from the empty-child-anchor case by drawing a little box.
	
	* gtk/gtktextlayout.c (add_child_attrs): Still set shape attribute
	if the child anchor has no anchored widgets - fixes #59328.

	Also, remove bizarre deletion of preedit string that seems to have
	gotten in here somehow.

2001-08-30  Havoc Pennington  <hp@redhat.com>

	* gtk/gtktextview.c (gtk_text_view_check_cursor_blink): apply fix
	to #58420 from Hidetoshi Tajima and Matthias Clasen

Wed Aug 29 17:28:04 2001  Jonathan Blandford  <jrb@redhat.com>

	* gtk/gtkcellrenderertoggle.c (gtk_cell_renderer_toggle_render):
	change color when the GtkTreeView loses focus.

	* gtk/gtkcellrenderertext.c (gtk_cell_renderer_text_render):
	ditto.
	
	* gtk/gtkstyle.c (gtk_default_draw_flat_box): ditto

2001-08-28  Havoc Pennington  <hp@pobox.com>

	* gtk/gtkwindow.c (gtk_window_set_icon_list): fix g_object_notify

2001-08-28  Havoc Pennington  <hp@pobox.com>

	* demos/gtk-demo/main.c (setup_default_icon): add default icon

	* gtk/gtkradiobutton.c (gtk_radio_button_new_with_mnemonic):
	warning fix
	(gtk_radio_button_new_with_label): warning fix

	* gtk/gtkdnd.c: used some random GtkImage private structs, 
	update to reflect GtkImage changes

	* gdk/x11/gdkwindow-x11.c (gdk_window_set_icon_list): don't check
	whether the hint is supported, just always set the icon. A task
	list might want to use it even if the WM doesn't, and the WM may
	change over time. Also, XDeleteProperty() if list == NULL.

	* gtk/gtkwindow.c (gtk_window_set_icon_list)
	(gtk_window_get_icon_list)
	(gtk_window_set_icon)
	(gtk_window_get_icon)
	(gtk_window_set_default_icon_list)
	(gtk_window_get_default_icon_list):
	new functions

	* gtk/gtk-boxed.defs (GtkIconSet): add GtkIconSet

	* gtk/gtkimage.c: Implement property support, bug #59408

	* gtk/gtkcontainer.c (gtk_container_add): make the warning message
	on reparent-without-removing-first a bit more helpful.
	Let's just destroy this FAQ.

Tue Aug 28 21:37:11 2001  Matthias Clasen  <matthiasc@poet.de>

	* demos/gtk-demo/appwindow.c (do_appwindow): Use g_signal_connect_object
	instead of gtk_signal_connect, to avoid warnings at destruction time. (#58161)

Tue Aug 28 21:00:44 2001  Matthias Clasen  <matthiasc@poet.de>

	* gtk/gtkprogressbar.c (gtk_progress_bar_set_text): Move the setting
	of use_text_format to the end of the function. (#56447)

Tue Aug 28 20:06:07 2001  Matthias Clasen  <matthiasc@poet.de>

	* demos/testpixbuf.c (update_timeout): Use gdk_pixbuf_loader_get_pixbuf
	only in response to an area_prepared signal.

2001-08-28  Alex Larsson  <alexl@redhat.com>

	* gtk/gtkwidget.c (gtk_widget_class_init):
	Make unrealize GTK_RUN_LAST.

Mon Aug 27 22:00:41 2001 Manish Singh <yosh@gimp.org>

	* gtk/gtkradiobutton.c: fix silly cut'n'paste error,
	with_label and with_mnemonic should create radio buttons, not
	check buttons

Mon Aug 27 15:28:56 2001  Jonathan Blandford  <jrb@redhat.com>

	* tests/testtreefocus.c (main): Fix to use GtkSelectionMode.
	* tests/treestoretest.c (make_window): ditto
	* demos/gtk-demo/main.c (create_tree): ditto
	* demos/gtk-demo/stock_browser.c (do_stock_browser): ditto.

Mon Aug 27 15:18:14 2001  Jonathan Blandford  <jrb@redhat.com>

	* gtk/gtktreeselection.c (gtk_tree_selection_set_mode): Use the
	GTK selection types rather than GtkTreeSelectionMode.

	* docs/Changes-2.0: Add comment about selection change.

Mon Aug 27 14:21:30 2001  Jonathan Blandford  <jrb@redhat.com>

	* gtk/gtkenums.h (GtkSelectionMode): deprecate
	GTK_SELECTION_EXTENDED.

	* gtk/gtkclist.c: Remove old GTK_SELECTION_MULTIPLE behavior.
	Make GTK_SELECTION_EXTENDED be GTK_SELECTION_MULTIPLE.

	* gtk/gtkctree.c: ditto

	* gtk/gtklist.c: ditto

	* gtk/gtktree.c: ditto

Mon Aug 27 14:18:12 2001  Owen Taylor  <otaylor@redhat.com>

	* gtk/gtkmenubar.h (gtk_menu_bar_prepend): Fix a cuple
	of typos in compat macros. (#59624, Skip Montaro)

Sun Aug 26 20:00:00 2001  Owen Taylor  <otaylor@redhat.com>

	* configure.in acinclude.m4: Use autoconf 2.13/2.50 compat
	macro.

	 (patch from ERDI Gergo  <cactus@cactus.rulez.org>, #58920)
 
 	* gtk/gtkmenuitem.c (gtk_menu_item_set_right_justified): Change
	interface to be a standard setter from gtk_menu_item_right_justify.
 	(gtk_menu_item_get_right_justified): a getter to go with the setter

	* gtk/gtkmenuitem.h: Add a deprecated compat macro for
	gtk_menu_item_right_justify.

	* demos/gtk-demo/menus.c tests/testgtk.c: Switch to 
	gtk_menu_item_set_right_justified.
 
2001-08-27  Jens Finke <jens@gnome.org>

	* gtk+.spec.in: Updated to match gpp requirements, reworked the
	files section to make it work with 1.3.x releases.

2001-08-26  Alexander Larsson  <alla@lysator.liu.se>

	* gtk/gtkbutton.[ch]:
	Add properties for labels, mnemonics and stock items.
	Added C accessor functions for the properties.
	Removed deprecated button->child.

	* gtk/gtkradiobutton.c:
	* gtk/gtktogglebutton.c:
	Update to use the functions in GtkButton.

	* gtk/gtkcheckbutton.c:
	Update to use the functions in GtkButton.
	Changed size allocation of child. Now only gets as much
	space as it requests.

	* gtk/gtkclist.c:
	Don't use GtkButton->child

	* gtk/gtklabel.c:
	Fixed typo in docs
	
2001-08-26  Alexander Larsson  <alla@lysator.liu.se>

	* tests/testgtk.c:
	* tests/Makefile.am:
	Ressurect the properties test.
	I don't care if it is inferior, I just want to test my property code.

2001-08-25  Chema Celorio  <chema@celorio.com>

	* gtk/gtktable.c (gtk_table_set_child_property): pass ->nrows to
	gtk_table_resize as the first argument for CHILD_PROP_RIGHT_ATTACH
	and CHILD_PROP_LEFT_ATTACH v.s. using ->ncols

2001-08-24  Havoc Pennington  <hp@pobox.com>

	* gtk/gtkcompat.h: remove gtk_menu_* compat defines; 
	these are already in gtkmenu.h, and the copies
	here were broken.

	Also, change GTK_DISABLE_COMPAT_H to GTK_DISABLE_DEPRECATED

	* gdk/gdkpixbuf-drawable.c (gdk_pixbuf_get_from_image):
	special-case bitmaps to allow no colormap
	(bitmap1): implement no-colormap bitmap-getting
	(bitmap1a): implement no-colormap bitmap-getting to pixbuf with
	alpha
	(rgb8): indentation
	(rgb1a, rgb1): change the way we read the data out of the image, 
	old way didn't seem to work quite right.

	I'm pretty sure a lot of the rgbconvert code is still broken.
	
	* gtk/gtkwindow.c (gtk_window_move_resize): move hints comparison
	above position constraint (I really intended to do this before,
	don't know what's up with that)
	(gtk_XParseGeometry): shut up gcc

	* gdk/gdkpixbuf-drawable.c (rgb1a): fix bug where "x1" was used
	and "0" should have been. remove the attempted 4-bytes-at-once
	optimization, it was totally broken.

Sat Aug 25 19:02:39 2001  Owen Taylor  <otaylor@redhat.com>

	* gtk/gtkbutton.[ch] gtk/gtktogglebutton.c: Add optional movement
	on push to buttons (based on patch from Soeren Sandmann, #54720)

	  - Add child_displacement_x/y style properties to control how far the
	    child moves when the button is depressed.

	  - Add non-exported function _gtk_button_set_depressed to clean
	    up the handling of the in/out shadow and separate it frmo
	    widget->state.

	  - Lots of code cleanup and simplification of state handling
	    for GtkButton/GtkToggleButton.
 
        * tests/testgtkrc: Set the x/y displacement to 1 to provide a test
        of button movement. testgtk + testgtkrc == test ugly GTK+, as always. 	

Fri Aug 24 23:09:05 2001  Owen Taylor  <otaylor@redhat.com>

	* gtk/gtkimage.[ch] docs/Changes-2.0.txt: Break compatibility 
	and make gtk_image_new() take no arguments. The compiler will
	catch it, and it is vastly more useful than having
	gtk_image_new() be a deprecated alias for gtk_image_new_from_image().  

	* gtk/gtkmenu.c (gtk_menu_set_property): Apply patch
	to add tearoff-title property (#51319, Lee Mallabone)

Fri Aug 24 22:12:32 2001  Owen Taylor  <otaylor@redhat.com>

	* gtk/gtkmenuitem.[ch]: Remove unused and useless function
	gtk_menu_item_configure(). (#58925)

Fri Aug 24 16:03:45 2001  Jonathan Blandford  <jrb@redhat.com>

	* gtk/gtktreeview.c (gtk_tree_view_scroll_to_cell): Add
	"use_align" to give people the option to just make a cell visible.

	* gtk/gtktreeview.c (gtk_tree_view_scroll_to_point): fix bug where
	we were scrolling past the end of the tree.

	* gtk/gtktreeviewcolumn.c (gtk_tree_view_column_pack_start):
	rename gtk_tree_view_column_pack_start_cell_renderer to
	gtk_tree_view_column_pack_start.  Same for pack_end, and clear.

Fri Aug 24 12:02:08 2001  Owen Taylor  <otaylor@redhat.com>

	* gtk/gtktextbuffer.c (gtk_text_buffer_new): Remove
	a stray g_object_ref() left over from gtk_object_ref/sink.
	(Pointed out by Josh Pritikin.)

Thu Aug 23 19:33:54 2001  Owen Taylor  <otaylor@redhat.com>

	* gtk/gtkcontainer.[ch]: Rename gtk_container_children()
	to gtk_container_get_children. Added deprecated compatibility
	macro. (Suggested by Vitaly Tishkov, #59051)

	* gtk/gtktoolbar.c gtkdialog.c: Fix gtk_container_children()
	calls.

Thu Aug 23 19:10:01 2001  Owen Taylor  <otaylor@redhat.com>

	* gtk/gtkmenubar.h (gtk_menu_bar_insert): Deprecate 
	gtk_menu_bar_append/prepend/insert, forgot to do this
	when we deprecated gtk_menu_append/prepend/insert.

	* gtk/gtkmenu.h (gtk_menu_insert): Add casts to deprecated
	compat macros.

	* gtk/gtkmenu.c: Fix problem with static gtk_menu_insert() being
	renamed by compat macro.

	* gtk/gtkfontsel.h: Deprecated gtk_font_selection_get_font(),
	gtk_font_selection_dialog_get_font(). (Suggested by
	Vitaly Tishkov, #59383)

Thu Aug 23 18:23:31 2001  Owen Taylor  <otaylor@redhat.com>

	* gtk/gtktexttag.c (gtk_text_tag_table_get_size): 
	Rename from gtk_text_tag_table_size(). (#59366)

Thu Aug 23 20:01:41 2001  Kristian Rietveld  <kristian@planet.nl>

	* gtk/gtktreemodelsort.[ch], gtk/gtktreesortable.[ch],
	gtk/gtktreestore.[ch], gtk/gtktreeviewcolumn.[ch],
	gtk/gtkliststore.[ch]: use GtkSortType instead of GtkTreeSortOrder.
	(#59173).

Thu Aug 23 16:26:47 2001  Tim Janik  <timj@gtk.org>

	* gtk/gtktreeviewcolumn.c (gtk_tree_view_column_finalize): 
	* gtk/gtktextmark.c (gtk_text_mark_finalize): chain parent class
	handlers, pointed out by Joshua N Pritikin <vishnu@pobox.com>.

Wed Aug 22 19:15:39 2001  Owen Taylor  <otaylor@redhat.com>

	[ Patch from Sebastian Wilhelmi, 52790 ]

	* gtk/gtkversion.h.in gtk/gtk.h: New file replacing gtkcompat.h

	* gdk/gdkcompat.h gdk/gdk*.h gtk/gtkcompat.h.in gtk/gtk*.h: 
	Move compatibility macros from g[dt]kcompat.h to within 
	#ifndef G[DT]K_DISABLE_DEPRECATED in each file.

	* gdk/gdk-pixbuf-csource.c: Fix up include of gtkcompat.h.

	* demos/Makefile.am demos/gtk-demo/Makefile.am 
	  docs/reference/gdk-pixbuf/Makefile.am modules/input/Makefile.am
	  tests/Makefile.am: Remove references to -G[DT]K_DISABLE_DEPRECATED.

	* demos/{pixbuf-demo.c,testpixbuf-drawable.c,testpixbuf-save.c,
	         testpixbuf.c}: Fix usages of deprecated functions.

Wed Aug 22 19:03:27 2001  Jonathan Blandford  <jrb@redhat.com>

	* gtk/gtktreeview.c (gtk_tree_view_set_model): clean up selection
	when changing models.

Wed Aug 22 18:25:46 2001  Jonathan Blandford  <jrb@redhat.com>

	* gtk/gtktreeview.c: Fix selection.  I think it's all dandy now.
	We check the current event for modifiers rather than try to trap
	all presses.

2001-08-22  Anders Carlsson  <andersca@gnu.org>

	* gtk/gtkliststore.h (GTK_LIST_STORE_CLASS): Fix a small typo.
	It's LIST_STORE, not LISTSTORE.

Tue Aug 21 12:43:29 2001  Owen Taylor  <otaylor@redhat.com>

	* gtk/gtk.h: Remove commented out gtkpacker reference.

2001-08-21  Matthias Clasen  <matthiasc@waldgeist.poet.de>

	* configure.in (all_loaders): Add tga loader, 
	patch by Nicola Girardi. (#56067)

Tue Aug 21 02:57:13 2001  Jonathan Blandford  <jrb@redhat.com>

	* gtk/gtktreeview.c (gtk_tree_view_button_press): Fix up selection
	a little.  More needs to be done tomorrow.

Tue Aug 21 00:45:55 2001  Jonathan Blandford  <jrb@redhat.com>

	* gtk/gtktreeview.c (gtk_tree_view_destroy): Grr... Get it right.

Mon Aug 20 23:48:18 2001  Jonathan Blandford  <jrb@redhat.com>

	* gtk/gtktreeview.c (gtk_tree_view_get_cell_area): Fix bug
	reported by Kristian Rietveld <kristian@planet.nl> to handle row
	== NULL.
	(gtk_tree_view_destroy): Fix bug reported by Kristian Rietveld
	<kristian@planet.nl> to change destroy order.

Mon Aug 20 11:39:44 2001  Jonathan Blandford  <jrb@redhat.com>

	* gtk/gtktreeselection.c (gtk_tree_selection_class_init): Use
	correct marshaller.

Sun Aug 19 03:22:59 2001  Jonathan Blandford  <jrb@redhat.com>

	* gtk/gtkliststore.c: Fix up warnings, #58928.

	* gtk/gtktreeselection.h: Change signal prototype, #58647

	* gtk/gtktreeview.c (_gdk_tree_view_find_node): Make more robust,
	#59221.

	* gtk/gtkstyle.c: Actually prelight arrow, #50981
	
2001-08-18  Hans Breuer  <hans@breuer.org>

	* gdk/gdk.def : updated externals

	* gdk/win32/gdkselection-win32.c : returning TRUE with gdk_selection_set
	is required to get (at least) visible in entry fields. Some selections
	are really handled now - even on win32 - but copying via middle
	mouse button into a different app needs to wait ... 

	* gdk/win32/gdkdnd-win32.c : implemented inter-app drag&drop
	mostly by stealling code from gdkdnd-fb.c. Thanks to who ever wrote it!

	* gdk/win32/gdkevents-win32.c : some tweaking to get better expose
	handling. I'm not sure if it is better now, but at least not worse

	* gdk/win32/gdkgeometry-win32.c : replaced every call to MoveWindow
	with SetWindowPos () which allows more fine-tuning backing-store wise

	* gdk/win32/gdkwindow-win32.c : allow unraised gdk_window_show ().
	Also changed move/resize to be more like the X version.

	* gtk/gtk.def : updated externals

2001-08-19  Sven Neumann  <sven@gimp.org>

	* gtk/gtktooltips.c
	* tests/testtreesort.c
	* tests/treestoretest.c: inserted some casts to get rid of compiler
	warnings.

Sun Aug 19 01:44:44 2001  Jonathan Blandford  <jrb@redhat.com>

	* gtk/gtktreeviewcolumn.c
	(gtk_tree_view_column_pack_{start,end}_cell_renderer): sink cell.

	* gtk/gtktreeview.c (gtk_tree_view_insert_column): sink column.
	(_gtk_tree_view_find_node): If *node is NULL,
	*tree should be NULL too.

	* demos/gtk-demo/stock_browser.c (do_stock_browser): don't unref
	column/renderers.
	* tests/testtreecolumns.c: ditto
	* tests/testtreefocus.c: ditto
	* tests/testtreesort.c: ditto
	* tests/testtreeview.c: ditto
	* tests/treestoretest.c: ditto

Sat Aug 18 04:34:31 2001  Jonathan Blandford  <jrb@redhat.com>

	* gtk/gtkcellrenderer.c (gtk_cell_renderer_class_init): 2 new
	signals; is_expander/is_expanded.

	* gtk/gtlcellrendererpixbuf.c: Allow other expanded and closed
	pixbufs.

	* gtk/gtktreeview.c: set above properties.

Sat Aug 18 23:01:33 2001  Owen Taylor  <otaylor@redhat.com>

	* gtk/gtkwidget.h: Really remove set_default_style().

	* docs/Changes-2.0.txt: added a note about
	gtk_widget_push/pop/set_default_style.

2001-08-18  Havoc Pennington  <hp@pobox.com>

	* gtk/gtkwindow.c (gtk_window_move_resize): constrain position on
	hints_changed in addition to the other cases.
	(gtk_window_move_resize): include last position from configure
	notify in debug spew

2001-08-18  James Henstridge  <james@daa.com.au>

	* gtk/gtkaccelgroup.c (gtk_accel_group_object_destroy): use the
	second argument to the weak ref notify, cleaning up some uglyness.
	(gtk_accel_group_attach): remove and add the weak notifier when
	changing the accel groups slist.
	(gtk_accel_group_detach): same here.

2001-08-17  Darin Adler  <darin@bentspoon.com>

	* gtk/gtktreeview.c: (gtk_tree_view_search_equal_func): Add
	missing parameters to utf8 functions to make it compile.

Fri Aug 17 19:30:14 2001  Jonathan Blandford  <jrb@redhat.com>

	* gtk/gtktreeprivate.h:
	* gtk/gtktreeview.c: (gtk_tree_view_class_init),
	(gtk_tree_view_init), (gtk_tree_view_set_property),
	(gtk_tree_view_get_property), (gtk_tree_view_destroy),
	(gtk_tree_view_key_press), (gtk_tree_view_leave_notify),
	(gtk_tree_view_focus_out), (gtk_tree_view_set_model),
	(gtk_tree_view_set_destroy_count_func),
	(gtk_tree_view_set_enable_search),
	(gtk_tree_view_get_enable_search),
	(gtk_tree_view_get_search_column),
	(gtk_tree_view_set_search_column),
	(gtk_tree_view_get_search_equal_func),
	(gtk_tree_view_set_search_equal_func),
	(gtk_tree_view_search_dialog_destroy),
	(gtk_tree_view_search_position_func),
	(gtk_tree_view_interactive_search),
	(gtk_tree_view_search_delete_event),
	(gtk_tree_view_search_button_press_event),
	(gtk_tree_view_search_key_press_event),
	(gtk_tree_view_search_move), (gtk_tree_view_search_equal_func),
	(gtk_tree_view_search_iter), (gtk_tree_view_search_init):
	* gtk/gtktreeview.h:
	Add heavily modified patch from Kristian Rietveld to handle
	interactive searching.

Fri Aug 17 17:30:34 2001  Tim Janik  <timj@gtk.org>

	* gtk/gtktreemodel.c (gtk_tree_path_new_from_string): const correct
	string parameter.

	* gtk/gtkoptionmenu.c (gtk_option_menu_set_menu): connect to
	GtkMenuShell::selection_done, now that we have it, instead of 
	::deactivate so we're not tearing the menu apart and notify
	the user prematurely.

Thu Aug 16 05:22:01 2001  Tim Janik  <timj@gtk.org>

	* gtk/gtkwindow.c (gtk_window_move_resize): if we actually move our
	window, clear window->need_default_position to avoid infinite loops.
	some comment fixups and GTK_RESIZE_IMMEDIATE fixups.

Wed Aug 15 12:36:55 2001  Tim Janik  <timj@gtk.org>

	* gtk/gtktreeview.c (gtk_tree_view_set_model): move all model setup
	code into this place. get rid of GTK_TREE_VIEW_MODEL_SETUP usage.
	(gtk_tree_view_set_property): don't cast possible NULL objects.
	(gtk_tree_view_destroy): reset the model to NULL.

	* gtk/gtktreeselection.c (gtk_tree_selection_finalize): chain
	parent_class handler.

2001-08-17  Matthias Clasen  <matthiasc@waldgeist.poet.de>

	* gtk/demos/gtk-demo/*: Remove all uses of deprecated functions.

2001-08-17  Anders Carlsson  <andersca@gnu.org>

	* gtk/gtkstyle.c (create_expander_affine): Divide with floating
	point numbers so that the result will be floating point.

2001-08-16  Matthias Clasen  <matthiasc@waldgeist.poet.de>

	* tests/testgtk.c (create_handle_box): 
	(create_toolbar): Replace gtk_window_set_policy calls by
	gtk_window_set_resizable.

2001-08-16  Jakub Steiner <jimmac@ximian.com>

	* gtk/stock-icons/dialog_info.png: new style bulb
	* gtk/stock-icons/dialog_error.png: maybe a little drastic ;)
	* gtk/stock-icons/dialog_warning.png: need a hand?
	* gtk/stock-icons/stock_add.png, stock_remove.png: I hope 
	  the aa border gets chopped off ok
	* gtk/stock-icons/stock_colorselector.png: using the new hand
	* gtk/stock-icons/stock_dnd_multiple.png: I'm not totally sure what 
	  this one is for, but the old icon was butt ugly.
	* gtk/stock-icons/stock*_insert_image.png: not sure if it belongs here
	* gtk/stock-icons/stock*_insert_object.png: "
	* gtk/stock-icons/stock_index.png: using new hand icon
	* gtk/stock-icons/stock*_new.png: the document template being used 
	  elsewhere too
	* gtk/stock-icons/stock*_print*.png: new print and print preview 
	  icons (panel/menu)  
	* gtk/stock-icons/stock*_save*.png, stock*_revert.png: new save/revert 
	  icons based on Tuomas' floppy image.
	* gtk/stock-icons/stock*_search*.png: search and s'n'r icons for panel/menu
	* gtk/stock-icons/stock*_stop.png: replacing the old 'x' button
	* gtk/stock-icons/stock*_trash.png: based on Tuomas' trash icon
	* gtk/stock-icons/stock*_undelete.png: "
	* gtk/stock-icons/stock_preferences.png: I have a version with a 
	  document base if the sliders are no good.
	* gtk/stock-icons/stock_properties.png: properties 
	

	* gtk/stock-icons/stock*_copy.png, stock*_cut.png, stock*_paste.png: Tuomas' 
	  (tigert@ximian.com) clipboard icons
	* gtk/stock-icons/stock_{up,down,left,right}_arrow.png: tigert's new arrows
	* gtk/stock-icons/stock*_{undo,redo}.png: tigert's undo/redo icons.
	* gtk/stock-icons/stock_open.png: shaded open icon by Tuomas. we should make it a
	  little bigger IMHO

2001-08-16  Sven Neumann  <sven@gimp.org>

	* gtk/gtkbox.c (gtk_box_class_init): removed unused widget_class.

2001-08-15  Padraig O'Briain  <padraig.obriain@sun.com>

	* gtk/gtkcellrenderertext.c:
	Avoid warning when specifying NULL for "attributes" property

2001-08-15  Matthias Clasen  <matthiasc@waldgeist.poet.de>

	* docs/debugging.txt: Add a warning about --enable-debug=no,
	some editorial changes.

2001-08-13  Matthias Clasen  <matthiasc@waldgeist.poet.de>

	* gtk/docs/debugging.txt, gdk/gdk.c, gdk/gdkinternals.h, 
	gdk/x11/gdkmain-x11.c, gtk/gtkdebug.h, gtk/gtkmain.c: Update 
	debugging info, remove unused debug flags. (#58330)

Mon Aug 13 13:17:32 2001  Jonathan Blandford  <jrb@redhat.com>

	* gtk/gtktreeselection.c (gtk_tree_selection_select_all): 
	(gtk_tree_selection_select_all): Remove strict checking for rows.

2001-08-13  Matthias Clasen  <matthiasc@waldgeist.poet.de>
	
	* gtk/gtktooltips.c (gtk_tooltips_set_tip, gtk_tooltips_draw_tips): 
	Don't remove the tooltip window when the tip text changes. (#15891)

Sun Aug 12 12:02:09 2001  Owen Taylor  <otaylor@redhat.com>

	* gtk/Makefile.am ($(srcdir)/gtkmarshal.c): Remove extra
	$(srcdir).

Sun Aug 12 10:39:12 2001  Owen Taylor  <otaylor@redhat.com>

	* Makefile.am (EXTRA_DIST): Fix problem with trying to
	dist files from intl/, which is no longer there.

2001-08-11  Hans Breuer  <hans@breuer.org>

	* gtk/gtkalignment.c, gtk/gtkarrow.c, gtk/gtkaspectframe.c,
	  gtk/gtkcellrenderer.c, gtk/gtkcellrenderertext.c, 
	  gtk/gtkcombo.c, gtk/gtkcurve.c, gtk/gtkfontsel.c, 
	  gtk/gtklayout.c, gtk/gtkmisc.c, gtk/gtkpacker.c, 
	  gtk/gtkprogress.c, gtk/gtkruler.c,, gtk/gtksettings.c,
	  gtk/gtkspinbutton.c, gtk/gtktexttag.c : coalescing property notifies

	* gtk/gtkclist.c, gtk/gtktipsquery.c, gtk/gtktexttag.c,
	  gtk/gtkwidget.c : added G_SIGNAL_TYPE_STATIC_SCOPE to all
	GDK_TYPE_EVENT signals

	* gtk/gtkalignment.c : removed 'direct allocation bug',
	which Tim discovered while reading the patch

Sat Aug 11 14:32:14 2001  Owen Taylor  <otaylor@redhat.com>

	* gtk/gtkwidget.h (gtk_widget_set_default_visual): Add some
	compat macros for push/pop/set_visual that were supposed
	to be added a long time ago, but got dropped. 

Fri Aug 10 16:55:53 2001  Tim Janik  <timj@gtk.org>

	* gtk/gtkwindow.c (gtk_window_set_policy): coalesce multiple
	property notifies.

2001-08-07  Havoc Pennington  <hp@pobox.com>

	* gtk/gtkfilesel.c (open_ref_dir): fix a typo.

	* gtk/gtkplug.c (gtk_plug_init): remove setting of auto_shrink;
	some fixage is needed here, but nothing simple. Owen understands
	it. ;-)

        * gtk/gtkwindow.h, gtk/gtkwindow.c: Rework code and API for window
	sizing and positioning.  Also, fix bug in compute_geometry_hints
	(width/height confusion for setting min size). 
	(gtk_window_move): new function
	(gtk_window_resize): new function
	(gtk_window_get_size): new function
	(gtk_window_get_position): new function
	(gtk_window_parse_geometry): new function
	
 	* gtk/gtkwidget.c (gtk_widget_set_size_request): new function
 	(gtk_widget_get_size_request): new function
 	(gtk_widget_get_usize): delete, that was a short-lived function
 	;-)
 	(gtk_widget_set_usize): deprecate
 	(gtk_widget_set_uposition): deprecate, make it a trivial 
	gtk_window_move() wrapper
	(gtk_widget_class_init): remove x/y/width/height properties,
	add width_request height_request
	
        * demos/*: update to avoid deprecated functions
	
	* gtk/gtklayout.c: add x/y child properties

	* gtk/gtkfixed.c: add x/y child properties, and get rid of 
	uses of "gint16"

	* tests/testgtk.c (create_window_sizing): lots of tweaks to window
	sizing test

	* gdk/x11/gdkevents-x11.c (gdk_event_translate): Ensure that
	configure events on toplevel windows are always in root window
	coordinates, following ICCCM spec that all synthetic events 
	are in root window coords already, while real events are 
	in parent window coords. Previously the code assumed that 
	coords of 0,0 were parent window coords, which was 
	really broken.
  
 	* gtk/gtkcontainer.c (gtk_container_get_focus_chain): fix
 	warning
 
 	* gdk/gdkwindow.h (GdkWindowHints): add GDK_HINT_USER_POS 
 	and GDK_HINT_USER_SIZE so we can set USSize and USPosition 
 	hints in gtk_window_parse_geometry()
 
 	* gdk/x11/gdkwindow-x11.c (gdk_window_set_geometry_hints): support
 	new USER_POS USER_SIZE hints 	

2001-08-09  Matthias Clasen  <matthiasc@waldgeist.poet.de>

	* tests/prop-editor.c (properties_from_type): Use 
	g_object_class_list_properties to get the param specs 
	for a given type. (#58609)

2001-08-09  Matthias Clasen  <matthiasc@waldgeist.poet.de>

	* gtk/gtkstyle.c (gtk_style_real_unrealize): Don't forget to
	free the text_aa parts. (#57549)

2001-08-09  Matthias Clasen  <matthiasc@waldgeist.poet.de>

	* gdk/gdkgc.c (gdk_gc_set_rgb_bg_color): Set the background color,
	not the foreground color. (#57621)

2001-08-09  Alexander Larsson <alexl@redhat.com>

	* gdk/win32/gdkfont-win32.c:
	Update to the new pango win32 api.

2001-08-08  HideToshi Tajima  <tajima@eng.sun.com>

	* gtk/gtkclipboard.c (request_text_received_func): ask apps for
	COMPOUND_TEXT instead of TEXT
	* gdk/x11/gdkselection-x11.c (gdk_utf8_to_compound_text): correctly
	interpret the return value of g_string_to_compound_text()
	(#55152)

2001-08-08  Matthias Clasen  <matthiasc@waldgeist.poet.de>

	* gtk/gtktreestore.c (gtk_tree_store_iter_n_children): Don't
	fail if iter is NULL. (#58347)

2001-08-07  Matthias Clasen  <matthiasc@waldgeist.poet.de>

	* gtk/gtktextdisplay.c (render_para, gtk_text_layout_draw): Fix
	some off-by-one issues, fixing selection of line-ends. (#50323)

2001-08-07  Matthias Clasen  <matthiasc@waldgeist.poet.de>

	* gtk/gtkhsv.c (gtk_hsv_map, gtk_hsv_unmap): Reinstate these
	functions in order to make mouse operation work again in the
	color wheel. (#58604)

2001-08-07  James Henstridge  <james@daa.com.au>

	* gtk/gtkaccellabel.c (gtk_accel_label_set_accel_object): refetch
	the accelerator when the accel object is changed.  Fixes bug
	#58628.

2001-08-06  HideToshi Tajima  <tajima@eng.sun.com>

	* modules/input/gtkimcontextxim.c (mb_to_utf8), xim_text_to_utf8):
	Skip g_convert when to_codeset and from_codeset are both 'UTF-8'
	(gnome bugzilla #58202)

2001-08-06  Havoc Pennington  <hp@pobox.com>
 
 	* gdk/x11/gdkimage-x11.c (_gdk_x11_get_image): The whole 
 	GDK_IS_WINDOW() branch of this was a bit screwed up, because 
 	it was expecting a GdkWindow, not a GdkWindowImplX11.
 
 	Also, we were getting the window rect in screen coords 
 	and the screen rect in window coords then intersecting 
 	them; instead, get window rect in window coords.
 
 	Finally, there were codepaths that resulted in a stuck server grab
 	(when the window was fully onscreen, or on gdk_image_new()
 	failure); make the server ungrab thing a bit more
 	robust/consistent.

2001-08-06  Sven Neumann  <sven@gimp.org>

	* gdk/gdkpango.c (gdk_pango_context_destroy): 
	check if info->colormap != NULL before unref'ing it. It might have
	been set to NULL using gdk_pango_context_set_colormap().

Sun Aug  5 11:24:27 2001  Owen Taylor  <otaylor@redhat.com>

	* gtk/gtkcolorsel.c (gtk_color_selection_set_current_alpha): 
	Fix conversion from float to int so that we don't get
	skew in the int => float => int roundtrip. 
	(#58120, reported by Vitaly Tishkov). Also fix problem
	where if no alpha was set, the returned alpha
	from (say) set_current_alpha() was returned as 1, not 65535.

Sun Aug  5 09:48:08 2001  Owen Taylor  <otaylor@redhat.com>

	* gtk/gtklist.c (gtk_list_clear_items): Fix
	problem with selecting a new focus child.

	* gtk/gtklist.c (gtk_list_clear_items): Clear 
	list->undo/list_focus_child after unparenting
	child, since unparenting the child can result
	in list->last_focus_child being set. (#58024)

	* Makefile.am (SUBDIRS): Add target specific pc
	files to DISTCLEANFILES.

	* gtk/Makefile.am: add @GTK_DEBUG_FLAGS@
	(58327, Matthias Clasen)

Sat Aug  4 19:28:21 2001  Owen Taylor  <otaylor@redhat.com>

	* tests/testgtk.c: Patch from Hans (with various modifications),
	to add the ability to use testgtk as a rough-and-ready
	benchmark. Try, 'testgtk --bench all:5' (if you want decent
	numbers, run without a window manager)

2001-08-04 Alexander Larsson <alexl@redhat.com>

	* gdk/win32/gdkinput.c:
	Add #ifdef HAVE_WINTAB around wintab.h include.

	* gtk/gtk.def:
	Removed marshals that have been moved to glib.
	Commented out plug and socket. They didn't compile for me 
	on win32.

2001-08-04  Hans Breuer  <hans@breuer.org>

	* gtk/stocks-icons/makefile.msc : new file
	* gtk/makefile.msc.in : use it

	* gtk/gtkstyle.c : not all platforms do provide M_PI and
	friends, but luckily there is G_PI

	* gtk/gtk.def : updated

	* gdk/win32/gdkwindow.c (gdk_window_new) : don't make all TEMP 
	windows WS_POPUP, but only those without a parent. This fixes the 
	mis-alignment between the selectable (temp, input only) window and 
	the window text of GtkLabel.

	(gdk_window_show) : respect private->state when actually showing
	the window.

	(gdk_window_set_transient_for) : Implementation from Wolfgang 
	Sourdeau <wolfgang@contre.com> ported to 2.0 and added some 
	error handling. Should fix #50586.

	* gdk/win32/gdkevents-win32.c : beautify log output

2001-08-04  Michael Natterer  <mitch@gimp.org>

	* gtk/gtkitemfactory.c (gtk_item_factory_create_item):
	Need to show the image after adding it to the GtkImageMenuItem.
	This used to work without in testgtk because of the
	gtk_widget_show_all() at the end of the function.
	(Closes #54978).

Tue Jul 31 22:59:33 2001  Tim Janik  <timj@gtk.org>

	* gtk/gtknotebook.c (gtk_notebook_get_child_property): 
	(gtk_notebook_set_child_property): fix finding of child's page,
	since we have to validly deal with labels and menus here as well.
	(gtk_notebook_get_child_property): fix warning.
	(gtk_notebook_class_init): property tab_pack is of type
	GTK_TYPE_PACK_TYPE (enum) not boolean.
	(gtk_notebook_find_child): don't always warn, we might be looking
	for a label or menu child.
	(gtk_notebook_map): fix mapping of panel.

	* gtk/gtkwidget.c (gtk_widget_set_child_visible): always constrain
	widget's mapped state, regardless of the value being set equals
	old settings, since things like REALIZED(parent) or MAPPED(parent)
	may have changed since the old value was set. make it an error to
	invoke this function on a toplevel widget.

2001-07-31  Darin Adler  <darin@bentspoon.com>

	* gdk/gdkprivate.h:
	* gdk/x11/gdkx.h:
	Put all mentions of GdkFont inside #ifndef GDK_DISABLE_DEPRECATED.

	* demos/gtk-demo/menus.c: (do_menus): Cast to G_OBJECT, not
	GTK_OBJECT.

Tue Jul 31 15:34:57 2001  Jonathan Blandford  <jrb@redhat.com>

	* gtk/gtktreeview.c (gtk_tree_view_remove_column): Whoops.  Stupid
	scoping error pointed out by matthiasc@poet.de.

2001-07-31  Sven Neumann  <sven@gimp.org>

	* demos/gtk-demo/appwindow.c
	* demos/gtk-demo/item_factory.c
	* tests/testgtk.c: gtk_accel_group_attach() takes a GObject.

Mon Jul 30 10:49:16 PDT 2001 Suresh Chandrasekharan <suresh.chandrasekharan@sun.com>

	* gtk/gtksignal.h (gtk_signal_handler_pending): corrected the wrong
	argument order for g_signal_has_handler_pending.

Sun Jul 29 17:14:01 2001  Tim Janik  <timj@gtk.org>

	* gtk/gtkitemfactory.c (gtk_item_factory_parse_rc): use g_file_test()
	instead of long deprecated g_scanner_stat_mode().

2001-07-29  Hans Breuer  <hans@breuer.org>

	* gdk/makefile.msc : build in the backend dir after
	auto-generating files

	* gdk/win32/gdkfont-win32.c (gdk_font_load) : reimplement
	with code from win32-production-branch.

	*  gdk/win32/gdkwindow-win32.c : set the private->destroyed flag
	before calling DestroyWindow, which indirectly calls 
	gdk_window_destroy_notify ()

	(performance patch merged from win32-production-branch)
	* gdk/win32/gdkdrawable-win32.c (gdk_win32_draw_segments): 
	Use PatBlt() instead of LineTo() when possible (solid single-pixel pen, 
	R2_COPYPEN rop). It is claimed to be much faster.

Fri Jul 27 11:31:15 2001  Jonathan Blandford  <jrb@redhat.com>

	* gtk/gtkcellrenderertext.c (gtk_cell_renderer_text_get_property):
	add an "attributes" property to the text renderer for ATK.

2001-07-26  Alex Larsson  <alexl@redhat.com>

	* gdk/linux-fb/gdkimage-fb.c (_gdk_fb_get_image):
	Initialize image->bits_per_pixel from the drawable, not from
	the root window.

	* gdk/linux-fb/gdkdrawable-fb2.c (gdk_fb_get_depth):
	Fix cast. argument is an IMPL already.

2001-07-15  James Henstridge  <james@daa.com.au>

	* gtk/gtkwindow.c (gtk_window_add_accel_group): cast to GObject.
	(gtk_window_remove_accel_group): same here.
	(gtk_window_key_press_event): same here.

	* gtk/gtkwidget.c (gtk_widget_add_accelerator): cast to GObject.
	(gtk_widget_remove_accelerator): same here.
	(gtk_widget_remove_accelerators): same here.

	* gtk/gtkplug.c (gtk_plug_accel_entries_changed): same here.

	* gtk/gtkmenushell.c (gtk_menu_shell_key_press): cast to GObject
	instead of GtkObject.

	* gtk/gtkmenu.c (gtk_menu_key_press): update since GtkAccelGroup
	now takes GObjects.

	* gtk/gtkitemfactory.c (gtk_item_factory_propagate_accelerator):
	pass a GObject to gtk_accel_group_entries_from_object.
	(gtk_item_factory_create_item): s/accel_widget/accel_object/

	* gtk/gtk-boxed.defs: remove GtkAccelGroup boxed def.

	* gtk/gtkaccellabel.c: convert to handle GObject accel objects.

	* gtk/gtkaccellabel.h: fix header to reflect that arbitrary
	GObjects can have accelerators set now.  Add compatibility
	defines.

	* gtk/gtkmarshal.list: add missing marshallers.

	* gtk/gtkaccelgroup.[ch]: convert to a GObject, and allow setting
	accelerators on plain GObjects.  gtk_accel_group_object_destroy
	has been converted into a weak reference, and
	gtk_accel_group_delete_entries is now a destroy notify for that
	piece of data.

2001-07-23  Ron Steinke  <rsteinke@w-link.net>

	* gdk/gdkdraw.c: Added a check on the colormap depth to
	gdk_drawable_set_colormap()
	* gdk/x11/gdkimage-x11.c: combination of Matthias Clasen's
	patch to fix colorsel and my patch to fix gdk_drawable_get_image()
	for pixmaps without visuals (more specifically, bitmaps)
	* gdk/x11/gdkpixmap-x11.c: Fixed gdk_pixmap_new() so it
	doesn't set a colormap with the wrong depth


2001-07-22  Anders Carlsson  <andersca@gnome.org>

	* gtk/gtktreeview.c (gtk_tree_view_class_init): Replace the
	expander_height and expander_width properties with a single
	property, expander_size.
	(gtk_tree_view_init): Set the tab_offset to expander_size
	plus some padding.
	(gtk_tree_view_unrealize): Remove the expand/collapse
	timeout if it exists.
	(coords_are_over_arrow): Fix a small bug.
	(gtk_tree_view_motion_draw_column_motion_arrow): Use
	expander_size.
	(gtk_tree_view_draw_focus): Use "treeview" instead of
	"add-mode" as detail when drawing the focus.
	(gtk_tree_view_bin_expose): Use "treeview-drop-indicator"
	instead of "add-mode" as detail when drawing the focus.
	(gtk_tree_view_deleted): If we have a node currently being
	expanded or collapsed, remove the timeout and set the node 
	to NULL.
	(gtk_tree_view_queue_draw_arrow): New function that just
	redraws the arrow of a node.
	(gtk_tree_view_draw_arrow): Use expander_size instead of
	expander_width/expander_height, also pass a different
	expander_style to gtk_paint_expander depending on the 
	state of the node being drawn.
	(expand_collapse_timeout): New function for expanding 
	or collapsing a node depending on the previous state.
	(gtk_tree_view_real_expand_row): Add timeout and set 
	correct state for node being expanded.
	(gtk_tree_view_real_collapse_row): Add timeout and set
	correct state for node being collapsed.

	* gtk/gtktreeprivate.h (struct _GtkTreeViewPrivate): Add
	information about the node currently being expanded or
	collapsed, and also a timeout id.

	* gtk/gtkstyle.h (struct _GtkStyleClass): Replace is_open
	with expander_style for draw_expander.

	* gtk/gtkstyle.c (gtk_draw_expander): Replace is_open with
	expander_style.
	(create_expander_affine): New function for creating an 
	expander affine.
	(apply_affine_on_point): New function for applying an 
	affine to a point.
	(gtk_default_draw_expander): Modified to take expander_style
	instead of is_open, and to draw the rectangle rotated differently
	depending on the expander style.
	(gtk_paint_expander): Replace is_open with expander_style.

	* gtk/gtkrbtree.h: Add expander states to GtkRBNodeColor.

	* gtk/gtkenums.h: Add expander style enum.

2001-07-21  Jonas Borgstrm  <jonas@codefactory.se>

	* gtk/gtktreemodel.c (gtk_tree_model_foreach): Check the return
	value from gtk_tree_model_get_iter, the model might be empty.

2001-07-20  Hans Breuer  <hans@breuer.org>

	* gdk/win32/gdkinput-win32.c : gdk_device_get_history moved to
	gdk/gdkinput.c like the other backends

	* gdk/win32/gdkinput-win32.h :
	* gdk/win32/gdkinput.c :
	* gdk/win32/gdkvisual-win32.c :
	* gdk/win32/gdkwin32.h : mechanical adaption to GdkDevice and
	GdkVisual GObjectification. UNTESTED for pen-devices because
	I simply have none.

	* gdk/gdk.def :
	* gtk/gtk.def : updated externals

	* gtk/gtkiconfactory.c :
	* gtk/gtkoldeditable.c : GError *error needs to be initialized (= NULL) 
	before passing &error to functions to avoid strange crashes
	
	* gtk/gtkcontainer.c (gtk_container_real_set_focus_child) : is static

	* gtk/gtkwidget.c (gtk_widget_get_child_visible): use g_return_val_if_fail

	* gtk/makefile.msc.in : updated

Thu Jul 19 15:35:32 2001  Owen Taylor  <otaylor@redhat.com>

	* gtk/gtkscrolledwindow.c (gtk_scrolled_window_set_vadjustment):
	Add property support. (#51858)

Thu Jul 19 14:56:33 2001  Owen Taylor  <otaylor@redhat.com>

	* gtk/gtkaccellabel.c (gtk_accel_label_class_init) 
	* gtk/gtkinputdialog.c (gtk_input_dialog_set_key):
	Use Shift/Ctrl instead of Shft/Ctl. (#53807)

Thu Jul 19 11:41:00 2001  Owen Taylor  <otaylor@redhat.com>

	* gtk/gtkcolorsel.c: Add propery support (roughly
	based on patch from Lee Mallabone, #51014)

	* gtk/gtkcolorsel.h: Mark gtk_color_selection_set_update_policy as
	deprecated, since we already g_warning() on it.

Thu Jul 19 14:24:34 2001  Owen Taylor  <otaylor@redhat.com>

	* gtk/gtkentry.c (gtk_entry_set_positions): Fix
	typo that sometimes caused selection not to work properly.

	* gtk/gtkentry.c (gtk_entry_grab_focus): Select text in
	entry when tabbing in. (#57743)
	
	* gtk/gtkentry.c (gtk_entry_motion_notify): If the
	user drags up above or down below the entry, move
	to the end or the beginning of the entry. (Suggestion
	from Jay Cox, #50940)

	* gtk/gtkentry.c (gtk_entry_move_cursor): If we have
	a current selection, then when moving by chars or
	words, move to the end of the selection rather than
	from entry->current_pos. (Suggestion from Jay Cox,
	#50942)
	
Thu Jul 19 12:14:28 2001  Owen Taylor  <otaylor@redhat.com>

	* gtk/gtkwindow.c (gtk_window_set_decorated): Actualy
	set window->decorated. (Patch from Hidetoshi Tajima,
	#55846)

Sat Jul  7 02:50:14 2001  Owen Taylor  <otaylor@redhat.com>

	* gtk/gtkwidget.c (gtk_widget_set_parent): Enforce
	the widget/child realization/mapping invariants.

	* gtk/gtkwidget.[ch] gtk/gtkprivate.h: Add functions 
	gtk_widget_[get/set]_child_visible() to control
	whether visible children of a mapped window are
	mapped.

	* docs/widget_system.txt: Updated for changes in
	container contract, and addition of GTK_CHILD_VISIBLE.

	* gtk/gtkcontainer.c: Add generic map()/unmap()
	functions that work for almost all containers.

	* gtk/gtknotebook.c gtk/gtkpacker.c: Use 
	gtk_widget_set_child_visible() where necessary.

	* gtk/*.c: Remove excess map(), unmap(), and 
	realization/mapping invariant enforcing code
	from many containers.

Wed Jul 18 19:51:45 2001  Owen Taylor  <otaylor@redhat.com>

	* gtk/gtktextview.c (gtk_text_view_set_attributes_from_style): 
	Get the foreground color from 'text', nor 'fg'. (#57568)

Wed Jul 18 19:28:46 2001  Owen Taylor  <otaylor@redhat.com>

	* gtk/*.c: Patch from Matthias Clasen to remove remove
	all instances of g_return_if_fail (foo != NULL); that are
	immediately before a g_return_if_fail (GTK_IS_FOO (foo));
	since the second check catches the NULL anyways.

Wed Jul 18 18:23:05 2001  Owen Taylor  <otaylor@redhat.com>

	* gtk/gtkbutton.c gtk/gtkentry.c gtk/gtkmenu.c gtk/gtktextview.c
	gtktreeview.c: Fix idles and timeouts to be properly surrounded by 
	GDK_THREADS_ENTER()/LEAVE() pairs.

	* gtk/gtkdialog.c gtk/gtkclipboard.c: Surround calls
	to g_main_loop_run() with GDK_THREADS_LEAVE()/ENTER()
	pairs. (Problem found by M. Meeks)

2001-07-18  Darin Adler  <darin@bentspoon.com>

	* gtk/gtkiconfactory.c: (gtk_icon_size_register): Reorder code so
	that we don't get a g_warning message every time we register a new
	icon size.

	* gdk/x11/gdkcolor-x11.c: (gdk_colormap_alloc1): Fix warning by
	using pixel variable of the correct type.
	
Fri Jul 13 15:33:32 2001  Owen Taylor  <otaylor@redhat.com>

	* gdk/gdkwindow.[ch]: Add a function gdk_window_get_internal_paint_info(),
	so that using X functions on a GdkWindow is possible, if
	a little hairy.

	* gdk/gdkgc.c (gdk_gc_offset): Add a function to offset the clip
	and ts_origin of a GC, so that external parties can offset/restore
	a GC, when using gdk_window_get_internal_paint_info().

2001-07-17  Darin Adler  <darin@bentspoon.com>

	* .cvsignore: Ignore the sgml directory made by gtkdoc.
	* demos/pixbuf-demo.c: (main): Use gtk_window_set_resizable
	instead of the deprecated gtk_window_set_policy.
	* demos/testpixbuf-scale.c: Add missing <stdlib.h> include.
	* gdk/gdkkeys.c: (gdk_keymap_class_init): Remove empty finalize
	function to get rid of warning and some code too.
	* gdk/x11/gdkfont-x11.c: (gdk_font_charset_for_locale): Add
	missing const.
	* gdk/x11/gdkmain-x11.c: (_gdk_windowing_init_check): Remove
	unused local.
	* gdk/x11/gdkpango-x11.c: (gdk_pango_context_get): Add missing
	const.
	* gdk/x11/gdkselection-x11.c: (gdk_text_property_to_utf8_list),
	(gdk_utf8_to_compound_text): Add missing const.
	* gtk/gtkimage.c: (gtk_image_expose): Remove unused local.
	* gtk/gtkmenubar.c: (gtk_menu_bar_hierarchy_changed): Add missing
	cast and get rid of an unnecessary one.
	* gtk/gtksettings.c: (gtk_settings_notify): Remove unused local.
	* gtk/gtkstatusbar.c: (gtk_statusbar_size_allocate): Remove unused
	local.
	* gtk/gtktreemodelsort.c: (gtk_tree_model_sort_build_level):
	Remove unused local.
	* modules/input/gtkimcontextxim.c: (gtk_im_context_xim_new): Add
	missing const.
	* tests/testsocket.c: (add_child): Add cast so the printf format
	doesn't make us implicitly depend on what integer type
	gtk_socket_get_id returns.
	* tests/testtextbuffer.c: Add missing const.
	* tests/testtreefocus.c: (main): Remove unused local.
	* tests/treestoretest.c: (iter_remove): Remove unused local.
	(uppercase_value): Remove unused function.
	(make_window): Add statement to quiet the compiler's uninitialized
	variable warning.

Sat Jul 14 12:47:35 2001  Tim Janik  <timj@gtk.org>

	* gtk/gtkrange.c:
	(second_timeout): 
	(initial_timeout): 
	(update_timeout): add GDK_THREADS_ENTER/GDK_THREADS_LEAVE.
	(gtk_range_calc_layout): compute the new layout based on an
	adjustment->value being passed in as argument.
	(gtk_range_button_press): for button2 slider warps, first recalc
	the layout, then adjust the value. also, use update_slider_position()
	for adjusting the value, so we keep pixel quantisation at which we
	usually operate (upon motion or button releases). the reason for this
	is that, we can't change the adjustment upon button2 presses to a non
	quantised value and upon button2 release re-quantise the value since
	that'd alter the value even if we didn't get any motion events (causing
	unexpected scroll area warps upon release and/or slider pixel-jitter).
	(gtk_range_motion_notify): update the slider position from queried
	coordinates, not event coordinates.

Fri Jul 13 09:47:52 2001  Tim Janik  <timj@gtk.org>

	* gtk/gtkstyle.c (gtk_default_draw_focus): fix line style resetting,
	the default gc values are: width=0, CapBut, JoinMiter.

2001-07-13  Anders Carlsson  <andersca@codefactory.se>

	* gtk/gtkcellrendererpixbuf.c (gtk_cell_renderer_pixbuf_render): Take
	into account the xpad and ypad when calculating the width and the
	height of the pixbuf cel.

Thu Jul 12 18:29:40 2001  Owen Taylor  <otaylor@redhat.com>

	* gtk/gtkradiomenuitem.[ch] (gtk_radio_menu_item_group): 
	Rename to gtk_radio_menu_item_get_group(), add deprecated
	alias. (#57044)

	* gtk/gtkfilesel.c: Indentation fix.

Thu Jul 12 17:33:00 2001  Owen Taylor  <otaylor@redhat.com>

	* gtk/gtkbbox.h gtk/gtkcompat.h: Patch from Mathias 
	Hasselmann to fix warnings in compat macros. 
	(#56773)

	* gtk/gtkmenubar.c (gtk_menu_bar_hierarchy_changed): Fix 
	stupid wrong cast added in last patch.

Thu Jul 12 16:51:34 2001  Owen Taylor  <otaylor@redhat.com>

	* gtk/gtkwidget.c: Replace a couple of inappropriate calls to 
	GTK_WIDGET_HAS_FOCUS() with gtk_widget_is_focus(). (#57067)

Thu Jul 12 14:06:19 2001  Owen Taylor  <otaylor@redhat.com>

	* gtk/gtkmenubar.c (gtk_menu_bar_hierarchy_changed): Add
	missing cast.

	* gtk/gtkcontainer.c (gtk_container_get_focus_chain): Fix
	NULL/FALSE return value confusion.

	* gtk/gtkrange.c (coord_to_value): Fix division-by-zero
	problem when scrollbar completely fills range. (Patch
	from  Matthias Clasen, #57047)

Thu Jul 12 13:53:28 2001  Owen Taylor  <otaylor@redhat.com>

	* gdk/x11/gdkevents-x11.c (gdk_event_translate): Properly
	clean up when handling events for move-resize emulation.
	(Problem traced down by Matthias Clasen, #57271)

Thu Jul 12 13:43:27 2001  Owen Taylor  <otaylor@redhat.com>

	* gtk/gtkclist.c gtk/gtkcolorsel.c gtk/gtkcombo.c
	  gtk/gtkctree.c gtk/gtkcurve.c gtk/gtkentry.c
	  gtk/gtkfontsel.c gtk/gtkhandlebox.c 
	  gtk/gtkimcontextsimple.c gtk/gtkmain.c gtk/gtkmenu.c
	  gtk/gtkmenuitem.c gtk/gtkoptionmenu.c gtk/gtkpixmap.c
	  gtk/gtkselection.c gtk/gtktextdisplay.c gtk/gtktextview.c
	  gtk/gtktooltips.c gtk/gtkwidget.c gtk/gtkwindow.c:
	Formatting fixes from multihead brnach. [ mostly foo(bar) => foo (bar) ]

2001-07-09  Peter Williams  <peterw@ximian.com>

	* gtk/Makefile.am ($(srcdir)/stamp-gtk.defs): Add a cd $(srcdir)
	for when srcdir != builddir

Mon Jul  9 12:50:51 2001  Jonathan Blandford  <jrb@redhat.com>

	* gtk/gtktreemodel.c: remove gtk_tree_model_get_first in favor of
	gtk_tree_model_get_iter_root.

	* gtk/gtkliststore.c: Add a bunch of g_return statements.
	(gtk_list_store_iter_n_children): Fix up.

	* gtk/gtktreestore.c: Add a bunch of g_return statements.

Fri Jul  6 15:38:33 2001  Owen Taylor  <otaylor@redhat.com>

	* gtk/gtkwidget.c (gtk_widget_class_init):
	G_SIGNAL_TYPE_STATIC_SCOPE GtkSelectionData to
	restore some workingness.

	* gdk/x11/gdkwindow-x11.c (gdk_window_new): Fix 
	handle of window type for input-only windows.

Thu Jul  5 21:53:46 2001  Owen Taylor  <otaylor@redhat.com>

	* gtk/gtkbbox.[ch] gtk/gtkbox.[ch] gtk/gtk[hv]bbox.c:
	Patch from Gregory Merchan to add 
	gtk_button_box_set_secondary(), which separates
	the child into a separate group from the normal
	buttons. (#56331)

	* gtk/gtkdialog.c: Make help buttons secondary by
	default.

	* gtk/gtkbbox.c: Added a child property "secondary".

	* gtk/testgtk.c: Turn on the help button for the 
	color selector to check that it properly appears
	as secondary.

Mon Jul  2 01:09:37 2001  Owen Taylor  <otaylor@redhat.com>
 
 	* gdk/gdkwindow.[ch] gdk/gdkinternals.h gdk/x11/gdkwindow-x11.c
 	gdk/linux-fb/gdkwindow-fb.c gdk/x11/gdkwindow-x11.c gdk/gdk:
 	Add gdk_set_pointer_hooks() to allow pointer-querying to
 	be hooked by an event record/playback system like GERD.
	(#56914)
 	
Thu Jul  5 08:57:07 2001  Owen Taylor  <otaylor@redhat.com>

	* gtk/gtkwidget.c (gtk_widget_reset_rc_style): Pass
	in the right value of initial_emission to
	gtk_widget_set_style_internal (#57091)

Wed Jul  4 23:17:04 2001  Owen Taylor  <otaylor@redhat.com>

	* gtk/gtkdnd.c (gtk_drag_dest_hierarchy_changed):
	Make compile.

	* gtk/gtkwidget.c (gtk_widget_reset_rc_style): Fix problem
	with calling gtk_widget_set_style_internal() with
	the old style, not the new style. (#56989)

Wed Jul  4 22:35:40 2001  Owen Taylor  <otaylor@redhat.com>

	* gtk/gtklabel.c gtk/gtkmenubar.c gtk/gtktreeviewcolumn.c
	  gtk/gtkwidget.c:
	Check GTK_WIDGET_TOPLEVEL(gtk_widget_get_toplevel (widget)),
	not GTK_WIDGET_GET_ANCESTOR ... see 
	http://mail.gnome.org/archives/gtk-devel-list/2001-July/msg00072.html.
	Indicate the best practice in the docs for gtk_widget_get_toplevel().

	* gtk/gtkwidget.[ch]: Expose a private _gtk_widget_hierarchy_changed(),
	so GtkPlug can give the correct signals when transforming
	from a child to a toplevel.
	
	* gtk/gtkdnd.c (gtk_drag_dest_hierarchy_changed): Handle
	reparentation correctly.

	* gtk/gtkwidget.c (gtk_widget_propagate_hierarchy_changed):
	Propagate the previous_toplevel argument down properly.

	* gtk/gtklabel.c (gtk_label_finalize): Fix unrefing
	of wrong atr list.

	* gtk/gtkplug.[ch]: Add an "embedded" signal.

	* gtk/gtksocket.[ch]: Add "child_added", "child_removed"
	signals.

	* gtk/gtkplug.[ch] gtk/gtksocket.[ch]: Add 
	functions gtk_plug_get_id(), gtk_socket_get_id(),
	to avoid the user having to worry about realization,
	and gdkx.h.

	* tests/testsocket.c: Extend to try out the new signals
	and gtk_plug/socket_get_id().

	* gtk/gtklabel.c (gtk_label_set_pattern_internal): Fix
	setting of underline attributes.

	* gdk/x11/gdkevents-x11.c (gdk_event_translate): Ignore
	DestroyNotify events from SubstructureNotifyMask

	* gdk/x11/gdkwindow-x11.c (gdk_window_reparent):
	Switch GDK_WINDOW_TYPE (window) as needed.

	* gdk/x11/gdkwindow-x11.c (gdk_window_new): Clean up,
	allow creation of toplevel windows as children of
	foreign windows.

	* gtk/gtkplug.c: Remove hacks involving changing private
	fields of GdkWindow.

	* gtk/gtkplug.[ch] gtk/gtksocket.c: Work to make 
	exactly the same signals and notification
	be emitted for local embedding as for inter-process
	embedding.

2001-07-04  James Henstridge  <james@daa.com.au>

	* gtk/gtkliststore.h: add missing gtk_list_store_newv prototype.

Mon Jul  2 16:53:25 2001  Owen Taylor  <otaylor@redhat.com>

	* gtk/xembed.h gtk/gtkplug.c gtk/gtksocket.c: For
	XEMBED embedding add a _XEMBED_INFO property to the
	client with version number and a "mapped" flags.
	Use the mapped flag instead of the racy MapRequestEvent

        * gtk/gtksocket.c: Clean up the gtk_socket_steal()
	code to reliably set things (when the child is a passive
	embedder participating in the XEMBED protocol) intead
	of just being a hack for embedding non-participating
	programs. Fix various bugs and race conditions.
	
	* gtk/gtksocket.[ch] gtk/gtkplug.[ch]: Make local embedding
	work by simply making the GtkSocket the gtk parent
	of the GtkPlug. Set a flag in this case and make
	the GtkPlug work like a normal container by overriding
	methods such as check_resize and "chaining past" GtkWindow
	to GtkBin.

 	* gtk/gtkentry.c (gtk_entry_real_activate)
	  gtk/gtkmain.c (gtk_propagate_event): 
 	Eliminate use of gtk_widget_get_ancestor (widget, GTK_TYPE_WINDOW).
	
	* gtk/gtkwidget.c (gtk_widget_get_toplevel,
	gtk_widget_get_ancestor):
	Explain	why gtk_widget_get_ancestor (widget, GTK_TYPE_WINDOW)
	might not give the expected result and recommend
	an alternative.

	* tests/testsocket.c tests/testsocket_child.c
	tests/testsocket_common.c tests/Makefile.am: Extended
	to test different type of adding plugs to sockets
	(local,active,passive),	and to test mapping/unmapping
	the plug.

 	* gdk/gdkwindow.c (_gdk_window_destroy_hierarchy): Don't
 	mark the window as destroyed until after we
 	called _gdk_windowing_window_destroy().
	(_gdk_windowing_window_destroy() may use GDK functions
	on the window.)

 	* gdk/x11/gdkinput.c: Remove the check for finalization - 
 	devices can be finalized under some circumnstances.
 
 	* gdk/x11/gdkinput-x11.c (gdk_input_device_new): Fix 
 	small problem with GDK_TYPE_DEVICE.
 
2001-07-02  Havoc Pennington  <hp@pobox.com>

	* gdk/x11/gdkwindow-x11.c (gdk_wmspec_change_state): fix to 
	use constants not atoms.

2001-07-02  James Henstridge  <james@daa.com.au>

	* gtk/gtktextview.c (gtk_text_view_class_init): same here for
	PANGO_TYPE_TAB_ARRAY.

	* gtk/gtktexttag.c (gtk_text_tag_class_init): same here, but also
	for PANGO_TYPE_TAB_ARRAY.

	* gtk/gtkcellrenderertext.c (gtk_cell_renderer_text_class_init):
	s/GTK_TYPE_PANGO_FONT_DESCRIPTION/PANGO_TYPE_FONT_DESCRIPTION/

	* gtk/gtk-boxed.defs: move all the boxed definitions to the top of
	the file.  Remove Pango types from defs -- they are now defined in
	libpango.

Mon Jul  2 06:35:10 2001  Tim Janik  <timj@gtk.org>

	* gdk/gdkkeys.c (gdk_keymap_class_init): s/signal_newc/signal_new/

	* gtk/gtkobject.c (gtk_object_destroy): invoke
	g_object_run_dispose().

	* gtk/gtkwindow.c: 
	* gtk/gtkwidget.c: 
	* gtk/gtkobject.c:
	* gtk/gtklist.c: s/shutdown/dispose/ for the GObject
	method.

Sat Jun 30 20:44:48 2001  Owen Taylor  <otaylor@redhat.com>

	* gtk/gtktypeutils.c (gtk_type_class): Remove
	change check for GTK_TYPE_OBJECT derivation to
	G_TYPE_OBJECTS - it's Tim-approved to use this 
	for arbitary objects.

	* gtk/gtkwindow.c gtk/gtkcontainer.[ch]: underscore
	prefix gtk_container_dequeue_resize_handler().

	* gtk/gtkwidget.[ch]: Add a previous_toplevel argument
	to the hierarachy_changed signal, since you otherwise
	have to always keep that around.

	* gtk/gtkmenubar.c gtk/gtklabel.c gtk/gtksocket.c: Adapt
	for extra argument to hierarchy_changed.

Tue Jun 26 19:39:03 2001  Owen Taylor  <otaylor@redhat.com>

	* gtk/gtkwidget.c (gtk_widget_set_style): Allow %NULL
	for style to mean "revert to default style"

	* gtk/gtkwidget.[ch] (gtk_widget_set_rc_style,
	  gtk_widget_restore_default_style): Make this functions
	deprecated aliases for gtk_widget_set_style (widget, NULL).

	* gtk/gtkwidget.[ch]: Remove:
	   gtk_widget_set_default_style ()
	   gtk_widget_push_style ()
	   gtk_widget_pop_style ()
	These functions interact are overriden by RC files, and
	thus virtually useless, and complicated.

Fri Jun 22 18:49:48 2001  Owen Taylor  <otaylor@redhat.com>

        * gtk/gtkrc.c: Add a GtkRcContext structure to hold 
	most of the previous global variables in gtkrc.c. This is
	in preparation for multi-head, since each screen can
	have different GtkSettings and RC information.

	* gtk/gtkrc.[ch]: 

	* gtk/gtkrc.h (struct _GtkRcStyleClass): Add a
	GtkSettings parameter to GtkRcStyle::parse.

	* gdk/x11/gdkevents-x11.c gtk/gtksettings.c gtk/gtkrc.c: 
	Add two new settings gtk-theme-name, gtk-key-theme-name,
	for RC files that are loaded by name after reading
	the default RC files.
	
	* gtk/gtkrc.c: Allow priorities for styles, as wll as
	bindings.

	* gtk/gtkenums.h gtk/gtkrc.c: Add GTK_PATH_PRIO_THEME,
	and use it by default for RC files loaded via 
	gtk-theme-name, gtk-key-theme-name.

	* gtk/gtkiconfactory.c (gtk_icon_source_set_filename)
        gtk/gtkrc.c (gtk_rc_parse_pixmap_path_string) 
	tests/testgtkrc: Require pathnames to be absolute.

	* gtk/gtkrc.c gtk/gtkiconfactory.c: Look up the full filename for
	the source when parsing, since the operation of looking up a
	pixmap from an RC file depends on the parsing context.

	* gtk/gtkrc.c (gtk_rc_context_reparse_all): Automatically
	reset RC styles on all widgets when files are reparsed.

	* tests/testgtk.c (create_rc_file) 
	  gtk/gtkwindow.c (gtk_window_read_rcfiles): 
	Simplify, now that gtk_rc_reparse_all() resets styles on
	all widgets itself.

	* gtk/gtkmain.c (gtk_get_default_language): Fix broken
	return value.

	* gtk/gtksettings.[ch] (gtk_settings_install_property[_ch]): Remove
	GtkSettings argument.

	* gtk/gtksettings.[ch] (gtk_settings_get_default): Rename from
	gtk_settings_get_global().

	* gtk/gtkwidget.[ch]: Add a function gtk_widget_Get_settings()
	to get the appropriate GtkSettings for a widget. (For now,
	just gets the default GtkSetttings.) 

	* gtk/gtkcolorsel.c gtk/gtkentry.c gtk/gtkmenu.c gtk/gtkmenubar.c
	  gtk/gtktextview.c gtk/gtktoolbar.c: Fixes for GtkSettings
        changes.

	* gtk/gtkrc.[ch]: Add gtk_rc_get_style_by_paths() to allow
	getting a style for a path without actually having a widget.
	(Allows using a style for a subpart of a widget, for
	example.)

	* gtk/gtkrc.[ch]: Add gtk_rc_reparse_all_for_setting() to allow forcing
	the RC files to be reloaded for just one GtkSettings
	(not sure how useful this really is.)

	* gtk/gtkrc.h: Deprecate
	gtk_rc_add_widget_name/widget_class/class_style

2001-06-30  Alex Larsson  <alexl@redhat.com>

	* gdk/linux-fb/gdkinput-none.c:
	* gdk/linux-fb/gdkinput.c:
	* gdk/linux-fb/gdkinputprivate.h:
	Convert GdkDevice to a GObject.

	* linux-fb/gdkprivate-fb.h:
	* linux-fb/gdkvisual-fb.c:
	Convert GdkVisual to a GObject.

2001-06-29  Alex Larsson  <alexl@redhat.com>

	* gdk/gdkvisual.h:
	* gdk/gdkcolor.c:
	* gdk/x11/gdkx.h:
	* gdk/x11/gdkvisual-x11.c:
	Convert GdkVisual to a GObject.

	* gdk/gdkinput.h:
	* gdk/gdkevents.c:
	* gdk/x11/gdkinputprivate.h:
	* gdk/x11/gdkinput-gxi.c:
	* gdk/x11/gdkinput-none.c:
	* gdk/x11/gdkinput-x11.c:
	* gdk/x11/gdkinput-xfree.c:
	* gdk/x11/gdkinput.c:
	Convert GdkDevice to a GObject.

Fri Jun 29 22:13:28 2001  Jonathan Blandford  <jrb@redhat.com>

	* gtk/gtktreestore.c (gtk_tree_store_new): changed new_with_types
	to just plain new, fixing the number of columns, and column types
	at creation time.

	* gtk/gtkliststore.c (gtk_list_store_new): ditto.

	* gtk/gtkcellrenderertext.c
	(gtk_cell_renderer_text_set_fixed_height_from_font): FIX the
	height to a specific font.

	* gtk/gtktreeview.c (gtk_tree_view_is_expander_column): fix brokenness.

	* tests/*c: change to work with new store models.

2001-06-29  Havoc Pennington  <hp@redhat.com>

       * Throughout: fixes to compile with G_DISABLE_COMPAT
	(s/g_signal_connectc/g_signal_connect/,
	s/g_signal_newc/g_signal_new/,
	s/g_signal_disconnect_by_func/g_signal_handlers_disconnect_by_func/)

Fri Jun 29 03:14:16 2001  Jonathan Blandford  <jrb@redhat.com>

	* gtk/gtktreeselection.c (gtk_tree_selection_selected_foreach):
	add path argument to selection callbacks.

Fri Jun 29 00:13:34 2001  Jonathan Blandford  <jrb@redhat.com>

	* gtk/gtktreemodel.c (gtk_tree_model_foreach): New function to
	walk through a model in a depth first manner, with the option to
	break out.

Fri Jun  8 18:52:10 2001  Jonathan Blandford  <jrb@redhat.com>

	* gtk/gtktreeview.[hc]: Patch Thomas Broyer from
	<tbroyer@ltgt.net>. Expander arrows are now attached to a specific
	column and follow it when draged, rather than a location in the
	view. "expander_column" property and drawing functions changed
	accordingly.  Fixes bug #55942.

	(gtk_tree_view_{set,get}_expander_column): Now works with a
	GtkTreeViewColumn* instead of int.

Thu Jun 28 22:53:18 2001  Owen Taylor  <otaylor@redhat.com>

	*  gdk/gdk.c gtk/gtktypeutils.c: Fix args to g_type_init(). 

2001-06-28  Havoc Pennington  <hp@pobox.com>

	* gdk/x11/gdkimage-x11.c (_gdk_x11_get_image): Clip the retrieved
	image data to the screen, using a server grab to avoid race
	conditions.

	* gtk/gtkitemfactory.c (gtk_item_factory_create_item): remove 
	check for NULL return from gtk_image_new_from_stock(), it never
	returns NULL.
	(gtk_item_factory_create_item): fix bug where we parsed the stock
	ID as an inline pixbuf

	* gtk/gtktext.c (gtk_text_key_press): numeric keypad support

	* gtk/gtkspinbutton.c (gtk_spin_button_key_press): numeric keypad
	support (should be using binding set here)

	* gtk/gtkoptionmenu.c (gtk_option_menu_key_press): numeric keypad
	support (should be using binding set here)

	* gtk/gtkmenushell.c (gtk_menu_shell_class_init): numeric keypad 
	support

	* gtk/gtkmenu.c (gtk_menu_class_init): numeric keypad support

	* gtk/gtkmenubar.c (gtk_menu_bar_class_init): numeric keypad

	* gtk/gtklistitem.c (gtk_list_item_class_init): numeric keypad

	* gtk/gtkimcontextsimple.c
	(gtk_im_context_simple_filter_keypress): keypad

	* gtk/gtkfilesel.c (gtk_file_selection_key_press): keypad 

	* gtk/gtkentry.c (gtk_entry_class_init): numeric keypad fixes

	* gtk/gtkctree.c (gtk_ctree_class_init): numeric keypad support

	* gtk/gtkcolorsel.c (palette_activate): keypad support (of course,
	should be binding-setted)

	* gtk/gtkwindow.c (gtk_window_class_init): numeric keypad fixes

	* gtk/gtkclist.c (gtk_clist_class_init): numeric keypad fixes

	* gtk/gtkcalendar.c: numeric keypad fixes

	* gtk/gtktextview.c (gtk_text_view_class_init): numeric keypad
	support

	* gdk/gdkwindow.c (gdk_window_get_clip_region): fix infinite loop
	screwup

	* gdk/gdkpixbuf-render.c (gdk_pixbuf_render_to_drawable_alpha): 
	clip the render area to the drawable's clip region in advance,
	so we don't get data from the server that we don't need.

	* gdk/gdkpixbuf-render.c (gdk_pixbuf_render_to_drawable_alpha):
	check return value of gdk_pixbuf_get_from_drawable(), fall back 
	to bilevel alpha if we can't get the pixbuf to composite against.

	* gdk/gdkdraw.c (gdk_drawable_get_image): set the image colormap

	* gdk/gdkimage.c (gdk_image_get_colormap): add
	gdk_image_set_colormap, gdk_image_get_colormap

	* gdk/gdkpixbuf-drawable.c (rgbconvert): Change all converters to
	take a region of the image, instead of converting the entire
	image.

	* gtk/gtkwidget.h (struct _GtkWidgetClass): add show_help
	keybinding signal. Add default bindings for it. Add default
	handler for show_help that shows the tooltip for the widget.

	* gtk/gtkdialog.c (gtk_dialog_class_init): add binding set and
	"close" keybinding signal, remove key press handler.

	* gtk/gtktooltips.c (gtk_tooltips_set_colors): Just remove this,
	it's not our usual practice to leave a deprecated function around
	with a runtime warning, plus we don't want it to appear in docs,
	plus if we make them yellow no one will want to change them
	anyhow.

Thu Jun 28 23:53:31 2001  Tim Janik  <timj@gtk.org>

	* gtk/gtkwidget.c (gtk_widget_hide): !GTK_OBJECT_DESTROYED() ->
	GTK_WIDGET_REALIZE() for resize queueing.

	* gtk/gtkmain.c (gtk_main_do_event): !GTK_OBJECT_DESTROYED() ->
	GTK_WIDGET_REALIZE() for post event delivery destruction upon
	GDK_DESTROY.
	
	* gtk/gtkwidget.c: added GtkWidget::event-after notification signal, to
	sompensate for former (pre-2.0) connect_after() facility.
	(gtk_widget_send_expose): 
	(gtk_widget_event): assert the widget is realized, since event delivery
	to non-realized widgets is essentially a bug. event handlers should
	be able to unconditionally rely on widget->window (unless they
	emit events on their own which can trigger widget destruction).
	(gtk_widget_event_internal): removed old outdated GTK_OBJECT_DESTROYED()
	logic. event delivery happens as follows:
	a) emission of GtkWidget::event (RUN_LAST handler). returns was_handled.
	b) if !was_handled in (a) and the widget is still realized, emit event-
	   specific signal (RUN_LAST handler). returns was_handled.
	c) emission of GtkWidget::event-after for notification if the widget is
	   still realized (regardless of was_handled from previous stages, no
	   class handler). no return value.
	d) was_handled gets passed on to caller, to determine further
	   propagation. if the widget got unrealized meanwhile, was_handled
	   is returned as TRUE.

	* gdk/gdkevents.[hc]: added gdk_event_get_root_coords() and
	gdk_event_get_coords().

Thu Jun 28 17:18:41 2001  Tim Janik  <timj@gtk.org>

	* configure.in (GTK_MICRO_VERSION): up version to 1.3.7, interface
	age 0, binary age 0. depend on glib 1.3.7.

	* gtk/gtkcontainer.c: remove g_signal_handlers_disconnect_by_func() hack.

	* gtk/gtkmenubar.c: same here.
	
	* gtk/gtkcontainer.c (gtk_container_focus_tab): fix param-spec retrival.

	* gtk/gtkcolorsel.c (gtk_color_selection_init): fix connect_data() usage.

	* gtk/gtkentry.c (gtk_entry_focus_in): same here.
	
	* gtk/gtkmenubar.c (add_to_window): likewise.
	
	* gtk/gtktextbtree.c: and here...
	
	* gtk/gtktextview.c (gtk_text_view_ensure_layout): same thing.
	
	* gtk/gtktoolbar.c (gtk_toolbar_init): once more.
	
	* gtk/gtktreemodel.c (connect_ref_callbacks): and another time.
	
	* gtk/gtktreeviewcolumn.c:
	(_gtk_tree_view_column_set_tree_view): yet again.

	* demos/gtk-demo/images.c (progressive_timeout): demonstrate
	signal connections without g_signal_connect_data().
	
	* demos/gtk-demo/stock_browser.c (do_stock_browser): second
	demo of the matter.
	
	* demos/testpixbuf.c (main): running out of equality phrases for the
	ChangeLog, but had to adapt connections here as well.
	
	* demos/testanimation.c (progressive_timeout): and for the fun of it,
	tackled this the same way.
	
	* tests/testtext.c (create_view): ok, it's becoming a pain at this
	point, but had enough enery for one more fix.

	* tests/testtreecolumns.c (main): stand up man, do your work!

	* tests/testtreeview.c (set_columns_type): ok, this is the last file i
	fix, either that's been all of it or CVS gtk is broken yet again.
	
2001-06-29  James Henstridge  <james@daa.com.au>

	The following changes correspond to bug #56812

	* gdk/gdkinput.h, gdk/gdkevents.c (GDK_TYPE_DEVICE): register type
	code for GdkDevice.

	* gdk/gdkcursor.[ch] (GDK_TYPE_CURSOR): register type code for
	GdkCursor.

2001-06-19  Havoc Pennington  <hp@pobox.com>

	* gdk/x11/gdkwindow-x11.c (gdk_window_show_unraised): new function
	for mapping a window without fooling with stacking order, but
	updating the "withdrawn" flag

	* gdk/x11/gdkevents-x11.c (gdk_event_translate): Do event
	filtering as soon as possible, moving move resize and wmspec_check
	handling after the event filter.  Make default filter apply to all
	events, not just those with no GdkWindow wrapped around the X
	window. Fix a FIXME about how the window could be a pixmap using 
	RTTI; this of course assumes GDK_IS_WINDOW() is optimized. 

	Also, be robust against events not on a known GdkWindow.

	* gdk/x11/gdkmain-x11.c (gdk_x11_grab_server,
	gdk_x11_ungrab_server): export reference-counted server grabs, so
	other people can grab server over a GDK function that also does
	so.

Wed Jun 27 19:40:31 2001  Jonathan Blandford  <jrb@redhat.com>

	* gtk/gtktreeviewcolumn.c
	(gtk_tree_view_column_pack_start_cell_renderer): New function to
	reflect that you can (hypothetically) pack cell renderers into a
	column.
	(gtk_tree_view_column_pack_end_cell_renderer): ditto.
	(gtk_tree_view_column_cell_is_visible): Move more functionality to
	the column.
	(gtk_tree_view_column_cell_can_focus): Move more functionality to
	the column.

	* gtk/gtktreeview.c: Move to use new column-packing code.
	(gtk_tree_view_real_expand_row): remove	totally braindead code.
	(gtk_tree_view_real_collapse_row): ditto.

2001-06-27  Kjartan Maraas  <kmaraas@gnome.org>

	* gtk/gtktreeviewcolumn.c: Fix a typo.
	
2001-06-26  Joel Becker  <jlbec@evilplan.org>

	* gdk-pixbuf/gdk-pixbuf-csource.c: remove '#include "x"' line
	  at the end of the file

2001-06-26  Havoc Pennington  <hp@redhat.com>

	* gtk/gtkwindow.c (gtk_window_set_policy): forgot a notification

2001-06-26  Havoc Pennington  <hp@redhat.com>

	* gtk/gtkwindow.c (gtk_window_class_init): add "resizable"
	property

Tue Jun 26 12:59:28 2001  Jonathan Blandford  <jrb@redhat.com>

	* gtk/gtktreemodelsort.c (gtk_tree_model_sort_set_model): fix
	stupid missing statement

	* gtk/gtktreeview.c (gtk_tree_view_set_destroy_count_func): New
	private function for ATK.  It notifies you of how many _visible_
	children are deleted when a node is deleted.  Should be used by
	atk only.

Tue Jun 26 11:06:34 2001  Owen Taylor  <otaylor@redhat.com>

	* gtk/gtkclist.c gtk/gtkentry.c gtk/gtkspinbutton.c:
	Use new pango_context_get_metrics() to fix problems
	with font lists in descriptions. (#56184, reported by
	Jonas Borgstrm)

Tue Jun 26 10:04:30 2001  Tim Janik  <timj@gtk.org>

	* gtk/gtkiconfactory.c:
	* gtk/gtkitemfactory.c: use gdk_pixbuf_new_from_stream(). fixed up
	item factory so inlined pixbufs actually work.

2001-06-25  Havoc Pennington  <hp@redhat.com>

	* gtk/gtktreeviewcolumn.h, gtk/gtktreeviewcolumn.c:
	s/RESIZEABLE/RESIZABLE/

	* gtk/gtkwindow.c, gtk/gtkwindow.h: s/resizeable/resizable/

2001-06-25  Alexander Larsson  <alexl@redhat.com>

	* configure.in:
	Added --enable-fbmanager. This is some experimental code
	that lets several GtkFB apps coordinate their access to the
	framebuffer.
	
	* acconfig.h:
	Added ENABLE_FB_MANAGER.

	* gdk/linux-fb/Makefile.am:
	Added gdkfbmanager and gdkfbswitch.

	* gdk/linux-fb/gdkkeyboard-fb.c:
	* gdk/linux-fb/gdkmouse-fb.c:
	* gdk/linux-fb/gdkprivate-fb.h:
	Split device init and open so that
	they can be opened and closed while switched
	away.

	* gdk/linux-fb/gdkmain-fb.c:
	Add the basic manager communication.

	* gdk/linux-fb/gdkrender-fb.c:
	Don't update to the shadow fb if we're
	blocked by the fb manager.

Sun Jun 24 22:15:16 2001  Owen Taylor  <otaylor@redhat.com>

	* docs/Changes-2.0.txt: Add note about child property
	changes.

Sun Jun 24 21:34:32 2001  Owen Taylor  <otaylor@redhat.com>

	* gtk/gtkenums.h gtk/gtkiconfactory.c: Add a special size for
	drag-and-drop GTK_ICON_SIZE_DND (Default to 32x32)

	* gtk/gtkdnd.c (gtk_drag_dest_set_target_list): Fix problem
	with un'reffing wrong list reported by Jeff Franks.

	* gtk/gtkdnd.[ch] (_gtk_drag_{source,}dest_handle_event): _prefix.

	* gtk/gtkdnd.c (gtk_drag_set_icon_default): Use GTK_STOCK_DND
	for the default icon. Remove inline XPM.

	* gtk/gtkstock.h gtk/gtkiconfactory.c:
	Add GTK_STOCK_DND GTK_STOCK_DND_MULTIPLE (Currently, stock_new
	is used for GTK_STOCK_DND, but it is a bit too small.)

	* gtk/stock-icons/stock_dnd_multiple.png
	gtk/stock-icons/Makefile.am: New stock icon moved from gnome-libs.

	* gtk/gtkdnd.c (gtk_drag_source_event_cb): Only return
	TRUE when starting a drag. In other cases, we are
	just observing. (#52995)

	* gtk/gtkdnd.[ch] (gtk_drag_set_icon_{stock,pixbuf}): Add 
	function to set the icon for a drag from a GdkPixbuf
	or stock ID.

	* gtk/gtkdnd.[ch] (gtk_drag_source_set_icon_{stock,pixbuf}): 
	Likewise, for drag sources.

	* gtk/gtkdnd.h: Deprecate gtk_drag_set_default_icon.
	(Now should be done using the stock system.)

Sun Jun 24 12:06:47 2001  Owen Taylor  <otaylor@redhat.com>

	* gtk/gtktextview.[ch] (gtk_text_view_set_text_window_size): 
	Removed - didn't work and not particularly useful anyways
	if it did. 

Sun Jun 24 11:29:35 2001  Owen Taylor  <otaylor@redhat.com>

	* gdk/x11/gdkimage-x11.c (gdk_image_new): Fix stupid error
	introduced last night that was making things decidedly not work.

	* gtk/*.[ch]: Patch from Kristian Rietveld adding 80 getters
	so that we have getter/setter pairing everywhere it makes
	sense. (#55767)

	* gtk/gtkradiobutton.[ch] gtk/gtktoolbar.c tests/testgtk.:
	Rename gtk_radio_button_group to gtk_radio_button_get_group, add a
	deprecated compat macro. (#55516)

	* gtk/gtklabel.[ch]: Add functions
	gtk_label_set/get_use_underline(), gtk_label_set/get_use_markup(),
	gtk_label_set_label(), which mirror the property API for GtkLabel.
	Make gtk_label_get_attributes() only reflect the attributes
	set by gtk_label_set_attributes.

	* gtk/gtknotebook.c (gtk_notebook_set_current_page) gtk/gtkcompat.h: Rename
	from gtk_notebook_set_page().

Sat Jun 23 18:02:46 2001  Owen Taylor  <otaylor@redhat.com>

	* configure.in: Fix tests for XShm.h.

	* gdk/x11/gdkimage-x11.c: Cleanup error handling in
	gdk_image_new() by use of goto, properly use g_object_unref().

Sat Jun 23 22:03:20 2001  Tim Janik  <timj@gtk.org>

	* gdk/x11/gdkimage-x11.c (gdk_image_init): disabled g_free (image)
	calls, as GdkImage is an object. these should be g_obejct_unref()
	instead but that won't work because of the g_error() statement
	in gdk_x11_image_destroy(). so for now, i did s/g_free/LEAK_IMAGE/
	to spot these places.

Sat Jun 23 10:27:53 2001  Owen Taylor  <otaylor@redhat.com>

	* modules/input/gtkimcontextxim.c: Fixup some problems with 
	text length handling in error cases.

	* gtk/gtkwidget.c (gtk_widget_size_allocate): Reorder
	a bit to make test actually warn on attempt to allocation
	a negative size. (#56101, Matthias Clasen)

Fri Jun 22 14:06:08 2001  Jonathan Blandford  <jrb@redhat.com>

	* gtk/gtktreeview.c (gtk_tree_view_real_collapse_row): Fix bug
	noticed by Brian Cameron.
	(gtk_tree_view_real_expand_row): Fix bug noticed by Brian
	Cameron.

2001-06-22  Hans Breuer  <hans@breuer.org>

	* gdk/gdk.def : updated externals

	* gdk/win32/gdkdrawable-win32.c : corrected some casts
	in GDK_NOTEs

	* gdk/win32/gdkevents-win32.c : use _gdk_windowing_window_get_offsets
	to translate coordinates to the internal > 16 bit system
	Try to handle WM_WINDOWPOSCHANGED to get better performance for
	when moving/resizing

	* gdk/win32/gdkkeys-win32.c : implement gdk_keymap_get_default ()
	and gdk_keymap_get_direction (). The latter is untested for
	the RTL case

	* gtk/gtk.def : updated externals

	* gtk/gtkmain.c : gtk_get_default_language () should reurn the result
	from pango_language_from_string (), not an already freed pointer

	* gtk/stock-icons/stock_menu_sort_ascending.png : PNGs need to be 
	binary (-kb) to be useable on windoze
 
2001-06-21  Alexander Larsson  <alexl@redhat.com>

	* gdk/linux-fb/gdkfont-fb.c (gdk_font_from_description): 
	Update to new PangoLanguage changes.
	
	* gtk/gtkwindow-decorate.c:
	* gtk/gtkwindow.[ch]:
	Added setting argument to gtk_window_set_has_frame ()
	
Thu Jun 21 13:42:01 2001  Owen Taylor  <otaylor@redhat.com>

	* gdk/x11/gdkkeys-x11.c (gdk_keymap_get_direction): Handle
	the case without XKB properly.

	* gtk/gtkrc.c (gtk_rc_set_default_files): Remove
	unused gtk_rc_auto_parse variable.

	* gtk/gtkrc.[ch] gtk/gtkstyle.c docs/Changes-2.0.txt:
	Remove gtk_rc_set_image_loader(), gtk_rc_load_image(), no
	longer needed with GdkPixbuf.

	* gtk/gtkrc.c (_gtk_rc_init): Make private.

Fri Jun 15 16:26:12 2001  Owen Taylor  <otaylor@redhat.com>

	* gtk/gtkentry.h: Mark deprecated functions with
	GTK_DISABLE_DEPRECATED.

Mon Jun 11 18:15:16 2001  Owen Taylor  <otaylor@redhat.com>

	* gdk/gdk.h: Add missing gdk_rectangle_get_type() prototype.

	* gtk/gtk[hv]scale.c: Include math.h, stdlib.h

	* gdk/gdkpango.h gtk/gtkclist.c gtk/gtkentry.c gtk/gtkmain.[ch]
	  gtk/gtkspinbutton.c gtk/gtkstyle.c gtk/gtktextbuffer.c
	  gtk/gtktextdisplay.c gtk/gtktextiter.[ch]
	  gtk/gtktextlayout.c gtk/gtktexttag.[ch] gtk/gtkwidget.c: Adapt
	  to recent changes in Pango.

	* tests/testgtk.c: Set language tags with gtk_label_set_markup()
	  to test whether the basic engine honors them.

Thu Jun 21 02:13:40 2001  Tim Janik  <timj@gtk.org>

	* gtk/gtkcontainer.[hc]: added gtk_container_child_set_property() and
	gtk_container_child_get_property().

Wed Jun 20 19:19:15 2001  Jonathan Blandford  <jrb@redhat.com>

	* gtk/gtktreeview.c (gtk_tree_view_move_cursor_up_down): clean up
	(gtk_tree_view_move_cursor_page_up_down): implement.

Wed Jun 20 05:32:05 2001  Tim Janik  <timj@gtk.org>

	* gtk/gtkspinbutton.c: make maximum digits compile time configurable
	via MAX_DIGITS and up to 20. 5 was just ridiculously small.
	don't use automatic fixed size buffer for printf-ing floats, doubles
 	can expand to really _huge_ strings, use g_strdup_printf() instead.

Wed Jun 20 04:28:24 2001  Tim Janik  <timj@gtk.org>

	* gtk/gtkrange.c (gtk_range_class_init): hum, "adjustment" was a
	construct property in 1.2 and still needs to be.

	* gtk/gtkwidget.c: "composite_child" is not a settable property.

Tue Jun 19 19:13:19 2001  Jonathan Blandford  <jrb@redhat.com>

	* gtk/gtkliststore.c (gtk_list_store_clear): 
	* gtk/gtktreestore.c (gtk_tree_store_clear): New functions to
	clear a model.

Mon Jun 18 02:00:49 2001  Tim Janik  <timj@gtk.org>

	* gtk/gtkwidget.c (gtk_widget_get_property): fix PROP_EVENTS.

	* gtk/Makefile.am:
	* gtk/gtk.h: disabled GtkPacker compilation.

	* gtk/gtkarg.[hc], gtk/gtkargcollector.c: got rid of these.

	* gtk/gtknotebook.c:
	* gtk/gtktable.c:
	* gtk/gtkbox.c: ported this over to child properties.

	* gtk/gtksettings.c: fetch class properties via
	g_object_class_list_properties().

	* gtk/gtkcontainer.[hc]: implemented child properties, got rid of the
	child arg interface. use gobjectnotifyqueue.c for child property
	notification.

	* gtk/gtkwidget.[hc]: provide necessary means for container child
	properties, i.e. ::child_notify signal,
	gtk_widget_freeze_child_notify(),
	gtk_widget_child_notify(),
	gtk_widget_thaw_child_notify().

	* tests/testgtk.c: removed inferior property handling code, for
	property editing, a generic module should be used, and GLE
	coincidentally fullfills that purpose.

	* docs/reference/Makefile.am: disabled gtk docs building, gtk-doc
	needs to be adapted to g_object_class_list_properties() before this
	builds again.

Mon Jun 18 20:06:10 2001  Jonathan Blandford  <jrb@redhat.com>

	* gtk/gtktreeview.c (gtk_tree_view_row_expanded): New function to
	test if a node is expanded.

Mon Jun 18 19:41:38 2001  Jonathan Blandford  <jrb@redhat.com>

	* gtk/gtktreeview.c (gtk_tree_view_real_collapse_row): Fix bug
	where collapsing a selected row would result in the cursor/anchor
	getting screwed up.

Fri Jun 15 18:53:48 2001  Jonathan Blandford  <jrb@redhat.com>

	* gtk/gtktreesortable.c (gtk_tree_sortable_set_sort_func): Rename
	gtk_tree_sortable_sort_column_id_set_func.  It's much shorter now.
	* gtk/gtktreeview.c (gtk_tree_view_sort_iter_changed): WOOO!!!
	Now I can really reorder/sort all Store widgets.  treesorttest
	seems to just work now.
	* gtk/gtklistview.c (gtk_list_store_iter_changed): Whoops.
	testtreesort worked through a big coincidence all this time.
	* gtk/gtkrbtree.c (_gtk_rbtree_reorder): Nasty bug fix in nasty
	code.
	* tests/testtreecolumns.c: Big 'ol warning at the top letting
	people know that this code should never ever ever be copied.

2001-06-15  Jonas Borgstrm  <jonas@codefactory.se>

	* gtk/gtkwindow.h: Fixed a small typo, it should be
	GTK_WINDOW_GROUP_GET_CLASS and not GTK_WINDOW_GET_CLASS
	on line 134.

2001-06-14  Havoc Pennington  <hp@redhat.com>

        Docs fixups, and:
	
	* gtk/gtkcompat.h: remove GTK_DISABLE_COMPAT_H, replace with
	GTK_DISABLE_DEPRECATED

Thu Jun 14 19:21:27 2001  Jonathan Blandford  <jrb@redhat.com>

	* gtk/gtktreestore.c (gtk_tree_store_sort_helper): Whoops.  Forgot
	this a couple months ago.  Now GtkTreeStore sort of sorts.  I'll
	finish it off tonight, though it basically works now when it's a
	list.  Also, I have a sinking feeling neither GtkTreeStore or
	GtkListStore actually resort when adding a new item.  I'll look
	into it.

2001-06-14  Havoc Pennington  <hp@redhat.com>

	* demos/gtk-demo/main.c (load_file): fix bug identified by
	warnings I just added to gtktextbuffer

2001-06-14  Havoc Pennington  <hp@redhat.com>

	* gtk/gtkwindow.c (window_group_cleanup_grabs): fix other typo

	* gtk/gtkwidget.c (gtk_widget_propagate_state): fix typo

	* gtk/gtktextbtree.c: don't leak node data all over the place.

	* demos/gtk-demo/main.c (main): create fontify tags for the right
	buffer

	* gtk/gtktextbuffer.c, gtk/gtktexttagtable.c: enhance docs
	to mention tags in the same table can't have the same name,
	suggested by Skip Montanaro

2001-06-11  Havoc Pennington  <hp@redhat.com>

	* gtk/gtktexttagtable.c (gtk_text_tag_table_add): improve warning 
	for trying to add two tags with same name to the tag table

	* demos/gtk-demo/main.c (main): fix colors ;-)

`Fri Jun  8 17:56:52 2001  Owen Taylor  <otaylor@redhat.com>

	* gtk/gtkwindow.[ch] gtk/gtkmain.c: Add a GtkWindowGroup struct
	that allows grouping together multiple windows so that grabs
	within that set of windows only affect those windows.

	* gtk/gtkmain.c gtk/gtkwidget.[ch]: Add a "grab_notify"
	signal for notification when a widget becomes shadowed
	by a grab or is no longer shadowed by a grab.

	* gtk/gtkwidget.c (gtk_widget_propagate_state)
	  gtk/gtkmain.c: (gtk_widget_grab_add): Don't allow
	insenstive widgets to maintain a grab.

2001-06-14  Alexander Larsson  <alexl@redhat.com>

        * docs/README.linux-fb:
	Add some example config files that can be used with the URW fonts.
	
	* gdk/linux-fb/gdkvisual-fb.c (gdk_visual_init): 
	Set up the color ramps for DirectColor mode.

2001-06-11  Havoc Pennington  <hp@redhat.com>

	* Release 1.3.6
	 
2001-06-13  Alexander Larsson  <alla@lysator.liu.se>

	* gdk/linux-fb/gdkwindow-fb.c:
	Unify shaped window code and make it repaint the area that used
	to be part of the shape, but isn't anymore.

2001-06-11  Havoc Pennington  <hp@redhat.com>

	* NEWS: Updates

	* configure.in (GTK_MINOR_VERSION): bump version to 1.3.6

	* gtk/Makefile.am: glib_genmarshal already contains top_builddir
	
2001-06-13  Alexander Larsson  <alla@lysator.liu.se>

	* gdk/linux-fb/gdkdnd-fb.c (gdk_drag_status):
	Don't pass on GDK_ACTION_DEFAULT. The Xdnd code
	passes zero instead, so do we.
	
2001-06-13  Alexander Larsson  <alla@lysator.liu.se>

	* gdk/linux-fb/gdkgc-fb.c (gdk_gc_copy):
	Deep copy dash_list too.
	(_gdk_fb_gc_new): Set default cap_style before
	setting values.

2001-06-12  Alexander Larsson  <alla@lysator.liu.se>

	* gdk/linux-fb/gdkkeyboard-fb.c (gdk_keymap_get_default,
	gdk_keymap_get_direction): New functions.

Tue Jun 12 12:41:27 2001  Jonathan Blandford  <jrb@redhat.com>

	* gtk/gtktreemodel.h (GTK_TREE_MODEL_LIST_ONLY): further justify
	gtk_tree_model_get_flags by adding a second flag for atk.

	* gtk/gtktreemodel.c: make cursor behavior interact better with
	mouse presses.

Mon Jun 11 12:43:08 2001  Jonathan Blandford  <jrb@redhat.com>

	* gtk/gtktreeview.c (gtk_tree_view_class_init): changed
	expand_row/collapse_row to be 2 signals each -- test_expand_row
	and row_expanded as well as test_collapse_row and row_collapsed.

2001-06-10  Anders Carlsson  <andersca@codefactory.se>

	* demos/gtk-demo/stock_browser.c (do_stock_browser): Update
	signal name to be changed instead of selection_changed.

2001-06-08  Havoc Pennington  <hp@redhat.com>

	* gtk/gtkentry.c (gtk_entry_class_init): add read-only
	"scroll_offset" property for notification when the layout offsets
	may have changed
	(gtk_entry_adjust_scroll): add notify for scroll_offset
	(gtk_entry_layout_index_to_text_index): function to compensate for
	preedit string when doing coordinate stuff on the entry's layout
	(gtk_entry_text_index_to_layout_index): inverse function
	(gtk_entry_get_layout_offsets): hook to get current position of
	the layout	
	(gtk_entry_get_layout): hook to get the layout itself.

	* gtk/gtklabel.c (gtk_label_get_layout): new function

Fri Jun  8 19:49:29 2001  Jonathan Blandford  <jrb@redhat.com>

	* gtk/gtktreeview.c (gtk_tree_view_real_select_cursor_row): New
	keybinding.
	(gtk_tree_view_focus): Fix merge conflict.

Fri Jun  8 18:41:30 2001  Jonathan Blandford  <jrb@redhat.com>

	* gtk/gtktreeview.c (gtk_tree_view_set_cursor): new function to
	clean up cursor handling.

2001-06-08  Havoc Pennington  <hp@redhat.com>

	* gtk/gtktextbuffer.c (gtk_text_buffer_get_start_iter): added this
	function

	* gtk/gtktextview.c (gtk_text_view_get_default_attributes): added
	this function

2001-06-08  Alex Larsson  <alexl@redhat.com>

	* gtk/gtkcompat.h.in:
	Added compat macros for all old GTK_TYPE_GDK_xxx types.
	Fixes bug #52892

2001-06-08  Havoc Pennington  <hp@redhat.com>
	
	* gtk/gtkhsv.h (struct _GtkHSVClass): had GtkContainerClass as
	parent still

2001-06-08  Havoc Pennington  <hp@redhat.com>

	* gtk/gtktextbuffer.c (gtk_text_buffer_remove_all_tags): geez,
	don't call g_list funcs on GSList

	* gtk/gtkwidget.c (gtk_widget_child_focus): replaces
	gtk_container_focus(), since some widgets have focusable locations
	which are not other widgets. These widgets should not have to be 
	containers just to manage the focus. For example, GtkHSV is
	currently a container for no good reason. Also, this cleans
	up the "if (is_container && is_sensitive && is_drawable)
	container_focus ()" mess in widget implementations.

	* gtk/gtkcontainer.c (gtk_container_focus): deprecate this
	function, and have it just call gtk_widget_child_focus().

	* gtk/gtkhsv.c: derive from widget not container
	
	Throughout: fix to reflect GtkContainer::focus change
	
Fri Jun  8 12:38:49 2001  Jonathan Blandford  <jrb@redhat.com>

	* gtk/gtktable.c (gtk_table_resize): warn if row/cols are out of
	range.  Fix bug #55921

	* gtk/gtkliststore.c (gtk_list_store_new_with_types): fix doc bug
	(#55920).

Fri Jun  8 12:03:07 2001  Owen Taylor  <otaylor@redhat.com>

	* gdk/gdkkeys.[ch]: Add a direction-changed signal,
	and gdk_keymap_get_current_direction().

	* gdk/x11/gdkevents-x11.c gdk/x11/gdkkeys-x11.c
	  gdk/x11/gdkmain-x11.c gdk/x11/gdkprivate-x11.h: Track
	the current locked group, use it to set the keymap
	direction.

	* gtk/gtksettings.c: Add a new gtk-split-cursor setting
	to determine whether we draw a split cursor or use
	a jumping cursor based on the current direction.

	* gtk/gtkentry.c gtk/gtktextview.c gtk/gtktextlayout.[ch]:
	Obey the split cursor setting. 

Fri Jun  8 11:57:50 2001  Owen Taylor  <otaylor@redhat.com>

	* gtk/gtkimmulticontext.c (activate_cb): Only activate
	when toggling on, not when toggling off... (#55906)

Wed Jun  6 10:37:07 2001  Owen Taylor  <otaylor@redhat.com>

	* gtk/gtkwidget.c (gtk_widget_set_double_buffered): 
	s/gdk_window_begin_paint/gdk_window_begin_paint_region/
	in docs. (#55812, Vitaly Tishkov)

2001-06-08  Anders Carlsson  <andersca@codefactory.se>

	* demos/gtk-demo/main.c (create_tree): Changed signal name from
	selection_changed to changed in signal connection to GtkTreeSelection,
	also used g_signal_connectc since GtkTreeSelection is now a GObject.

Thu Jun  7 18:25:42 2001  Jonathan Blandford  <jrb@redhat.com>

	* gtk/gtktreeselection.c: Now it's a GObject instead of a
	GtkObject.  The GtkTreeSelection::selection_changed signal is now
	the GtkTreeSelection::changed signal.

	* gtk/gtktreeview.c: Modified to deal with new GtkTreeSelection
	object.

	* tests/gtktree*.c: Modified to deal with new GtkTreeSelection
	object.

2001-06-07  Havoc Pennington  <hp@redhat.com>

	* gtk/Makefile.am: fix glib-mkenums and glib-genmarshal again

2001-06-07  Havoc Pennington  <hp@redhat.com>
	
	* gtk/Makefile.am: fixups for glib-mkenums and glib-genmarshal
	(not tested yet because with absolute path to srcdir I can't build
	atk, but it was broken anyway so this may help)	

2001-06-07  Havoc Pennington  <hp@redhat.com>

	* configure.in: output m4macros/Makefile
	
Wed Jun  6 21:59:16 2001  Jonathan Blandford  <jrb@redhat.com>

	* gtk/gtktreeview.c (gtk_tree_view_size_allocate): hook up arrow
	buttons.  Fixes #55460 reported by matthiasc@poet.de.

Wed Jun  6 21:18:54 2001  Jonathan Blandford  <jrb@redhat.com>

	* gtk/gtktreeview.c (gtk_tree_view_real_collapse_row): centralize
	expansion/collapsing so it only happens in one place.
	(gtk_tree_view_real_expand_row): ditto.

2001-06-07  Havoc Pennington  <hp@redhat.com>

	* tests/Makefile.am: add missing -I flag

	* gtk/Makefile.am: use @GLIB_MKENUMS@, @GLIB_GENMARSHAL@, etc.

	* configure.in: use pkg-config to see if GModule is
	supported; fix to properly turn on included loaders 
	when GModule isn't supported; don't use AC_CHECK_LIB 
	when libs are not installed yet

	* autogen.sh: add support for AUTOGEN_SUBDIR_MODE

	* Makefile.am (SUBDIRS): add m4macros subdir

	* gtk/Makefile.am: $(srcdir)/foo targets must be $(srcdir)/foo in
	dependencies also.

Wed Jun  6 19:31:11 2001  Jonathan Blandford  <jrb@redhat.com>

	* gtk/gtktreeview.c (gtk_tree_view_set_model): fix silly bug
	reported by "Padraig O'Briain" <Padraig.Obriain@Sun.COM>.

Wed Jun  6 20:01:38 2001  Jonathan Blandford  <jrb@redhat.com>

	* gtk/gtktreeview.c
	(gtk_tree_view_real_expand_collapse_cursor_row): Handle key
	bindings to expand and collapse rows.
	(gtk_tree_view_real_select_cursor_parent): New key binding.
	(gtk_tree_view_real_toggle_cursor_row): New key binding.

	* gtk/gtkmarshal.list: new
	marshaller. (VOID__BOOLEAN_BOOLEAN_BOOLEAN)

2001-06-06  Havoc Pennington  <hp@redhat.com>

	* gtk/gtkrange.c (gtk_range_class_init): add "inverted" property

	* gtk/gtkscale.c (gtk_scale_class_init): Change Page Up and Page
	Down to move visually rather than logically, since it confuses 
	people. Add -/+ and Ctrl--/+ bindings for logical movement.

2001-06-06  Alex Larsson  <alexl@redhat.com>

	* gdk/linux-fb/gdkmain-fb.c (_gdk_windowing_init_check):
	Fix up error messages.

Wed Jun  6 10:34:42 2001  Owen Taylor  <otaylor@redhat.com>

	* gtk/gtktooltips.h: Include gtkwidget.h 
	(#55798, Karl Nelson)

	* gdk/x11/gdkwindow-x11.c (utf8_is_latin1): 0xff is
	a valid latin-1 character. (Marc Lehmann, #35467)

	* gdk/x11/gdkwindow-x11.c: Fix minor typo in comment. 
	(Marc Lehmann, #35467)
	
2001-06-05  Alex Larsson  <alexl@redhat.com>

	* demos/gtk-demo/appwindow.c (do_appwindow):
	Don't swap the order of the args to gtk_widget_destroyed.

	* tests/testgtk.c (destroy_properties):
	Don't crash when the properties window is destroyed.

	* gtk/gtkimagemenuitem.c (gtk_image_menu_item_new_from_stock):
	Use with_mnemonics to handle the case of stock items with
	underscores in them.

2001-06-05  Havoc Pennington  <hp@redhat.com>

	* gtk/gtktextiter.c (gtk_text_iter_order): rename from 
	gtk_text_iter_reorder

2001-06-05  Havoc Pennington  <hp@redhat.com>

	* gtk/gtktoolbar.c (gtk_toolbar_remove_space): new function

2001-06-05  Havoc Pennington  <hp@redhat.com>

	* gtk/gtkspinbutton.c (gtk_spin_button_set_range): clamp the value 
	to the range that was set

	* gtk/gtkrange.c: add value_changed signal, primarily 
	intended for use with GtkScale
	(gtk_range_set_increments): new function
	(gtk_range_set_range): new function with weird name
	(gtk_range_set_value): new function
	(gtk_range_get_value): new function

	* gtk/gtkspinbutton.c (gtk_spin_button_get_value): rename 
	from gtk_spin_button_get_value_as_float(). Compat #define
	added for get_value_as_float.

	* gtk/gtkhscale.c (gtk_hscale_new_with_range): new function

	* gtk/gtkvscale.c (gtk_vscale_new_with_range): new function

Tue Jun  5 14:57:18 2001  Jonathan Blandford  <jrb@redhat.com>

	* gtk/gtktreeviewcolumn.c (gtk_tree_view_column_get_size): Fix bug #55573

Mon Jun  4 12:41:25 2001  Owen Taylor  <otaylor@redhat.com>

	* gtk/gtkwidget.h: Deprecate gtk_widget_set().

	* tests/testgtk.c (create_tooltips): Remove usage of
	gtk_widget_set().

2001-06-05  Havoc Pennington  <hp@redhat.com>

	* gtk/gtkcolorsel.c: Use new mnemonic convenience functions

	Applying patch from Jeff Franks, with function docs added.
	
	* gtk/gtkcheckbutton.c (gtk_check_button_new_with_mnemonic):
	remove call to set_mnemonic_widget, change docs a bit.	

	* gtk/gtkimagemenuitem.c (gtk_image_menu_item_new_with_mnemonic):
	new function

	* gtk/gtkcheckmenuitem.c (gtk_check_menu_item_new_with_mnemonic):
	new function

	* gtk/gtkmenuitem.c (gtk_menu_item_new_with_mnemonic): new function

	* gtk/gtkradiobutton.c (gtk_radio_button_new_with_mnemonic): new
	function
	(gtk_radio_button_new_with_mnemonic_from_widget): new function

	* gtk/gtkradiomenuitem.c (gtk_radio_menu_item_new_with_mnemonic):
	new function

	* gtk/gtktogglebutton.c (gtk_toggle_button_new_with_mnemonic): new
	function	

	* gtk/gtklabel.c (gtk_label_new_with_mnemonic): Improve docs on 
	auto-selection of mnemonic widget.

Mon Jun  4 15:05:24 2001  Jonathan Blandford  <jrb@redhat.com>

	* gtk/gtktreeviewcolumn.c (gtk_tree_view_column_set_max_width):
	Fix segfault found by Vitaly Tishkov <tvv@sparc.spb.su>.
	(gtk_tree_view_column_set_min_width): ditto.

Tue Jun  5 11:04:06 2001  Owen Taylor  <otaylor@redhat.com>

	* gdk/gdkpixmap.h (GDK_PIXMAP_GET_CLASS): 
	s/GdkPixmapClass/GdkPixmapObjectClass/. (#51890, Jeff Franks)

Mon Jun  4 12:50:11 2001  Owen Taylor  <otaylor@redhat.com>

	* gtk/gtkctree.c (gtk_ctree_insert_gnode): Add a missing
	gtk_clist_thaw().

2001-06-04  Havoc Pennington  <hp@pobox.com>

	* gdk/x11/gdkevents-x11.c (gdk_event_translate): Ignore 
r	eleases for buttons 6, 7

2001-06-04  Havoc Pennington  <hp@redhat.com>

	* gtk/gtkseparatormenuitem.h: Fix a search-and-replace screwup
	(s/CHECK/SEPARATOR/ gone awry). Patch from Jeff Franks, bug
	#55562

2001-06-04  Havoc Pennington  <hp@redhat.com>

	* gtk/gtktextview.c (gtk_text_view_size_request): handle case
	where text_view->layout == NULL by assuming its size is 0, 
	i.e. same as if we haven't done any reflow. Reported by 
	Hidetoshi Tajima #55448 

2001-06-04  Havoc Pennington  <hp@redhat.com>

	* gdk/x11/gdkevents-x11.c (gdk_event_translate): support button 6
	and 7 for scroll left/right, from Thomas Broyer

2001-05-10  Havoc Pennington  <hp@redhat.com>

	* gtk/gtksettings.c (gtk_settings_get_property): Handle case where
	we need to parse the xsetting as if it were an RC file string.

	* gtk/gtkcolorsel.c (gtk_color_selection_class_init): load initial
	value of palette from settings, not from static variable

	* gdk/x11/gdkevents-x11.c: add color palette, toolbar mode to
	xsettings translation table

	* gtk/gtktoolbar.c (gtk_toolbar_new): Remove arguments, because 
	hardcoding the toolbar style conflicts with new customizable 
	toolbar style philosophy
	(gtk_toolbar_class_init): add settings for default toolbar style;
	these are used unless the app specifically forces a toolbar style

	* gtk/gtksettings.c (settings_install_property_parser): only
	return at the start if we warn and parser == NULL

	* gtk/gtkcolorsel.c (gtk_color_selection_finalize): disconnect the
	palette changed handler so we don't notify dead color selections

	* gtk/gtkstyle.c (gtk_default_draw_shadow): handle
	xthickness/ythickness of 0 or 1 properly 
	(gtk_default_draw_resize_grip): clear the background behind the
	resize grips, and align to bottom right if we square the 
	area to be drawn.

	* gtk/gtkstatusbar.c (gtk_statusbar_init): set horizontal usize on 
	statusbar label to 1, so it doesn't make toplevels resize oddly
	(gtk_statusbar_size_request): add grip size to request
	(gtk_statusbar_size_allocate): hack so the hbox still works with 
	the grip size in the request

	* gtk/gtktoolbar.c (gtk_toolbar_show_all): override to fix 
	bug where showing all on a toplevel makes the toolbar 
	button text appear despite the toolbar mode

	* gtk/gtkmenubar.c: add internal padding style property

	* gtk/gtktoolbar.c: Add internal padding style property; add
	shadow type style property

	* gtk/gtkmenubar.c (gtk_menu_bar_paint): paint box with widget
	state; and put Container::border_width outside the frame

	* gtk/gtktextview.c: don't draw focus rectangle if we're in
	interior focus mode, we just use blinking cursor

2001-06-04  Havoc Pennington  <hp@redhat.com>

	* configure.in: Make gdk-pixbuf have same version number as GTK

2001-06-04  Havoc Pennington  <hp@redhat.com>

	* gtk/gtkspinbutton.c: Get rid of stupid g_return_if_fail on 
	digits greater than 6. If there actually are limits (which there
	likely aren't), should clamp to them not warn.
	(gtk_spin_button_new_with_range): don't take log of 0
	(gtk_spin_button_size_request): use digits to compute size
	request, rather than step increment.

	* tests/testgtk.c (create_spins): test larger values of digits
	
	* gtk/gtkfontsel.c (gtk_font_selection_init): scroll to selected
	font on map not expose, so we don't get weirdness during scrolling

2001-06-04  Havoc Pennington  <hp@redhat.com>

	* gtk/gtkclist.c (vadjustment_value_changed): Apply fix from
	Sam Solon, bug #54577, update value even if not drawable.

2001-06-04  Havoc Pennington  <hp@redhat.com>

	* gtk/gtkrange.c (gtk_range_scroll_event): change SCROLL_RIGHT to
	SCROLL_LEFT, reported by Thomas Broyer.

2001-06-04  Havoc Pennington  <hp@redhat.com>

	* gtk/gtkrange.c (gtk_range_adjustment_value_changed): 
	Process updates immediately, to prevent funny lag effect
	when scrolling, at some mild potential efficiency cost.

2001-06-04  Havoc Pennington  <hp@redhat.com>

	* gtk/gtkrange.c (gtk_range_button_press): on middle click, center
	slider on the click.

2001-06-03  Havoc Pennington  <hp@pobox.com>

	* gtk/gtkstyle.c (gtk_default_draw_slider): make this special-case
	hscale/vscale details, so we can use it for scrollbar as well.

	* tests/testgtk.c (reformat_value): honor digits from GtkScale

	* gtk/gtkenums.h (GtkTroughType): Remove this enum
	(GtkScrollType): add START and END from GtkTroughType

	* gtk/gtkstyle.c (gtk_default_draw_slider): was not properly using
	its x/y arguments

	* gtk/gtkrange.h, gtk/gtkrange.c, gtk/gtkscrollbar.h,
	gtk/gtkscrollbar.c, gtk/gtkscale.h, gtk/gtkscale.c,
	gtk/gtkhscrollbar.h, gtk/gtkhscrollbar.c, gtk/gtkvscrollbar.h,
	gtk/gtkvscrollbar.c, gtk/gtkhscale.h, gtk/gtkhscale.c,
	gtk/gtkvscale.h, gtk/gtkvscale.c: Rewrite GtkRange and subclasses.

	Notable changes in the process:
	 
	- stepper_size style property is the height for vertical 
	  ranges, width for horizontal; the other dimension matches
	  the trough size
	- add ability to do NeXT-style steppers (and several other styles
	  that don't make any sense)
	- added min_slider_length, fixed_slider_length properties to
          GtkScrollbar
        - cleaned some private (or at least useless) functions out of
          gtkscale.h	
        - moved bindings to GtkScale from subclasses, even arrow keys,
	  since blind users don't know scale orientation.
        - change move_slider action signal to use new GtkScrollType,
	  remove GtkTroughType argument
	- digits rounds the values a range will input to the given 
	  number of decimals, but will not try to force adjustment 
	  values set by other controllers. That is, we no longer
	  modify adjustment->value inside a value_changed handler.
	- added getters for GtkScale setters
        - middle-click begins a slider drag
	
Fri Jun  1 18:54:47 2001  Jonathan Blandford  <jrb@redhat.com>

	* gtk/gtktreeview.c: (gtk_tree_view_focus): Initial stab at
	getting the focus code to work.
	(gtk_tree_view_class_init): Add a bunch of keybindings.

	* gtk/gtktreeviewcolumn.c
	(gtk_tree_view_column_set_cell_data_func):
	s/GtkCellDataFunc/GtkTreeCellDataFunc.
	(_gtk_tree_view_column_set_tree_view): Use "notify::model" instead
	of "properties_changed" to help justify the death of the latter
	signal. (-:

	* tests/testtreefocus.c (main): Let some columns be focussable to
	test focus better.

2001-06-01  Havoc Pennington  <hp@redhat.com>

	* gtk/gtkentry.c (gtk_entry_commit_cb): implement overwrite mode
	
	* gtk/gtktextview.c (gtk_text_view_commit_handler): don't
	overwrite in overwrite mode if we already deleted the selection
	and replaced it with new text.	

	* gtk/gtklabel.c (gtk_label_select_region_index): if you set the
	selection to an empty range, clear the clipboard if we owned it.
	(gtk_label_set_selectable): give up selection if we become
	unselectable.
	(gtk_label_state_changed): override state changed to unselect text
	when insensitive
	(get_text_callback): add paranoia check that indexes aren't
	outside of label->text
	(gtk_label_select_region): make -1 for start_offset mean "end of
	label," for consistency with GtkEditable

	* gtk/gtkmessagedialog.c (gtk_message_dialog_new): honor
	GTK_DIALOG_NO_SEPARATOR flag

Fri Jun  1 11:47:11 2001  Owen Taylor  <otaylor@redhat.com>

	* gtk/gtkcombo.c (gtk_combo_set_use_arrows_always): Fix 
	notifications on non-existant "enable_arrow_keys".
	(#53753, Skip Montanaro)

Fri Jun  1 11:31:55 2001  Owen Taylor  <otaylor@redhat.com>

	* gdk/gdkrectangle.c (gdk_rectangle_get_type): Add 
	GDK_TYPE_RECTANGLE.

	* gtk/gtkwidget.c (gtk_widget_class_init): Fix type
	of allocation argument be GDK_TYPE_RECTANGLE.

Thu May 31 12:43:57 2001  Owen Taylor  <otaylor@redhat.com>

	* gtk/gtkoptionmenu.c: Account for the fact that the border
	width is _outside_ the window. (Fixes #54585, bug found
        by Bastien Nocera.)

Wed May 30 15:56:30 2001  Owen Taylor  <otaylor@redhat.com>

	* gtk/gtksettings.c (gtk_settings_get_property): Validate
	value from GDK settings against parameter spec.

	* gdk/x11/gdkevents-x11.c (gdk_setting_get): Add assignments
	to temporary values and use g_value_transform(), since
	thinking that GValue was going to be easy or efficient
	to use was, of course, a mistake.

        * gtk/gtksettings.c: Add cursor blink setting.
	
	* gdk/x11/gdkevents-x11.c: Add cursor blink X settings.

	* gtk/gtkentry.c: Add cursor blinking.

	* gtk/gtktextview.c (gtk_text_view_check_cursor_blink): Use
	cursor blink global settings.

	* gtk/gtkentry.c (gtk_entry_button_press): Add notification
	for :text_position in places where it is missing.

Tue May 29 18:17:11 2001  Owen Taylor  <otaylor@redhat.com>

	* autogen.sh (have_libtool): Fix GNU sedism (#55430)

Tue May 29 17:40:29 2001  Owen Taylor  <otaylor@redhat.com>

	* configure.in (GTK_DEP_CFLAGS): Use $PKG_CONFIG,
	not pkg-config. (#51032)

	* gdk/gdkproperty.h: Remove inappropriate G_GNUC_CONST
	(fixes #51952, James Henstridge)
	
2001-05-27  Alexander Larsson  <alla@lysator.liu.se>

	* gtk/gtkstock.h (GTK_STOCK_GO_UP):
	Rename to the more correct gtk-go-up.

	* gtk/stock-icons/stock_menu_sort_ascending.png:
	Added new file.
	
	* gtk/stock-icons/stock_menu_sort_descending.png:
	Changed to show descending instead of ascending.

	* gtk/gtkiconfactory.c:
	Added menu size icon to sort ascending.

	* gtk/stock-icons/Makefile.am:
	Added stock_menu_sort_ascending.png.
	
	* gtk/gtkseparatormenuitem.c:
	Use correct typenames.

Sun May 20 20:07:35 2001  Tim Janik  <timj@gtk.org>

	* gtk/gtksignal.[hc] (gtk_signal_connect_full): make hanlder id a
	gulong as in GSignal.

Fri May 25 19:04:17 2001  Jonathan Blandford  <jrb@redhat.com>

	* gtk/gtktreeview.c (gtk_tree_view_calc_size): Remove almost all
	instances of GtkCellRenderer in code (all but dnd icon code).
	Virtualized in GtkTreeViewColumn.  Now I need to move focus in
	there, and I can do multiple Cells per column.

	* gtk/gtktreeviewcolumn.c: Proxy all cell calls correctly

	* gtk/gtktreemodel.c (gtk_tree_row_reference_new_proxy): fix bug
	when model was unreffed prior to removing the row reference.

2001-05-25  Havoc Pennington  <hp@redhat.com>

	* gtk/gtkiconfactory.c: fix so that default icons are created if 
	you call gtk_stock_list_ids()

	* demos/gtk-demo/stock_browser.c (create_model): sort stock items
	in list

2001-05-25  Havoc Pennington  <hp@redhat.com>

	* gtk/gtkiconfactory.c (gtk_icon_set_get_sizes): get sizes an icon
	set can render without falling back to missing image icon

	* gtk/gtktextview.c (gtk_text_view_size_request): request full
	size of text, instead of random values

	* gtk/gtktreeview.c (gtk_tree_view_size_request): request full
	size of tree view, instead of random values

	* gtk/gtkiconfactory.c (gtk_icon_set_render_icon): render fallback
	image in an appropriate size

        * gtk/gtkstock.h: Rename the stock items including _BUTTON_,
	etc. not to include that. i.e. s/GTK_STOCK_BUTTON_OK/GTK_STOCK_OK/

        Throughout: fix GTK_STOCK_BUTTON_ instances
	
	* gtk/gtkstock.h, gtk/gtkstock.c, gtk/gtkiconfactory.h,
	gtk/gtkiconfactory.c, gtk/stock-icons/Makefile.am:
	Add a bunch of new stock items/icons

	* gtk/gtktreeview.c (gtk_tree_view_insert_column_with_data_func):
	new function, convenience for inserting columns with a data func

	* gtk/gtkiconfactory.c: keep a list of all existing icon factories
	(_gtk_icon_factory_list_ids): use list of all factories to
	generate a list of all known IDs

	* gtk/gtkstock.c (gtk_stock_list_ids): replace
	gtk_stock_list_items() with a function that returns all IDs known
	including those for GtkIconFactory.

2001-05-25  Hans Breuer  <hans@breuer.org>

	* gdk/win32/gdkgc-win32.c : made fil mode GDK_STIPPLED actually
	work -> check boxes and radio buttons are drawn now, even on win9x.
	Improved line settings a bit, still no clue how to get really dotted
	lines on win9x, on NT it's PS_ALTERNATE.

	* gdk/win32/gdkwindow-win32.c : use SafeAdjustWindowRect for 
	GDK_HINT_MIN_SIZE as well

	* gdk/win32/makefile.am : added gdkkeys-win32.c to EXTRA_DIST

	* gtk/gtk.def : updated

	* gtk/gtktreeprivate.h : change column_drop_func to be a function
	pointer not a function pointer pointer

	* tests/testdnd.c : include <stdlib.h> for putenv prototype

	* tests/testsocket.c : made it compile on win32 again

	* tests/makefile.msc : one more test-app uses prop-editor.obj

2001-05-22  Havoc Pennington  <hp@pobox.com>

	* gtk/gtkbin.c (gtk_bin_get_child): New function

Wed May 23 20:07:53 2001  Owen Taylor  <otaylor@redhat.com>

	* gtk/gtkimcontextsimple.c: Add Mode_Switch to list of keys
	to ignore when doing compose processing.

2001-05-22  Joe Shaw  <joe@ximian.com>

	* gtk/gtktextiter.c (_gtk_text_btree_get_iter_at_last_toggle): 
	Simplify as suggested by Havoc. Just get the last iter and work
	backward to the tag instead of getting a line and working back from
	there. Fixes passing in an invalid offset to
	iter_init_from_byte_offset().

Tue May 22 16:25:27 2001  Jonathan Blandford  <jrb@redhat.com>

	* gtk/gtktreeview*.h: 
	* gtk/gtkcell*.h:
	* gtk/gtk*store.h:
	Added patch from Jeff Franks <jcf@tpg.com.au> to add GET_CLASS
	macros to all objects.

Tue May 22 15:13:52 2001  Jonathan Blandford  <jrb@redhat.com>

	* gtk/gtkcellrenderertext.c
	(gtk_cell_renderer_text_set_fixed_size): Evil function to deal
	with very large (TM) amounts of text.  May be moved to
	GtkCellRenderer in the future, though I'm not sure it wants to be
	this accessible.

	* gtk/gtktreeviewcolumn.c (gtk_tree_view_column_update_button):
	More sanity brought to this class.  I like it.

	* tests/testtreecolumns.c (ViewColumnModel): Amazingly scary test
	case.  Kids, don't try this at home.

	* gtk/gtktreemodel.c (gtk_tree_model_get_iter_root): new
	convenience function.

	* gtk/gtkwindow.c (gtk_window_set_geometry_hints): Fix typo in docs.

2001-05-21  Alexander Larsson  <alexl@redhat.com>

	* gtk/gtkfontsel.c:
	Added properties. Based on patch by Lee Mallabone.

	* gtk/gtkruler.c:
	* gtk/gtkhruler.c:
	* gtk/gtkvruler.c:
	* gtk/gtktext.c:
	* gtk/gtktextview.c:
	Converted GtkArg to GParam. Based on patches by John Margaglione.

	* tests/Makefile.am:
	* tests/testtext.c:
	Add a property editor to testtext.
	
Mon May 21 11:29:21 2001  Owen Taylor  <otaylor@redhat.com>

	* gtk/gtk{h,v,}paned.c: Only show the separator if 

	* configure.in: Fixed reversed conditional causing all image
	libraries to be linked in.

2001-05-21  Joe Shaw  <joe@ximian.com>

	* gtk/gtklayout.c (gtk_text_layout_get_lines): Remove the assertion
	that top_y needs to be >= 0.

2001-05-11  Havoc Pennington  <hp@pobox.com>
	
	* gdk/x11/gdkmain-x11.c: Improve error messages for X errors and
	losing connection to the X server.

Sun May 20 13:59:20 2001  Owen Taylor  <otaylor@redhat.com>

	* configure.in: Start checks for X from pangox/pangoxft
	CFLAGS to avoid duplicate libraries.

	* gdk/Makefile.am (LDFLAGS): Remove extra -lm.

	* configure.in (GDK_PIXBUF_PACKAGES): Fix GDK_PIXBUF_PACKAGES
	to include gobject.
	
2001-05-18  Alexander Larsson  <alexl@redhat.com>

	* gtk/gtkspinbutton.c:
	Convert GtkArgs to GParams. Based on patch by John Margaglione.
	Also do size request reasonable for MAXDOUBLE. Previously it printed
	the limits to a buffer and overran it. Instead do it using log10() and
	limit the width to 10 digits.
	
	* gtk/gtkwidget.c (gtk_widget_get_property):
	Correctly handle setting the parent property to NULL.

Fri May 18 15:26:26 2001  Owen Taylor  <otaylor@redhat.com>

	* gtk/gtktextview.c (gtk_text_view_style_set): Reset 
	style attributes even if the widget isn't realized.

	* demos/gtk-demo/main.c: Use a slightly smaller font.

Fri May 18 14:25:20 2001  Owen Taylor  <otaylor@redhat.com>

	* gtk/gtkcontainer.c: Remove reallocate-redraws property.
	This is something that only a widget writer would ever want
	to change.

	* gtk/gtksignal.c: Handle G_SIGNAL_TYPE_STATIC_SCOPE for
	gtk_signal_emit_by_name().

	* gtk/gtkviewport.c: Fix some warnings.

	* gtk/gtkwidget.c gtk/gtksizegroup.c: Add "size group" facility
	allowing the requisitions of multiple widgets to be grouped
	together.

	* tests/testgtk.c: Add GtkSizeGroup test

	* demos/gtk-demo/sizegroup.c: Add GtkSizeGroup demo.

	* demos/gtk-demo/main.c demos/gtk-demo/pixbufs.c: Fix some
	warnings.

	* configure.in: Switch to using AM_GLIB_GNU_GETTEXT.

2001-04-28  Martin Baulig  <baulig@suse.de>

	* gtk/gtkimagemenuitem.[ch]: Renamed gtk_image_menu_item_add_icon()
	to gtk_image_menu_item_set_icon() and made it work if there's already
	an image.
	(gtk_image_menu_item_new): This function doesn't take any arguments anymore.
	(gtk_image_menu_item_new_with_label): New function.

Thu May 17 16:20:04 2001  Jonathan Blandford  <jrb@redhat.com>

	* demos/gtk-demo/main.c (fontify): It's the worlds ugliest
	highlighting code!!!!  The result is okay so long as you don't try
	to stress it.  It also highlights a bug in the TextView so it's in
	an unproportional font right now until it's fixed.

	*demos/gtk-demo/*.c: Clean up code a bit to make it
	ugly-parser(TM) friendly. (-:

2001-05-17  Joe Shaw  <joe@ximian.com>

	* gtk/gtktextdisplay.c (gtk_text_layout_draw): Remove the assertions
	that x_offset and y_offset must be >= 0. Clip the cursor being drawn
	if it is only partially onscreen.

Thu May 17 17:10:13 2001  Owen Taylor  <otaylor@redhat.com>

	* gtk/gtkentry.c: Make logical motion and deletion by graphemes, 
	not by characters.

	* gtk/gtkentry.c: Handle "trailing" returns from Pango when they
	are not zero or one; that is, when graphemes of multiple characters
	are involved.

	* gtk/gtktextlayout.c (line_display_index_to_iter): Remove unnecessary
	FIXME.

2001-05-17  Alexander Larsson  <alla@lysator.liu.se>
	
	* gtk/gtkbbox.c:
	Add properties, based on patch by Lee Mallabone.

	* gtk/gtknotebook.c:
	* gtk/gtktoolbar.c:
	Convert from GtkArg to GParam, based on patch by John Margaglione.
	
	* gtk/gtkhscale.c:
	* gtk/gtkvscale.c:
	* gtk/gtkhscrollbar.c:
	* gtk/gtkvscrollbar.c:
	* gtk/gtkrange.c:
	Move adjustment property to GtkRange.

	* gtk/gtklabel.c:
	Setup mnemonics on property changes

	* gtk/gtkwidget.c (gtk_widget_get_property):
	GdkExtensionMode is an enum, not a flag. Set it with
	g_value_set_enum ().

	* tests/prop-editor.c:
	Better propery editor.

	* tests/testgtk.c:
	Add new property test. Pass zero to the property editor to
	get properties from all derived types.
	
Sun May 13 12:01:12 2001  Owen Taylor  <otaylor@redhat.com>

	* autogen.sh (have_automake): Require libtool-1.4,
	automake-1.4p1.

	* acinclude.m4: Remove libtool macros.

	* gdk-pixbuf/Makefile.am: Add dependencies to loade
	modules.

	* gdk/Makefile.am: Add dependency on libgdk_pixbuf.la
	for libgdk.

	* gtk/Makefile.am: Add dependency on libgdk_pixbuf.la
	libgdk.la for libgtk.

	* modules/input/Makefile.am: Make modules have full
	dependencies.

Wed May 16 14:06:01 2001  Jonathan Blandford  <jrb@redhat.com>

	* gtk/gtktreemodel.c (gtk_tree_path_new_from_string): fix bug
	#54699 where paths weren't being checked for correctness.

Tue May 15 20:13:24 2001  Jonathan Blandford  <jrb@redhat.com>

	* gtk/gtktreeviewcolumn.c: You can now set all sorts of properties
	in any order you wan, whether or not the column is added to the
	tree, or the tree is realized.  Yay!

	* gtk/gtktreeviewcolumn.c
	(gtk_tree_view_column_setup_sort_column_id_callback): handle
	sorting columns a lot saner

	* gtk/gtktreeviewcolumn.c (gtk_tree_view_column_set_reorderable):
	new function to actually set wether or not a column is
	reorderable.

	* gtk/gtktreeview.c (gtk_tree_view_unrealize): Only destroy things
	if we have 'em.

	* gtk/gtktreeviewcolumn.c (_gtk_tree_view_column_set_tree_view):
	Fix nasty bug where we were showing the button just before
	realizing it.  As a result, the parent window was
	tree_view->window instead of tree_view->priv->header_window.

	* gtk/gtktreeview.c (gtk_tree_view_set_reorderable): new property
	to let you easily reorder a list or tree.

2001-05-15  Alexander Larsson  <alla@lysator.liu.se>

	* gtk/gtkpacker.c: Apply patch from John Margaglione that converts
	from args to properties.

Tue May 15 10:11:59 2001  Owen Taylor  <otaylor@redhat.com>

	* gtk/gtkpreview.c: Apply patch from John Margaglione converting
	from args to properties. (#51957)

	* gtk/gtkscale.c (gtk_scale_class_init): Move install property
	calls to after ->set_property call.

Mon May 14 14:56:21 2001  Owen Taylor  <otaylor@redhat.com>

	* tests/prop-editor.c: Block against redundant changes.

	* gtk/gtkpaned.c gtk/gtk[hv]paned.c: Add position, position_set
	properties.

Sun May 13 18:40:04 2001  Owen Taylor  <otaylor@redhat.com>

	* gdk/gdkpixmap.h: Remove creative formatting.

Thu May 10 19:22:28 2001  Owen Taylor  <otaylor@redhat.com>

	* gtk/gtktogglebutton.c:  Patch from John Margaglione converting to
	property API. (#51669)

	* gtk/gtkscale.c: Patch from John Margaglione converting to
	property API. (#51891)

	* gtk/gtkaccellabel.c: Applied patch from Lee Mallabone, converting
	to property API. (#50985)

Fri May 11 20:13:44 2001  Tim Janik  <timj@gtk.org>

	* gtk/gtkmain.c (gtk_main_do_event): remember widget's double
	buffering state across expose event, so we still call end_paint().

2001-05-11  Alexander Larsson  <alexl@redhat.com>

	* gtk/gtkhsv.c (paint_triangle):
	Expose the ring in the triangle at the correct place when
	exposing just a part of the triangle.

	* gtk/gtkwindow-decorate.c (gtk_decorated_window_focus_change):
	Return FALSE, or window focusing will not work.

2001-05-11  Havoc Pennington  <hp@pobox.com>

	* gtk/gtkimage.c (gtk_image_new_from_stock): docs, fixes bug
	#54144

	* gtk/gtkcolorsel.c (gtk_color_selection_new): docs, fixes
	bug #54330

Fri May 11 02:53:57 2001  Tim Janik  <timj@gtk.org>

	* gtk/gtktogglebutton.c (gtk_toggle_button_expose): don't
	propagate exposes to NULL child.

	* gtk/gtkscrolledwindow.c (gtk_scrolled_window_adjustment_changed): guard
	against not having one of the scrollbars.

	* gtk/gtklabel.c (gtk_label_setup_mnemonic): clean up after us,
	we don't keep a mnemonic window if we have no mnemonic installed.

Fri May 11 01:05:00 2001  Tim Janik  <timj@gtk.org>

	* gtk/gtktypeutils.h: grum, gtk_type_class() is not GNUC_CONST
	it has the _important_ side effect of initializing a class.

2001-05-10  Alexander Larsson  <alexl@redhat.com>

	* gdk/linux-fb/gdkprivate-fb.h:
	Make sure you can compile out the implementation/wrapper assert
	macros.

	* gdk/linux-fb/gdkdrawable-fb2.c:
	Check implementation/wrappers, initialize type for pixmap dummys.

	* gdk/linux-fb/gdkimage-fb.c (_gdk_fb_get_image):
	Hide the cursor if reading from the screen.

	* gdk/linux-fb/gdkrender-fb.c (gdk_fb_fill_span_generic):
	Fix sign bug in tiling code.

	* gdk/linux-fb/gdkwindow-fb.c (_gdk_windowing_window_clear_area):
	Handle background pixmaps.

Wed May  9 15:27:22 2001  Jonathan Blandford  <jrb@redhat.com>

	* gtk/gtktreeview.c (gtk_tree_view_set_column_drag_function): New
	function to let user control where columns are dragged.

	* gtk/gtktreeview.c (gtk_tree_view_key_press): Cancel drags if
	Escape is pressed.

Wed May  9 09:08:44 2001  Jonathan Blandford  <jrb@redhat.com>

	* gtk/gtktreeview.c (gtk_tree_view_class_init): New
	"columns_changed" signal.
	(gtk_tree_view_motion_draw_column_motion_arrow): Change column
	motion code to draw arrows to the side if indicator is outside the
	widget.
	(gtk_tree_view_map_expanded_rows): Implement.

2001-05-07  Alexander Larsson  <alexl@redhat.com>

	* demos/testpixbuf-save.c: 
	* demos/testpixbuf-drawable.c:
	Include gdkfb.h on linux-fb.

2001-05-07  Alexander Larsson  <alexl@redhat.com>

	* gdk/linux-fb/gdkdnd-fb.c (get_toplevel_window_at):
	New function for getting toplevel window at position.
	(gdk_drag_find_window): Use get_toplevel_window () instead
	of gdk_window_get_pointer(). (gdk_drag_status): Use
	correct context for getting window.

	* gdk/linux-fb/gdkproperty-fb.c (gdk_atom_name):
	g_strdup the atom name.

	* gdk/linux-fb/gdkwindow-fb.c:
	Costmetic fix.

	* gtk/gtkdnd.c (gtk_drag_source_handle_event):
	Add code for changing cursor on linux-fb backend (same as
	win32).

2001-05-07  Federico Mena Quintero  <federico@ximian.com>

	* gtk/gtkwindow.c (gtk_window_focus): Test for bin->child being
	present before doing anything with it.  Patch from Hvard Kvlen
	<havardk@netcom.no>.  Fixes Ximian bugzilla #2492 (OK, the bug
	report was not for the development branch of GTK+, but it applies
	anyways).

2001-05-04  Havoc Pennington  <hp@redhat.com>

	* configure.in: fix some shell typos

	* gtk/gtkcolorsel.c (gtk_color_selection_destroy): warning fix

	* gtk/gtkimage.c: handle animations

	* gtk/gtkcheckbutton.c (gtk_check_button_size_request): request
	border_width * 2, not just border_width

	* gtk/gtkscale.c: add "format_value" signal to allow people
	to override the way values are drawn.
	(gtk_scale_get_value_size): fix width/height mistake,
	and compute size from actual displayed text, not 
	from made-up text.

	* gtk/gtktexttag.c (gtk_text_tag_class_init): fix return type in 
	signal registration

	* tests/testtext.c: Add "Remove all tags" menu item for testing

	* gtk/gtktextbuffer.c (gtk_text_buffer_remove_all_tags): implement

	* demos/gtk-demo/main.c (main): add hack so we can find modules
	without installing gtk

	* demos/gtk-demo/textview.c (insert_text): demo font scaling

	* gtk/gtkcellrenderertext.c: Add "scale" property (font scaling
	factor)
	(gtk_cell_renderer_text_set_property): remove some bogus
	g_object_notify

	* gtk/gtktexttag.c: add "scale" property which is a font scaling
	factor

	* gtk/gtktextlayout.c (add_text_attrs): add font scale attribute 
	to layout

	* gtk/gtktextiter.c (gtk_text_iter_is_start): rename from
	gtk_text_iter_is_first

2001-01-06  Hans Breuer  <hans@breuer.org>

	* gdk/gdk.def : updated exports

	* gdk/win32/makefile.msc : -DGDK_ENABLE_BROKEN otherwise
	gdk won't compile anymore
 
	* gdk/win32/gdkevents-win32.c : initialize ret_val when
	processing GDK_FILTER functions, initialize event.key->hardware_keycode.
	Improved gdk_flush () to not only do pending drawing operations
	but also process all currently pending events. This should make
	the behaviour more similar to the X11 version.	

	* gdk/win32/gdkgc-win32.c (predraw_set_background) : a background
	option needs to be set even if there is no GDK_GC_BACKGROUND.
	(gdk_win32_hdc_get) : use predraw_set_background () independent
	of value_mask. This allows to draw dashed lines leaving the original
	background intact.

	* gdk/win32/gdkimage-win32.c (gdk_image_new_bitamp) : free data
	after processing, because we can't reuse it as the X11 version does.

	* gtk/gtk.def : updated exports

	* gtk/makefile.msc.in : added ATK, removed all test apps. (I
	would like to get rid of this file again, and use straight
	makefile.msc again, as the other Gtk+ subdirs do)

	* test/makefile.msc (new file) : build the test apps here

2001-05-05  ERDI Gergo  <cactus@cactus.rulez.org>

	* gdk/gdkpango.c (gdk_pango_get_item_properties): Peek
	strike-through setting
	(gdk_draw_layout_line_with_colors): Render strike-through

Sat May  5 10:06:24 2001  Owen Taylor  <otaylor@redhat.com>

	* Release 1.3.5

	* configure.in (GTK_MICRO_VERSION): Up to 1.3.5

	* NEWS: Updated

	* demos/gtk-demo/Makefile.am (EXTRA_DIST): Fix minor
	Makefile breakage.

Sat May  5 09:18:30 2001  Owen Taylor  <otaylor@redhat.com>

	* demos/gtk-demo/images.c (progressive_timeout): Fix
	typo in filename.

	* gtk/gtktreeview.c (gtk_tree_view_row_activated): Comment
	out FIXME warning; just too annoying.

2001-05-04  Alex Larsson  <alla@lysator.liu.se>

	* gdk/linux-fb/gdkcolor-fb.c:
	Better error messages.

	* gdk/linux-fb/gdkpixmap-fb.c (gdk_pixmap_new):
	Initialize abs_x and abs_y.
	
	* gdk/linux-fb/gdkrender-fb.c (gdk_fb_fill_span_generic):
	Correct handling of stipple offset.

	* gdk/linux-fb/gdkvisual-fb.c (gdk_visual_init):
	Treat directcolor framebuffers as truecolor.
	
Thu May  3 14:13:49 2001  Owen Taylor  <otaylor@redhat.com>

        * INSTALL.in HACKING gtk/gtkaccessible.[ch] gtk/gtk.c: Add
	dependency on Atk for accessibility support.

	* configure.in **/Makefile.am: Major reworking of substituted
	variables for CFLAGS/LIBS to make a lot more sane and 
	keep the the compile/link lines a bit shorter.

	* gdk/x11/gdkkeys-x11.c: Fix #endif with trailing stuff.

Thu May  3 08:10:54 2001  Owen Taylor  <otaylor@redhat.com>

	* gtk/gtktexttag.c (gtk_text_tag_class_init): Fix return
	value to be G_TYPE_BOOLEAN, not G_TYPE_INT, also,
	use _gtk_boolean_handled_accumulator.

Thu May  3 07:00:09 2001  Owen Taylor  <otaylor@redhat.com>

	* gtk/gtktextview.c: Patch from Juan Pablo Mendoza Mendoza
	to fix things so clicking inside selection leaves cursor
	at point where clicked. (#50324)

	* gtk/gtksettings.c (gtk_settings_class_init): Restore
	sane value for default double click time.

	* tests/testtext.c (test_init): Really path to input modules.

2001-05-03  Sven Neumann  <sven@convergence.de>

	* demos/testpixbuf-save.c: include target-specific headers as
	done in testpixbuf-drawable.c

Wed May  2 20:36:38 2001  Owen Taylor  <otaylor@redhat.com>

	* gtk/gtkentry.c (gtk_entry_real_insert_text): Reduce
	new_text_length appropriately when we run into the 
	size limit for the entry. (#53445, reported by Jeff Franks)

	* tests/testgtk.c (create_entry): Remove most of the
	property toggle buttons. Replace with a "Props" button
	that brings up a property editor.

	* tests/prop-editor.[ch] test/testtreeview.c tests/Makefile.am:
	Split the property editor code out for reuse, improve.

Wed May  2 17:26:22 2001  Owen Taylor  <otaylor@redhat.com>

	* gdk/x11/gdkevents-x11.c gdk/x11/gdkwindow-x11.c: Always
	trap errors around calls to XSetInputFocus since we have
	no way of knowing reliably whether we are viewable or
	not. (#53947)

Tue May  1 09:21:23 2001  Jonathan Blandford  <jrb@redhat.com>

	* gtk/gtktreeview.c (gtk_tree_view_button_release_drag_column):
	fix bug in dropping columns.  Moving columns now basically works
	modula some fine tuning.

Tue May  1 19:09:21 2001  Jonathan Blandford  <jrb@redhat.com>

	* gtk/gtktreeview.c (gtk_tree_view_horizontal_autoscroll): Add
	autoscroll support.  It mostly works, but could use some fine
	tuning.
	* gtk/gtktreeview.c (gtk_tree_view_button_release_drag_column):
	Actually move the column.

Mon Apr 30 20:29:27 2001  Owen Taylor  <otaylor@redhat.com>

	* gtk/gtkbutton.c gtk/gtkcheckbutton.c gtk/gtkoptionmenu.c 
	  gtk/gtkspinbutton.c gtk/gtkstyle.c gtk/gtkwidget.c:
  	  New default theme! A slighly improved version of the 2.0 Raleigh
	  theme, with Windows-esque focus/drawing default. 
	  (GtkWidget::interior_focus defaults to TRUE.)

	* gtk/gtkstyle.[ch]: Add a text_aa color halfway between text and base.

2001-04-30  Havoc Pennington  <hp@pobox.com>

	* tests/testtext.c (line_numbers_expose): fix to work with
	gtk_paint_layout change

Mon Apr 30 19:18:07 2001  Owen Taylor  <otaylor@redhat.com>

	* gtk/gtkstyle.[ch] gtk/gtkaccellabel.c gtk/gtkcellrenderertext.c
	  gtk/gtkhruler.c gtk/gtkhscale.c gtk/gtklabel.c gtk/gtkprogressbar.c
	  gtk/gtkvruler.c gtk/gtkvscale.c: Add an extra parameter
          use_text to gtk_paint_label() to deal with style->bg[] vs style->text[].

	* gtk/gtkbbox.c gtk/gtkdialog.c: Tweak padding some to deal
	  with GtkWidget::interior_focus = TRUE better.

	* gtk/gtkbutton.c: Switch ::default_spacing to ::default_border,
	::default_outside_border for more flexibility.

	* gtk/gtkwidget.c (gtk_widget_style_get_valist): Remove 
	G_VALUE_NO_COPY_CONTENTS, to correspond with the recent
	change that had to be made with g_object_get.

Sun Apr 29 20:13:40 2001  Jonathan Blandford  <jrb@redhat.com>

	* gtk/gtktreeview.c (gtk_tree_view_get_columns): new function.
	(gtk_tree_view_move_column_after): Clean up interface. 

Sun Apr 29 03:02:02 2001  Tim Janik  <timj@gtk.org>

        * gtk/gtkpacker.h:
        * gtk/gtkenums.h: moved GtkAnchorType and GtkSideType from gtkpacker.h
	 to gtkenum.h.

	* gtk/gtkmain.c (gtk_main_do_event): silence compiler (GDK_SETTING not
	handled in switch).

	* gtk/Makefile.am:
	(gtk.defs): generate enum portions with  glib-mkenums.
	(gtktypebuiltins_evals.c): generate this with glib-mkenums.
	got rid of makeenums.pl and makeenums.awk in distributed tarballs.
	
	* gtk/gtkaccelgroup.c (gtk_accel_group_add): refined havocs warning
	addition.

	* docs/Changes-2.0.txt: keep a note on signal handlers now
	not getting emitted during the emission they were connected within.

2001-04-28  Havoc Pennington  <hp@pobox.com>

	* gtk/gtkcolorsel.c (palette_new): fix bug in tooltip

2001-04-24  Havoc Pennington  <hp@redhat.com>

	* gtk/gtktextlayout.c (gtk_text_layout_move_iter_to_previous_line): 
	(gtk_text_layout_move_iter_to_next_line): fix these two for
	invisible text, lots of other stuff still hosed.

	* gtk/gtkcolorsel.c (gtk_color_selection_set_change_palette_hook):
	new function, replaces the get/set palette stuff. This function 
	is intended for use by libgnomeui which should set the hook to a
	thing which sets the palette in GConf, and we need the
	GConf-to-xsettings proxy which will result in the change being
	propagated back to the GTK app.

	* gtk/gtkaccelgroup.c (gtk_accel_group_add): add note to warning 
	about unusable signals that it may be because the signal has 
	parameters.

	* gtk/gtkwidget.c (gtk_widget_modify_style): always copy the
	style, otherwise gtkrc.c won't know to create a new GtkStyle for
	it.
	(gtk_widget_modify_color_component): call
	gtk_widget_modify_style() so the rc style will get copied.
	(gtk_widget_modify_font): ditto

	* gtk/gtkrc.c: make a couple variables static

	* gtk/gtkcolorseldialog.c (gtk_color_selection_dialog_init): hide
	help button by default, since it does nothing

	* gtk/gtkcolorsel.c: add tooltips, work on key navigation, fool
	around with UI

	* gtk/gtkentry.c (gtk_entry_realize): request enter/leave notify
	so we can have tooltips

	* gtk/gtkhsv.c (gtk_hsv_realize): request enter/leave notify so we
	can have tooltips

	* gdk/gdkimage.h: mark gdk_image_new_bitmap with
	GDK_ENABLE_BROKEN, because its memory behavior is completely
	hosed.

	* gtk/gtknotebook.c: remove key press handler, replace with
	binding set, add numeric keypad support

	* gtk/gtktextview.c (gtk_text_view_class_init): accept KP_Delete

	* gtk/gtktext.c (gtk_text_key_press): add a bunch of KP keysyms

	* gtk/gtkentry.c (gtk_entry_class_init): accept GDK_KP_Delete in
	addition to plain Delete

	* gtk/gtktextview.c (gtk_text_view_key_press_event): accept
	GDK_KP_Enter in addition to GDK_Return

	* gtk/gtkfontsel.c (gtk_font_selection_size_key_press): connect to
	activate on entry instead of key press
	(gtk_font_selection_on_clist_key_press): get
	rid of this signal handler, not needed with new font sel.

	* gtk/gtkfilesel.c (gtk_file_selection_key_press): remove a
	no-longer-needed emit_stop_by_name(), just return TRUE

	* gtk/gtkhscrollbar.c, gtk/gtkvscrollbar.c: remove keybindings
	cruft, this widget is no longer focusable.

	* gtk/gtkrange.h, gtk/gtkrange.c, gtk/gtkvscale.c,
	gtk/gtkhscale.c: Get rid of trough_keys virtual function, add
	move_slider action signal, add binding set for vscale/hscale, in
	the process support numeric keypad

	* gtk/gtkentry.c (gtk_entry_class_init): Add keypad bindings; 
	make GDK_Return and GDK_KP_Enter activate the entry via 
	binding set, instead of hardcoded.

Fri Apr 27 20:27:21 2001  Jonathan Blandford  <jrb@redhat.com>

	* gtk/gtktreeview.[hc]: Massive reorder/cleanup of a lot of the
	code.  Some documentation added.

2001-04-27  Havoc Pennington  <hp@redhat.com>

	* gtk/gtkcombo.c (gtk_combo_popup_button_press): fix warning

	* gtk/gtkmessagedialog.c (gtk_message_dialog_init): make messages selectable

	* gtk/gtkentry.c (gtk_entry_real_insert_text): don't strip
	line/para separators
	(gtk_entry_create_layout): set single paragraph mode on the layout

	* gtk/gtkbutton.c (gtk_button_new_from_stock): don't put much
	spacing between the image and label; instead, inside a button box 
	the button will get extra space that will go there, but if people 
	configure button box for 0 chubbiness, then there's no spacing.

	* gtk/gtkbbox.c (gtk_button_box_class_init): Make child ipadding
	and min/max size style properties, so people can tune their
	chubbiness.

	* tests/testgtk.c (make_toolbar): remove calls to removed toolbar
	functions

	* gtk/gtktoolbar.c (gtk_toolbar_class_init): Make space_size,
	space_style, and button_relief into style properties, remove
	functions for setting them
	
	* gtk/gtkmenu.c (gtk_menu_key_press): handle menu bar accel to pop 
	it back down

	* gtk/gtkoptionmenu.c (gtk_option_menu_get_props): free boxed
	types from gtk_widget_style_get

	* gtk/gtkmenubar.c (gtk_menu_bar_set_shadow_type): Remove, replace
	with a style property.

	* gdk/x11/gdkevents-x11.c: namespace the settings

	* gtk/gtkmenubar.c: Add F10 accelerator to move between menubars.

	* gtk/gtksettings.c (gtk_settings_class_init): remove code with
	side effects from inside g_assert(), so that G_DISABLE_ASSERT can
	be used. Also, translate doc strings for settings. Also, namespace
	the double-click-time property. Also, remove bell properties crap.

2001-04-27  Sven Neumann  <sven@gimp.org>

	* Makefile.am: before creating links, check if pkg-config files
	exist for the default target. Otherwise link to the pkg-config files
	that got installed with this build.

Thu Apr 26 19:11:46 2001  Jonathan Blandford  <jrb@redhat.com>

	* gtk/gtktreeview.c (gtk_tree_view_motion): clean up column
	dragging code.  Revealed some (potential) GdkWindow bugs.

	* gdk/x11/gdkwindow-x11.c (gdk_window_reparent): add
	_gdk_window_init_position to the end of reparent to fix the case
	of reparenting when new_x != old_x and new_y != old_y.

Thu Apr 26 10:54:50 2001  Owen Taylor  <otaylor@redhat.com>

	* gtk/gtkentry.c (strstr_len): Fix optimization that
	was correct for the use here, but completely incorrect
	in general.

Thu Apr 26 10:40:41 2001  Owen Taylor  <otaylor@redhat.com>

	* gtk/gtkwindow.h: Remove deprecation of gtk_window_set_default_size()
	until patch adding gtk_window_set_size() is recommitted. 

	* **Makefile.am configure.in gdk/x11/gdkim-11.c
	  gtk/gtkmain.c gtk/gtkimmulticontext.c gtk/gtkmain.c
	  gtk/gtkrc.c: Remove all traces of -DX_LOCALE support.
	  (#10784)

Wed Apr 25 12:16:36 2001  Owen Taylor  <otaylor@redhat.com>

	* gdk/X11/gdkevents-x11.c (gdk_event_translate): Test for 
	window == NULL in a number of cases.

	* tests/testdnd.c: Set module path for gdk-pixbuf.

Thu Apr 19 16:11:07 2001  Owen Taylor  <otaylor@redhat.com>

	* gtk/Makefile.am xembed.h: File containing #defines
	for XEMBED protocol.

	* gtk/gtkplug.[ch] gtk/gtksocket.[ch]: 

	- Change protocol from old plug/socket specific protocol
	  to XEMBED draft
	- Various fixes to work with GTK+-2.0

	Still quite a bit of work to do here to handle initiation
	from the socket side (as specified by XEMBED), to handle
	the more advanced features of XEMBED, and to figure out
	a good way to handle same-app embedding with less overhead
	than using full XEMBED.

Wed Apr 18 16:04:28 2001  Owen Taylor  <otaylor@redhat.com>

	* gtk/gtkwindow.[ch] (gtk_window_real_set_focus): Keep
	track of whether the toplevel has the focus; only send
	focus-in events to the focus widget when the window
	actually has the focus.

2001-04-25  Havoc Pennington  <hp@pobox.com>

	* gtk/gtkwindow.h: set_decorations_hint and set_functions_hint
	were still in the header

2001-04-24  Alexander Larsson  <alexl@redhat.com>

	* gtk/gtkclist.[ch]:
	* gtk/gtkctree.c:
	When there is a row highlighted for D'n'D it must alse
	be painted hightlighted on exposes. Otherwise exposes from
	the icon being dragged will mess up the hightlight.

	* gtk/gtkfontsel.c:
	Don't recenter selected font when exposing the font family
	clist. This means you can now actually scroll the font family
	list.

	* gtk/gtknotebook.c:
	Fix focus movement on scrolling tabs that are placed on the left
	and right.

2001-04-21  Havoc Pennington  <hp@pobox.com>

	* gtk/gtktextdisplay.c (gtk_text_layout_draw): handle 0-height
	empty/invisible lines.

	* gtk/gtktextiter.c (gtk_text_iter_set_visible_line_offset)
	(gtk_text_iter_set_visible_line_index): new functions to set
	indexes excluding invisible text

	* gtk/gtktextlayout.c (line_display_iter_to_index): get visible 
	index

	* gtk/gtktextiter.c (gtk_text_iter_get_visible_line_index)
	(gtk_text_iter_get_visible_line_offset): new functions to 
	get indexes excluding invisible text

	* gtk/gtkmessagedialog.c (gtk_message_dialog_init): strip out a
	bunch of extra padding that served no purpose

	* gtk/gtkdialog.c: Make all the spacings configurable via style
	properties, for chubbiness configuration in themes

	* tests/testtext.c: fix path to the immodules.
	
Mon Apr 23 18:57:03 2001  Jonathan Blandford  <jrb@redhat.com>

	* gtk/gtksocket.c (gtk_socket_filter_func): add missing '}' that
	got munched by #endif.

	* gtk/Makefile.am (gtk_plug_c_sources): add missing '\'

	* gtk/gtktreeview.c: Refactored code to clean up a number of
	events.

	* gtk/gtktreemodel.c (gtk_tree_path_compare): Switched return
	values to make consistent with other functions.  Spotted by Jeff
	Franks <jcf@tpg.com.au>.

	* gtk/gtktreeview.h (struct _GtkTreeViewClass): Fixes to signal
	declaration spotted by Jeff Franks <jcf@tpg.com.au>.

2001-04-23  Sven Neumann  <sven@gimp.org>

	* gtk/Makefile.am
	* gtk/gtkplug.c
	* gtk/gtksocket.c: on request of Owen, reverted my last change 
	and exclude gtkplug.c/gtksocket.c from the build for non-X11 targets

2001-04-23  Sven Neumann  <sven@gimp.org>

	* gtk/gtkplug.c: put into #ifdef GDK_WINDOWING_X11 to make GTK+
	compile for non-X11 targets again

2001-04-20  Alexander Larsson  <alexl@redhat.com>

	* gtk/gtkcolorsel.[ch]:
	API Change. Take GdkColor arguments instead of gdouble *.
	Leave the old gtk_color_selection_set_color for compatibility,
	but marked deprecated.
	Do correct rounding when converting RGB <-> HSV.
	
	* gtk/gtkcolorseldialog.c:
	* tests/testgtk.c:
	Use new GtkColorSelection API.

	* gtk/gtkhsv.c:
	Fix problem selecting colors in triangle when Hue is 330.
	Fix some black dots around the HSB triangle.
	
	* gtk/gtkfilesel.c:
	return FALSE from the focus_in_event handler to fix focus problems.

2001-04-18  Havoc Pennington  <hp@redhat.com>

	* gtk/gtkwindow.c (gtk_window_class_init): add signals and binding
	set, so keybindings are configurable	
	(gtk_window_activate_default): Change to activate the focus widget
	instead if there's a focus widget, to be consistent with the
	behavior that previously existed in key_press_event

2001-04-18  Havoc Pennington  <hp@redhat.com>

	* gdk/gdkkeyuni.c: Handle numeric keypad keysyms; bug #50201

2001-04-18  Havoc Pennington  <hp@redhat.com>

        Close bug #50615:
	
	* gtk/gtkstyle.c (gtk_default_draw_layout): Use text_gc to draw
	the layout

	* gtk/gtktext.c: Use base/text instead of bg/fg throughout

	* gtk/gtkentry.c: Use base/text instead of bg/fg throughout

	* gtk/gtktextdisplay.c: Use base/text instead of bg/fg throughout
	
	* gtk/gtkstyle.c (gtk_style_init): make GTK_STATE_SELECTED default
	to blue for base, in addition to bg
	
2001-04-18  Havoc Pennington  <hp@redhat.com>

	* tests/testgtk.c (create_image): allow shrinking the image window
	to test that we clip to allocation.

	* gtk/gtkimage.c (gtk_image_expose): clip to allocation,
	#9845

	* gtk/gtkenums.h: move GtkWrapMode in here, #50472

Wed Apr 18 14:23:14 2001  Owen Taylor  <otaylor@redhat.com>

	* gdk/x11/gdkimage-x11.c (gdk_image_new): Try changing
	mode on shm segments to 0600. We'll see who complains.

	* gdk/gdkwindow.c (_gdk_window_destroy_hierarchy): Call
	_gdk_windowing_window_destroy() AFTER recursing through
	children.

	* tests/Makefile.am (noinst_PROGRAMS): Build testsocket,
	testsocket_child on X.

	* tests/testsocket[_child].c: Fix uses of
	gtk_window_get_default_accel_group().

	[ Merge patch from Ramiro Estrugo  <ramiro@eazel.com> from gtk-1-2 ]

	* gdk/gdkimage.c: (gdk_image_get):
	Deal with the possibility that XGetImage() might return NULL.
	Allocate the GdkImagePrivate structure only after XGetImage()
	succeeds in order not to dereference a NULL ximage pointer.  This
	prevents a core dump when XGetImage() fails - which is unlikely,
	but can happen due to race conditions accessing the geometries of
	drawables.  An x error will still be triggered, but the gdk image
	wrapper at least wont seg fault.
	
2001-04-18  Havoc Pennington  <hp@redhat.com>

	* gtk/gtkimage.c: fix to properly queue resizes when the image is
	set

	* gtk/gtktextview.c (gtk_text_view_do_popup): desensitize Paste
	if the insertion point isn't editable

	* demos/gtk-demo/images.c: Added a GtkImage demo

	* demos/gtk-demo/drawingarea.c: drawing area demo
	
	* demos/gtk-demo/menus.c (create_menu): cleanups

Wed Apr 18 12:15:52 2001  Owen Taylor  <otaylor@redhat.com>

	* gdk/x11/gdkwindow-x11.c gdk/x11/gdkwindow-x11.h 
	  gdk/x11/gdkevents-x11.c: Introduce an extra child
	of toplevel windows that serves to hold the focus to
	avoid events being delivered to embedded windows.

	* gdk/x11/gdkwindow-x11.c (gdk_window_new): Introduce
	some extra variables to clean up code and reduce the
	number of casts.

	* gdk/x11/gdkwindow-x11.h (struct _GdkXPositionInfo): Use
	guint for 1 bit bit fields, not gboolean.

Wed Apr 18 10:04:23 2001  Owen Taylor  <otaylor@redhat.com>

	* gtk/gtktooltips.c (gtk_tooltips_paint_window): Return FALSE,
	not TRUE. (Fixes #52925)

Tue Apr 17 18:05:34 2001  Owen Taylor  <otaylor@redhat.com>

	* Released 1.3.4

	* NEWS: Updated

	* gtk/gtktextview.c (gtk_text_view_class_init): Fix to not
	use GTK_TYPE_ENUM.

Tue Apr 17 13:47:12 2001  Owen Taylor  <otaylor@redhat.com>

	* configure.in: Don't put -lgthread in GLIB_LIBS, GLIB_DEPLIBS

	* gtk/gtktypeutils.h gtk/gtksignals.h: Restore proper parameter
	names to compatibility #defines so docs work.

	* gtk/gtkenums.h: Remove GtkMenuFactoryType

	* gtk/gtkwindow.c gtk/gtkdnd.c: Docs cleanups.

	* configure.in: Don't include -lgthread in GLIB_LIBS, GLIB_DEPLIBS

	* tests/testgtkrc: No magenta cursors, please.

	* README.in INSTALL.in HACKING README.cvs-commits: Updated.

	* gtk/gtkenums.h (enum): Remove left over GtkMenuFactoryType.
	
Mon Apr 16 14:38:41 2001  Owen Taylor  <otaylor@redhat.com>

	* gtk/gtklist.c gtk/gtklistitem.c: Remove explicit pointer
	grabs, since they are no longer necessary.

	* gtk/gtkcombo.c (gtk_combo_popup_button_press): Fix #52926
	by signal_connect() and call gtk_button_pressed() rather
	than signal_connect_after().

	* tests/testgtk.c: Restore radio menu items to combos 
	since they'll look OK with Raleigh, and it is easier
	than finishing the process of removing them that was
	started earlier.

2001-04-16  Hans Breuer  <hans@breuer.org>

	* gdk/gdk.def :
	* gtk/gtk.def : added all exports required to link PyGtk 0.7.1

	* gdk/gdkfont.h : #define GDK_TYPE gdk_font_get_type ()
	we are interested in the functions return value not the function address
	* gdk/gdkvisual.h : same for GDK_TYPE_VISUAL

	* gtk/makefile.msc.in : reflect movement of GDK_TYPEs from gtk to gdk

2001-04-14  Hans Breuer  <hans@breuer.org>

	* gdk/gdk.def :
	* gdk/makefile.msc : updated

	* gdk/win32/gdkdrawable.win32 (gdk_win32_draw_rectangle) : if modus is 
	"fill with tile" do so with new helper function	gdk_win32_draw_tiles 
	(the testgtk::text backgound pixmap is drawn again)
	Changed SetTextAlign before pango_win32_render to TA_BASELINE to reflect 
	Win32 Pango change
	* gdk/win32/gdkprivate-win32.h : prototype for gdk_win32_draw_tiles

	* gdk/win32/gdkproperty-win32.c : first implementation of gdk_setting_get
	Not sure if the returned settings have the right unit, because I couldn't
	find any docs for the X version ...

	* gtk/gtk.def :
	* gtk/makefile.msc.in : updated

Thu Apr 12 17:41:17 2001  Owen Taylor  <otaylor@redhat.com>

	* gtk-2.0.m4: Fix up to refer to GTK+, not to GLib; fix some
	wording problems. (Compared to version from Johannes Stezenbach to
	check correctness.)

Thu Apr 12 21:04:26 2001  Tim Janik  <timj@gtk.org>

	* gtk/gtktreeview.c (_gtk_tree_view_column_start_drag): get
	this to compile.

2001-04-12  Anders Carlsson  <andersca@codefactory.se>

	* gtk/gtkcellrenderertextpixbuf.c (gtk_cell_renderer_text_pixbuf_class_init): It's pixbuf_pos,
	not pixbufpos.

	* gtk/gtkcellrendererpixbuf.c (gtk_cell_renderer_pixbuf_render): Fix small typo.

	* gtk/gtkcellrenderer.c (gtk_cell_renderer_get_property): xpad and ypad
	are unsigned insts, therefore use g_value_set_uint.
	(gtk_cell_renderer_set_property): Likewise, use g_value_get_uint.

Sun Apr  8 05:36:06 2001  Jonathan Blandford  <jrb@redhat.com>

	* gtk/gtktextview.c (gtk_text_view_class_init): fix a fixme.

	* gtk/gtkcellrendertoggle.c: change GTK_TYPE_POINTER to
	GTK_TYPE_STRING.

	* gtk/gtktreeview.c: New functions to allow initial column
	dragging work.

	* gtk/gtktreeviewcolumn.c: Initial column dragging support.

	* tests/testtreefocus.c: give dave some love.

	* tests/testtreesort.c: Modify test to check really long samples.

2001-04-11  Alexander Larsson  <alexl@redhat.com>

	* gtk-2.0.m4: Pass pkg-config options
	before the other args so it works even if
	POSIXLY_CORRECT is set.

Mon Apr  9 19:02:07 2001  Tim Janik  <timj@gtk.org>

	* configure.in (GTK_MICRO_VERSION): increment version to 1.3.4 (binary
	0, interface 0).

2001-04-04  Denis Oliver Kropp  <dok@convergence.de>

	* gtk/gtkcalendar.c (gtk_calendar_button_press):
        check for action_func != NULL

2001-04-04  Sven Neumann  <sven@gimp.org>

	* tests/testgtk.c (test_init): corrected path to gtk.immodules

Wed Apr  4 09:18:18 2001  Tim Janik  <timj@gtk.org>

	* Released Gtk+-1.3.3.

Wed Apr  4 07:42:23 2001  Tim Janik  <timj@gtk.org>

	* gdk/Makefile.am (EXTRA_DIST): add makeenums.pl to EXTRA_DIST.

Wed Apr  4 04:13:18 2001  Tim Janik  <timj@gtk.org>

	* gtk/stock-icons/Makefile.am: stay in builddir and read/write
	files to/from source dir. (if we don't stay in builddir, we
	can't reach make-inline-pixbuf.

	* gdk/Makefile.am (gdkenumtypes.c): add $(srcdir) to mekeenums.pl
	deps.

	* configure.in (GTK_MICRO_VERSION): up and away (1.3.3 bin/interface
	ages 0).

Tue Apr  3 15:04:45 2001  Jonathan Blandford  <jrb@redhat.com>

	* gtk/gtktreemodelsort.h:  removed set_sort_column, as it was
	moved to the GtkTreeSortable interface.

	* gtk/gtktreeselection.c (gtk_tree_selection_selected_foreach):
	Make more efficient (fixes #50262).

Tue Apr  3 13:55:37 2001  Owen Taylor  <otaylor@redhat.com>

	* NEWS: Updated.

	* configure.in: Remove support for uninstalled glib.

	* gtk/gtkdnd.c (gtk_drag_highlight_expose): Return FALSE as
	so as not to stop emission.

	* gtk-config-2.0.in: Exit with an error message that gtk-config-2.0
	is no longer supported.

	* Makefile.am gtk/Makefile.am tests/*: Moved all tests
	into tests, change build order to build modules before
	gtk/.

	* modules/input/Makefile.am: Move gtk-query-immodules-2.0 invocation
	to here.

Tue Apr  3 13:52:57 2001  Tim Janik  <timj@gtk.org>

	* gtk/gtkitemfactory.[hc]: changed gtk_item_factory_dump_items()
	and gtk_item_factory_dump_rc() GtkPatternSpec argument to
	GPatternSpec. this is actually unlikely to cause breakage in
	third-party apps since except for gle, pretty much ever caller
	passes NULL here.

	* gtk/gtkbindings.[hc]: removed gtk_pattern_*() API.

	* *.c: use g_pattern_*() API.

	* docs/Changes-2.0.txt: GtkPatternSpec->GPatternSpec updates.

	* gtk/gtkstyle.c (gtk_default_draw_resize_grip): assert unhandled
	directions aren't passed in.

	* gtk/gtksettings.[hc] (_gtk_settings_parse_convert): export conversion
	functionality to be usable from gtkstyle.c as well, give precedence
	for conversion to user-supplied parsers.
	s/_gtk_rc_property_parser_for_type/_gtk_rc_property_parser_from_type/;

	* gtk/gtkstyle.c (_gtk_style_peek_property_value): use
	_gtk_settings_parse_convert() for rcporperty value conversion.

2001-04-03  Alexander Larsson  <alexl@redhat.com>

	* gdk/linux-fb/gdkevents-fb.c:
	Add empty gdk_setting_get().

Tue Apr  3 05:09:07 2001  Tim Janik  <timj@gtk.org>

	* gtk/gtkmain.c (_gtk_boolean_handled_accumulator): use more elaborate
	variable names.
	
	* gtk/makeenums.pl: touch this so enum files get remade.

Mon Apr  2 19:36:57 2001  Jonathan Blandford  <jrb@redhat.com>

	* gtk/gtktreestore.c (gtk_tree_store_init):  Bug fix to make trees
	work again when not sorted.

	* gtk/gtktreeview.c (gtk_tree_view_class_init): Add "collapse_row"
	and "expand_row" signal, closing bug 52578.

	* gtk/gtktreeview.c (gtk_tree_view_expand_row): Add signal
	support.

	* gtk/gtktreeview.c (gtk_tree_view_collapse_row): Add signal
	support.

Mon Apr  2 18:18:07 2001  Owen Taylor  <otaylor@redhat.com>

        * gdk/gdkevents.h: Add GdkEventSetting event for notification
	of changes to system settings, gdk_setting_get() to retrieve
	a single system setting.

	* gdk/x11/gdkevents-x11.c: Bridge gdk_setting_get() and GdkEventSetting
	to the draft XSETTINGS mechanism.

	* gdk/x11/xsettings-{common,client}.[ch]: Sample-implementation of
	XSETTINGS.

	* gtk/gtkmain.c gtk/gtksettings.[ch]: Propagate notification
	of GDK settings changes to the GtkSettings object.

	* gdk/gdkevents.[ch] gdk/gtk/gtksettings.c: Hook up the
	double-click-timeout property to GDK.

	* gdk/gdkcolor.[ch] gdk/gdkvisual.h gdk/gdkevent.[ch] gdk/gdkfont.[ch]:
	Define GDK boxed types here.

	* gdk/Makefile.am gdk/makeenums.pl: Generate source files
	gdk/gdkenumtypes.[ch] for enum definitions.

	* gtk/gtkcompat.h: Add defines for GTK_TYPE_GDK_*
	* gtk/gtk-boxed.defs: Comment out GDK types
	* gtk/gtktypeutils.h: Remove GDK types
	* gtk/Makefile.am: No longer scan GDK headers for enumerataions

Mon Apr  2 16:41:08 2001  Owen Taylor  <otaylor@redhat.com>

	* Applied patch from Ron Steinke to add signal accumulators
	so that signals with the convention 'TRUE return means
	handled' stop emission on a TRUE return.

	* gtk/gtkmain.[ch]: Add private accumulator 
	_gtk_boolean_handled_accumulator, used throughout GTK+.
	
	* gtk/gtkspinbutton.c: Add accumulator for ::output.

	* gtk/gtktipsquery.c: Add accumulator for ::widget_selected
	
	* gtk/gtkwidget.c: Add accumulators for event signals,
	::drag_motion, ::drag_drop. Use _gtk_boolean_handled_accumator
	for ::mnemonic-activate.

	* gtk/gtkwindow.c: Add accumulator for ::frame_event

Mon Apr  2 16:24:21 2001  Owen Taylor  <otaylor@redhat.com>

	* gtk/gtkwidget.c: Add missing include.

Mon Apr  2 16:56:15 2001  Jonathan Blandford  <jrb@redhat.com>

	* gtk/gtkmarshal.list (VOID:BOXED,BOXED,BOXED,BOXED): new
	marshaller.

	* gtk/gtktreemodel.c (gtk_tree_model_range_changed): change
	"changed" signal to "range_changed".

	* gtk/gtktreeview.c (gtk_tree_view_set_model): fix small bug where
	removing a tree from one model would remove all trees from that
	model.
	* gtk/gtktreeview.c (gtk_tree_view_range_changed): use range
	changed signal instead.

Mon Apr  2 16:13:58 2001  Owen Taylor  <otaylor@redhat.com>

	* gtk/gtkinvisible.c (gtk_invisible_style_set): Avoid
	chaining up to parent impl, since we have a INPUT_ONLY
	window.

	* gtk/gtkentry.[ch]: Add a cursor_color property to set the
	foreground color for the cursor.

Mon Apr  2 15:06:13 2001  Owen Taylor  <otaylor@redhat.com>

	* gtk/gtkstyle.c (_gtk_style_peek_property_value): Reference 
	param spec when caching property values, since we unref it
	later when we free the style.

	* gtk/gtkoptionmenu.c (gtk_option_menu_get_props): Dont' free
	values since they are retrieved with G_VALUE_NO_COPY_CONTENTS.

Mon Apr  2 10:47:57 2001  Owen Taylor  <otaylor@redhat.com>

	* gtk/gtkwidget.c (gtk_widget_class_init): Fix 
	G_VALUE_NO_COPY_CONTENTS instead of G_SIGNAL_TYPE_STATIC_SCOPE
	stupidity.

Mon Apr  2 00:51:11 2001  Owen Taylor  <otaylor@redhat.com>

	[ First pass at adding style properties. Still needs some definite
	fine-tuning. ]

        * gtk/gtkbutton.c: Add ::default_spacing style property.
	 
	* gtk/gtkcheckbutton.[ch] gtkradiobutton.c: Add ::indicator_size,
	::indicator_spacing style properties.

	* gtk/gtkoptionmenu.c: Add ::indicator_size, ::indicator_spacing
	style properties.

	* gtk/gtk{,h,v}paned.[ch]: Make handle_size a style property
	rather than a normal property.

	* gtk/gtkwidget.c: Add an ::interior_focus style property to
	draw focus inside buttons, in the Windows/Java Metal/etc. style.

	* gtk/gtkbutton.c gtk/gtkcheckbutton.c gtk/gtktogglenbutton.c:
	Honor ::interior_focus.
	
	* gtk/gtkentry.c: Don't draw focus at all when ::interior_focus is 
	TRUE.

	* gtk/gtkrange.[ch] gtk/gtk{h,v}scrollbar.c gtk/gtk{h,v}scale.c:
	Add ::slider_width, ::trough_border, ::stepper_size,
	::stepper_spacing style properties.

	* gtk/gtkscale.[ch] Add ::slider-length style property.

2001-04-02 Alexander Larsson   <alexl@redhat.com>

	* gdk/linux-fb/gdkwindow-fb.c:
	Add gdk_window_begin_resize_drag and gdk_window_begin_move_drag. Remove some
	warnings that were spewed on startup.

	* gtk/gtkwindow-decorate.c:
	gtk_window_reposition -> _gtk_window_reposition

Sun Apr  1 21:37:22 2001  Owen Taylor  <otaylor@redhat.com>

	* gtk/gtkwidget.[ch] gtk/gtktypeutils.c gtk/gtk-boxed.defs:
	Add boxed type for GtkRequistion. Use it for ::size-request.

	* gtk/gtkstyle.[ch] gtk/gtktypeutils.c gtk/gtk-boxed.defs:
        Add a new GtkBorder structure useful for geometry properties
	for widgets. Add corresponding GTK_TYPE_BORDER.
	
	* gtk/gtkwidget.c (gtk_widget_class_install_style_property):
	Support automatic parser selection like
	gtk_settings_install_property_parser().

	* gtk/gtksettings.c (_gtk_rc_property_select_parser): Export
	functionality for use by gtk_widget_class_install_style_property.
	Support GTK_TYPE_BORDER, GTK_TYPE_REQUISITION.

Sun Apr  1 20:48:59 2001  Owen Taylor  <otaylor@redhat.com>

	* gtk/gtkentry.c (gtk_entry_class_init): Make invisible-char
	g_param_spec_unichar(). 

Sun Apr  1 23:41:37 2001  Tim Janik  <timj@gtk.org>

	* gdk/x11/gdkwindow-x11.c (gdk_window_focus): raise window for non
	_NET window managers.

	* gtk/gtkmenufactory.[hc]: cvs removed those files now.

Sun Apr  1 08:00:13 2001  Tim Janik  <timj@gtk.org>

	* gtk/gtkwidget.[hc]: got rid of gtk_widget_popup(), a function that
	bad needs to be nuked, not just deprecated.

	* gtk/gtktooltips.c (gtk_tooltips_draw_tips): don't use 
	gtk_widget_popup().

	* gtk/*.[hc]: s/activate_mnemonic/mnemonic_activate/g;
	
	* gtk/gtkmenufactory.[hc]: removed this long-standingly deprecated
	widget.
	
	* docs/Changes-2.0.txt: updates.
	
Sun Apr  1 01:02:54 2001  Jonathan Blandford  <jrb@redhat.com>

	* gtk/gtktreestore.c (gtk_tree_store_sort_iter_changed):
	for (i = 0; i < 100; i ++)
	  g_print ("I will confirm it compile before committing\n");

Sun Apr  1 00:52:06 2001  Jonathan Blandford  <jrb@redhat.com>

	* gtk/gtktreestore.c: Initial work on implementing the
	GtkTreeSortable interface.  Basicaly a big cut'n'paste job.

Sun Apr  1 03:28:14 2001  Tim Janik  <timj@gtk.org>

	* gtk/gtkwidget.c: fixed a bunch of notifications, added
	reference counts around emissions where the widget is used afterwards.
	added freeze/thaws around multiple properties being notified.
	(_gtk_widget_get_aux_info): cleanups.
	
	* gtk/gtksettings.c (gtk_settings_install_property): provide
	default parsing functions for gdkcolor, enums and flags.

	* gtk/gtkwindow.[hc]: partially reverted patch from havoc,
	applied by owen.
	backed out gtk_window_get_location(), gtk_window_set_location(),
	gtk_window_get_size() and gtk_window_set_size(), these
	have to be sorted out wrg x/y/width/height/default_with/default_height
	properties.
	kept a flag in GtkWindowGeometryInfo to handle user
	resetting default sizes.
	cleaned up ZVT comments.
	bunch of assorted bug fixes, notification fixes.
	(_gtk_window_reposition): make this a really internal function.
	
	* gtk/testgtk.c: fixups.
	
2001-03-31  Hans Breuer  <hans@breuer.org>

	* config.h.win32.in : disable USE_MMX for msvc build cause
	the assembler doesn't fit and is out of my scope. Disable
	USE_GMODULE for msvc build as wel. The right way to share
	binaries on win32 would be to use libtiff.dll etc. To reduce
	installation hassles IMO it's better to include all fileformats
	builtin to gdk-pixbuf

	* gdk-pixbuf/makefile.msc : new file

	* gdk/gdk.def : updated

	* gdk/win32/gdkevents-win32.c : don't erase the background if
	.no_bg is set. It improves the scrolling (e.g. of testgtk main
	buttons
	* gdk/win32/gdkgeometry-win32.c : added comment about the above

	* gdk/win32/gdkwindow-win32.c : added three new functions like
	the X version. Only one is implemented, because the other two
	"gdk_window_begin_(resize|move)_drag" got no docs and appear to
	be default behaviour on win32 anyway ...

	* gtk/gtk.def : updated

	* gtk/makefile.msc.in : update for new files, use glib-genmarshal
	from where it was built and add an additional rule to automagically
	build gtkmarshal.[hc]

	* gtk/gtkfilesel.c (open_new_dir) : don't increase n_entries
	before array access for the current entry isn't finished

	* gtk/gtktreeitem.c (gtk_tree_item_subtree_button_click) :
	use g_return_val_if_fail

	* gtk/testgtk.c (window_controls) : don't use the *wrong* size
	for the static array, but let the compiler calculate it. It
	makes me wonder if gcc isn't capable to catch bugs like this ...

2001-03-31  James Henstridge  <james@daa.com.au>

	* gtk/gtkwidget.c (gtk_widget_size_adjust): fix use of magic
	constant "-1" in the aux info structure.

2001-03-30  Alexander Larsson  <alexl@redhat.com>

	* gtk/gtkbutton.c (gtk_button_get_property):
	* gtk/gtklabel.c:
	Remove leaks.
	
	* gtk/gtkcontainer.c:
	* gtk/gtkhscale.c:
	* gtk/gtkhscrollbar.c:
	* gtk/gtklayout.c:
	* gtk/gtkmisc.c:
	* gtk/gtkprogress.c:
	* gtk/gtkprogressbar.c:
	* gtk/gtkrange.c:
	* gtk/gtktable.c:
	* gtk/gtkviewport.c:
	* gtk/gtkvscale.c:
	* gtk/gtkvscrollbar.c:
	* gtk/gtkwidget.c:
	Property patches, based on patches from John Margaglione and Lee Mallabone.

Thu Mar 29 21:20:38 2001  Mike Kestner  <mkestner@ameritech.net>

	* gtk/gtkspinbutton.c : added value_changed signal which proxies for the
	adjustment. Cleaned redundant preconditions (spin != NULL). Added
	inline API function docs.
	(gtk_spin_button_new_with_range): New convenience constructor.
	(gtk_spin_button_set_increments): New adjustment helper.
	(gtk_spin_button_set_range): New adjustment helper.

	* gtk/testgtk.c : added test of the new convenince constructor and
	value_changed signals.

Thu Mar 29 20:20:38 2001  Jonathan Blandford  <jrb@redhat.com>

	* gtk/gtktreemodel.c (gtk_tree_row_ref_reordered_callback): Now we
	listen to the reorder signal.

Wed Mar 28 20:30:26 2001  Owen Taylor  <otaylor@redhat.com>

	* gtk/gtkwidget.[ch] (_gtk_widget_get_aux_info): Add private function
	to get the aux info structure fo the widget.

	* gtk/gtklabel.c gtk/gtkscrolledwindow.c gtk/gtkwindow.c: Use
	above function.

        [ Patch from  Havoc Pennington  <hp@redhat.com> ]

	* gdk/x11/gdkwindow-x11.c (gdk_window_get_frame_extents): function
	to get the size of the window manager frame, basically the same
	code that gdk_window_get_root_origin() had
	(gdk_window_get_root_origin): use gdk_window_get_frame_extents()

	* gtk/gtkwindow.c (gtk_window_set_default_size): use
	gdk_window_resize() if the window is realized and resizeable

	* gdk/x11/gdkwindow-x11.c (gdk_window_set_geometry_hints): fix
	typo so that setting gravity works

	* gtk/gtkwindow.c (gtk_window_move_resize): don't ever use
	allocation if auto_shrink is on, even if the default size
	has not changed.

	* gtk/gtkwidget.c (gtk_widget_render_icon): remove bogus
	g_return_if_fail

Thu Mar 29 16:29:12 2001  Jonathan Blandford  <jrb@redhat.com>

	* gtk/gtkliststore.c (gtk_list_store_iter_changed): Massive
	reordering/sorting work.  Now pretty much works.

	* gtk/gtkrbtree.c (_gtk_rbtree_reorder): Lots of work to make
	reorder mostly work.  Still need to get the parity correct.

	* gtk/gtktreeviewcolumn.c: Listen for "model" property changed
	signal, so I can listen for the sort_column_changed signal so I
	can change my "sort_indicator" property.  Cool.

Wed Mar 28 00:03:10 2001  Owen Taylor  <otaylor@redhat.com>

	[ Patch from Havoc Pennington, hp@redhat.com ]

	* gdk/gdkwindow.h gdk/x11/gdkwindow-x11.c:
	Add functions gdk_window_begin_resize_drag/begin_move_drag
	to start resizing or moving a toplevel window. This
	is done either using the _NET_WM_MOVERESIZE protocol,
	or, if that isn't present, by emulation.

	* gtk/gtkwindow.[ch]: Add functions gtk_begin_move/resize_drag
	to export the above to GTK+-land.

	* gtk/gtkstyle.[ch]: Add ->draw_resize_grip() paint func.
	
	* gtk/gtkwindow.c gdk/gdkwindow.[ch] (gdk_window_constrain_size):
	Move this function into gdkwindow, since we need it
	when implementing fallback resizing.

	* gdk/x11/gdkwindow-x11.c: gdk_window_set_geometry_hints.
	Fix typo when setting gravity.

	* gtk/gtkstatusbar.[ch] (gtk_statusbar_set_has_resize_grip):
	Add an optional (but on by default) resize grip for resizing 
	the parent window.

01-03-29  Alexander Larsson  <alexl@redhat.com>

	* gtk/gtktooltips.c (gtk_tooltips_event_handler):
	Don't return TRUE from the event handler,that blocks all
	event signals on the tooltip widget. Now you can press buttons
	in toolbars again.

Wed Mar 28 19:20:43 2001  Owen Taylor  <otaylor@redhat.com>

	* gtk/testtext.c (create_buffer): Add missing NULL on
	valist.

	* gtk/gtkcheckmenuitem.c (gtk_check_menu_item_class_init): Fix
	c-n-p problem with INCONSISTENT property.

        [ Patch from Havoc Pennington  <hp@redhat.com> ]

	* gtk/gtkentry.h (struct _GtkEntryClass): add same populate_popup
	hook.

	* gtk/gtktextview.h (struct _GtkTextViewClass): add populate_popup
	signal as a hook for extending the default popup menu

	* gtk/gtkimmulticontext.c (gtk_im_multicontext_append_menuitems):
	use radio menu items for the input method menuitems

	* gtk/gtkimcontextsimple.c (check_hex): do better validation of 
	inserted unicode from Ctrl-Shift-hex input method

	* gtk/gtktextbtree.c (_gtk_text_btree_insert): remove utf8
	validatation here, already done at GtkTextBuffer level.

	* gtk/gtkwidget.c (gtk_widget_class_init): add binding set, add
	popup_menu run action signal and Shift+F10 and Menu keybindings.

	* gtk/gtkentry.c: implement a default handler for popup_menu

	* gtk/gtktextview.c: implement a default handler for popup_menu

	* gtk/gtkmenu.c (gtk_menu_popup): select first item if popup is
	from a key event
	
	* gtk/gtklabel.c: remove "trailer" cruft

Wed Mar 28 17:27:12 2001  Jonathan Blandford  <jrb@redhat.com>

	* gtk/gtkrbtree.c (_gtk_rbtree_reorder): new function to
	handle reordering of trees.  Seems to mostly work w/ the exception
	of the parity flag.

	* gtk/gtktreeview.c (gtk_tree_view_reordered): handle "reordered"
	signal.

Wed Mar 28 21:12:37 2001  Tim Janik  <timj@gtk.org>

	* gtk/gtkwidget.h: c++ fixes.

Sun Mar 25 15:51:28 2001  Owen Taylor  <otaylor@redhat.com>

	* gtk/gtksettings.c (gtk_settings_init): Fix use of uninitialized
	memory.

Tue Mar 27 22:36:07 2001  Owen Taylor  <otaylor@redhat.com>

	* gtk/gtkwidget.h gtk/gtkrange.h: Apply patch from 
	Nils Barth fixing event return values. (#51041)

	* gtk/gtkwidget.c: Fix some return values for default
	functions.

	* gtk/gtk[vh]scrollbar.c gtk/gtk[vh]range.c: Fix
	return values for trough_keys functions.

	* gtk/gtkwidget.h (struct _GtkWidgetClass): Fix return
	value for add_accelerator (shoudl have been a void
	return.)

	* gtk/gtkcellrenderer.[ch]: gtkcellrenderertoggle.h:
	Fix return type of EVENT.

	* gtk/gtkmarshal.list gtk/gtktexttag.c: Make EVENT
	signal return a boolean.

Tue Mar 27 22:07:44 2001  Jonathan Blandford  <jrb@redhat.com>

	* gtk/gtkliststore.c (gtk_list_store_sort): Fix arguments to
	reordered signal.

	* tests/testtreesort.c (main): fix spelling.

Tue Mar 27 20:55:29 2001  Jonathan Blandford  <jrb@redhat.com>

	* gtk/gtkliststore.c: More work on implementing sortable
	interface.

Mon Mar 26 15:48:45 2001  Owen Taylor  <otaylor@redhat.com>

	* gtk/gtkwindow.c (gtk_window_list_toplevels): Don't
	reference the widgets in the resulting list. (#11821)
	This makes this consistent with gtk_container_children.

	* gtk/gtkwindow.c gtk/gtkwidget.c: Fix up the two
	uses of gtk_window_list_toplevels.

Mon Mar 26 15:26:17 2001  Owen Taylor  <otaylor@redhat.com>

	* gtk/gtkimcontext.c (gtk_im_context_set_use_preedit): Add
	a virtual function to set whether the IM context should use 
	the preedit string. (#51922)
	
Mon Mar 26 14:42:59 2001  Owen Taylor  <otaylor@redhat.com>

	* gdk/gdkpango.h: Remove stale FIXME comment.

2001-03-26  Alexander Larsson  <alla@lysator.liu.se>

	* gtk/gtkfilesel.c (gtk_file_selection_get_filename):
	Fixed bug that returned NULL if a filename was selected.

2001-03-24  Havoc Pennington  <hp@pobox.com>

	* gtk/gtkthemes.c (gtk_theme_engine_load): improve error message
	to contain the word "theme"

2001-03-24  Havoc Pennington  <hp@pobox.com>

	* gtk/gtkhsv.c (gtk_hsv_move): make motion around the ring much
	slower but finer-grained
	(gtk_hsv_focus): get initial focus on the ring or triangle 
	according to tab direction

	* gtk/testgtk.c (main): get rid of weird sleep(1) on exit

2001-03-23  Havoc Pennington  <hp@pobox.com>

	* gtk/gtkhsv.c: make this somewhat key-navigable

	* gtk/gtkfontsel.c: mnemonics

	* gtk/gtkgamma.c: mnemonics

	* gtk/gtkcolorsel.c: add mnemonics to labels

2001-03-22  Havoc Pennington  <hp@pobox.com>

	Applied big patch from Seth Lytle to fix event handler return
	values, slightly modified.

	* gtk/gtkcalendar.c (gtk_calendar_button_press): return TRUE if
	handled.
	(gtk_calendar_key_press): return TRUE for GDK_space triggers
	select_day

	* gtk/gtkclist.c (gtk_clist_button_press): return TRUE if handled
	(gtk_clist_button_release): return TRUE if handled

	* gtk/gtkcolorsel.c (mouse_release):
	(palette_activate): 
	(palette_press): 
	(palette_new): 
	(mouse_press): 
	(get_screen_color): 
	fixed return type (void to gboolean), return TRUE,
	added GTK_SIGNAL_FUNC cast

	* gtk/gtkcombo.c (gtk_combo_popup_button_press): fixed return type
	(void to gboolean), and return TRUE
	(gtk_combo_button_release): changed return value to TRUE after
	gtk_grab_add on combo->popwin

	* gtk/gtkctree.c (gtk_ctree_button_press): return TRUE if triggers a
	collapse or expand

	* gtk/gtkcurve.c (gtk_curve_graph_events): return TRUE for
	button/motion

	* gtk/gtkdnd.c (gtk_drag_source_event_cb): return TRUE for button
	press/release and motion that trigger act

	* gtk/gtkentry.c (gtk_entry_button_release): return TRUE

	* gtk/gtkfontsel.c (gtk_font_selection_size_key_press): return TRUE
	for GDK_Return
	
	* gtk/gtklist.c (gtk_list_button_press): return TRUE mostly
	(gtk_list_button_release): return TRUE if selection

	* gtk/gtklistitem.c (gtk_list_item_button_press): return TRUE on
	press

	* gtk/gtkmenushell.c (gtk_menu_shell_button_press):
	(gtk_menu_shell_button_release): chain parent_menu_shell retval

	* gtk/gtknotebook.c (gtk_notebook_button_press): return FALSE if
	nothing triggered
	(gtk_notebook_button_release): return TRUE if we do anything

	* gtk/gtkspinbutton.c (gtk_spin_button_button_press): 
	(gtk_spin_button_button_release): return TRUE or chained retval

	* gtk/gtktext.c (gtk_text_button_press): 
	(gtk_text_button_release): return TRUE
	(gtk_text_key_press): remove redundant retval code
	
	* gtk/gtktreeitem.c (gtk_tree_item_button_press): return TRUE if button
	and sensitive
	(gtk_tree_item_subtree_button_click): changed type to gint, and return
	TRUE if sensitive

	* gtk/gtktooltips.c (gtk_tooltips_event_handler): deactivate implies 
	return TRUE

2001-03-23  Havoc Pennington  <hp@redhat.com>

	* gtk/testgtk.c: fix warnings

	* gtk/gtktoolbar.c (gtk_toolbar_insert_element): fix return value

	* gtk/gtktextview.c: fix warnings

	* gtk/gtktext.c (find_cursor_at_line): fix warning

	* gtk/gtkselection.c (gtk_selection_notify): fix warning 

	* gtk/gtkitemfactory.c (gtk_item_factory_menu_pos): fix signature
	of this function

	* gtk/gtkimmulticontext.c (gtk_im_multicontext_append_menuitems):
	fix warning

	* gtk/gtkhandlebox.c (gtk_handle_box_style_set): fix warning

	* gtk/gtkfontsel.c: fix warning

	* gtk/gtkcolorsel.c: fix warnings

2001-03-23  Havoc Pennington  <hp@redhat.com>

	* gtk/gtkhandlebox.c: Apply property patch from Lee Mallabone

	* gtk/gtkbox.c: Apply property patch from Lee Mallabone

	* gtk/gtkcheckmenuitem.c: Apply property patch from Lee Mallabone,
	and deprecated gtk_check_menu_item_set_show_toggle().
	
	* gtk/gtkbutton.c: Apply property patch from Lee Mallabone

	* gtk/gtkfilesel.c: Apply property patch from Lee Mallabone

	* gtk/gtkframe.c: Apply property patch from Lee Mallabone

2001-03-23  Havoc Pennington  <hp@redhat.com>

	* gtk/gtktoolbar.c, gtk/gtkimcontext.c, gtk/gtklabel.c: fix up
	some docs

Fri Mar 23 16:13:43 2001  Jonathan Blandford  <jrb@redhat.com>

	* gtk/gtktreeviewcolumn.h (GtkCellDataFunc): Forgot to namespace
	this.

	* gtk/gtktreestore.c (gtk_tree_store_set_value): change from
	set_cell to set_value

	* gtk/gtkliststore.c (gtk_list_store_set_value): change from
	set_cell to set_value

Thu Mar 22 19:27:34 2001  Jonathan Blandford  <jrb@redhat.com>

	* gtk/gtkcellrenderertoggle.c (gtk_cell_renderer_toggle_render):
	fix braino.
	* gtk/gtktreesortable.[ch]: New interface to add cleanup sortable
	support.

	* gtk/gtktreeview.c: Addition of initial sortable support.

	* gtk/gtktreestore.c: Addition of initial sortable support.

	* gtk/gtkliststore.c: Addition of initial sortable support.

	* gtk/gtkmarshal.list: yet another marshaller.

	* gtk/gtktreedatallist.[ch]: shared code between the store models
	for handling sorting headers.

2001-03-22  Havoc Pennington  <hp@redhat.com>

	* gtk/gtkcontainer.c (gtk_container_set_focus_chain): 
	(gtk_container_unset_focus_chain): Add ability to override the 
	focus chain for a container explicitly

Thu Mar 22 13:01:44 2001  Tim Janik  <timj@gtk.org>

	* gtk/gtklabel.[hc]: some cleanups, fixed mnemonic_widget handling,
	added PROP_MNEMONIC_WIDGET.

	* gtk/gtkwindow.c (gtk_window_activate_mnemonic): 
	(gtk_window_remove_mnemonic): 
	(gtk_window_add_mnemonic): fixed assertions.
	(gtk_window_activate_mnemonic): constrain modifier checks to those
	permitted by gtk_accelerator_get_default_mod_mask().
	got rid of gtk_window_get_default_accel_group().

	* gtk/gtkwidget.c (gtk_widget_real_activate_mnemonic): handle non
	activatable widgets either by focussing or a warning.
	added a signal accumulator to ::activate_mnemonic which stops the
	emission once a handler returned TRUE.

2001-03-22  Havoc Pennington  <hp@pobox.com>

	* gtk/gtktoolbar.c (gtk_toolbar_insert_stock): handle mnemonics in
	the stock item label

	* gtk/gtklabel.c: s/@gtk_func/gtk_func()/ in docs

	* gtk/gtkstock.c (builtin_items): add mnemonics where missing

	* demos/gtk-demo/*.c: Add mnemonics all over the place

	* gtk/gtklabel.h: mark parse_uline deprecated

2001-03-21  Alexander Larsson  <alexl@redhat.com>

	* gtk/gtkitemfactory.[ch]:
	Add support for stock and normal imagemenuitems.
	
	* gtk/testgtk.c:
	Add some tests for mnemonics, stock toolbars, stock
	and image menuitems in itemfactory and gdk_window_scroll.

2001-03-21  Alexander Larsson  <alexl@redhat.com>

        * gtk/gtkbutton.[ch]:
	* gtk/gtkdialog.c:
	Renamed gtk_button_new_stock() to gtk_button_new_from_stock() and
	removed accel_group argument. Renamed gtk_button_new_accel() to
	gtk_button_new_with_mnemonic() and removed accel_group argument.

	* gtk/gtkcheckbutton.[ch]:
	New function gtk_check_button_new_with_mnemonic().

	* gtk/gtkentry.c:
	Override activate_mnemonic and just grab focus.

	* gtk/gtkitemfactory.c:
	Don't add menu uline accel group, instead use mnemonics support.

	* gtk/gtklabel.[ch]:
	New support for mnemonics.

	* gtk/gtkmarshal.list:
	Needed BOOLEAN:BOOLEAN for activate_mnemonic.

	* gtk/gtkmenu.[c]:
	* gtkmenushell.c:
	Use mnemonics instead of accel groups for uline
	support in menu items.
	Removed gtk_menu_get_uline_accel_group() and
	gtk_menu_ensure_uline_accel_group().

	* gtk/gtkmenuitem.c:
	Override activate_mnemonic to handle switching between
	menu items if there are collisions.
	
	* gtk/gtknotebook.c:
	Connect to activate_mnemonic on the tab_label, so that
	activating it switches to that notebook page.

	* gtk/gtkwidget.[ch]:
	Add activate_mnemonic signal. New function
	gtk_widget_activate_mnemonic() to emit it.
	Default implementation does activate/grab_focus.

	* gtk/gtkwindow.[ch]:
	Add support for mnemonics in windows.
	New functions:
	gtk_window_add_mnemonic, gtk_window_remove_mnemonic,
	gtk_window_activate_mnemonic, gtk_window_set_mnemonic_modifier

	* gtk/testgtk.c:
	Update to function name changes.
	
2001-03-21  Alexander Larsson  <alexl@redhat.com>

	* gtk/gtkimagemenuitem.[c]:
	Add gtk_image_menu_item_new_from_stock()

Tue Mar 20 15:00:43 2001  Jonathan Blandford  <jrb@redhat.com>

	* gtk/gtkcellrenderertoggle.c (gtk_cell_renderer_toggle_render):
	Fix buglet in meeting.

2001-03-19  Havoc Pennington  <hp@redhat.com>

	* gtk/gtkiconfactory.c: Make GtkIconSource an opaque datatype, and
	add a bunch of accessor functions. This is because we have
	reasonable expectations of extending what fields it contains in
	the future.

	* gtk/gtkstyle.c (gtk_default_render_icon): adapt to icon source
	changes

	* gtk/gtkrc.c (gtk_rc_parse_icon_source): fix to use new
	GtkIconSource	

Mon Mar 19 15:53:36 2001  Owen Taylor  <otaylor@redhat.com>

	* gtk/gtkitemfactory.c gtk/testgtk.c: Handle quoting of / with \; properly
	handle __ in paths, quote " and \n in gtk_item_factory_dump_items().

	* gtk/gtkadjustment.[ch] gtk/gtkclist.c gtk/gtkhruler.c gtk/gtklayout.c 
	  gtk/gtklist.c gtk/gtkprogress.[ch] gtk/gtkprogressbar.[ch] gtk/gtkrange.[ch]
	  gtk/gtkruler.[ch] gtk/gtkscale.c gtk/gtkscrolledwindow.c gtk/gtkspinbutton.[ch]
	  gtk/gtktext.c gtk/gtktextview.c gtk/gtkvruler.c gtk/testgtk.c:
	Change float to double everywhere with the exception of 0<->1.0 alignment
	and GtkCurve.

2001-03-19  Tor Lillqvist  <tml@iki.fi>

	* gdk/win32/gdkdrawable-win32.c
	* gdk/win32/gdkimage-win32.c: Use correct casts in debugging
	output.

	* demos/testpixbuf-drawable.c: If GDK_WINDOWING_WIN32, include
	gdkwin32.h.

2001-03-18  Tor Lillqvist  <tml@iki.fi>

	* gdk/win32/gdkevents-win32.c (print_window_state): New function.
	print_event_state, print_event): Use preprocessor macro to make
	code more compact. Print also GDK_WINDOW_STATE events.
	(synthesize_crossing_events): Remove the old #ifdeffed-out code.
	
	* gtk/gtk.def
	* gtk/makefile.mingw.in: Update.

	* gtk/gtkmain.h: Check for G_PLATFORM_WIN32, not only G_OS_WIN32,
	to catch also Cygwin.

Sun Mar 18 01:15:30 2001  Tim Janik  <timj@gtk.org>

	* gtk/gtkspinbutton.[hc]: added rc-style argument
	GtkSpinButton::shadow_type.
	removed spin_button->shadow_type, gtk_spin_button_set_shadow_type()
	and ARG_SHADOW_TYPE as it doesn' make much sense to try to override
	rc-style settings.

	* gtk/gtkfixed.c: removed gtk_fixed_paint() (was unused).

	* gtk/gtkwidget.c: quark cleanups.

	* gtk/gtkrc.[hc]: added gtk_rc_scanner_new() to create an rc-file
	scanner with appropriate configuration, renamed GtkRcStyleClass.clone
	to create_rc_style() (we don't do cloning in standard OO sense).
	added per rc style properties.
	
	* gtk/gtkstyle.[hc]: added code to retrive pspec conformant rc-style
	property values and for caching those. some cleanups.
	
	* gtk/Makefile.am: -DG_DISABLE_CONST_RETURNS.
	
	* gtk/gtksettings.[hc]: new file for global rc-file properties
	(at least currently, should get extended to support X properties
	and other communication mechanisms).
	
	* gtk/gtkwidget.[hc]: added style property support:
	(gtk_widget_class_install_style_property_parser): install style
	property pspec with parser function for rc-file values other
	than LONG, DOUBLE or STRING.
	(gtk_widget_class_install_style_property): same as above without
	parser (parsers are going to be needed quite infrequently).
	(gtk_widget_style_get_property): retrive style property value.
	(gtk_widget_style_get_valist): same as above with varargs support,
	has NOCOPY semantics.
	(gtk_widget_style_get): wrapper around gtk_widget_style_get_valist().

Fri Mar 16 18:24:53 2001  Jonathan Blandford  <jrb@redhat.com>

	* demos/gtk-demo/main.c (row_activated_cb): modified to use
	"row_activated" signal.

	* gtk/gtktreeview.c (gtk_tree_view_row_activated): oh, the
	stupidity.  Lets actually pass in the row with this signal...

Fri Mar 16 18:01:17 2001  Jonathan Blandford  <jrb@redhat.com>

	* gtk/gtktreeviewcolumn.[ch]: s/GTK_TREE_COLUMN/GTK_TREE_VIEW_COLUMN

	* gtk/gtktreeview.c (gtk_tree_view_row_activated): New signal.

	* gtk/gtktreeview.c (gtk_tree_view_destroy): moved pretty much
	everything into the ::destroy function, and freed a lot more.

2001-03-16  Havoc Pennington  <hp@redhat.com>

	* gtk/gtkwidget.h (struct _GtkWidgetAuxInfo): change to use gint
	instead of gint16, to avoid overflow issues, since sizes > 16-bit
	are now allowed.

2001-03-16  Havoc Pennington  <hp@redhat.com>

	* Applied patch from Nils Barth (bug # 51041) to 
	replace "gint" with "gboolean" and 0/1 with TRUE/FALSE
	in various places.

2001-03-15  Havoc Pennington  <hp@redhat.com>
	
	* gtk/gtktextbuffer.c (gtk_text_buffer_create_tag): add varargs 
	for properties to set on the tag.

	* gtk/testtext.c: fixups to reflect create_tag change
	
	* gtk/gtktexttag.c (gtk_text_tag_set_property):
	background/foreground stipple are objects, not boxed.

	* demos/gtk-demo/textview.c: intellihancing

Fri Mar 16 11:38:42 2001  Jonathan Blandford  <jrb@redhat.com>

	* gtk/gtktreeview.c (gtk_tree_view_set_model): Fixed some
	braindeadness spotted by Jamie Strachan <frostfreek@yahoo.com>.

2001-03-16  Alexander Larsson  <alexl@redhat.com>

	* gdk/x11/gdkgeometry-x11.c (_gdk_window_process_expose):
	Fix sign error with queued region translations.

2001-03-15  HideToshi Tajima  <tajima@happy>

	* modules/input/gtkimcontextxim.c (gtk_im_context_xim_set_cursor_location): 
	* gtk/gtkimmulticontext.c (gtk_im_multicontext_set_cursor_location):
	* gtk/gtkentry.c (update_im_cursor_location): 
	* gtk/gtkimcontext.c (gtk_im_context_set_cursor_location):
	* gtk/gtkimcontext.h (struct _GtkIMContextClass): rename
	set_cursor_pos to set_cursor_location in GtkInputContext class

Thu Mar 15 18:22:44 2001  Jonathan Blandford  <jrb@redhat.com>

	* gtk/gtkcellrenderer.h: Changed prototype to allow for getting
	the location of the cell relative to its area.
	* gtk/gtkcell*: modified for above change
	* gtk/gtktreeview.c: modified for above change.

Wed Mar 14 13:58:32 2001  Jonathan Blandford  <jrb@redhat.com>

	* gtk/gtktreeview.c (gtk_tree_view_set_model): Ref the model.
	 (gtk_tree_view_finalize): actually unref the model.  Thanks to
	Jamie Strachan <frostfreek@yahoo.com> for noticing this error.

2001-03-14  Havoc Pennington  <hp@redhat.com>

        * gtk/gtkdata.h, gtk/gtkdata.c: Delete.
	
	* gtk/gtk.h: remove gtkdata.h

	* gtk/Makefile.am: remove gtkdata
	
	* gtk/gtktext.c (gtk_text_set_adjustments): connect to "destroy"
	not "disconnect" on the adjustments.
	
	* gtk/gtktooltips.h, gtk/gtktooltips.c: derive from GtkObject not
	GtkData

	* gtk/gtkadjustment.h, gtk/gtkadjustment.c: derive from GtkObject
	not GtkData

	* configure.in: handle case where X render exists, but Pango lacks
	Xft support.

2001-03-15 Alexander Larsson  <alexl@redhat.com>

	* gtk/gtktoolbar.[ch]:
	New functions gtk_toolbar_set_icon_size and gtk_toolbar_insert_stock
	to add stock items to toolbars.

	* gtk/Makefile.am:
	Remove ../gdk/gdkim.h from gdk_headers.

2001-03-15  Sven Neumann  <sven@gimp.org>

	* gdk/gdkim.h: removed
	
	* gdk/gdkprivate.h
	* gdk/x11/gdkim-x11.c: do not include gdkim.h 

2001-03-14  HideToshi Tajima  <tajima@happy.sunsoft.eng.sun.com>

	* gtk/gtkimmulticontext.c (gtk_im_multicontext_set_cursor_pos):
	* gtk/gtkimcontext.c (gtk_im_context_set_cursor_pos):
	* gtk/gtkimcontext.h (struct _GtkIMContextClass): add
	set_cursor_pos() virtual method

	* modules/input/gtkimcontextxim.c (gtk_im_context_xim_class_init):
	(gtk_im_context_xim_set_cursor_pos): add implementation for
	set_cursor_pos() method

	* gtk/gtkentry.c (recompute_idle_func): set current cursor
	position to input methods

Mon Mar 12 21:02:08 2001  Jonathan Blandford  <jrb@redhat.com>

	* gtk/gtktreeview.c (gtk_tree_view_header_focus): Fix up focus
	code a lot.

	* gtk/gtktreedatalist.c (_gtk_tree_data_list_free): use
	g_mem_chunk.
	(_gtk_tree_data_list_alloc): use g_mem_chunk.
	(_gtk_tree_data_list_node_to_value): Fix to switch on
	G_TYPE_FUNDAMENTAL.
	(_gtk_tree_data_list_value_to_node): Fix to switch on
	G_TYPE_FUNDAMENTAL.
	(_gtk_tree_data_list_node_copy): Fix to switch on
	G_TYPE_FUNDAMENTAL.

2001-03-12  Havoc Pennington  <hp@redhat.com>

	* gtk/gtkwindow.c (gtk_window_class_init): Patch from John Margaglione 
	to convert to new property API. Also, change default_width and
	default_height get_property to return 0 as the flag value for
	"unset"; -1 is not a valid value for these fields.

2001-03-12  Havoc Pennington  <hp@redhat.com>

	* gtk/gtkiconfactory.h, gtk/gtkiconfactory.c: Switch to using an
	enum with registration for icon sizes, instead of strings.

	* gtkimage.h, gtkimage.c, gtkstyle.h, gtkstyle.c, gtkwidget.h, 
	gtkwidget.c: Fix to reflect GtkIconSize
	
2001-03-12  Alexander Larsson  <alexl@redhat.com>

	Make GtkFB compile and link.
	
        * gdk/linux-fb/gdkdrawable-fb2.c:
	window->mapped to GDK_WINDOW_IS_MAPPED(). 
	
	* gdk/linux-fb/gdkwindow-fb.c:
	window->mapped to GDK_WINDOW_IS_MAPPED(). 
	Added gdk_window_shape_combine_region.
	Added assorted placeholders for unimplemented new GdkWindow API calls.

2001-03-12  Alexander Larsson  <alexl@redhat.com>

	* gtk/gtkfilesel.c:
	Add more test when converting filenames from/to utf-8.
	Don't allow entering text in the filename entry which isn't allowed in
	a filename. Just beep instead.

2001-03-12  Alexander Larsson  <alexl@redhat.com>

	* gtk/gtkclist.c:
	Scroll using gdk_window_scroll(). Don't wait for exposes.
	Move the column headers in an order that makes them flash less.

2001-03-10  Hans Breuer  <hans@breuer.org>

	* gdk/gdk.def : updated

	* gdk/win32/gdkgc-win32.c : pixmaps are visible again, due
	to offseting the clip_mask at the right place

	* gdk/win32/gdkwindow-win32.c : don't create background brushes
	for all the gdkClasses, especially not for the input_only case.
	Otherwise flickering wont be avoidable, because we don't get
	WM_ERASEBKGND message for these windows.

	* gdk/win32/gdkevents-win32.c : initialize event->expose.region
	and fixed massive redraw problems apparently triggered by Alexanders 
	recent change. Not fully understood the GDK_EXPOSE / WM_PAINT handling
	but it seems to work quite well :-)

	* gdk/win32/gdkprivate-win32.h : added _gdk_window_process_expose
	prototype

Sat Mar 10 12:15:31 2001  Jonathan Blandford  <jrb@redhat.com>

	* gtk/gtktreestore.c (gtk_tree_store_set_cell): Fix a stupid typo.
	(gtk_list_store_set_cell): Fix a stupid typo.

Fri Mar  9 20:36:21 2001  Jonathan Blandford  <jrb@redhat.com>

	* gtk/gtktreeselection.c (gtk_tree_selection_select_all): Make
	select_all not work if you're in SINGLE mode (it doesn't make that
	much sense, anyway.)

	* gtk/gtktreedatalist.c (_gtk_tree_data_list_node_to_value):
	handle types more sanely.
	(_gtk_tree_data_list_value_to_node): handle types more sanely.
	(_gtk_tree_data_list_node_copy): handle types more sanely.

	* gtk/gtkliststore.c (gtk_list_store_set_cell): fix to work with
	GValue better. Converts the type as well.

	* gtk/gtktreestore.c (gtk_tree_store_set_cell): fix to work with
	GValue better. Converts the type as well.

Wed Mar  7 20:47:41 2001  Owen Taylor  <otaylor@redhat.com>

	* gtk/gtktext.c gtk/gtkoldeditable.[ch] gdk/gdk.[ch]
	gdk/Makefile.am gdk/x11/Makefile.am gdk/x11/gdkevents-x11.c 
	gdk/x11/gdkglobals-x11.c gdk/x11/gdkprivate-x11.c
	gdk/x11/gdkx.h gdk/x11/gdkim-x11.c: Remove old XIM code.

	* gdk/win32/gdkim-win32.c gdk/linux-fb/gdkim-fb.c: Remove
	gdk_im/gdk_ic.

2001-03-09  Hans Breuer  <hans@breuer.org>

	* gdk/gdk.def : updated

	* gdk/win32/gdkevents-win32.c : don't ask input_only windows
	for their palette

	* gdk/win32/gdkgeometry-win32.c : reflect GdkWindowObject::mapped
	removing

	* gdk/win32/gdkwindow-win32.c : reflect GdkWindowObject::mapped
	removing and implemented Havoc's GdkWindow state functions; 
	stick/unstick only as no-op, cause I don't know how to emulate 
	on win32 ...

	* gtk/gtk.def : updated

	* gtk/gtkbox.c (gtk_box_get_spacing) : use g_return_val_if_fail ()

	* gtk/gtktypeutils.c : #include <string.h>

	* gtk/gtkwindow.h : declare gtk_window_set_decorated ()

Fri Mar  9 09:31:55 2001  Tim Janik  <timj@gtk.org>

	* gtk/gtkwidget.c (gtk_widget_class_init): fixed signals with
	GDK_TYPE_DRAG_CONTEXT, it needs to be marshaled as an object,
	not a boxed.

2001-03-09  Alexander Larsson  <alexl@redhat.com>

	* docs/Changes-2.0.txt:
	Document expose event->region change and that gtk_widget_event
	doesn't allow passing expose events.

	* gdk/gdkevents.h:
	Add region to expose event.
	
	* gdk/gdkevents.c:
	Handle event->region in gdk_event_copy() and gdk_event_free().

	* gdk/gdkwindow.c (gdk_window_process_updates_internal):
	Generate expose_event->region when creating expose events.

	* gdk/x11/gdkevents-x11.c:
	Generate expose events with regions when translating X events.

	* gtk/gtkcontainer.[ch]:
	Default expose handler that propagates expose events to NO_WINDOW
	children. New function gtk_container_propagate_expose()

	* gtk/gtkwidget.[ch]:
	Moved gtk_widget_event implementation to gtk_widget_event_internal.
	gtk_widget_event calls gtk_widget_event_internal but doesn't allow
	expose events. New function gtk_widget_send_expose() to send expose
	events. New function gtk_widget_region_intersect() to calculate
	window/region intersections.
	
	* gtk/gtkmain.c (gtk_main_do_event):
	Use gdk_window_begin_paint_region() instead of gdk_window_begin_paint_rect().
	Use gtk_widget_send_expose() to send expose events.
	
	* gtk/gtkbin.c:
	* gtk/gtkbox.c:
	* gtk/gtkfixed.c:
	* gtk/gtkimagemenuitem.c:
	* gtk/gtklist.c:
	* gtk/gtkpacker.c:
	* gtk/gtktable.c:
	* gtk/gtktree.c:
	Remove expose handler, using the default container implementation
	instead.
	
	* gtk/gtkbutton.c:
	* gtk/gtkcheckbutton.c:
	* gtk/gtkeventbox.c:
	* gtk/gtkfixed.c:
	* gtk/gtkhandlebox.c:
	* gtk/gtklayout.c:
	* gtk/gtklistitem.c:
	* gtk/gtkmenu.c:
	* gtk/gtkmenubar.c:
	* gtk/gtkmenuitem.c:
	* gtk/gtknotebook.c:
	* gtk/gtkoptionmenu.c:
	* gtk/gtkpaned.c:
	* gtk/gtkscrolledwindow.c:
	* gtk/gtktogglebutton.c:
	* gtk/gtktoolbar.c:
	* gtk/gtktreeitem.c:
	* gtk/gtkviewport.c:
	Chain expose handler to parent class handler. Use
	gtk_container_propagate_expose() to propagate exposes.

	* gtk/gtkclist.c (check_exposures):
	* gtk/gtktext.c (process_exposes):
	Use gtk_widget_send_expose instead of gtk_widget_event.

Thu Mar  8 19:40:28 2001  Jonathan Blandford  <jrb@redhat.com>

	* gtk/gtktreeview.c (gtk_tree_view_destroy): Add destroy function.

Thu Mar  8 19:18:27 2001  Jonathan Blandford  <jrb@redhat.com>

	* gtk/gtktreeview.c (gtk_tree_view_unref_tree_helper): Actually
	unref the nodes.   Fixes bug #50058.

	* gtk/gtktreemodel.c (gtk_tree_model_ref_node): change
	"::ref_iter" to "::ref_node".
	(gtk_tree_model_unref_node): change "::unref_iter" to
	"::unref_node". Fixes bug #50064.

Thu Mar  8 17:40:09 2001  Jonathan Blandford  <jrb@redhat.com>

	* gtk/gtktreeview.c (gtk_tree_view_create_row_drag_icon): add
	support for invisible cells.
	 (gtk_tree_view_bin_expose): ditto

Thu Mar  8 16:36:00 2001  Jonathan Blandford  <jrb@redhat.com>

	* gtk/gtktreemodel.c (gtk_tree_model_get_type): add prerequesite
	on gobjects.

	* tests/testtreefocus.c (main): New test file.

	* tests/testtreeview.c: update to latest glib changes.

	* tests/testtreecolumns.c: update to latest glib changes.

Thu Mar  8 18:13:20 2001  Tim Janik  <timj@gtk.org>

	* gtk/testgtk.c: re-enabled event watcher emission hooks.

Thu Mar  8 16:51:21 2001  Tim Janik  <timj@gtk.org>

	* *.c: added accumulator data argument to g_signal_newc()
	functions.

	* gtk/gtktreemodelsort.c (gtk_tree_model_sort_set_model): 
	* gtk/gtktreeview.c (gtk_tree_view_setup_model): 
	* gtk/treestoretest.c (make_window):
	s/g_signal_connect/g_signal_connectc/.

	* gtk/gtktextbuffer.c: completed signal arg fixups,
	they also needed G_SIGNAL_TYPE_STATIC_SCOPE flag.

Thu Mar  8 00:02:30 2001  Owen Taylor  <otaylor@redhat.com>

	* gtk/gtkwidget.[ch] (gtk_widget_get_name): Make
	G_CONST_RETURN.

	* gtk/gtkwidget.[ch] gtk/gtkprivate.h: Add a 
	::hierarchy-changed signal when a widget changes
	from anchored to unanchored or vice versa.
	(anchored means 
	 gtk_widget_get_ancestor (widget, GTK_TYPE_WINDOW) != NULL.)
	Use a private flag to keep track of this efficiently.

2001-03-07  Havoc Pennington  <hp@redhat.com>

	* gtk/testgtk.c (create_spins): uglify so that size request gets
	tested.

	* gtk/gtkspinbutton.c (gtk_spin_button_size_request): Base size
	request on values for upper/lower, completes #6152

Wed Mar  7 20:07:22 2001  Owen Taylor  <otaylor@redhat.com>

	* Makefile.am: Remove gtk-config-2.0 again.
	(Grrrr, pkg-config. And stops make loops.)

Thu Mar  8 00:18:29 2001  Tim Janik  <timj@gtk.org>

	* gtk/gtksignal.[hc]: removed old emission hook API.
	
	* docs/Changes-2.0.txt: fixed sections.
	
	* gtk/gtktextbuffer.c: signal arg fixups.

2001-03-07  Havoc Pennington  <hp@redhat.com>

	* gtk/gtktextview.c (invalidated_handler): use PRIORITY_VALIDATE

	* gtk/gtktextview.h (GTK_TEXT_VIEW_PRIORITY_VALIDATE): add this
	here, bug #50368; changed to be GDK_PRIORITY_REDRAW + 5, instead
	of GDK_PRIORITY_REDRAW + 1, so you can insert stuff in between the
	validation and the redraw which is higher priority than the
	validation.

2001-03-07  Havoc Pennington  <hp@redhat.com>

	* gtk/gtkentry.c (gtk_entry_get_property): remove trailer
	(gtk_entry_set_property): remove trailer

	* gtk/gtkentry.c (gtk_entry_set_width_chars): 
	(gtk_entry_get_width_chars): new functions, to set size request to 
	a given number of characters

	* gtk/testgtk.c (create_dialog): beef up the dialog test slightly

	* gtk/gtkdialog.c (gtk_dialog_set_has_separator): new function
	(gtk_dialog_get_has_separator): new function
        (run_delete_handler): fix to not emit "response" signal
	because we already did in the delete event handler installed
	at dialog creation time.
	
	* gtk/gtkdialog.h: add a has_separator property,
	add GTK_DIALOG_NO_SEPARATOR flag

2001-03-07  Havoc Pennington  <hp@redhat.com>

	* gtk/gtkwindow.c (gtk_window_set_decorated): new function, turns
	off decorations for a window.

	* demos/gtk-demo/button_box.c (create_bbox): adapt to button box
	changes

	* gtk/gtklabel.c (gtk_label_get_layout_offsets): new function 
	to get location of PangoLayout inside the label, closes #51198

	* gtk/testgtk.c (create_bbox): fix up button box usage

	* gtk/testcalendar.c (create_calendar): fix up button box usage

	* gtk/gtkfilesel.c (gtk_file_selection_init): fixup buttonbox usage

	* gtk/gtkdialog.c (gtk_dialog_init): fixup buttonbox usage

	* gtk/gtkhbbox.h: deprecations

	* gtk/gtkvbbox.h: deprecations

	* gtk/gtkbox.c (gtk_box_get_spacing): new function, used to
	emulate deprecated gtk_button_box_get_spacing

	* gtk/gtkbbox.h: deprecate some useless functions, remove entirely 
	the "set global default" functions
	(struct _GtkButtonBox): remove "spacing" field, use the one from 
	GtkBox base class

	* gtk/gtkbbox.c (_gtk_button_box_child_requisition): rename with uscore

	* gtk/gtkiconfactory.c (gtk_icon_set_render_icon): If we fail to
	render the icon, return the missing image icon.

	* gtk/gtkimage.c (gtk_image_set_from_file): fall back to missing
	image icon if the load fails.	

	* gtk/gtkstock.h (GTK_STOCK_MISSING_IMAGE): Add stock icon for use
	when no image is found; should be the Netscape "missing image"
	icon eventually but for now is a random image

	* gtk/gtkwindow.c (gtk_window_set_role): new function, sets the 
	role for the session manager

	* gtk/testgtk.c (dnd_drop): remove use of GTK_WINDOW_DIALOG

	* gtk/gtkcompat.h (GTK_WINDOW_DIALOG): compat #define
	GTK_WINDOW_DIALOG GTK_WINDOW_TOPLEVEL

	* gtk/gtkenums.h (enum GtkWindowType): remove GTK_WINDOW_DIALOG

Wed Mar  7 13:24:57 2001  Tim Janik  <timj@gtk.org>

	* gtk/*.c: marshaller fixes.
	
	* gtk/gtkmarshal.list: extreme cleanup.

	* gtk/gtktreeview.c (gtk_tree_view_class_init): disable interface
	param spec for now.

	* gtk/gtktexttag.c (gtk_text_tag_set_property): use g_value_get_boxed()
	where appliable.

	* gtk/gtktypeutils.[hc]: updates to GLib API changes.
	special cased autogenerated boxed types from gtktypebuiltins_ids.c
	which are not reference counted:
	GtkSelectionData, GdkEvent, GdkColor, GtkTextIter, PangoTabArray,
	PangoFontDescription, GtkTreeIter and GtkTreePath.

Thu Mar  1 03:58:56 2001  Tim Janik  <timj@gtk.org>

	* gtk/gtktreeselection.h: 
	* gtk/gtktreemodel.c:
	* gtk/gtktreedatalist.[hc]: fixed includes. no gobject/*
	file should be included directly, and gobject/gmarshal.h
	as well as gtk/gtkmarshal.h even can't be included directly.

	* Makefile.am: grr, install gtk-config-2.0.

	* gtk/testgtk.c:
	* gtk/simple.c:
	* gtk/gtkmenu.c:
	* gtk/gtkitemfactory.c: use g_object_connect() instead of
	passing "*signal*::*" args to gtk_widget_set().
	
	* gtk/gtktypeutils.[hc]: got rid of GTK_TYPE_SIGNAL.
	
	* gtk/*.c: removed trailer arg from property setters and getters.
	macro fixups.

2001-03-07  Alexander Larsson  <alexl@redhat.com>

	* gtk/gtklabel.c (set_markup): Removed warning

Tue Mar  6 19:59:12 2001  Jonathan Blandford  <jrb@redhat.com>

	* gtk/gtkcellrenderer.h (struct _GtkCellRenderer): Add visible
	field to allow you to hide cell renderers.

	* gtk/gtkcellrenderer.c: Add support for invisible cells.

	* gtk/gtktreeview.c: Add support for invisible cells.

Tue Mar  6 17:25:07 2001  Jonathan Blandford  <jrb@redhat.com>

	* gtk/gtktreeviewcolumn.c (gtk_tree_view_column_button_clicked):
	Add "clicked" signal back to columns.

	* ChangeLog: remove conflict markers.

Tue Mar  6 10:45:45 2001  Owen Taylor  <otaylor@redhat.com>

	* gtk/gtkbutton.c: Add animation of activation by, on 
	activate, pressing the button, and adding a timeout that 
	releases the button after 250ms	or on key release and
	emits ::clicked. (#51501)

	* gtk/gtkdialog.c: Bit of a hack - for buttons in the
	action area, we connect to ::clicked instead of ::activate
	so the dialog stays up through the animation.

Mon Mar  5 16:38:15 2001  Owen Taylor  <otaylor@redhat.com>

	* gtk/gtkmenushell.c (gtk_menu_shell_enter_notify): Only
	check the ignore_enter flag for the menu shell that
	the item is actually a child of, not for attached
	submenus. (#51536)

Tue Feb 27 02:16:14 2001  Owen Taylor  <otaylor@redhat.com>

	* gtk/gtkmain.c (gtk_propagate_event): Only do special
        special key-press grab handling for widgets within
        GtkWindows. Otherwise, fall through to normal case.

        This prevents key events being sent twice to GtkInvisible
        widgets, which can cause all sorts of mischief.

Fri Feb  2 13:20:12 2001  Owen Taylor  <otaylor@redhat.com>

	* gtk/gtkmain.c (gtk_propagate_event): When a grab
	widget is in effect, give the grab widget a first
	crack at KEY_PRESS/RELEASE events. (#424)

2001-03-06  James Henstridge  <james@daa.com.au>

	* gtk/gtkwidget.c (gtk_widget_class_init): set the class closure
	offset for the window_state_event to point at window_state_event
	rather than no_expose_event.

Mon Mar  5 19:10:15 2001  Jonathan Blandford  <jrb@redhat.com>

	* gtk/gtkimmodule.h: fix busted /* comment */

Mon Mar  5 15:07:05 2001  Jonathan Blandford  <jrb@redhat.com>

	* gtk/gtktreeview.c: Apply patch from John Margaglione to add
	object properties.

Mon Mar  5 14:55:19 2001  Jonathan Blandford  <jrb@redhat.com>

	* gtk/gtkcellrenderertoggle.c: Apply patch from Lee Mallabone to
	add object properties.

	* gtk/gtkcellrenderertextpixbuf.c: Apply patch from Lee Mallabone
	to add object properties.

	* gtk/gtkcellrenderertext.c: Apply patch from Lee Mallabone to add
	object properties.

	* gtk/gtkcellrendererpixbuf.c: Apply patch from Lee Mallabone to
	add object properties.

	* gtk/gtkcellrenderer.c: Apply patch from Lee Mallabone to add
	object properties.

Mon Mar  5 14:38:54 2001  Jonathan Blandford  <jrb@redhat.com>

	* gtk/gtktreemodel.c: renamed "child_toggled" to
	"has_child_toggled".

	* gtk/gtktreeview.c: Handle removing columns better.  Updated to
	handle new signal name.

	* gtk/gtktreestore.c: Updated to handle new signal name.
	* gtk/gtklisttore.c: Updated to handle new signal name.
	* gtk/gtktreemodelsort.c: Updated to handle new signal name.

2001-03-05  Alexander Larsson  <alexl@redhat.com>

	* gtk/gtkmenu.c (gtk_menu_set_tearoff_state):
	Set GDK_WINDOW_TYPE_HINT_MENU on tearoff window.

2001-03-05  Michael Natterer  <mitch@gimp.org>

	* gtk/gtklabel.c: Made the "parent_class" pointer static. The
	pixbuf-engine coincidentially also failed to make one of it's
	parent_class pointers static, causing overwriting of GtkLabel's
	parent_class pointer in pixbuf_style_class_init().
	(Will commit the fix to the pixbuf-engine too).

2001-03-05  Alexander Larsson  <alexl@redhat.com>

	* gdk/gdkwindow.h:
	Added GdkWindowTypeHint type. Added modal_hint field to GdkWindindow.
	New functions gdk_window_set_type_hint, gdk_window_set_modal_hint and
	gdk_window_set_icon_list for net wmspec functionality.

	* gdk/x11/gdkwindow-x11.c:
	Set _NEW_WM_STATE_MODAL from window->modal_hint in set_inital_hints.
	Implement gdk_window_set_type_hint, gdk_window_set_modal_hint and
	gdk_window_set_icon_list.
	Added gdk_wmspec_change_state helper function and used it in the code.
	Set _NET_WM_ICON_NAME in gdk_window_set_title and gdk_window_set_icon_name.

	* gtk/gtkdialog.c (gtk_dialog_init):
	Set GDK_WINDOW_TYPE_HINT_DIALOG.

	* gtk/gtkhandlebox.c (gtk_handle_box_realize):
	Set GDK_WINDOW_TYPE_HINT_TOOLBAR.

	* gtk/gtkwindow.c:
	new function gtk_window_set_type_hint.
	On realize, set type hint and modal hint.

	* gtk/gtkwindow.h:
	Added type_hint field and gtk_window_set_type_hint.

2001-03-05  Alexander Larsson  <alexl@redhat.com>

	* gtk/gtklabel.[ch]:
	Convert from GtkArg to GParam (originally based on patch from Lee Mallabone).
	New function gtk_label_get_accel_keyval () to get the underline accelerator
	of the label. Setting the label pattern overrides other attributes.

Mon Mar  5 14:51:10 MET 2001  Sven Neumann  <sven@gimp.org>

	* gtk/gtkrc.c: fixed compiler warnings by inserting some consts.
	Added missing initializers to gtk_rc_style_init().

Sun Mar 04  07:30:03 2001 CET Mikael Hermansson <mikeh@bahnhof.se>

	* gtk/gtktextview.c: fixed bug #51097 about setting 
	gtk_text_view_set_border_window_size() if the widget is 
	already realized.

Sat Mar  3 16:59:16 2001  Owen Taylor  <otaylor@redhat.com>

	* gdk/gdkpango.h gdk/x11/gdkwindow-x11.c: Doc fixes

	* gdk/win32/gdkinput.c (gdk_device_get_axis): Remove doc
	comment. Won't do to have duplicated doc comments between
	the platform subdirs.

Sat Mar  3 16:26:33 2001  Owen Taylor  <otaylor@redhat.com>

	* gdk/x11/gdkmain-x11.c gdk/x11/gdkkeys-x11.c 
	  gdk/x11/gdkevents-x11.c gdk/x11/gdkprivate-x11.c:

	Detectable auto-repeat - make a repeating key generate
	press/press/press/release instead of press/release pairs.

	If we have Xkb and XkbSetDectableAutoRepeat supports
	that, we do it that way. Otherwise, when we get
	a release event, we check ahead with XPending to see
	if the next key is a KeyPress with the same keycode
	and timestamp. (Not 100% reliable, but pretty close.)
	  
Tue Feb 27 02:16:14 2001  Owen Taylor  <otaylor@redhat.com>
	
  	* gtk/gtkmain.c (gtk_propagate_event): Only do special
        special key-press grab handling for widgets within
        GtkWindows. Otherwise, fall through to normal case.
 
        This prevents key events being sent twice to GtkInvisible
        widgets, which can cause all sorts of mischief.
 
Fri Feb  2 13:20:12 2001  Owen Taylor  <otaylor@redhat.com>
 
 	* gtk/gtkmain.c (gtk_propagate_event): When a grab
 	widget is in effect, give the grab widget a first
 	crack at KEY_PRESS/RELEASE events. (#424)
 
Sat Mar  3 15:39:49 2001  Owen Taylor  <otaylor@redhat.com>

	* gtk/gtkentry.c (gtk_entry_button_press): Add shift-clicking
	to extend the selection. (Roughly based on patch
	from Jay Cox, #50939)

	* gtk/gtkentry.c (gtk_entry_button_press): Fix triple-clicking
	to properly handle previous GDK_BUTTON_PRESS. 
	(Patch from Jay Cox, #50938)

	* gtk/gtkentry.c (gtk_entry_real_delete_text): Move the
	'\0' back along with the deleted text. (#51148)

Mon Jan 22 14:31:29 2001  Owen Taylor  <otaylor@redhat.com>

	* gdk/x11/gdkevents-x11.c (gdk_event_translate): Unshift
	the group when extracting it from the X keyboard event.

	* modules/input/Makefile.am modules/input/imipa.c: 
	Simple module for entering IPA. (Do we need a 
	gtk-stupid-input-tricks CVS module?)

Sat Mar  3 13:32:47 2001  Owen Taylor  <otaylor@redhat.com>

	* gtk/gtkimmodule.c (gtk_im_module_init): Remove spurious
	const.

	* gdk-pixbuf-2.0.pc.in gtk+-2.0.pc.in: Fix include path.

	* gtk/gtkdialog.c (gtk_dialog_set_default_response): If there
	is no focus widget for the dialog currently, grab the focus as well
	as the default.

	* gtk/gtkdialog.c (gtk_dialog_set_default_response): Get
	the action area's children to iterate through, not the
	dialog's children.

Sat Mar  3 13:21:27 2001  Owen Taylor  <otaylor@redhat.com>

	* tests/Makefile.am tests/testsocket.c tests/testsocket_child.c:
	Add plug-socket tests. (Won't work worth a darn until I commit
	the rest of the plug-socket changes, but no reason these
	can't go into CVS now.)

2001-03-02  Havoc Pennington  <hp@redhat.com>

	* gdk/x11/gdkgc-x11.c (_gdk_x11_gc_flush): use
	_gdk_region_get_xrectangles()

	* gdk/x11/gdkmain-x11.c (_gdk_region_get_xrectangles): new function

	* gtk/testgtk.c (create_shapes): add test for shape_combine_region

	* gdk/x11/gdkwindow-x11.c (gdk_window_shape_combine_region): new
	function, contributed by Ron Steinke	

	* gdk/x11/gdkevents-x11.c (gdk_wmspec_supported): rename
	gdk_net_wm_supports

	* gdk/gdkregion-generic.c (gdk_region_get_rectangles): 
	New function, contributed by Ron Steinke

	* gtk/gtkentry.c (gtk_entry_get_layout_offsets): New function, 
	used to line up the text in the entry when using the entry for
	editable sheet cell hacks

	* gtk/testgtk.c (create_entry): test the activate_default setting
	on GtkEntry

	* gtk/gtkentry.c (gtk_entry_set_activates_default): New function to 
	cause the entry to activate the default button for a dialog when 
	activated
	(gtk_entry_get_activates_default): new function

Wed Feb 28 19:10:43 2001  Owen Taylor  <otaylor@redhat.com>

	* gtk/gtkclist.c (real_remove_row): Patch from ChiDeok
	Hwang to move call to sync_selection() up a few lines
	to before the row list is modified, to fix crash when
	removing rows in the undo_selection list.

	(Test case provided by Daniel Elstner:

        http://mail.gnome.org/archives/gtk-list/2001-February/msg00359.html)

Fri Feb 23 15:06:48 2001  Owen Taylor  <otaylor@redhat.com>

	* gtk/gtktree.c (gtk_tree_class_init): Do the setting
	of tree->root_tree in parent_set rather than _map(), 
	fixing #50892 in a bit better manner.

Thu Feb 22 17:07:58 2001  Owen Taylor  <otaylor@redhat.com>

	* gtk/gtkmenu.c (gtk_menu_popup): Don't flip cursor. (#50934)

Tue Feb  2 11:22:33 2001  Jody Goldberg <jgoldberg@home.com>

	* gtk/gtkstyle.c : Remove duplicate fwd decl for
	gtk_default_draw_shadow.

ue Feb 20 11:40:58 2001  Owen Taylor  <otaylor@redhat.com>

	* gdk/gdkimage.c (gdk_image_new): Remove excess 
	warning, make warnings more verbose, treat a error
	in shmat as permanent, and don't try again.
	(#51163, Ed Randall.)

Mon Feb 19 20:15:28 2001  Owen Taylor  <otaylor@redhat.com>

	* gtk/gtkrange.c (gtk_range_timer_1st_time): Add an initial
	delay for the first click before starting to scroll.
	(based on #51026, gtk-enf-990512-0.patch, Eric Fisher)

	* gtk/gtktext.c: GtkText should have I-beam cursor. 
	(based on gtk-enf-990513-1.patch, Eric Fisher.)

Mon Feb 19 16:42:19 2001  Owen Taylor  <otaylor@redhat.com>

	* gtk/gtklayout.c (gtk_layout_allocate_child): Tiny
	cleanup to remove some references to unused
	->xoffset, ->yoffset.

Mon Feb 19 14:20:36 2001  Owen Taylor  <otaylor@redhat.com>

	* gdk/gdkrgb.c (gdk_rgb_convert_555_br): Fix incorrect
	mask. (#51039, fix from Martin Maierhofer)

Fri Feb 16 20:09:42 2001  Owen Taylor  <otaylor@redhat.com>

	* gtk/gtkctree.c (gtk_ctree_class_init): Add bindings
	for unshifted + and shifted = for non-us keyboards.
	Make <Control>+ and <Control>- work as well as 
	<Control>KP_Plus, <Control>KP_Minus for recursive
	open/close.  (#2682, Ren Seindal)

Fri Feb 16 18:50:59 2001  Owen Taylor  <otaylor@redhat.com>

	* gtk/gtkmenushell.c (gtk_real_menu_shell_cancel): Unset
	the active menu item before deactivating the menu,
	so gtk_menu_popdown doesn't change the history. (#50964)
	
Fri Feb 16 15:55:22 2001  Owen Taylor  <otaylor@redhat.com>

	* gtk/gtktreeitem.c (gtk_tree_item_draw_lines): 
	draw lines with text_gc rather than black_gc.
	(Patch from Vlad Harchev <hvv hippo ru>, #50926)

Thu Mar  1 19:50:56 2001  Jonathan Blandford  <jrb@redhat.com>

	* gtk/gtktreeviewcolumn.c (_gtk_tree_view_column_realize_button):
	Move handling of buttons fully in gtktreeviewcolumn.  This code is
	less interrelated then it was, but it still requires the
	GtkTreeView to map it.

	* test/testtreecolumn.c: Now I can add a column to one view,
	remove it, add it to the another view, remove it, then re-add it
	to the first.  Nifty.

Thu Mar  1 13:14:27 GMT 2001  Tony Gale <gale@gtk.org>

	* docs/tutorial/gtk-tut.sgml: Minor corrections

Wed Feb 28 16:36:46 2001  Jonathan Blandford  <jrb@redhat.com>

	* gtk/gtktreemodel.c (gtk_tree_row_reference_*): Sanitize
	GtkRowReference.

2001-02-28  Havoc Pennington  <hp@redhat.com>

	* gtk/gtkwidget.h (struct _GtkWidgetClass): Remove draw_focus and
	draw_default
	(gtk_widget_draw_focus): remove this function; we could instead
	make it just gtk_widget_draw(), but in most cases I think the
	result would be broken user code, so think it's better to have
	that code not compile and get fixed
	(gtk_widget_draw_default): ditto

	* gtk/gtkwidget.c: Add default handlers for focus_in_event and
	focus_out_event that set/unset GTK_HAS_FOCUS and call queue_draw
	
	* gtk/gtkwindow.c (gtk_window_set_default): just queue a draw when
	widgets lose/get the default, instead of calling draw_default
	
	* docs/Changes-2.0.txt: note about all this

	Then fixed every widget in GTK, I won't list all the filenames.

Tue Feb 27 19:32:53 2001  Jonathan Blandford  <jrb@redhat.com>

	* gtk/gtktreemodel.c (deleted_callback): Proxy out to
	_gtk_tree_row_reference_deleted.
	(inserted_callback): Proxy out to
	_gtk_tree_row_reference_inserted.
	(_gtk_tree_row_reference_new_from_view): Somewhat yukky hack to
	get around signal emission ordering problem.

	* gtk/gtktreeselection.c (gtk_tree_selection_real_unselect_all):
	fix to work with SINGLE 
	(_gtk_tree_selection_internal_select_node): Major sanitization on
	selections.  SINGLE now seems to work.

	* tests/Makefile.am: add testtreecolumn.c:

	* tests/testtreecolumn.c: New test.  Mostly points out selection
	bugs currently, but will test columns later.

	* gtk/gtkrbtree.c (_gtk_rbtree_remove_node): Fix really nasty
	selection bug.  I hate touching this code -- it's scary.

2001-02-26  Havoc Pennington  <hp@redhat.com>

	* gtk/testgtk.c: test the window state stuff

	* gtk/gtkwindow.c (gtk_window_present): new function, makes a
	window come to the user's attention as if it were just created
	(gtk_window_iconify): new function
	(gtk_window_deiconify): new function
	(gtk_window_stick): new function
	(gtk_window_unstick): new function
	(gtk_window_maximize): new function
	(gtk_window_unmaximize): new function

	* gtk/gtkwidget.h, gtk/gtkwidget.c: add window_state_event signal

	* gtk/gtkmain.c (gtk_main_do_event): handle GDK_WINDOW_STATE

	* gdk/x11/gdkevents-x11.c: create window state events when
	appropriate
	(gdk_wmspec_supported): new function

	* gdk/x11/gdkwindow-x11.c (gdk_window_iconify): handle
	iconification before showing the window
	(gdk_window_deiconify): new function
	(gdk_window_stick): new function
	(gdk_window_unstick): new function
	(gdk_window_maximize): new function
	(gdk_window_unmaximize): new function

	* gdk/gdkwindow.c: store the window state in the window; 
	change to using the GDK_WINDOW_STATE_WITHDRAWN flag instead of
	window->mapped.
	(gdk_window_get_state): return the current window state

	* gdk/gdkevents.c (gdk_event_get_time): handle GDK_WINDOW_STATE
	(gdk_event_get_state): handle GDK_WINDOW_STATE
	(gdk_synthesize_window_state): function to create the window state
	events

	* gdk/gdkevents.h (struct _GdkEventWindowState): new type of
	event, for changes to "window state" such as maximized, sticky, 
	etc.
	
	* gdk/x11/gdkwindow-x11.c (gdk_window_focus): new function,
	focuses a window

	* gdk/x11/gdkmain-x11.c (_gdk_wmspec_supported): new function, 
	finds out if we support a given WM spec hint

Tue Feb 27 13:37:38 GMT 2001  Tony Gale <gale@gtk.org>

	* docs/faq/gtk-faq.sgml: New question re memory leaks.

2001-02-25  Hans Breuer  <hans@breuer.org>

	* gdk/gdk.h : changed #ifdef GDK_DISBALE_DEPRECARED to #ifndef
	cause we want to loose those prototypes only in the latter case

	* gdk/win32/gdkevents-win32.c : can't cast from GdkPixmap to
	GdkPixmapImplWin32 because it itsn't derived from it. Use the
	impl member variable instead

	* gtk/gtk.def : updated

	* gtk/gtklist.c : 
	* gtk/gtkmenus.c : include <string.h> for memset ()

	* gtk/makefile.msc.in : updated and don't define GTK_COMPILATION
	for everthing built here, but for gtk-x.x.dll only. This solves
	problem of indifferent gtk type definitions

Sat Feb 24 20:11:39 2001  Jonathan Blandford  <jrb@redhat.com>

	* gtk/gtkclipboard.h: actually put /* */ around #endif comment.

Fri Feb 23 17:50:13 2001  Jonathan Blandford  <jrb@redhat.com>

	* gtk/gtktreeview.c (gtk_tree_view_bin_expose): Only draw the
	column that is exposed.

	(_gtk_tree_view_update_size): Changed name from set_size, and
	changed function to do more work, and not force people calling it
	to figure out the size.  Simplifies a lot of code elsewhere.

2001-02-23  Alexander Larsson  <alexl@redhat.com>

	* gdk/gdkpixmap.c (gdk_pixmap_colormap_new_from_pixbuf):
	return solid masks for xpms that have no transparent color.
	This makes the ..._create_from_xpm... API backwards
	compatible.

2001-02-23  Tor Lillqvist  <tml@iki.fi>

	* README.win32: Update. Mention the gtk-1-3-win32-production
	branch.

	* gdk/win32/bdfcursor.c: New file. A program that generates
	xcursors.h. Thanks to Stefan Ondrejicka.

	* gdk/win32/xcursors.h: New file, contains the X cursor font in a
	compact format.

	* gdk/win32/Makefile.am (EXTRA_DIST): Add new files.

	* gdk/win32/gdkcursor-win32.c (_gdk_win32_data_to_wcursor): New
	function, uses xcursors.h.
	(gdk_cursor_new): Use _gdk_win32_data_to_wcursor to generate
	cursor from inline data instead of using LoadCursor() to generate
	it from a resource.

	* gdk/win32/gdkevents-win32.c (gdk_event_translate): At button up
	event, must check the Windows message for mouse button state, as
	the GDK event state might not have been built if it is
	undelivered. Remove one goto.

	* gdk/win32/gdkwindow-win32.c (gdk_window_set_cursor): Call
	SetCursor() if the current cursor as returned by GetCursor() is
	the window's previous cursor. The ChildWindowFromPoint() test
	apparently didn't work correctly.

	* gdk/win32/rc/*.cur: Remove.

	* gdk/win32/rc/gdk.rc.in: Remove cursors.

	* gdk/win32/rc/Makefile.am (EXTRA_DIST): Remove from here, too.

	* gtk/makefile.{mingw,msc}.in: Updates.

Wed Feb 21 20:56:50 2001  Jonathan Blandford  <jrb@redhat.com>

	* gtk/gtktreemodel.h: add functions for signal emission.

	* gtk/gtktreestore.c: move to use above functions instead of
	g_signal_emit.

	* gtk/gtkliststore.c: ditto

Wed Feb 21 15:41:34 2001  Jonathan Blandford  <jrb@redhat.com>

	* gtk/gtktreestore.c: removed signals.  Moved to inherit from
	GObject instead of GtkObject.

	* gtk/gtkliststore.c: ditto.

	* gtk/gtktreemodelsort.c: ditto.

	* gtk/gtktreemodel.c (gtk_tree_model_base_init): moved signals to
	GtkTreeModelIface, instead of in each model.

2001-02-21  Havoc Pennington  <hp@redhat.com>

	* gtk/gtktextbuffer.c (gtk_text_buffer_insert_child_anchor):
	unbreak this function

	* gtk/gtkentry.c: apply patch from Lee Mallabone to add object 
	properties

	* gtk/gtkcurve.c: apply patch from Lee Mallabone to add object
	properties

	* gtk/gtkcombo.c: apply patch from Lee Mallabone to add object 
	properties

	* gtk/gtkentry.c (gtk_entry_set_max_length): have this take -1 to
	mean unset the max length

Wed Feb 21 14:23:05 2001  Jonathan Blandford  <jrb@redhat.com>

	* gtk/gtktreeviewcolumn.c (gtk_tree_view_column_set_cell_data_func):
	Changed name to be set_cell_data_func to make it clear what
	the functino does.  Close bug #51069.

Tue Feb 20 16:49:00 2001  Jonathan Blandford  <jrb@redhat.com>

	* gtk/testgtk.c (main): Remove turning on of profiling malloc,
	have memory actually freed.  Keeps box running longer.

2001-02-21  Alexander Larsson  <alexl@redhat.com>
	
        * gtk/gtkseparatormenuitem.[ch]:
	Added new menu separator item. The drawing and size handling
	is still done in GtkMenuItem, but the API is a bit more sane.
	
	* gtk/Makefile.am:
	Add gtkseparatormenuitem.[ch].

	* gtk/gtk.h:
	Add gtkseparatormenuitem.h.
	
	* gtk/gtkentry.c:
	* gtk/gtkmenufactory.c:
	* gtk/gtktextview.c:
	Use the new API for menu separators.
	
	* demos/gtk-demo/menus.c (create_menu):
	Add some GtkSeparatorMenuItem demo code.

2001-02-20  Havoc Pennington  <hp@redhat.com>

	* gtk/gtkaspectframe.c: Convert to new property API, patch from 
	Lee Mallabone

	* gtk/gtkarrow.c: Convert to new property API, patch from 
	Lee Mallabone

Tue Feb 20 14:26:41 2001  Jonathan Blandford  <jrb@redhat.com>

	* tests/testtreeview.c (toggled_callback): fix to reflect change
	in GtkTreeModelStore.

Tue Feb 20 12:16:12 2001  Jonathan Blandford  <jrb@redhat.com>

	* gtk/gtkiconfactory.c (gtk_icon_set_new_from_pixbuf): New
	function to create an icon set from a pixbuf.

2001-02-20  Alexander Larsson  <alexl@redhat.com>

	* gtk/gtkcellrenderertext.[ch]:
	Add a "markup" property.

	* gtk/treestoretest.c:
	Use the markup property, remove some leftover stuff from
	GtkTreeModelMapping.

2001-02-20  Alexander Larsson  <alexl@redhat.com>

	* gtk/gtklabel.c (gtk_label_set_selectable):
	Queue a redraw if the selectable setting was changed.

2001-02-20  Alexander Larsson  <alexl@redhat.com>

	* gdk/linux-fb/gdkgc-fb.c (gdk_gc_copy):
	Actually copy the whole gc, not just the public parts.
	
	* gdk/linux-fb/gdkwindow-fb.c (gdk_window_new):
	GDK_WINDOW_TEMP are not toplevel. Fixes selectable
	labels.

2001-02-19  Havoc Pennington  <hp@pobox.com>

	* gdk/gdkwindow.c: docs

	* gdk/gdkrgb.c: docs

	* gdk/gdkregion-generic.c: docs

	* gdk/gdkgc.c (gdk_gc_set_values): docs

	* gdk/gdkdraw.c: docs

	* gdk/gdkdrawable.h: deprecate drawable get/set data

Mon Feb 19 20:37:35 2001  Jonathan Blandford  <jrb@redhat.com>

	* demos/gtk-demo/dialog.c: Add simple new demo.

2001-02-19  Havoc Pennington  <hp@redhat.com>

	* gtk/gtktextbuffer.h (struct _GtkTextBufferClass): add
	insert_child_anchor signal, bug #50245

	* gtk/gtktextbtree.c (_gtk_text_btree_insert_child_anchor): change
	from create_child_anchor, so the anchor is passed in

	* gtk/gtktextchild.c (gtk_text_child_anchor_new): new function
	(_gtk_widget_segment_new): have the child anchor object passed in, 
	instead of creating it.

	* gtk/gtktextbuffer.c (gtk_text_buffer_modified): rename
	to gtk_text_buffer_get_modified

2001-02-19  Havoc Pennington  <hp@redhat.com>

	* gtk/gtktreemodel.c (gtk_tree_model_get_valist): hmm, someone
	changed GLib without fixing GTK

	* gtk/gtkrange.h: Rename all the stupid implementation detail 
	functions to have an underscore in front. Most of them should 
	probably just go away, but for starters don't export them.
	Bug #50482

2001-02-19  Havoc Pennington  <hp@redhat.com>

	* gdk/gdkcolor.h: test was backward, so deprecated functions were
	excluded by default

	* gtk/gtkstyle.c (gtk_default_draw_diamond): draw etched in/out,
	clean up the old code a bit

	* gtk/gtkradiobutton.c (gtk_radio_button_draw_indicator): draw
	inconsistent state

	* gtk/gtkradiomenuitem.c (gtk_radio_menu_item_draw_indicator):
	draw inconsistent state

	* gtk/testgtk.c (create_toggle_buttons): add test for inconsistent
	(create_menu): add inconsistent test

	* gtk/gtkcheckmenuitem.c (gtk_check_menu_item_set_inconsistent):
	new function
	(gtk_check_menu_item_get_inconsistent): new function
	(gtk_real_check_menu_item_draw_indicator): draw the inconsistent
	state (using etched in for now)

	* gtk/gtkcheckbutton.c (gtk_real_check_button_draw_indicator):
	draw inconsistent state

	* gtk/gtktogglebutton.c (gtk_toggle_button_set_inconsistent): new
	function, used when the user has selected a range of stuff in
	different states
	(gtk_toggle_button_get_inconsistent): accessor for that
	(gtk_toggle_button_paint): draw inconsistent state (etched in?
	don't know what else to do)

2001-02-19  Hans Breuer <hans@breuer.org>

	* gtk/gtk.def : updated exported symbols

	* gtk/makefile.msc.in : updated

	* gtk/gtkstyle.c (gtk_style_realize) : gets called without
	a colormap, when invoked from testgtk::entry. I'm not sure where
	the bug is, but g_return_if_fail (GDK_IS_COLORMAP (colormap));
	avoids immediate crashing ...

	* gtk/gtkmain.c (check_setugid) : totally disabled on win32;
	any objections ?

	* gtk/gtktreemodel.c : called G_VALUE_LCOPY with an extra
	0 parameter. At least msvc doesn't like macros with var args. 
	I simply removed the extra 0, was it a feature or a typo ?

	* gtk/gtktreeviewcolumn.[hc] (gtk_tree_view_column_set_func) :
	removed the extra indirection from the GtkTreeViewColumnFunc parameter,
	because the value assignment to the internal struct wasn't working.
	I'm not absolutely sure. The problem could have been resolved by
	changing the "func" declartion in the struct, but was the pointer
	to the function pointer intended ?

	* gtk+/gtk/gtktreedatalist.c : include gboxed.h

	* gdk/gdk.def : updated exported symbols

	* gdk/win32/gdkdrawable-win32.c (gdk_win32_draw_image) :
	only use SetDIBitsToDevice if there is a palette at the drawable
	and the image is GDK_VISUAL_PSEUDO_COLOR

	* gdk/win32/gdkkeys-win32.c : msvc still has no <unistd.h> ...

	* gdk/win32/gdkwindow-win32.c : #include "gdk.h" /* gdk_rectangle_intersect */

	* gdk/*/makefile.msc : updated

2001-02-19  Havoc Pennington  <hp@redhat.com>

	* demos/gtk-demo/Makefile.am (INCLUDES): GDK_DISABLE_COMPAT_H,
	GDK_DISABLE_DEPRECATED (we need to merge those two #defines)

	* gdk/x11/gdkmain-x11.c (gdk_key_repeat_disable): nuke
	(gdk_key_repeat_restore): nuke

	* gdk/gdk.c (gdk_exit_func): #if 0 this for now, don't install it
	(gdk_init_check): no atexit func

	* gdk/gdkrgb.h: mark some stuff deprecated

	* gdk/gdkcolor.h: mark some stuff deprecated
	
	* gdk/gdk.h: deprecated gdk_exit, gdk_input_*

	* gdk/gdkfont.h: bracket in GDK_DISABLE_DEPRECATED

2001-02-16  Havoc Pennington  <hp@redhat.com>

	* gtk/gtkvscrollbar.c (gtk_vscrollbar_trough_keys): use the visual
	scroll steps.

	* gtk/gtkvscale.c (gtk_vscale_trough_keys): use the visual scroll
	steps, and add Ctrl-arrow shortcuts for paging visually as with
	HScale, since Page Up and Page Down move logically.

	* gtk/gtkenums.h (GtkScrollType): add GTK_SCROLL_STEP_UP,
	GTK_SCROLL_STEP_DOWN, etc. for visual scroll directions
	
	* gtk/gtkrange.c (gtk_range_key_press): handle the visual scroll
	steps
	(gtk_range_scroll): handle the visual steps

	* gtk/gtklist.c (gtk_list_scroll_horizontal): handle the up/down
	scroll steps

	* gtk/gtkhscale.c (gtk_hscale_trough_keys): use the visual scroll
	steps, not the logical ones.

	* gtk/gtkclist.c (move_focus_row): handle the up/down scroll steps
	(scroll_vertical): handle up/down steps

2001-02-19 Alexander Larsson  <alexl@redhat.com>

	* gdk/linux-fb/gdkimage-fb.c (gdk_image_new_bitmap):
	Copy data and free data with free().

	* gdk-pixbuf/gdk-pixbuf.c:
	* gdk-pixbuf/io-jpeg.c:
	* gdk-pixbuf/io-png.c:
	Use g_try_malloc/g_free instead malloc/free.
	
	* gdk-pixbuf/test-gdk-pixbuf.c:
	Must... initialize... gobject...
	
	* gdk-pixbuf/pixops/timescale.c:
	* gtk/gtkcalendar.c:
	Use g_malloc instead of malloc.
	
2001-02-19 Alexander Larsson  <alla@lysator.liu.se>

	* gtk/testgtkrc:
	Comment out property assignments, these don't work yet.

2001-02-17  Havoc Pennington  <hp@pobox.com>

	* gtk/gtkalignment.c (gtk_alignment_class_init): clean this up a
	bit.

2001-02-17  Havoc Pennington  <hp@pobox.com>

	* gtk/gtklabel.c (gtk_label_ensure_layout): fix screwup with
	shadowed variables that had broken size request in some cases,
	leading to bogus tooltips (#50996)

2001-02-06  Jon K Hellan  <hellan@acm.org>

	Implement fast browsing of tooltips, bug #50619
	
	* gtk/gtktooltips.h (struct _GtkTooltips): Add use_sticky_delay
	and last_popdown
	
	* gtk/gtktooltips.c (gtk_tooltips_init): Initialize sticky_delay,
	use_sticky_delay and last_popdown.
	(gtk_tooltips_draw_tips, gtk_tooltips_set_active_widget): Record
	time of popdown.
	(gtk_tooltips_set_active_widget): Unset sticky behaviour if widget
	is NULL.
	(gtk_tooltips_recently_shown): New static function.  Return true
	if < sticky_delay has elapsed since last popdown.
	(gtk_tooltips_event_handler): Display window after sticky_delay
	(presumably < normal delay) if < STICKY_REVERT_DELAY has elapsed
	since last popdown.
	
2001-02-17  Havoc Pennington  <hp@pobox.com>

	* gtk/gtktypeutils.h (GtkSignalFunc): change it to take (void)
	instead of (). #6394

	* gtk/gtkprogressbar.c (gtk_progress_bar_get_text): Add
	G_CONST_RETURN, make it return by reference, #50473
	
Sat Feb 17 06:47:27 2001  Tim Janik  <timj@gtk.org>

	* gtk/gtkmenu.c (gtk_menu_motion_notify): default initialize the
	generated ENTER_NOTIFY event with 0, otherwise not explicitely
	setup fields contain garbage (e.g. subwindow, breaking
	gdk_drawable_ref() upon event copy).
	(gtk_menu_stop_navigating_submenu_cb): same here.

	* gtk/gtklist.c (gtk_list_vertical_timeout): 
	* gtk/gtklist.c (gtk_list_horizontal_timeout): 
	* gtk/gtkclist.c (vertical_timeout): 
	* gtk/gtkclist.c (horizontal_timeout): change direct assignment
	default-zero-intialization for unions to memset(,0,), as unions are
	not fully default-zero-initialized by compilers (GdkEvent x = { 0, };
	has to become GdkEvent x; memset (&x, 0, sizeof (x)); )

	* gtk/gtktreeview.c (gtk_tree_view_set_rows_drag_source): scratch
	g_closure_sink() warning.

	* gtk/gtktreemodel.c (gtk_tree_model_get_valist): 
	* gtk/gtktreestore.c (gtk_tree_store_set_valist): 
	* gtk/gtkliststore.c (gtk_list_store_set_valist): 
	fix G_VALUE_COLLECT() and G_VALUE_LCOPY() calls.
	
Fri Feb 16 17:49:59 2001  Jonathan Blandford  <jrb@redhat.com>

	* gtk/gtktreestore.[hc], gtk/gtkliststore.[ch]: removed
	gtk_*_store_get, and moved to GtkTreeModel.

	* gtk/gtktreemodel.h (gtk_tree_model_set{v,}): Added

	* gtk/gtktreeviewcolumn.c (gtk_tree_view_column_finalize): added.

	* gtk/Makefile.am: remove gtktreemodelmapping.[ch]

	* gtk/gtktreeviewcolumn.c (gtk_tree_view_column_set_func): let you
	set the func.

	* gtk/gtktreeviewcolumn.c (gtk_tree_view_column_set_cell_data):
	freeze/thaw notify between setting all the properties for a cell.

	* gtk/gtk.h: remove gtktreemodelsimple.h, and gtktreemodelmapping.h

2001-02-15  Havoc Pennington  <hp@redhat.com>

	* gdk/gdkpango.c (gdk_pango_layout_line_get_clip_region): convert
	the X coordinates so they're with respect to the line, rather than 
	with respect to the layout.

	* gtk/gtkalignment.c: Convert to new property API, patch from Lee
	Mallabone

	* gtk/testgtk.c (create_range_controls): add vscale tests, 
	and inverted test

	* gtk/gtkrange.c (gtk_range_set_inverted): new function to fix 
	#50806

	* gtk/gtkentry.c (gtk_entry_get_text): add G_CONST_RETURN

	* gtk/gtktextiter.h (gtk_text_iter_is_last): rename 
	gtk_text_iter_is_end

	* gtk/gtktextbuffer.h (gtk_text_buffer_get_last_iter):
	rename gtk_text_buffer_get_end_iter

	* gtk/testgtk.c (create_labels): Add test for selectable

	* gtk/gtkentry.c (gtk_entry_draw_text): Use new GDK API to draw
	the selection stuff. This code is kind of broken since it doesn't 
	use the theme engine.

	* gdk/gdkpango.c (gdk_pango_layout_line_get_clip_region): 
	fix infinite loop and y offset problem
	(gdk_draw_layout_line_with_colors): fix foreground color handling

        * gtk/gtklabel.h, gtk/gtklabel.c: Implement a "selectable" flag 
	that makes the label selectable.
	
	* gtk/gtklabel.c (gtk_label_style_set): recreate the label's
	layout when the style is set, since fonts etc. could have changed.	

Fri Feb 16 14:22:05 2001  Jonathan Blandford  <jrb@redhat.com>

	* gtk/Makefile.am: Removed gtktreemodelsimple.[ch]

	* gtk/gtktreemodelsimple.[ch]: removed.

2001-02-16  Alexander Larsson  <alexl@redhat.com>

	* gtk/gtktreemodelmapping.[ch]:
	New files. Implement GtkTreeModelMapping.
	
	* gtk/Makefile.am:
	Add gtktreemodelmapping.[ch].
	
	* gtk/gtk.h:
	Add gtktreemodelmapping.h

	* gtk/treestoretest.c:
	Test the GtkTreeModelMapping

Tue Feb 13 13:16:09 2001  Jonathan Blandford  <jrb@redhat.com>

	* demos/gtk-demo/panes.c (create_pane_options): If we're going to
	have a demo, we might as well pass in real values.  Thanks to
	clahey for pointing this out.

2001-02-14  Havoc Pennington  <hp@pobox.com>

	* gtk/gtkimagemenuitem.c (gtk_image_menu_item_remove): add
	"static" to a private function
	(gtk_image_menu_item_class_init): remove destroy handler,
	add "image" object property

2001-02-13  Alexander Larsson  <alla@lysator.liu.se>

	* gdk/linux-fb/gdkdrawable-fb2.c (gdk_fb_clip_region):
	Add a shortcut if the window and the current clip_region doesn't
	overlap. This is needed when there are a lot of windows in a
	window. The layout test in testgtk is a good test.

	* gdk/linux-fb/gdkwindow-fb.c:
	Whitespace fix.

2001-02-13  Sven Neumann  <sven@convergence.de>

	* demos/testanimation.c: replaced deprecated gtk_drawing_area_size

2001-02-13  Alexander Larsson  <alexl@redhat.com>

	* gdk/linux-fb/gdkcursor-fb.c (gdk_fb_cursor_unhide):
	Don't reference last_cursor if it is null. Fixes crash when rotating
	the screen before having moved the mouse.

	* gdk/linux-fb/gdkcc-fb.c: Zapp!

	* gdk/linux-fb/Makefile.am: Don't compile gdkcc-fb.c

	* gdk/linux-fb/gdkwindow-fb.c: Fix typo. width->height. Fixes redraw 
	when using 90 or 270 degrees rotation.

2001-02-12  Havoc Pennington  <hp@pobox.com>

	* gdk/gdkpango.c (gdk_pango_get_gc): fix bug where 
	it always set the foreground, even if we were only using
	a stipple.
	(gdk_draw_layout_line_with_colors): new function, allow
	override colors
	(gdk_draw_layout_with_colors): new function, allow override
	colors
	(gdk_pango_layout_line_get_clip_region): function to get the clip
	region for a logical text range
	(gdk_pango_layout_get_clip_region): get the clip region for a
	logical text range

	* gdk/x11/gdkcolor-x11.c: forward declare gdk_colormap_sync(),
	(gdk_colormap_new): fix call to gdk_colormap_sync() so it has 
	the right number of arguments.

	* gtk/gtktextbtree.c (gtk_text_btree_node_check_consistency):
	enhance the function to check that node data corresponds to a 
	view still belonging to the tree.

	* gtk/gtktreeview.c (gtk_tree_view_changed): we were leaking the 
	GtkTreePath
	(gtk_tree_view_inserted): ditto
	(gtk_tree_view_child_toggled): ditto

	* gtk/gtktreemodel.c (gtk_tree_path_append_index): use realloc to
	simplify this code.

	* gtk/gtkcellrenderertext.c (get_layout): fix leak of 
	a PangoAttrList

	* demos/gtk-demo/main.c (load_file): Fix leak of a GString

	* gtk/gtkentry.c (gtk_entry_realize): Fix leak of a GdkCursor

	* gtk/gtkmenubar.c (gtk_menu_bar_size_request): consider toggle
	size in the size request 
	(gtk_menu_bar_size_allocate): consider toggle size here

	* gtk/gtkimagemenuitem.h, gtkimagemenuitem.c: Menu item
	that displays a widget in the toggle slot

	* gtk/testgtk.c: test GtkImageMenuItem

	* gtk/Makefile.am, gtk/gtk.h: Add GtkImageMenuItem
	
	* gtk/gtkmenuitem.h: Use "gint" not "guint16" for toggle size
	request and allocation

	* gtk/gtkmenu.c (gtk_menu_size_request): use gint not guint16

	* gtk/gtkcheckmenuitem.c
	(gtk_check_menu_item_toggle_size_request): ditto
	
Mon Feb 12 23:43:30 2001  Owen Taylor  <otaylor@redhat.com>

	* gtk/Makefile.am (gdk_headers): Remove gdkcc.h 
	reference.

	* configure.in gtk/gtkmain.c: Add checks for setuid/setgid,
	and refuse to initialize GTK+ if they fail.

Mon Feb 12 15:02:07 2001  Owen Taylor  <otaylor@redhat.com>

	* configure.in: Add check for gtk-doc version.

Thu Feb  8 17:18:26 2001  Owen Taylor  <otaylor@redhat.com>

	* gtk/gtklabel.c (gtk_label_size_request): Fix bug
	where the xpad/ypad was only being used on one side!

2001-02-11  Tor Lillqvist  <tml@iki.fi>

	* gdk/win32/gdkcolor-win32.c (gdk_colormap_query_color): New
	function, copied from X11 version.

	* gdk/win32/gdkwindow-win32.c (gdk_window_set_cursor): Eliminate
	DestroyCursor failures. The reason for the problem (despite the
	inconsistent messages from GetLastError()) was that
	DestroyCursor() cannot be called while a cursor is set in a
	window. Set the new cursor first and then destroy the old one.
	Thanks to jpe@archaeopteryx.com.

	* gdk/win32/gdkcc-win32.c: Remove.

	* gdk/win32/Makefile.am: Remove from here, too.
	
	* gdk/gdk.def
	* gdk/makefile.mingw.in: Update. Godbye GdkColorContext.

	* gtk/gtk.def
	* gtk/makefile.mingw.in: Updates.

2001-02-08  Havoc Pennington  <hp@redhat.com>

	* gtk/gtkbin.c (gtk_bin_add): better error message if you try to
	add a widget to a bin that already has a child.

	* gdk/gdkcc.h, gdk/gdkcc-x11.c: Remove GdkColorContext, #50512

	* docs/Changes-2.0.txt: note that GdkColorContext is gone.
	
	* gdk/x11/Makefile.am (libgdk_x11_la_SOURCES): remove gdkcc-x11.c

	* gdk/gdk.h: remove gdkcc.h

	* gdk/Makefile.am (gdk_public_h_sources): remove gdkcc.h

	* gtk/gtkpixmap.c (build_insensitive_pixmap): rewrite using
	GdkPixbuf, since the previous implementation was GdkColorContext
	dependent.

	* gtk/testgtk.c (create_pixmap): add test for insensitive GtkPixmap
	
Thu Feb  8 19:00:00 2001  Jonathan Blandford  <jrb@redhat.com>

	* gtk/gtktreeview.c (TREE_VIEW_VERTICAL_SEPARATOR): moved back to
	a sane value!

2001-02-08  Havoc Pennington  <hp@redhat.com>

	* gtk/gtkstyle.c (get_darkened_gc): let's darken colors, not
	lighten them.

2001-02-08  Havoc Pennington  <hp@redhat.com>

	* gtk/gtktextview.c (gtk_text_view_destroy_layout): remove
	validation idle

	* demos/gtk-demo/main.c (create_tree): adjust to changes in text
	cell renderer

	* demos/pixbuf-demo.c (timeout): remove deprecated
	gtk_widget_draw

	* demos/testpixbuf-save.c (main): remove deprecated
	gtk_drawing_area_size

	* gtk/gtktreeview.c (gtk_tree_view_size_allocate): allocate
	buttons even if the model isn't setup. gtk_tree_view_check_dirty()
	at the start of the allocation.
	(gtk_tree_view_check_dirty): handle column->button == NULL, handle
	unsetup or NULL model.

	* gtk/gtkstyle.c (gtk_default_draw_flat_box): drawing for the 
	even/odd/sorted cells in the tree view.

	* gtk/gtktreeselection.c (gtk_tree_selection_real_unselect_all):
	bugfixes

	* gtk/gtktreeview.c: assorted bugfixy stuff. Draw the row
	backgrounds with draw_flat_box using different detail for even/odd
	rows.

	* gtk/gtkrbtree.c, gtkrbtree.h: Keep track of the parity of each
	row, so we can draw the alternating colors thing

	* gtk/gtktexttag.c (gtk_text_tag_set_property): if we change a
	property from a synonym property, notify for the synonym.
	Also, nuke the background_gdk_set and foreground_gdk_set synonyms
	(gtk_text_tag_get_property): Always return the font, even if
	all its fields aren't set

	* gtk/gtkcellrenderertext.h (struct _GtkCellRendererText): don't
	store the attr list; it leaves us with no way to change attributes
	in _render according to the render flags, and no way to implement
	get_property. Instead store all the specific text attributes. 
	Separate whether an attribute is enabled from its value. Sync all
	properties with GtkTextTag, make them all consistent, etc.

	* gtk/gtkcellrenderer.h: Add a flag GTK_CELL_RENDERER_SORTED so
	renderers can highlight the sort row/column	

	* gtk/gtktreeviewcolumn.c (gtk_tree_view_column_get_property): use
	accessor functions to get values; this has the side effect of
	showing up which accessor functions were missing. Added those.

	* gtk/gtktreeviewcolumn.h: Replace set_justification with
	set_alignment, to be consistent with GtkLabel, GtkMisc

	* gtk/gtktreeviewcolumn.c: Added code to display sort indicator
	arrow.

	* gtk/Makefile.am (gtk_public_h_sources): add gtktreesortable.h

	* gtk/gtktreesortable.h: updates in here

2001-02-07  Sven Neumann  <sven@convergence.de>

	* gtk/gtkentry.c (gtk_entry_draw_text): convert area_height to 
	pango dimensions after painting the background. We used to draw
	gigantic flat boxes here.

Mon Feb  5 22:05:57 2001  Owen Taylor  <otaylor@redhat.com>

	* gdk/linux-fb/gdkimage-fb.c (_gdk_fb_get_image): Fix syntax
	error introduced with earlier commit) (pointed out by
	Ollie Lho)

Mon Feb  5 12:25:06 2001  Owen Taylor  <otaylor@redhat.com>

	* gtk/gtkbutton.c: Remove calls	to gtk_grab_add/gtk_grab_remove,
	which are no longer necessary.

Mon Feb  5 13:22:54 GMT 2001  Tony Gale <gale@gtk.org>

	* docs/faq/gtk-faq.sgml: s/MISK/MISC/

2001-02-04  Tor Lillqvist  <tml@iki.fi>

	* gdk/gdk.def
	* gdk/win32/gdkim-win32.c (gdk_ic_attr_new, gdk_ic_attr_destroy):
	Provide dummy implementations.

Sun Feb  4 07:55:17 2001  Tim Janik  <timj@gtk.org>

	* gtk/gtksignal.h: removed gtk_signal_init() compat define.

	* gtk/gtktypeutils.[hc]: gtk_tpye_init() take an additional argument
	GTypeDebugFlags debug_flags and pass it on to g_type_init ();
	deprecated this function.

	* gdk/gdk.c (gdk_init_check): call g_type_init () with 0 as
	argument.

Sun Feb  4 07:45:45 2001  Tim Janik  <timj@gtk.org>

	* gtk/gtkdebug.h: nuke GTK_DEBUG_OBJECTS and GTK_DEBUG_SIGNALS.

2001-02-03  Havoc Pennington  <hp@pobox.com>

	* gtk/gtktextbtree.c (_gtk_text_btree_tag): Fix bug reported by
	Mikael Hermansson with patch from Mikael (if there was a toggle
	start one after the first character in the range, this function
	was broken). Bug #50380

Sat Feb  3 11:28:03 2001  Owen Taylor  <otaylor@redhat.com>

	* configure.in: Remove confusing comment about X11.

Fri Feb  2 19:21:23 2001  Owen Taylor  <otaylor@redhat.com>

	* gdk/gdkwindow.c (gdk_propagate_shapes): Surround additional
	regions with HAVE_SHAPE_EXT. (#50511, Eric Ding)
	
Fri Feb  2 18:31:54 2001  Owen Taylor  <otaylor@redhat.com>

	* gdk/x11/gdkimage-x11.c: Remove definition of _XOPEN_SOURCE, since
	it breaks things on BSD. If you want to compile GTK+ with
	-ansi -pedantic, you should supply CPP_FLAGS=_XOPEN_SOURCE 
	when configuring, since GTK+ simply can't be "pure ANSI" 
	in the header files it uses. (#8170, Greg Hudson)

2001-02-02  Havoc Pennington  <hp@redhat.com>

	* gtk/gtkwindow.c: docs

	* gtk/gtkwidget.c: docs
	(gtk_widget_set_colormap): add a reference to the colormap
	(gtk_widget_get_default_colormap): add a reference to the colormap

	* gtk/gtktextbtree.c (gtk_text_mark_set_visible): docs

	* gtk/gtktextiter.c: docs

	* gtk/gtkmain.c (gtk_propagate_event): docs

	* gtk/gtkpaned.c (gtk_paned_get_position): docs
	(gtk_paned_set_position): docs

	* gtk/gtktreesortable.h (struct _GtkTreeSortableIface): Initial
	sort interface, no implementation yet.

	* demos/testpixbuf.c (new_testrgb_window): replace
	gtk_drawing_area_size() with gtk_widget_set_usize()

	* demos/testpixbuf-drawable.c (main): ditto
	
	* gtk/testgtk.c: remove use of GtkStatusbarMsg

	* gtk/gtktextbuffer.c: docs

	* gtk/gtkstock.c: docs

	* gtk/gtkscrolledwindow.c (gtk_scrolled_window_set_shadow_type): docs

	* gtk/gtkoptionmenu.c (gtk_option_menu_get_history): docs

	* gtk/gtklabel.c (gtk_label_set_markup_with_accel): fix docs
	
	* gtk/gtkimage.c: add some docs in here
	(gtk_image_size_request): change name of
	gtk_widget_render_stock_icon
	(gtk_image_get_icon_set): don't dup returned string
	(gtk_image_get_icon_set): don't dup returned string

	* gtk/gtkwidget.c (gtk_widget_render_icon): rename from 
	gtk_widget_render_stock_icon(), more consistent with gtkstyle.h
	and gtkiconfactory.h functions

	* gtk/gtkiconfactory.c: add some docs in here

	* gtk/gtkmain.c (gtk_get_default_language): document
	(gtk_get_current_event): document
	(gtk_get_current_event_state): document
	(gtk_get_event_widget): document

	* gtk/gtkentry.c (gtk_entry_set_invisible_char): document

	* gtk/gtkcontainer.c: Add some documentation
	(gtk_container_add): give a more explanatory warning on adding an
	already-parented widget, this is kind of a FAQ and also a common
	typo that's easier to debug with a nice warning	

	* gtk/gtkcellrenderertoggle.c
	(gtk_cell_renderer_toggle_get_active): remove, I was on crack
	adding this, it's useless
	(gtk_cell_renderer_toggle_set_active): remove
	(gtk_cell_renderer_toggle_get_radio): add

	* gtk/gtkcellrenderer.c (gtk_cell_renderer_get_size): don't allow
	the NULL cell renderer, that doesn't make any sense to me. 

	* demos/gtk-demo/Makefile.am (INCLUDES): -DGTK_DISABLE_DEPRECATED,
	demo code should never use deprecated features.

	* demos/Makefile.am (INCLUDES): -DGTK_DISABLE_DEPRECATED, demo
	code should never use deprecated features.

	* gtk/gtkwidget.h: Mark gtk_widget_draw, gtk_widget_queue_clear,
	gtk_widget_queue_clear_area deprecated

	* gtk/gtklayout.h: mark gtk_layout_freeze/gtk_layout_thaw
	deprecated

	* gtk/gtklabel.h: mark gtk_label_get() deprecated

	* gtk/gtkimage.h: mark the legacy GtkImage functions that took 
	a GdkImage deprecated, replaced by new consistently-named
	functions	

	* gtk/gtkmain.h: Mark gtk_exit() deprecated

	* gtk/gtkdrawingarea.h: mark gtk_drawing_area_size deprecated

	* gtk/gtkstyle.h: mark gtk_draw_string, gtk_paint_string 
	deprecated

	* gtk/gtkstatusbar.h: Move GtkStatusbarMsg to the .c file, 
	so it won't appear in docs and confuse people.

	* gtk/gtkprogressbar.h: Mark all the old methods deprecated

	* gtk/gtkprogress.h: Mark all methods deprecated, mark the cast
	macros deprecated. (can't mark the type itself deprecated, since
	GtkProgressBar is not deprecated and we need the type decl to use
	GtkProgressBar)

	* gtk/gtkpixmap.h: Mark deprecated

	* gtk/gtkoldeditable.h: Mark deprecated

	* gtk/gtklist.h: Mark deprecated

	* gtk/gtklabel.h: delete "GtkLabelWord" typedef, not used 
	for anything anymore.

	* gtk/gtkctree.h: Mark deprecated

	* gtk/gtkclist.h: Mark deprecated

	* gtk/gtkpreview.h: Mark deprecated

	* gtk/gtkpacker.h: Mark deprecated

	* gtk/gtktipsquery.h: Mark deprecated

	* gtk/gtkinputdialog.h: Add comment that it will move out of GTK

	* gtk/gtkvruler.h: Add comment that it will move out of GTK

	* gtk/gtkhruler.h: Add comment that it will move out of GTK

	* gtk/gtkruler.h: Add comment that it will move out of GTK

	* gtk/gtkgamma.h: Add comment that it will move out of GTK

	* gtk/gtkcurve.h: Add comment that it will move out of GTK

Fri Feb  2 17:16:09 2001  Owen Taylor  <otaylor@redhat.com>

	* gdk/x11/gdkcolor-x11.c (gdk_colormap_sync): Make
	gdk_colormap_sync private since it was never exported
	in a header file.

	* gdk/x11/gdkcolor-x11.c (gdk_colormap_new): Fill in
	colormap->colors[] for StaticGray, StaticColor colormaps.

	* gdk/gdkpixbuf-drawable.c: Fix problems where image->bpp
	was being used as if it was image->bits_per_pixel.

	* gdk/gdkimage.h, gdk/x11/gdkimage-x11.c: Save the bits-per-pixel
	for the image in the GdkImage structure since it isn't
	reconstructable, and we need it to handle packed types

	* gdk/win32/gdkimage-win32.c: Set image->bits_per_pixel. (I'm making
	the assumption that on Win32 image->bits_per_pixel == image->depth,
	always.

	* gdk/linux-fb/gdkimage-fb.c: Set image->bits_per_pixel.

	* gdk/gdkrgb.c (gdk_rgb_select_conv): Exit with an informative
	warning message if no converter can be found. 

Fri Feb  2 15:09:51 2001  Owen Taylor  <otaylor@redhat.com>

	* gtk/fnmatch.c (FOLD): Fix problem with passing signed
	chars to isupper() / tolower(). (#567)

	* examples/packer/pack.c: Add GINT_TO_POINTER, GPOINTER_TO_INT
	to clear up 64-bit warnings. (#567)

Fri Feb  2 12:26:50 2001  Owen Taylor  <otaylor@redhat.com>

	* gtk/gtkrc.c (gtk_rc_add_initial_default_files): Get rid of
	a bunch of g_strdup_printf("%s%s") in favor of g_strconcat().

	* gtk/gtkrc.c Makefile.am: Use $(libdir), not $(exe_prefix),
	since some people set $(libdir) separately. (#1290, David Kaelbling)

Thu Feb  1 18:25:46 2001  Owen Taylor  <otaylor@redhat.com>

	* gtk/gtkfilesel.c: If PATH_MAX and MAXPATHLEN are not
	defined, define MAXPATHLEN to 2048. (The Hurd doesn't have
	MAXPATHLEN, but the code here depends on a fixed value.)
	(#4524)

Wed Jan 31 22:01:04 2001  Owen Taylor  <otaylor@redhat.com>

	* gtk/gtkhandlebox.c (gtk_handle_box_button_changed): Handle the case
	where child == NULL and handle_position == RIGHT or BOTTOM. (#8041g)

Wed Jan 31 21:20:39 2001  Owen Taylor  <otaylor@redhat.com>

	* gtk/gtkctree.c (real_tree_move): If the node being moved isn't
	viewable there is no way that moving the node will cause the 
	focus row to become not viewable, so omit check on the visibility
	of new_sibling, which is irrelevant. (Fixes #8002, David Helder)

Wed Jan 31 20:38:17 2001  Owen Taylor  <otaylor@redhat.com>

	* gtk/gtkentry.c (gtk_entry_commit_cb): Delete the current
	selection before inserting new text.

Wed Jan 31 18:49:33 2001  Owen Taylor  <otaylor@redhat.com>

	* gtk/gtkoptionmenu.c (gtk_option_menu_item_state_changed_cb):
	Make the sensitivity of the reparented child track that of
	the original parent menu item. (#34218, David Hodson)

	* gtk/gtkoptionmenu.c (gtk_option_menu_item_destroy_cb): Handle
	the case where the current item is destroyed properly.

	* gtk/gtkoptionmenu.c: Some additional code cleanups and fix
	some edge cases with child-less menuitems.
	
Wed Jan 31 17:16:13 2001  Owen Taylor  <otaylor@redhat.com>

	* gtk/gtkcombo.c (gtk_combo_window_key_press): Make Return
	key pop down window. (#12074, Jon K Hellan)

Wed Jan 31 16:21:42 2001  Owen Taylor  <otaylor@redhat.com>

	* gtk/gtklist.c (gtk_list_signal_item_toggle): Don't allow
	toggling of rows off in BROWSE or EXTENDED mode. (#12072, Jon K Hellan) 
	The solution here isn't perfect - you get an extraneous
	emission of "toggle", which could conceivably confuse an app,
	but better than the current situation. LXR search seems to
	indicate that no apps in GNOME CVS connect to "toggle".

Wed Jan 31 15:46:13 2001  Owen Taylor  <otaylor@redhat.com>

        * gtk/Makefile.am (libgtkinclude_HEADERS): Move gtkcompat.h from
        gtk_public_h_sources to directly here to avoid warning when
        building srcdir != builddir. (#9656)

Tue Jan 30 19:49:02 2001  Owen Taylor  <otaylor@redhat.com>

	* gtk/gtkrange.c: Patch from Kipp Hickman to make the event
	handlers in gtkrange.c return the proper values (TRUE == handled)
	(#10316).

	This is just the tip of the iceberg, but gtkrange.c is the
	most common place where the propagation is problematical,
	and also a place where it is almost certainly safe to change
	this in the stable branch.

	(You don't want right click popups on a range control or anything...)

Tue Jan 30 18:57:59 2001  Owen Taylor  <otaylor@redhat.com>

	* gtk/gtktext.c (clear_focus_area): We need to clear the focus
	area on focus out, even if a background pixmap isn't set.
	(#13941)
	
Tue Jan 30 18:24:10 2001  Owen Taylor  <otaylor@redhat.com>

	* gtk/gtknotebook.c (gtk_notebook_set_shape): Fix from Sean Cunningham
	to deal with setting the shape properly when scrolling arrows are
	turned on, but not visible because there is sufficient space.
	(#13432)

Tue Jan 30 16:39:25 2001  Owen Taylor  <otaylor@redhat.com>

	* gtk/gtkitemfactory.c (gtk_item_factory_delete_item): For menu
	items with submenus, destroy the item along with the submenu.
	(#7841, Brian Masney(?)) Also, handle paths of the form '<foo>/abcd...' 
	properly.

	* gtk/testgtk.c (menu_items): Add a dummy branch that we delete
	later.

Tue Jan 30 15:51:25 2001  Owen Taylor  <otaylor@redhat.com>

	* gtk/gtkwindow.c (gtk_window_real_set_focus): Fix a problem where
	the focus widget sometimes wasn't drawn with the default if there
	was no default widget.

	* gtk/gtkstyle.c (gtk_style_real_unrealize): free colors,
	unreference pixmaps. 

	* gtk/gtkstyle.c (gtk_style_realize): Reference colormap
	for some extra safety.

Mon Jan 29 19:00:01 2001  Owen Taylor  <otaylor@redhat.com>

	* gtk/gtk{ctree.c,clist.c} (set_cell_contents): Handle setting
	the text of a cell to the old pointer value better, by
	copying the new text before freeing the old text. Some code
	cleanup. (#8079, Karl Nelson)

Mon Jan 29 16:50:19 2001  Owen Taylor  <otaylor@redhat.com>

	* gtk/gtklabel.[ch] gtk/gtkframe.[ch]: Make gtk_label_get_text()
	gtk_frame_get_label() non strdup'ing, and G_CONST_RETURN.

Mon Jan 29 15:22:51 2001  Owen Taylor  <otaylor@redhat.com>

	* gtk/gtkmenu.c (gtk_menu_remove): When removing an
	item from a menu, check to see if it matches 
	menu->old_active_menu_item, and if so, unref and clear
	old_active_menu_item (Patch from Pavel Cisler)

	* gtk/gtkmenushell.c (gtk_menu_shell_remove): Unset 
	menu_shell->active_menu_item, if it is the child being
	removed. (Patch based on that of Gene Ragan, #50337)

2001-01-31  Alexander Larsson  <alla@lysator.liu.se>

	* gdk/linux-fb/gdkselection-fb.c: 
	* gdk/linux-fb/gdkcolor-fb.c: 
	* gdk/linux-fb/gdkdrawable-fb2.c: 
	* gdk/linux-fb/gdkfont-fb.c: 
	* gdk/linux-fb/gdkim-fb.c: 
	* gdk/linux-fb/gdkinput.c: 
	* gdk/linux-fb/gdkkeyboard-fb.c: 
	* gdk/linux-fb/gdkmain-fb.c: 
	* gdk/linux-fb/gdkrender-fb.c: 
	A bunch of whitespace cleanup.
	
2001-01-30  Havoc Pennington  <hp@pobox.com>

	* gtk/gtktreeitem.h, gtk/gtktree.h, gtk/gtktext.h: bracket in 
	#ifdef GTK_ENABLE_BROKEN.

	* gtk/gtktreeitem.c, gtk/gtktree.c, gtk/gtktext.c: #define
	GTK_ENABLE_BROKEN just before including the broken headers.
	
	* gtk/gtktypeutils.c: #define GTK_ENABLE_BROKEN, so we can get the
	deprecated types registered.

	* gtk/testgtk.c, gtk/testselection.c: #define GTK_ENABLE_BROKEN,
	we have to test the broken stuff.

        * docs/Changes-2.0.txt: explain GTK_ENABLE_BROKEN
	
2001-01-30  Havoc Pennington  <hp@redhat.com>

	* gtk/gtkliststore.c (gtk_list_store_insert_before): fix bug in
	here where prev pointer was set to the wrong thing

	* gtk/gtktreemodel.c (gtk_tree_path_is_ancestor): new function
	(gtk_tree_path_is_descendant): new function

	* gtk/gtkliststore.c (gtk_list_store_iter_n_children): return
	cached length
	(gtk_list_store_get_iter): don't modify iter if we can't get the
	path.

	* gtk/gtkliststore.h (struct _GtkListStore): cache the length
	
	* gtk/gtktreednd.h: add virtual function row_drop_possible() to
	GtkTreeDragDest

	* gtk/gtktreestore.c (copy_node_data): fix varargs type error that
	was causing segfault

	* gtk/gtktreedatalist.c (_gtk_tree_data_list_node_copy): set next
	pointer to NULL

	* gtk/gtktreestore.c (gtk_tree_store_append): fix memleak

	* gtk/gtkliststore.c (gtk_list_store_iter_next): don't modify iter
	on returning FALSE
	(gtk_list_store_iter_children): ditto
	(gtk_list_store_iter_nth_child): ditto
	(gtk_list_store_iter_nth_child): ditto
	(gtk_list_store_iter_parent): ditto

	* gtk/gtktreestore.c (gtk_tree_store_get_path): g_return_if_fail
	on iter->user_data != NULL instead of silently accepting it.
	(gtk_tree_store_iter_next): ditto. Also, don't modify iter unless
	we are returning TRUE.
	(gtk_tree_store_iter_children): ditto
	(gtk_tree_store_iter_nth_child): ditto
	(gtk_tree_store_iter_parent): ditto
	(gtk_tree_store_insert): remove handling of parent->user_data ==
	NULL, replace with parent == NULL	

	* gtk/gtktreemodel.c (inserted_callback): put some fixes in here,
	and a comment explaining things

	* gtk/gtktreestore.c: add GtkTreeDragSource/GtkTreeDragDest
	interface support to GtkTreeStore.

	* gtk/gtktreemodel.c (gtk_tree_path_prev): didn't properly return
	FALSE if no prev, fix

	* gtk/gtktreeview.c (set_source_row): use a row reference
	(set_dest_row): use a row reference

Sat Jan 27 15:52:02 2001  Jonathan Blandford  <jrb@redhat.com>

	* gtk/gtktreeselection.c (gtk_tree_selection_unselect_iter): Fix
	stupid typo pointed out by Kristian Rietveld <kristian@planet.nl>.
	(gtk_tree_selection_select_iter): The same as above.

2001-01-26  Havoc Pennington  <hp@redhat.com>

	* gtk/gtktreemodel.c, gtk/gtktreemodel.h: add GtkTreeRowReference
	which holds a handle to a specific row (particular set of values
	in the model, i.e. pointer-identity row).

	* gtk/gtktreeview.c, gtk/gtktreeprivate.h, gtk/gtktreeselection.c:
	use GtkTreeRowReference for anchor, cursor, and drag_dest_row.
	Still need to use it for the src/dest row saved on the drag context.

2001-01-26  Havoc Pennington  <hp@redhat.com>

	* gtk/gtktextlayout.c (convert_color): adapt to handle PangoColor

	* gtk/gtktreeview.c (gtk_tree_view_widget_to_tree_coords): fix to
	not offset by TREE_VIEW_HEADER_HEIGHT
	(gtk_tree_view_tree_to_widget_coords): fix to not offset by
	TREE_VIEW_HEADER_HEIGHT

	* configure.in (included_loaders): for me, --with-included-loaders
	generates the error "the specified loader yes does not exist",
	i.e. the arg defaults to "yes", so change test for value ""
	to test for value "yes", and include all loaders in that case.

	* gtk/gtkrbtree.c (_gtk_rbtree_get_depth): new function

	* gtk/gtktreeview.c (gtk_tree_view_get_cell_rect): fix to properly
	handle TREE_VIEW_VERTICAL_SEPARATOR
	(gtk_tree_view_bin_expose): fix to consider the row offset as
	pointing halfway into vertical separator.	
	(gtk_tree_view_draw_node_focus_rect): ditto

	* gtk/gtkdebug.h, gtk/gtkmain.c (gtk_init_check): Add
	--gtk-debug=updates, which causes gdk_window_set_debug_updates
	(TRUE) to be called.

	* gdk/gdkwindow.c (gdk_window_set_debug_updates): Allow enabling a
	debug mode where the invalid region is colored in on invalidate,
	so you can see the flicker and know whether your redraw code is 
	doing a good job.

	* gtk/gtktreeview.c (gtk_tree_view_queue_draw_node): Work in 
	tree window coordinates (clip rect is in tree window coords)

	* gtk/Makefile.am: add gtktreednd.[hc]

	* gtk/gtkliststore.c: implement gtktreednd interfaces.

	* gtk/gtktreednd.c, gtk/gtktreednd.h: New interface to support
	drag-and-drop data operations on a model (so we can set up tree
	drag-and-drop automatically)

	* gtk/testgtk.c: Add a window to change sensitivity in the
	GtkLabel test; add a way to change the entry frame in GtkEntry
	test

	* gtk/gtkentry.c (gtk_entry_set_has_frame): 
	(gtk_entry_get_has_frame): new functions to remove the frame
	around an entry
	(gtk_entry_size_request): shrink requisition if no frame
	(gtk_entry_draw_focus): don't draw frame if no frame

	* gtk/gtkstyle.c (gtk_default_draw_check): draw custom look for
	checks inside a cell renderer
	(gtk_default_draw_option): ditto for options

	* gtk/gtktreeviewcolumn.c (update_button_contents): add/remove
	children from the alignment, not the button
	(gtk_tree_view_column_init): ref/sink the column, to emulate
	GObject refcounting.

	* gtk/gtkcellrenderer.c (gtk_cell_renderer_init): ref/sink
	
	* gtk/gtkcellrenderertoggle.c (gtk_cell_renderer_toggle_render):
	Use theme functions to draw the toggles	

	* gdk/gdkpango.c (gdk_pango_get_gc): use GdkRGB to alloc colors

	* gdk/gdkpango.h, gdk/gdkpango.c: Add GdkPangoAttrStipple and
	GdkPangoAttrEmbossed to use in rendering insensitive text

	* gdk/gdkpango.c (gdk_draw_layout_line): render new properties

	* gtk/gtkstyle.c (gtk_default_draw_layout): handle sensitivity
	using new GDK features
	
2001-01-24  Alexander Larsson  <alexl@redhat.com>

	* gtk/gtkimage.c:
	Splitted gtk_image_clear into gtk_image_clear() and
	gtk_image_reset(). Call gtk_image_clear() in ::destroy
	to avoid leaks.

	* gtk/gtklabel.c (set_markup):
	Don't leak text.

	* gtk/gtktextlayout.c:
	Always free display->shaped_objects.

	* gtk/testgtk.c (create_clist):
	Don't leak custom style.

2001-01-23  Alexander Larsson  <alexl@redhat.com>

	* gtk/gtkcolorsel.c (grab_color_at_mouse):
	Don't leak image. Simplify using gdk_colormap_query_color().
	(gtk_color_selection_init): Don't leak dropper_pixmap and mask.

	* linux-fb/gdkcolor-fb.c:
	Implemented gdk_colormap_query_color.

2001-01-23  Alexander Larsson  <alexl@redhat.com>

        * linux-fb/gdkcursor-fb.c:
	Don't leak built-in cursors.

	* linux-fb/gdkdrawable-fb2.c (gdk_fb_draw_polygon):
	Don't leak tmp_points.

	* linux-fb/gdkfont-fb.c (gdk_font_from_description):
	Don't modify desc. Don't leak font if the PangoFont
	isn't found.
	
	* linux-fb/gdkgc-fb.c (gdk_fb_gc_finalize):
	Free dash_list.

	* linux-fb/gdkkeyboard-fb.c (gdk_fb_handle_key):
	Don't leak string.
	
2001-01-20  Havoc Pennington  <hp@pobox.com>

	* gtk/gtktexttag.h (enum GtkWrapMode): rename member fields
	from GTK_WRAPMODE_WORD to GTK_WRAP_WORD, etc., seems nicer to 
	me, matches Pango

2001-01-22  Havoc Pennington  <hp@redhat.com>

	* demos/testanimation.c: fix to reflect gdk-pixbuf changes

	* demos/testpixbuf.c: fix to reflect gdk-pixbuf changes

	* gtk/gdk-pixbuf-loader.c, gtk/gdk-pixbuf-loader.h: 
	Remove, move back to gdk-pixbuf

	* gtk/gtktextiter.c, gtk/gtktextiter.h: add sentence equivalents
	to all the word functions

	* gtk/gtktextview.c (gtk_text_view_start_cursor_blink): return
	before doing anything on NULL layout or if we don't have the focus

	* gtk/testtext.c (fill_example_buffer): "justification"

	* gtk/gtktexttag.h, gtk/gtktexttag.c: change the tag attribute
	to be called "justification" not "justify"

	* demos/gtk-demo/textview.c (create_tags): "justification"
	
	* gtk/gtktextlayout.c (set_para_values): Handle char-wise wrapping

2001-01-22  Alexander Larsson  <alexl@redhat.com>

	* gdk/gdkwindow.c (gdk_window_invalidate_region):
	Don't leak visible_region. Use visible_region instead of region.
	
	* gdk/linux-fb/gdkwindow-fb.c (gdk_window_new):
	Don't do extra gdk_drawable_ref(). This is not X.
	(gdk_fb_window_find_focus, gdk_fb_change_focus): make sure
	gdk_fb_focused_window is ref:ed.
	(gdk_fb_window_send_crossing_events): Watch out for destroyed
	windows.

2001-01-22  Alexander Larsson  <alexl@redhat.com>

	* gtk/gtkwindow-decorate.c (gtk_decorated_window_realize):
	Don't leak the PangoFontDescriptor.

Sun Jan 21 09:58:00 2001  Jonathan Blandford  <jrb@redhat.com>

	* gtk/gtktreeview.c (gtk_tree_view_scroll_to_point): Make fail
	when not realized.
	(gtk_tree_view_scroll_to_cell): Make work when not realized.
	(gtk_tree_view_realize): add scroll_to support
	(gtk_tree_view_finalize): add a finalize method.  Populate.
	(gtk_tree_view_insert_column): ref and sink the column.
	(gtk_tree_view_append_column): ref and sink the column.
	(gtk_tree_view_queue_draw_node): New function to handle redrawing
	individual nodes.  Should make the code much more efficient, if
	actually used.

2001-01-19  Havoc Pennington  <hp@redhat.com>

	* gtk/gtktextlayout.c (gtk_text_layout_get_line_display):
	byte_offset variable was being used to mean both "offset into
	layout" and "offset into buffer line" which was no longer true
	with addition of preedit string; fix

2001-01-19  Havoc Pennington  <hp@redhat.com>

	* demos/gtk-demo/main.c (button_press_event_cb): sync to tree changes

	* gtk/gtkrbtree.c (_gtk_rbtree_node_find_offset): fix this
	function

	* gtk/gtktreeviewcolumn.c (gtk_tree_view_column_set_widget):
	implement

	* gtk/gtktreeview.c (gtk_tree_view_move_to): rename
	scroll_to_cell, matches TextView scroll functions better
	(gtk_tree_view_tree_to_widget_coords): new function
	(gtk_tree_view_widget_to_tree_coords): new function
	(gtk_tree_view_get_visible_rect): new function
	(gtk_tree_view_get_path_at_pos): accept negative coordinates
	(gtk_tree_view_draw_node_focus_rect): new function moved from
	draw_focus, also, use width of bin_window as width of the focus
	rect
	(gtk_tree_view_expand_row): fix bug where it didn't recognize
	already-expanded rows
	(gtk_tree_view_get_cell_rect): new function
	(gtk_tree_view_get_path_at_pos): return the click position
	relative to the passed-in cell
	(gtk_tree_view_set_expander_column): new function

	* configure.in: remove gtk-config-2.0 chmod

	* gtk/gtktextview.c (gtk_text_view_drag_motion): small cleanups,
	and properly handle drags with targets we don't understand
	(gtk_text_view_drag_end): don't stop scrolling, the source isn't
	scrolling anyway
	(gtk_text_view_drag_drop): stop scrolling here though, and set the
	mark invisible

	* gtk/gtkdnd.c (gtk_drag_dest_find_target): export as a public
	function
	(gtk_drag_dest_get_target_list): new function
	(gtk_drag_dest_set_target_list): new function
	
	* gtk/gtktreeview.c: Add a bunch of drag-and-drop implementation

	* gtk/gtktreeprivate.h (struct _GtkTreeViewPrivate): add fields
	related to drag-and-drop

2001-01-19  Alexander Larsson  <alexl@redhat.com>

	* gdk/linux-fb/gdkprivate-fb.h:
	Define EMULATE_GDKFONT.
	Add extra pango_font stuff to GfkFontPrivate.
	
	* gdk/linux-fb/gdkdrawable-fb2.c:
	* gdk/linux-fb/gdkfont-fb.c:
	If EMULATE_GDKFONT defined, implement a slow lame GdkFont
	emulation using PangoFont.

2001-01-17  Havoc Pennington  <hp@pobox.com>

	* gtk/gtkprogressbar.c, gtk/gtkprogressbar.h: Add "getters" for
	all the non-deprecated set_foo functions. Added missing object
	properties, and added g_object_notify() to setters. 
	Wrote docs.
	
2001-01-18  Tor Lillqvist  <tml@iki.fi>

	* gtk/gtkmain.c
	* gtk/gtkrc.c: (Win32) Use the new
	g_win32_get_package_installation_(sub)directory() functions.

	* config.h.win32.in: New file.
	
	* config.h.win32: Removed.

	* configure.in: Output config.h.win32.

	* Makefile.am: Add it to EXTRA_DIST.

	* gtk/gtk.def: Update.

Wed Jan 17 16:22:54 2001  Owen Taylor  <otaylor@redhat.com>

	* gtk/gtklabel.c (gtk_label_size_request): Set the
	attributes onto the PangoLayout even if they are newly
	created from label->pattern.

Tue Jan  9 11:20:48 2001  Owen Taylor  <otaylor@redhat.com>

	* gdk/x11/gdkdnd-x11.c: Remove unused variable.

	* gtk/gtkdnd.c: Encapsulate storing and retrieving info
	structures in functions. Fixes bug where gtk_dataset_*
	was accidentally still being used in one place, causing
        every dest side event to be treated independently.

	* gtk/gtkdnd.c: Remove last vestages of handling
	::draw (fixes warning)
	
	* gtk/gtkentry.[ch]: Add drag and drop support.

	* gtk/gtkdnd.[ch] gtk/gtktextview.c gtk/gtkentry.c: Add
	new function gtk_check_drag_threshhold() for checking
	to check if (dx,dy) has exceeded the threshhold for starting
	a drag and use it everywhere.

Mon Jan  8 11:58:05 2001  Owen Taylor  <otaylor@redhat.com>

	* gtk+-2.0.pc.in gdk-pixbuf-2.0.pc.in (Cflags): Remove -I${includedir},
	add -I{includedir}/gtk-2.0.

	* gtk/gtktreeview.[ch] gtktreemodelsort.[ch] gtknotebook.c
	gdk/gdk-pixbuf.h: Doc fixups.
	
	* gtk/gtkobject.h: Remove trailing , from enum

2001-01-17 Alexander Larsson <alexl@redhat.com>	

	* gdk/linux-fb/gdkdrawable-fb2.c (gdk_shadow_fb_draw_arc):
	Doh! Mixed up x and y.

	* gdk/linux-fb/gdkglobals-fb.c:
	Removed gdk_fb_pointer_grab_window_events,
	added _gdk_fb_pointer_grab_owner_events and
	_gdk_fb_keyboard_grab_owner_events.

	* gdk/linux-fb/gdkmain-fb.c (gdk_fb_pointer_grab):
	Set all button mask if GDK_BUTTON_MOTION_MASK set. Send
	crossing events before grabbing. Set _gdk_fb_pointer_grab_owner_events.
	(gdk_fb_pointer_ungrab): Unset _gdk_fb_pointer_grab_owner_events
	Send crossing events after ungrab finished.
	(gdk_keyboard_grab): Set ..._owner_events
	(type_masks): Move out of function.
	(gdk_fb_other_event_window, gdk_fb_pointer_event_window,
	gdk_fb_keyboard_event_window): New functions, return the
	window an event should be targeted at. Handles grabs and
	event propagation. Can return NULL.
	(gdk_event_make): Remove event_mask checking. Now always
	returns an event.
		
	* gdk/linux-fb/gdkkeyboard-fb.c:
	* gdk/linux-fb/gdkproperty-fb.c:
	* gdk/linux-fb/gdkselection-fb.c:
	Use new event_window/gdk_event_make() behaviour.
	
	* gdk/linux-fb/gdkmouse-fb.c:
	Use new event_window/gdk_event_make() behaviour.
	Only send motion events if in the same window.
	If grabbed, use cursor from window if sibling of grabbed
	window, and cursor from grabbed window otherwise.

	* gdk/linux-fb/gdkprivate-fb.h:
	Update gdk_fb_window_send_crossing_events, gdk_event_make
	and grab varaible declarations. Add gdk_fb_*_event_window().

	* gdk/linux-fb/gdkwindow-fb.c:
	Use new event_window/gdk_event_make() behaviour.
	Keep correct track of focus window.
	(gdk_window_set_events): Set all specific button motion masks
	if GDK_BUTTON_MOTION_MASK set.

	* gtk/gtkdnd.c (gtk_drag_update):
	Free info->last_event if gdk_drag_motion returned FALSE.

2001-01-16  Tor Lillqvist  <tml@iki.fi>

	* gdk/win32/gdkwindow-win32.c (gdk_window_show, gdk_window_hide):
	Eliminate redraws when input-only windows are shown or
	hidden. Thanks to jpe@archaeopteryx.com.

Tue Jan 16 13:13:13 GMT 2001  Tony Gale <gale@gtk.org>

	* docs/faq/gtk-faq.sgml: FAQ update:
	  - Update to bugzilla
	  - Add GTK+ and security/SUID/SGID
	  - Add DnD question

2001-01-16  Alexander Larsson  <alla@lysator.liu.se>

	* gdk/linux-fb/gdkdnd-fb.c:
	Some cleanups.
	
2001-01-15  Havoc Pennington  <hp@pobox.com>

	* tests/testtreeview.c: add test stuff for CellRendererToggle

	* gtk/gtktreemodelsort.c (gtk_tree_model_sort_get_model): add this
	accessor

	* gtk/gtkcellrenderertoggle.c: distinguish different event types,
	only toggle on button press (would do release like GtkButton, but
	we'd need implicit grab code for treeview cells)

2001-01-16  Tor Lillqvist  <tml@iki.fi>

	* gdk/win32/gdkvisual-win32.c: Include <stdlib.h> for getenv().

	* gdk/win32/gdkevents-win32.c (gdk_event_translate): Don't use
	GDK_COLORMAP_PRIVATE_DATA on a potentially NULL GdkColormap.

	* gdk/win32/gdkfont-win32.c (gdk_font_load_internal): Adapt calls
	to g_{locale,filename}_{to,from}_utf8 to match current API.

	* gtk/makefile.msc.in (gtk_OBJECTS)
	* gtk/makefile.mingw.in (gtk_OBJECTS): Add gtkwindow-decorate.

	* gtk/gtk.def: Update.

2001-01-15  Tor Lillqvist  <tml@iki.fi>

	* gdk/win32/gdkevents-win32.c (synthesize_crossing_events): New
	implementaion that more closely mimics the events that an X server
	would generate. Especially, properly generate GDK_NOTIFY_VIRTUAL and
	GDK_NOTIFY_NONLINEAR_VIRTUAL crossing events. This makes buttons
	with nested preview widgets, for instance, more responsive when
	you move the mouse quickly into them.
	(find_window_for_pointer_event): Make it actually compile.
	(gdk_event_translate): Set send_event to the value of
	InSendMessage (). This doesn't really mean the same as X11's
	send_event flag, but is close enough, says jpe@archaeopteryx.com

2001-01-15  Alexander Larsson  <alexl@redhat.com>

	* gdk/linux-fb/gdkdnd-fb.c:
	Implemented drag and drop.
	Seems to be mostly working. I sometimes get an assert from gtkdnd.c:2664
	when it tries to free and then copy the same event (info->last_event).
	I am not sure about why	this happens, but will continue looking.

2001-01-15  Alexander Larsson  <alexl@redhat.com>

	* gdk/linux-fb/gdkwindow-fb.c:
	Use gdk_window_invalidate_rect instead of
	gdk_window_invalidate_rect_clear to minimise flashing.
	When hiding windows you need to clear the root window though.

2001-01-15  Alexander Larsson  <alexl@redhat.com>

	* gdk/linux-fb/gdkdrawable-fb2.c:
	For optization, add an full_shapes argument to gdk_fb_clip_region.
	If this is false, only the cliprects of the shapes are used.

	* gdk/linux-fb/gdkprivate-fb.h:
	Export gdk_fb_window_peek_shape.
	Add full_shapes to gdk_fb_clip_region.

	* gdk/linux-fb/gdkwindow-fb.c (gdk_fb_window_move_resize):
	When moving a window, don't clear everything under the it, just the
	root window. Makes stuff faster and flash less.
	(gdk_window_get_pointer): Correctly handle offseted shapes, due to
	USE_CHILD_SHAPE. (gdk_fb_window_peek_shape): Return the correct
	offset of the shape.
	

2001-01-12  Havoc Pennington  <hp@redhat.com>

	* gdk/x11/gdkgeometry-x11.c (gdk_window_scroll): offset the 
	current invalid region, fixes redraw bug while scrolling the 
	text widget

	* gtk/gtktextview.c, gtk/gtktextview.h:
	Rearrange the scrolling/validation/etc. code in a major way, 
	so it seems to make sense to me. Probably isn't genuinely that
	much better, but...

	* gtk/gtktexttag.c (set_fg_color): fix name of property used for
	notifies

	* gtk/gtktextmark.c (gtk_text_mark_get_left_gravity): new function

2001-01-12  Alexander Larsson  <alla@lysator.liu.se>

	* gdk/linux-fb/gdkmain-fb.c (gdk_fb_set_rotation):
	Hide mouse pointer while rotation. Show it afterwards.

2001-01-12  Alexander Larsson  <alexl@redhat.com>

	* gdk/linux-fb/gdkdrawable-fb2.c (gdk_fb_clip_region): Take shaped
	windows in consideration when generating clip region.

	* gdk/linux-fb/gdkfb.h:
	Huge HACK. Added GDK_FB_USE_CHILD_SHAPE.

	* gdk/linux-fb/gdkprivate-fb.h:
	Add shape to GdkWindowFBDatat.
	exported gdk_fb_window_get_abs_shape().
	removed gdk_fb_draw_lines declaration.

	* gdk/linux-fb/gdkwindow-fb.c (gdk_window_impl_fb_init):
	Init shape to NULL. (gdk_fb_window_send_crossing_events): Don't
	send focus changes when there is a grabbed window.
	(gdk_window_get_pointer): Handle shaped windows.
	(gdk_fb_region_create_from_bitmap): Convert bitmap to region.
	(gdk_fb_window_peek_shape): Returns the shape for a window,
	handles GDK_FB_USE_CHILD_SHAPE.
	(gdk_fb_window_get_abs_shape): Returns the shape of the window,
	offseted to absolute positions. Handles GDK_FB_USE_CHILD_SHAPE.
	(gdk_window_shape_combine_mask): Implement.

	* gtk/gtkwindow-decorate.c:
	HACK! Set GDK_FB_USE_CHILD_SHAPE on window->frame to make sure
	setting the shape of a window makes the window transparent.

2001-01-11  Havoc Pennington  <hp@redhat.com>

	* gtk/gtktreemodelsimple.h: Oops, broke some macros

2001-01-10  Havoc Pennington  <hp@redhat.com>

	* gtk/gtktreeviewcolumn.c (gtk_tree_view_column_clear_attributes):
	add this function, bug 40251

	* gtk/gtktreemodelsimple.h (GTK_TYPE_TREE_MODEL_SIMPLE): fix name
	of type macro	

2001-01-11  Alexander Larsson  <alexl@redhat.com>

	* acconfig.h:
	Added ENABLE_SHADOW_FB

	* configure.in:
	Added --disable-shadowfb

	* gdk/linux-fb/gdkcursor-fb.c:
	Update shadowfb when updating cursor

	* gdk/linux-fb/gdkdrawable-fb2.c:
	Added wrappers for shadowfb that calls 	the normal drawable
	methods, but calls gdk_shadow_fb_update(bounding box) when
	GdkWindows are drawed to.
	Moved gdk_draw_glyphs implementation to _gdk_draw_glyphs
	which also returns the bounding box.

	* gdk/linux-fb/gdkfb.h:
	Added GdkFBAngle type and gdk_fb_set_rotation declaration.

	* gdk/linux-fb/gdkgeometry-fb.c:
	Update shadowfb when scrolling window.

	* gdk/linux-fb/gdkglobals-fb.c:
	Add _gdk_fb_screen_angle.
	
	* gdk/linux-fb/gdkkeyboard-fb.c:
	Test code for screen rotation. Shift-F2 in the xlate driver
	rotates the screen.

	* gdk/linux-fb/gdkmain-fb.c:
	Handle shadowfb. Add gdk_fb_set_rotation(). Remove CM and RP.

	* gdk/linux-fb/gdkmouse-fb.c:
	Use fb_width/height instead of modeinfo.xres/yres.

	* gdk/linux-fb/gdkprivate-fb.h:
	Added fb_men, fb_width, fb_height & fb_stride. When using
	shadow fb these can differ from the framebuffer stuff.
	Declarations for gdk_shadow_fb_update, gdk_shadow_fb_init,
	gdk_shadow_fb_stop_updates, gdk_fb_recompute_all,
	_gdk_fb_screen_angle. Removed CM, RP.

	* gdk/linux-fb/gdkrender-fb.c:
	Added code for shadowfb handling and screen rotation using
	shadowfb.

	* gdk/linux-fb/gdkwindow-fb.c:
	Use fb_mem, fb_stride, fb_width, fb_height.
	Added recompute_rowstride to reset the rowstride of all windows.
	Added gdk_fb_recompute_all() which recomputes rootwindow size,
	window abs positions and window rowstrides. Usefull when the
	rotation has changed.

Thu Jan 11 13:16:50 GMT 2001  Tony Gale <gale@gtk.org>

	* docs/faq/gtk-faq.sgml: update to make web site updating easier

2001-01-10  Havoc Pennington  <hp@redhat.com>

	* gtk/gtktreestore.c (gtk_tree_store_insert_before): handle case
	where sibling == iter
	(gtk_tree_store_insert_after): handle sibling == iter
	(gtk_tree_store_prepend): remove stamp checks
	(gtk_tree_store_insert_before): ditto
	(gtk_tree_store_append): ditto
	(gtk_tree_store_get_path): ditto
	(gtk_tree_store_get_value): ditto
	(gtk_tree_store_iter_has_child): ditto
	(gtk_tree_store_iter_n_children): ditto
	(gtk_tree_store_iter_nth_child): ditto
	(gtk_tree_store_insert_after): ditto
	(gtk_tree_store_is_ancestor): ditto
	(gtk_tree_store_iter_depth): ditto
	(gtk_tree_store_insert_before): assert that sibling's parent is
	the same as the passed-in parent
	(gtk_tree_store_insert_after): assert that sibling's parent is
	the same as the passed-in parent

	
	* gtk/gtktreemodel.c (gtk_tree_model_get_first): new convenience 
	function to get the first iterator in a model
	
	* gtk/gtktreestore.c (gtk_tree_store_get_root_iter): remove,
	conventionally the "root" in this sense is just NULL afaict.

	* gtk/gtkliststore.c (gtk_list_store_insert_before): handle case
	where sibling == iter
	(gtk_list_store_insert_after): handle case where sibling == iter

	* tests/testtreeview.c (run_automated_tests): fairly lame basic
	automated tests for ListStore, TreeStore

        * gtk/gtkliststore.c (gtk_list_store_remove): update tail pointer
	(gtk_list_store_insert): update tail pointer, and fix it to work
	(gtk_list_store_insert_before): update tail pointer, and fix it to work
	(gtk_list_store_append): use tail to be faster
	(gtk_list_store_prepend): fix it, update tail pointer
	(gtk_list_store_insert_after): fix it, update tail pointer

	* gtk/gtkliststore.h (struct _GtkListStore): add tail pointer for 
	the list

2001-01-09  Havoc Pennington  <hp@redhat.com>

	* gtk/gtklabel.c (gtk_label_expose): don't draw if label->layout
	is NULL due to a pending resize

	* gtk/gtktreeview.c (gtk_tree_view_check_dirty): don't set the
	column width to values less than 1

	* gtk/gtktreeviewcolumn.c (gtk_tree_view_column_set_width): clamp
	width to be between min/max width, and still set the width 
	even if autosize is turned on, so the tree view can use this 
	function in order to autosize.
	(gtk_tree_view_column_init): set initial width to 1 not 0

	* gtk/gtktreeview.c (gtk_tree_view_size_request_buttons): use
	setter function to modify column width, so we get notification
	(gtk_tree_view_insert_iter_height): ditto
	(gtk_tree_view_calc_size): ditto
	(gtk_tree_view_check_dirty): ditto

	* gtk/gtktreeviewcolumn.c (gtk_tree_view_column_class_init): Add
	properties to change all the interesting attributes of the tree
	view column.
	(gtk_tree_view_column_set_header_clickable): rename set_clickable
	(gtk_tree_view_column_get_clickable): add
	(gtk_tree_view_column_set_cell_renderer): don't unset the current
	attributes; assume a cell renderer with equivalent object
	properties has been swapped in. Do g_object_notify().
	(gtk_tree_view_column_set_visible): g_object_notify
	(gtk_tree_view_column_get_sizing): rename from get_col_type
	(gtk_tree_view_column_set_sizing): g_object_notify
	(gtk_tree_view_column_set_width): add g_object_notify
	(gtk_tree_view_column_set_min_width): ditto
	(gtk_tree_view_column_set_max_width): ditto
	(gtk_tree_view_column_set_title): ditto
	(gtk_tree_view_column_set_clickable): ditto
	(gtk_tree_view_column_set_widget): ditto
	(gtk_tree_view_column_set_justification): ditto

2001-01-09  Havoc Pennington  <hp@redhat.com>

	* gtk/gtktreeview.c (gtk_tree_view_check_dirty): handle case where
	there are no rows in the model

	* gtk/gtkliststore.c (gtk_list_store_iter_children): if parent is
	NULL, then return the start of the list

	* gtk/gtktreeview.c (gtk_tree_view_setup_model): don't build tree
	if we can't get any rows from an empty model 

	* gtk/gtktreeviewcolumn.h (struct _GtkTreeViewColumn): remove
	extraneous * after function pointer typedef usage

	* Makefile.am: don't specify full path to cp and rm

	* gtk/gtkcellrenderertextpixbuf.c
	(gtk_cell_renderer_text_pixbuf_get_size): check width/height !=
	NULL before dereferencing, fixes a segfault that happened from
	time to time

	* gtk/gtkcellrendererpixbuf.c (gtk_cell_renderer_pixbuf_render):
	use gdk_pixbuf_render_to_drawable_alpha() to get alpha channel,
	and reindent the function
	(gtk_cell_renderer_pixbuf_get_size): indentation

	* gtk/gtkdialog.c (gtk_dialog_run): destroy main loop only after
	we quit it
	(gtk_dialog_add_buttons_valist): add g_return_if_fail
	(gtk_dialog_set_default_response): New function, to set default
	button
	(gtk_dialog_set_response_sensitive): New function, to set 
	sensitivity of buttons

	* gtk/gtkcellrendererpixbuf.c
	(gtk_cell_renderer_pixbuf_get_property): allow getting a NULL pixbuf
	(gtk_cell_renderer_pixbuf_set_property): allow setting a NULL pixbuf

	* gtk/gtktreedatalist.c (_gtk_tree_data_list_node_to_value):
	handle any G_TYPE_OBJECT subclass, not just the base class, and 
	also boxed types.
	(_gtk_tree_data_list_value_to_node): ditto

	* gtk/gtkrbtree.c: Run _gtk_rbtree_test at strategic points if 
	--gtk-debug=tree

	* gtk/gtkmain.c: add GTK_DEBUG_TREE

	* gtk/gtkdebug.h: add GTK_DEBUG_TREE

2001-01-09  Tor Lillqvist  <tml@iki.fi>

	* gdk/win32/gdkevents-win32.c: Implement better mouse
	capturing. Do use SetCapture(). Thanks to jpe@archaeopteryx.com.
	(find_window_for_pointer_event): New function.
	(gdk_event_translate): Use it when handling mouse events.

2001-01-09  Alexander Larsson  <alla@lysator.liu.se>

	* configure.in:
	Added --with-included-loaders option

	* gdk-pixbuf/Makefile.am:
	* gdk-pixbuf/gdk-pixbuf-io.c:
	Add support for including selected gdk-pixbuf loaders only.

	* gtk/gtkwindow.c (gtk_window_set_frame_dimensions,
	gtk_window_set_has_frame):
	Added inline documentation.

	* gdk/x11/gdkwindow-x11.c (gdk_window_get_decorations):
	* docs/reference/gdk/tmpl/windows.sgml:
	Added inline documentation.

Mon Jan  8 14:42:06 2001  Jonathan Blandford  <jrb@redhat.com>

	* gtk/gtktreeview.c (gtk_tree_view_realize_buttons): Skip
	realizing buttons that have already been realized.

Mon Jan  8 14:06:29 2001  Jonathan Blandford  <jrb@redhat.com>

	* tests/testtreeview.c (main): Show menu items before adding to
	option menu.

	* gtk/gtktreeview.c (gtk_tree_view_set_model): Keep the columns
	around if we kill them.

	* gtk/gtktreeviewcolumn.c (gtk_tree_view_column_set_cell_data):
	Return if we pass in a NULL model.

2001-01-08  Havoc Pennington  <hp@redhat.com>

	* tests/testtreeview.c: hack on this some

	* gtk/gtktreestore.c (gtk_tree_store_setv): rename
	gtk_tree_store_set_valist, v is for arrays, valist for varargs
	list
	(gtk_tree_store_getv): rename gtk_tree_store_get_valist

	* gtk/gtkliststore.h: Add varargs set() and get() convenience
	functions

2001-01-08  Alexander Larsson  <alexl@redhat.com>

	* gtk/gtkwindow-decorate.[hc]:
	* gtk/Makefile.am:
	New files. Contains an implementation of a minimal WM for
	linux-fb.

	* gtk/gtkwindow.h:
	Add the possibility for GtkWindows to specify a frame. This
	is used for the window decoration code, but could concievably
	be used for X programs too (xmms style windows).
	GtkWindow->frame is the toplevel window if the window is framed.
	The signal frame_event gets all events that are targeted to
	GtkWindow->frame.
	(_gtk_window_constrain_size): Exported for usage by gtkwindow-decorate.c.
	
	* gtk/gtkwindow.c:
	Implement gtk_window_set_has_frame and gtk_window_set_frame_dimensions.
	Call out to gtkwindow-decorate.c for WM support in linx-fb.

2001-01-08  Alexander Larsson  <alexl@redhat.com>

	* docs/README.linux-fb:
	Correct filename ~/.pangoft2_aliases

	* gdk/gdkwindow.h:
	Added new function gdk_window_get_decorations.

	* gdk/linux-fb/gdkfb.h:
	Removed _gdk_window_get_decorations declaration.
	Renamed _gdk_window_set_child_handler to
	gdk_fb_window_set_child_handler.

	* gdk/linux-fb/gdkwindow-fb.c:
	Renamed _gdk_window_set_child_handler to
	gdk_fb_window_set_child_handler.

	* gdk/x11/gdkwindow-x11.c:
	New function gdk_window_get_mwm_hints().
	Implemented gdk_window_get_decorations.

	* docs/reference/gdk/tmpl/windows.sgml:
	* docs/reference/gdk/gdk-sections.txt:
	Added gdk_window_get_decorations docs.
	
2001-01-08  Alexander Larsson  <alla@lysator.liu.se>

	* gdk/linux-fb/gdkwindow-fb.c (_gdk_fb_window_find_focus,
	gdk_fb_window_find_focus, gdk_fb_send_focus_change,
	gdk_fb_window_send_crossing_events):
	Possibly send focus events when the mouse moves from one
	window to another.

2001-01-07  Tor Lillqvist  <tml@iki.fi>

	* gdk/win32/gdkwindow-win32.c (gdk_window_set_title,
	gdk_window_new): Adapt calls to g_{locale,filename}_{to,from}_utf8
	to match current API.

	* gdk/win32/gdkvisual-win32.c (gdk_visual_init): If a secret
	environment variable is set, don't call g_error when on a
	palettized (PseudoColor) display. Some people want to use GTK+ 
	in 256-colour mode even though works only partially.

	* gdk/gdk.def
	* gtk/gtk.def
	* gtk/makefile.mingw.in: Update.

2001-01-05  Havoc Pennington  <hp@redhat.com>

	* tests/testtreeview.c: hack on this a bit

	* gtk/gtktextlayout.c (gtk_text_layout_class_init):
	s/GTK_RUN_LAST/G_SIGNAL_RUN_LAST

	* gtk/gtktreemodelsimple.h (GTK_IS_TREE_MODEL_SIMPLE_CLASS): 
	was spelled incorrectly
	(GTK_IS_TREE_MODEL_SIMPLE): ditto

	* gtk/gtktreeview.c (gtk_tree_view_set_headers_clickable): rename
	from gtk_tree_view_set_headers_active	

	* gtk/gtktexttag.c:
	(gtk_text_tag_get_property): handle PROP_DIRECTION
	(gtk_text_tag_set_property): g_object_notify when we toggle the _set
	properties, bug 40235

	* gtk/gtktextiter.c (gtk_text_iter_forward_to_delimiters): rename
	forward_to_line_end

Fri Jan  5 16:16:29 2001  Owen Taylor  <otaylor@redhat.com>

	* gtk/{gtkcalender.c,gtkfilesel.c,gtkimcontext.c},
	modules/input/gtkimcontextxim.c: Adapt to new prototypes
	for unicode,locale,filename conversion functions.

2001-01-05  Havoc Pennington  <hp@redhat.com>

	* gtk/gtktextiter.c (gtk_text_iter_ends_line): this function was
	broken if called on the first position in the buffer.

	* gtk/gtktextlayout.c (line_display_index_to_iter): fix
	forward_to_delimiters to be called only if we aren't already at
	the delimiters.

2001-01-05  Havoc Pennington  <hp@redhat.com>

	* demos/gtk-demo/main.c (create_tree): Oops, that didn't link. Fix.

2001-01-05  Alexander Larsson  <alexl@redhat.com>

	* gdk/linux-fb/gdkdrawable-fb2.c (gdk_fb_drawable_finalize): free
	colormap in here. Sync from X port.
	(gdk_fb_set_colormap): allow the colormap to be NULL if you like.
	Sync from X port.
	(gdk_fb_clip_region): Comment out g_warning about empty clip region.
	This happens now and then, and i don't think it is a bug.
	(gdk_fb_draw_polygon): Correctly add extra point if startpoint
	!= endpoint.
	(gdk_fb_draw_lines): Don't draw dashed lines if line_style is
	GDK_LINE_SOLID.

	* gdk/linux-fb/gdkfont-fb.c: Return bogus GdkFont that has
	some of the fields filled in at least.

	* gdk/linux-fb/miwideline.c: The widths argument to miLineArcI, and
	miLineArcD is no more, remove it from the function definition.

2001-01-04  Havoc Pennington  <hp@redhat.com>

	* gtk/gtktreeselection.c (gtk_tree_selection_get_tree_view): add
	this

	* gtk/gtktreemodel.h (struct _GtkTreeIter): rename fields to
	user_data instead of tree_node

	* gtk/gtktreeprivate.h (TREE_VIEW_COLUMN_WIDTH): rename from
	TREE_VIEW_COLUMN_SIZE

	* gtk/gtktreeviewcolumn.h (struct _GtkTreeViewColumn): rename
	"size" field to "width" finishes bug 40061

	* gtk/gtkcellrenderer.h: Use GtkCellRendererState instead of guint
	for bitfields, bug 40268

2001-01-04  Havoc Pennington  <hp@redhat.com>

        Rename some stuff:
	
	s/gtk_tree_view_column_set_size/gtk_tree_view_column_set_width/g;

	s/GtkModelSimple/GtkTreeModelSimple/g;
	s/GTK_MODEL_SIMPLE/GTK_TREE_MODEL_SIMPLE/g;
	s/gtk_model_simple/gtk_tree_model_simple/g;
	s/gtkmodelsimple/gtktreemodelsimple/g;

	s/gtk_tree_view_column_set_header_active/gtk_tree_view_column_set_header_clickable/g;

	s/GtkTreeViewColumnType/GtkTreeViewColumnSizing/g;
	s/column_set_col_type/column_set_sizing/g;

	s/GtkTreeSelectionType/GtkTreeSelectionMode/g;
	s/gtk_tree_selection_set_type/gtk_tree_selection_set_mode/g;

	s/GtkCellRendererType/GtkCellRendererState/g;
	
	* gtk/gtkcellrenderertoggle.c: remove _ macro, include gtkintl.h
	(gtk_cell_renderer_toggle_class_init): change "state" property to
	"active", to match GtkToggleButton
	(gtk_cell_renderer_toggle_get_active): new function, bug
	40269
	(gtk_cell_renderer_toggle_set_active): new function
	(gtk_cell_renderer_toggle_set_property): route changes to toggle
	state through gtk_cell_renderer_set_active

Thu Jan  4 15:46:18 2001  Jonathan Blandford  <jrb@redhat.com>

	* gtk/gtkmodelsimple.c: Changed a bunch of boxed types to pointers
	temporarily until they work again.  Brought up to date with
	changes in the model.
	* gtk/gtkmodelsimple.h: Brought up to date with changes in the
	model.

2001-01-04  Havoc Pennington  <hp@redhat.com>

	* gtk/gtktextlayout.c (line_display_index_to_iter): if index is
	equal to the line length, then position iterator before paragraph 
	separators. Fixes crash reported by Mikael Hermansson when
	pressing left arrow from the start of a line.	

	* gtk/gtktextiter.c (iter_set_from_byte_offset): Add g_error
	about byte indexes off the end
	(iter_set_from_char_offset): add g_error about char offsets
	off the end

2001-01-03  Havoc Pennington  <hp@redhat.com>

	* gtk/gtktextbtree.c: Adapt to uscore-ification of gtktextiterprivate

	* gtk/gtktextdisplay.c (gtk_text_layout_draw): remove use 
	of private functions; remove inclusion of private headers.

	* gtk/gtktextlayout.c (gtk_text_layout_get_iter_at_line): Add this 
	function, so we don't need private functions in gtktextdisplay.c

	* gtk/gtktextiterprivate.h: underscore-ification

	* gtk/gtkwidget.c: Clean up a bunch of docs that said "INTERNAL"
	to instead say "only useful to implement widgets"

	* gtk/gtkenums.h (GtkMovementStep): Rename GTK_MOVEMENT_CHARS,
	GTK_MOVEMENT_POSITIONS to GTK_MOVEMENT_LOGICAL_POSITIONS,
	GTK_MOVEMENT_VISUAL_POSITIONS. Resolves bug 40249.

	* gdk/x11/gdkwindow-x11.c (gdk_window_impl_x11_set_colormap):
	This function was completely broken

	* gtk/testtext.c (line_numbers_expose): use gtk_paint_layout

	* gtk/gtkvscale.c (gtk_vscale_draw_value): use gtk_paint_layout

	* gtk/gtkvruler.c (gtk_vruler_draw_ticks): use gtk_paint_layout

	* gtk/gtklabel.c (gtk_label_expose): use gtk_paint_layout

	* gtk/gtkhscale.c (gtk_hscale_draw_value): use gtk_paint_layout

	* gtk/gtkhruler.c (gtk_hruler_draw_ticks): use gtk_paint_layout

	* gtk/gtkcellrenderertext.c (gtk_cell_renderer_text_render): use
	gtk_paint_layout

	* gtk/gtkaccellabel.c (gtk_accel_label_expose_event): use
	gtk_paint_layout

	* gtk/gtkstyle.h: Add draw/paint expander to draw tree expanders.
	Progress on bug 40103. Add draw_layout to draw a PangoLayout.
	(struct _GtkStyleClass): Remove draw_cross, draw_oval, draw_ramp,
	which were not implemented.	

	* gtk/gtktextbuffer.h (struct _GtkTextBufferClass): Add
	insert_pixbuf signal. Rename delete_text to delete_range since it
	also deletes pixbufs and child anchors. This almost closes bug
	40245 (still need to deal with child anchors)

	* gtk/gtktextbuffer.c (gtk_text_buffer_class_init): Add
	insert_pixbuf, change signal names as appropriate, change types of
	signals taking marks/tags to have the specific type, not just
	G_TYPE_OBJECT
	
	* gtk/gtkmain.c (gtk_get_current_event_state): Add this function; 
	closes bug 40051

	* gtk/gtkoptionmenu.c (gtk_option_menu_set_history): clean up
	unnecessary remove_contents() call
	(gtk_option_menu_class_init): add a "changed" signal, closes
	bug 40039
	(gtk_option_menu_update_contents): emit "changed" if the 
	active menu item changes

	* gtk/gdk-pixbuf-loader.c (gdk_pixbuf_loader_frame_done): fix bad
	cast to GtkObject, reported by Jonas Borgstrom
	(gdk_pixbuf_loader_finalize): don't close the loader on finalize;
	we can't do stuff with side effects in finalize. Instead, spew a
	warning if the loader isn't closed.

	* gdk/x11/gdkdrawable-x11.c (gdk_drawable_impl_x11_finalize): free
	colormap in here, non-X ports probably need to sync to this change

	* gdk/x11/gdkdrawable-x11.c (gdk_x11_set_colormap): remove 
	assertion that colormap != NULL, you can set the colormap to NULL
	if you like.
	
	* Makefile.am: remove gtk-config-2.0

	* configure.in: Use pkg-config to locate GLib. Remove
	separated-out GMODULE_LIBS, GMODULE_CFLAGS; these were not used,
	and the gmodule libs/cflags were in GLIB_LIBS GLIB_CFLAGS anyhow.
	Use pkg-config to locate Pango. Output correct Pango libs to
	gdk-2.0.pc.in. Fix test for FREETYPE_CONFIG (typo fix).

	* Makefile.am (pkgconfig_DATA): install only target-specific pc
	files
	(install-data-local): symlink gtk+-2.0.pc and gdk-2.0.pc to the
	X11 pc files

	* gtk+-2.0.pc.in (Requires): require the GDK for the current target
	unref from here

2001-01-03  Alexander Larsson  <alla@lysator.liu.se>

	* configure.in:
	Change GTK_NO_CHECK_CASTS to G_DISABLE_CAST_CHECKS.

Tue Jan  2 16:23:05 2001  Owen Taylor  <otaylor@redhat.com>

	* gtk/gtktextlayout.c
	(gtk_text_layout_move_iter_to_previous_line): Fix unitialized
	variable when moving back onto a single line.

2001-01-01  Havoc Pennington  <hp@redhat.com>

	* gtk/Makefile.am (LDFLAGS): add @LIBTOOL_EXPORT_OPTIONS@

	* gdk/Makefile.am (LDFLAGS): add @LIBTOOL_EXPORT_OPTIONS@

	* configure.in (LIBTOOL_EXPORT_OPTIONS): define
	LIBTOOL_EXPORT_OPTIONS with options to control symbol export

2001-01-01  Havoc Pennington  <hp@redhat.com>

	* gtk/gtktexttagprivate.h: uscore-prepend all the stuff in here.

	* gtk/gtk-boxed.defs (GtkTextAttributes): Add boxed type for 
	GtkTextAttributes

	* gtk/gtktexttag.c: Fix up GtkTextAttributes copying to close bug 
	#40246
	(gtk_text_attributes_copy_values): rename from 
	gtk_text_attributes_copy
	(gtk_text_attributes_copy): a more standard GTK copy function, 
	which returns a new object

2001-01-01  Havoc Pennington  <hp@redhat.com>

	* gtk/gtktreeview.c: Adapt to GtkTreeSelection changes
	
	* gtk/gtktreeselection.c (_gtk_tree_selection_set_tree_view):
	don't fill in tree_view->priv->selection, kind of an unexpected
	side effect

	* gtk/gtkcellrenderertext.c: Remove definition of _ and include
	gtkintl.h
	
	* gtk/gtkcellrenderer.c: Remove definition of _ and include
	gtkintl.h
	(gtk_cell_renderer_get_property): remove calls to g_value_init

	* gtk/gtkcellrendererpixbuf.c: Remove definition of _ and include
	gtkintl.h

	* gtk/gtkcellrenderertextpixbuf.c: Remove definition of _ macro
	and include gtkintl.h
	(gtk_cell_renderer_text_pixbuf_class_init): remove spaces from
	property names

	* gtk/gtktreeselection.c (_gtk_tree_selection_new): rename, return
	GtkTreeSelection
	(_gtk_tree_selection_new_from_with_view): rename, return
	GtkTreeSelection
	(_gtk_tree_selection_set_tree_view): rename with uscore
	(gtk_tree_selection_get_selected): fill in the "model" out param
	first, so it gets filled in even if we return at the top of the 
	function
	(gtk_tree_selection_real_select_all): add a comment and an else{}
	to clarify this a bit
	(gtk_tree_selection_real_unselect_all): add the same else{}

	* gtk/gtktreeselection.h: Rename new, new_with_tree_view, and
	set_tree_view to have underscore prefixes, move them to the
	private header, fix return type of new_with_tree_view
	(struct _GtkTreeSelection): mark struct
	fields private	

	* gtk/gtktreemodel.c (gtk_tree_model_get_flags): return
	GtkTreeModelFlags, not a guint
	(gtk_tree_path_prev): return gboolean not gint
	(gtk_tree_path_up): return gboolean not gint

	* gtk/gtktreemodel.h (struct _GtkTreeModelIface): make get_flags
	return GtkTreeModelFlags, not a guint

	* gtk/gtktreemodelsort.c (gtk_tree_model_sort_finalize): check
	that child model is non-null before unrefing it
	(g_value_int_compare_func): make this a qsort compare func, not 
	a boolean predicate

	* gtk/gtktreemodelsort.h: rename gtk_tree_model_set_sort_column,
	(add -umn to the end), and mark it unimplemented
	(gtk_tree_model_sort_resort): remove, this wasn't implemented, and 
	I don't see what it's for - doesn't the model always sort itself?
	(gtk_tree_model_sort_set_compare): this had the wrong signature

	* gtk/gtktreeviewcolumn.c (gtk_tree_view_column_set_attributes):
	Fix the docs to say that it destructively replaces existing
	attributes (previously said that it added attributes).
	(gtk_tree_view_column_set_visible): canonicalize bool before
	equality testing. Also, check for realization before
	hiding/showing the tree_column->window; if this window could exist
	before realization, then it's busted and needs fixing, we can't 
	create GDK resources pre-realization. Also, remove
	superfluous queue_resize(), since set_size() does that for us.
	(gtk_tree_view_column_set_col_type): check realization before 
	using tree_column->window

	* gtk/gtktreedatalist.c: fix filename in copyright notice

2000-12-31  Havoc Pennington  <hp@pobox.com>

	* gtk/gtktextview.c: Rearrange all the
	scroll-while-dragging-or-selecting code to be different, not
	necessarily better. ;-)
	(gtk_text_view_scroll_to_mark): Change this
	function to take within_margin as a fraction instead of a pixel
	value, and to take alignment arguments (indicating where to align 
	the mark inside the visible area)
	
	* gtk/testtextbuffer.c (fill_buffer): fix bad cast of GtkTextTag
	to GtkObject

	* gtk/gtktextiter.c (gtk_text_iter_set_line_offset): change
	behavior so that offsets past the end of the line are not 
	allowed, and an offset equal to the line length moves the iterator
	to the next line
	(gtk_text_iter_set_line_index): make parallel change
	(gtk_text_iter_get_bytes_in_line): add this function
	
	* gtk/gtktextbtree.c (_gtk_text_line_byte_locate): change handling
	of byte indexes off the end of the line; byte index at the end of
	the line now returns FALSE and doesn't fill in the requested
	values, byte index past the end of the line is an error.  Also,
	don't allow -1 offset anymore, since its meaning is unclear.

	This change exposes some bug in visual cursor motion, where we
	end up with a huge invalid byte index; needs fixing. Symptom of 
	bug is a crash when you hit up arrow.
	
	(_gtk_text_line_char_locate): match the change to byte_locate

	* gtk/gtktextiter.c (find_by_log_attrs): Handle iteration backward
	from start of line properly. fixes bug reported by Mikael
	Hermansson where backspace would delete all text before the
	cursor.

2000-12-30  Tor Lillqvist  <tml@iki.fi>

	* gdk/win32/gdkwindow-win32.c
	(gdk_window_impl_win32_get_visible_region): New function, as in
	the X11 backend.
	(gdk_window_new, gdk_window_set_title): Use g_locale_from_utf8()
	instead of duplicating the same code here.

	* gdk/win32/gdkwin32.h (GDK_COLORMAP_PRIVATE_DATA): Use
	GDK_COLORMAP macro.

	* gdk/win32/gdkevents-win32.c (gdk_event_funcs): Use NULL as
	destroy function.
	(gdk_event_translate): Use GDK_COLORMAP_PRIVATE_DATA to correctly
	access that.

	* gtk/gtk.def: Update.

	* gtk/makefile.mingw.in: Use glib-genmarshal from $(GLIB)/gobject.

2000-12-30  Havoc Pennington  <hp@pobox.com>

	* gdk/x11/gdkwindow-x11.c (gdk_window_new): Set the system
	colormap on input only windows, to avoid special cases all over
	the code for these windows.

2000-12-26  Tor Lillqvist  <tml@iki.fi>

	* gdk/win32/gdkvisual-win32.c (gdk_visual_init): Call g_error if
	we are on a palettized display ("PseudoColor" in X11), as the code
	for that doesn't work anyway, and never has.

2000-12-22  Alexander Larsson  <alexl@redhat.com>

	* gdk/linux-fb/gdkkeyboard-fb.c (xlate_io):
	Don't use isprint() for chars > 255.

2000-12-21  Havoc Pennington  <hp@redhat.com>

	* tests/testtreeview.c: more work

2000-12-21  Alexander Larsson  <alexl@redhat.com>

	* docs/README.linux-fb:
	Update the docs to the new pangoft2 way.

2000-12-21  Alexander Larsson  <alexl@redhat.com>

	* configure.in:
	For linux-fb get the pangoft2 cflags and libs. This needs a recent
	pango version.
	Remove modules/linux-fb/Makefile.

	* gdk/linux-fb/gdkdrawable-fb2.c:
	Render glyphs using freetype.

	* gdk/linux-fb/gdkfb.h:
	Add new fb-specific functions needed for managing windows.

	* gdk/linux-fb/gdkmain-fb.c:
	Remove gdk_font_init/fini() calls.

	* gdk/linux-fb/gdkpango-fb.c:
	Remove old implementation. Use pangoft2 instead.

	* gdk/linux-fb/gdkprivate-fb.h:
	Remove PangoFBFont and related stuff.

	* gdk/linux-fb/gdkwindow-fb.c:
	Implement drawable->get_visible_region.
	Implement support for _gdk_window_set_child_handler () and
	_gdk_window_get_decorations().

	* modules/Makefile.am:
	Remove linux-fb subdir.

	* modules/linux-fb/*:
	Removed all.
	
2000-12-20  Jonathan Blandford  <jrb@redhat.com>

	* gtk/gtkcellrenderer*.c (::get_property): remove g_value_init
	calls, as they are no longer needed.

	* gtk/gtktreemodelsort.c: Fix up the comparison code.
	
	* gtk/gtktreemodel.h: Start work on ::reordered signal.  Need to
	figure out how to emit a signal on an interface.

2000-12-20  Havoc Pennington  <hp@redhat.com>

	* tests: new directory to contain tests, gtk/test* should move
	here sometime (with appropriate on-cvs-server hackery)

	* tests/testtreeview.c, tests/Makefile.am: a test
	
	* configure.in (AC_OUTPUT): add tests/Makefile

	* gtk/gtktexttag.c (gtk_text_tag_get_property): Add "invisible"
	and "invisible_set" which were missing

	* gtk/gtkrbtree.h: some cheesy indentation fix
	
2000-12-20  Alexander Larsson  <alexl@redhat.com>

	* gtk/gtkinvisible.c (gtk_invisible_realize):
	Attach the style to the window so that the style it is not
	leaked when unrealizing the window.

2000-12-18  Havoc Pennington  <hp@redhat.com>

	* gtk/gtktextview.c (gtk_text_view_delete_from_cursor): do
	begin/end user action where appropriate
	(gtk_text_view_commit_handler): add begin/end user action

	* gtk/gtktextbuffer.c: add begin/end user action signals, and
	bracket interactive operations with begin/end user action pair.
	
	* gtk/gtktextbuffer.h (struct _GtkTextBufferClass): remove
	"interactive" arg from insert_text and delete_text signals.
	Add begin_user_action, end_user_action signals
	(gtk_text_buffer_begin_user_action): 
	(gtk_text_buffer_end_user_action): New functions to delimit 
	a user-visible action

	* gtk/gtkmarshal.list: update to reflect changes to gtktextbuffer
	signals.
	
2000-12-18  Havoc Pennington  <hp@redhat.com>

	* gdk/gdkevents.c (gdk_event_get_state): wow, that implementation
	was pretty non-working.

	* gtk/testtext.c (fill_file_buffer): make this a bit more robust
	by passing the length to g_utf8_validate().

2000-12-16  Havoc Pennington  <hp@pobox.com>

	* gtk/gdk-pixbuf-loader.h, gtk/gdk-pixbuf-loader.c: 
	Port to GObject, can go back in gdk-pixbuf after setting up 
	a gdk-pixbuf-marshal.h header over there.

	* gtk/gtktreeview.c: s/SEPERATOR/SEPARATOR/g;
	(gtk_tree_view_class_init): specify GTK_TYPE_ADJUSTMENT for signal
	args
	(gtk_tree_view_init): don't unset GTK_NO_WINDOW, it shouldn't be
	set
	(gtk_tree_view_realize_buttons): don't gtk_widget_show() buttons
	here, do it when we create the buttons later
	(gtk_tree_view_realize_buttons): add some g_return_if_fail 
	(gtk_tree_view_map): paranoia checks that column->button is shown 
	and unmapped
	(gtk_tree_view_size_request): only request visible children.
	Move header size calculation in here, for cleanliness, and 
	to maintain invariants for child widgets if we eventually 
	let users set different children inside the buttons
	(gtk_tree_view_map_buttons): factor out code to map buttons,
	since it was being called several times
	(gtk_tree_view_size_allocate_buttons): move_resize the drag
	windows instead of just moving them; their height may change 
	if we allow random widgets in there, or the theme changes.
	(gtk_tree_view_size_allocate): move button size allocation 
	above emitting the scroll signals, to ensure a sane state when we
	hit user code
	(gtk_tree_view_button_release): remove queue_resize after
	tree_view_set_size(), set_size() will handle any resize queuing
	that's needed
	(gtk_tree_view_focus_in): just queue a draw, don't fool with
	draw_focus goo
	(gtk_tree_view_focus): use gtk_get_current_event() and
	gdk_event_get_state()
	(gtk_tree_view_deleted): don't queue_resize() after calling set_size()
	(gtk_tree_view_build_tree): fix a "if (foo); {}" bug - i.e. remove
	semicolon
	(gtk_tree_view_create_button): show the button here
	(gtk_tree_view_button_clicked): actually emit the clicked signal
	on the column
	(_gtk_tree_view_set_size): return right away if the size is
	unchanged, as a cheesy optimization
	(gtk_tree_view_setup_model): rename set_model_realized to 
	setup_model to match the flag that indicates whether we've 
	called it
	(gtk_tree_view_get_hadjustment): create adjustment if it doesn't
	exist, because set_scroll_adjustment does that and it shouldn't
	matter what order you call these in
	(gtk_tree_view_get_vadjustment): ditto
	(gtk_tree_view_set_headers_visible): canonicalize the bool, 
	for paranoia
	(gtk_tree_view_set_headers_visible): call
	gtk_tree_view_map_buttons() instead of using cut-and-paste code
	(gtk_tree_view_append_column): clarify whether the return value
	is the count of columns before or after, and do the increment 
	separately from the return statement so you can tell from the code.
	(gtk_tree_view_remove_column): ditto
	(gtk_tree_view_insert_column): ditto
	(gtk_tree_view_get_column): remove g_return_if_fail for columns
	outside the existing range, the docs say that outside-range
	columns are allowed, so we handle them as documented. (Presumably
	this allows a nice loop with column != NULL as test.)
	(gtk_tree_view_move_to): document what 0.0, 0.5, 1.0 alignments 
	mean (left/right/center etc.).
	(gtk_tree_view_collapse_all): only queue a draw if we're mapped
	(gtk_tree_view_expand_row): add docs
	(gtk_tree_view_collapse_row): add docs

	* gtk/gtktreeviewcolumn.c (gtk_tree_view_column_clicked): new
	function to emit the clicked signal on a column
	
	* gdk/gdkevents.c (gdk_event_get_state): new function, to get the
	state of an event
	(gdk_event_get_time): don't treat GDK_SCROLL 
	as a button event, remove default case from switch so gcc 
	will whine if we don't explicitly handle all event types

	* gtk/gtktreeselection.h: added some FIXME 
	
	* gtk/gtktreeprivate.h (struct _GtkTreeViewPrivate): rename
	"columns" to "n_columns" and "column" to "columns" for clarity

2000-12-16  Havoc Pennington  <hp@pobox.com>
	
	* gtk/gtktextiter.c: General cleanup of the log attr iteration
	stuff. This should make e.g. the delete key work again in the
	text widget...
	(gtk_text_iter_forward_cursor_positions): handle negative count
	(gtk_text_iter_backward_cursor_positions): handle negative count
	(gtk_text_iter_forward_word_ends): handle negative count
	(gtk_text_iter_backward_word_starts): handle negative count

	* gtk/gtktextlayout.h, gtk/gtktextlayout.c, gtk/gtktexttag.h,
	gtk/gtktexttag.c, gtk/gtktexttagtable.h, gtk/gtktexttagtable.c, 
	gtk/gtktextbuffer.h, gtk/gtktextbuffer.c: Convert everything to 
	GObject. No doubt will cause breakage.

	* demos/gtk-demo/textview.c: remove hacks around
	non-GObject-ification of the text objects

	* demos/gtk-demo/main.c (main): use g_object_set() to manipulate 
	the text tag
	
2000-12-14  Havoc Pennington  <hp@pobox.com>

	* configure.in: only AC_DEFINE(HAVE_XFT) if we actually determined
	that we have Xrender

Thu Dec 14 20:22:31 2000  Owen Taylor  <otaylor@redhat.com>

        * gdk/{gdkdrawable.[ch],gdkpixmap.c,gdkwindow.c,x11/gdkwindow.c}:
	Add two virtualized functions gdk_drawable_get_clip_region - to
	get the clip region when drawing.
	
	* gdk/gdkwindow.c (gdk_window_invalidate_rect): Rewrite to simple
	use invalidate_region.

	* gdk/gdkwindow.c (gdk_window_invalidate_region): Clip to visible
	region.

	* acconfig.h configure.in: Check for Xft. For now, assume
	that if Xft is found, Pango was compiled with Xft support
	as well.

	* gdk/gdkcolor.h gdk/x11/gdkcolor-x11.c: Add 
	gdk_colormap_query_color().
	
	* gdk/x11/gdkdrawable-x11.c (gdk_x11_draw_glyphs): Draw
	with Xft if appropriate.

	* gdk/x11/gdkpango-x11.c (gdk_pango_context_get): Create
	a pangoxft context if we have XFT and the environment
	variable GD_USE_XFT is set.
	
	* gdk/x11/gdkx.h (struct _GdkGCX11): Cache the fg_pixel
	and also possibly an XftDraw structure.

        * gtk/gtkfontsel.c: Handle the case where the font from the
	style doesn't match any of the fonts a bit better.
	
	* gtk/testgtk.c: Add tabs between directional segments for
	hebrew/arabic test. (Not really necessary, just a little
	prettier.)

2000-12-14  Havoc Pennington  <hp@redhat.com>

	* gtk/testtext.c (fill_file_buffer): fix unicode validation when
	reading a file

2000-12-14  Havoc Pennington  <hp@redhat.com>

	* gtk/gtktextbtree.c (_gtk_text_btree_validate_line): remove
	unused call to get_last_line()

	* gtk/gtkobject.c (gtk_object_add_arg_type): add G_TYPE_POINTER
	here until boxed is working (and maybe after that - we should
	really not gratuitously break old code)

	* gtk/gtktexttag.c (gtk_text_tag_class_init): add commented-out
	specific types for font_desc and tabs args, move them to
	GTK_TYPE_POINTER for now, waiting on g_param_spec_boxed() to get 
	fixed. Move GdkColor args to GTK_TYPE_POINTER also.

	* gtk/gtktextbuffer.c (gtk_text_buffer_class_init): temporarily
	use GTK_TYPE_POINTER for signal signatures as a hack-around

	* gtk/gtk-boxed.defs: Add boxed types for PangoFontDescription and
	PangoTabArray

	* gtk/gtktextlayout.c (line_display_iter_to_index): 
	make static
	(line_display_index_to_iter): make static

	* gtk/gtktextbuffer.c (gtk_text_buffer_class_init): fix marshaller
	to marshal a string not a boxed

	* gtk/gtkmarshal.list: add marshaller for GtkTextBuffer:insert_text

	* gtk/testtext.c (fill_file_buffer): don't use g_utf8_next_char
	since the UTF-8 isn't validated yet

	* gtk/gtktextsegment.c (char_segment_check_func): don't require
	lines to end in '\n'
	
	* gtk/gtktextview.c (gtk_text_view_move_cursor): update to use
	forward_to_delimiters, and grapheme boundaries
	(gtk_text_view_delete_from_cursor): properly handle non-newline
	delimiters, and grapheme boundaries

	* gtk/gtktextiter.c (gtk_text_iter_forward_to_newline): rename
	to gtk_text_iter_forward_to_delimiters, and make it work properly
	if empty lines end with a character other than '\n'

	* gtk/gtktextiter.h, gtk/gtktextiter.c: Add movement by cursor
	position

2000-12-15  Tor Lillqvist  <tml@iki.fi>

	* gdk/makefile.{mingw.in,msc} (gdk_OBJECTS): Add gdkkeys.

	* gtk/gtk.def
	* gdk/gdk.def: Update.

	* gdk/win32/gdkmain-win32.c
	* gdk/win32/gdkkeys-win32.c: New file. Move some functions from
	gdkmain-win32.c here.

	* gdk/win32/makefile.mingw.in (all): No need to make
	gdk-win32res.o here, the makefile one step up will call us to make
	it.

	* gdk/win32/makefile.{mingw.in,msc} (gdk_win32_OBJECTS): Add
	gdkkeys-win32.

	* gdk/win32/gdkcolor-win32.c: Silence gcc -Wall.

	* gdk/win32/gdkevents-win32.c (gdk_events_init): Remove leftover
	call to g_source_add().

	* gdk/win32/gdkgc-win32.c (BitmapToRegion): Plug memory
	leak. Thanks to Andreas Kemnade.

2000-12-13  Havoc Pennington  <hp@pobox.com>

	* gtk/gtktextbtree.h: Remove double _ in front of some functions

	* gtk/gtktext*.[hc]: update accordingly
	
2000-12-13  Havoc Pennington  <hp@pobox.com>

	* gtk/gtktextbtree.h: Put _ in front of every function in this 
	header file

	* gtk/gtktext*.[hc]: update to reflect renamed btree functions

2000-12-13  Alex Larsson  <alexl@redhat.com>

	* gdk/linux-fb/gdkmouse-fb.c (mouse_devs):
	Add support for ps2 intellimouse.

	* gdkkeyboard-fb.c:
	Move shift-F1 repaint handling to xlate handler only.
	
	* docs/README.linux-fb:
	Add imps2 to docs.
	Document the new refresh keys.
	
Tue Dec 12 23:46:44 2000  Tim Janik  <timj@gtk.org>

	* gtk/stock-icons/Makefile.am: doh, this was broken beyond believe.

	* gtk/gtkbox.c: change property types from (u)long to (u)int for
	::position and ::padding.

	* gtk/gtkcontainer.c: make ::border_width an INT property.

	* gtk/gtkpacker.c: make ::position an INT property.

	* gtk/gtkscrolledwindow.c (gtk_scrolled_window_adjustment_changed):
	guard against NULL h/v scrollbars, since this is used at construction
	time.

	* gtk/gtkclist.[hc]: nuked gtk_clist_construct(), implemented
	internal gtk_clist_constructor().

	* gtk/gtkctree.[hc]: nuked gtk_ctree_construct(), implemented
	gtk_ctree_constructor().

	* gtk/gtkprogressbar.c (gtk_progress_bar_class_init): property
	::pulse_step should use ARG_PULSE_STEP, not ARG_FRACTION.

	* docs/reference/Makefile.am: fun stuff, disabled docs generation
	again, gtk-scan.c needs to introspec paramspecs, not GtkAgs.

	* gtk/gtkwidget.[hc]:
	removed gtk_widget_setv(), gtk_widget_getv(), gtk_widget_newv()
	and gtk_widget_get().
	(gtk_widget_new): use g_object_new_valist().
	(gtk_widget_set): use g_object_set_valist().

	* gtk/gtkobject.[hc]:
	removed gtk_object_arg_get_info(), gtk_object_getv(),
	gtk_object_query_args(), gtk_object_newv(),
	gtk_object_class_add_signals(),
	gtk_object_class_user_signal_new(),
	gtk_object_class_user_signal_newv(),
	gtk_object_arg_set(), gtk_object_arg_get(),
	gtk_object_args_collect(),
	gtk_object_default_construct(),
	gtk_object_constructed(),
	GTK_CONSTRUCTED and GTK_OBJECT_CONSTRUCTED().
	removed nsignals, signals and n_args members from GtkObjectClass.
	(gtk_object_new): use g_object_new_valist().
	(gtk_object_set): use g_object_set_valist().
	(gtk_object_get): use g_object_get_valist().
	
	* gtk/gtkcompat.h: define gtk_object_default_construct().
	
	* gtk/gtktypeutils.c (gtk_type_new): create constructed objects via
	g_object_new().

	* gtk/*.c: removed gtk_object_class_add_signals() from class_init()
	fucntions, cleaned up method assignments (make sure your structures
	are setup properly before calling out). removed all GTK_CONSTRUCTED
	hacks ;)

Tue Dec 12 11:52:16 2000  Owen Taylor  <otaylor@redhat.com>

	* gtk/gtkclist.c (gtk_clist_optimal_column_width): Fix 
	off-by-one error in checks. (Dave Lambert)

2000-12-12  Alexander Larsson  <alexl@redhat.com>

	* gdk/linux-fb/gdkkeyboard-fb.c (xlate_close, raw_close):
	Don't free gdk_fb_keyboard twice.

Tue Dec 12 08:24:42 2000  Tim Janik  <timj@gtk.org>

	* gtk/testgtk.c:
	(create_tooltips): 
	(create_statusbar): get rid of object_signal:: GtkObject argument uses,
	use GObject swapped_signal:: properties instead.

	* gtk/gtkcellrenderertoggle.c: 
	* gtk/gtkcellrenderertextpixbuf.c: 
	* gtk/gtkcellrenderertext.c: 
	* gtk/gtkcellrendererpixbuf.c: 
	* gtk/gtkcellrenderer.c:
	* gtk/gtktreeviewcolumn.c: s/[sg]et_param/[sg]et_property/, fixed
	missing warnings for invalid property ids, install properties
	with g_object_class_install_property() now.
	
	* gtk/gtksignal.c:
	(gtk_signal_emit): let g_signal_emit_valist() collect the values for us.
	
Wed Oct 25 14:17:43 2000  Owen Taylor  <otaylor@redhat.com>
	
	* gtk/gtkwidget.[ch] (gtk_widget_is_focus): Add a function
	to determine if a window is the focus widget within
	its toplevel.

	* gtk/gtkcontainer.[ch]: Fix the return type of ::focus
	to be boolean.

	* gtk/gtkcontainer.c (gtk_container_real_focus): Move handling 
	of the case where the container CAN_FOCUS to here instead
	of having it in each individual move-the-focus place.

	* gtk/gtkcontainer.c: Rewrite handling of left-right and up-down
	focusing to be geometric in a much more obvious sense. Arrowing
	around is still non-intuitive because it isn't perfect and
	because entries, etc, grab the arrow keys, but it at least
	usually will do what you expect now.
	
	* gtk/gtknotebook.[ch]: Many cleanups. Moved docs inline in this
	file.

	* gtk/gtknotebook.c: Change tabs to be a single item in
	the focus chain. Make movement of focus on tabs with arrow
	keys wrap around.
	
	* gtk/gtknotebook.c (gtk_notebook_find_child): Add
	CHECK_FIND_CHILD macro to give informative error messages
	instead of silent returns.

	* gtk/gtknotebook.c (gtk_notebook_init): Set the RECEIVES_DEFAULT 
	flag since we handle GdkReturn on the tabs.

	* gtk/gtknotebook.c (gtk_notebook_expose_tabs): Invalidate
	windows rather than sending expose events directly.

	* gtk/gtknotebook.[ch] docs/Changes-2.0.txt: Move structure 
	definition for GtkNotebookPage into .c file, since it is private.

	* gtk/testgtk.c (create_notebook): Add option for 
	testing borderless notebook.

	* gtk/testgtk.c (page_switch): Removed egregious poking
	around in GTK+ internals.

	* docs/widget-system.txt: Remove references to GTK_REDRAW_PENDING.

	* gtk/gtkclist.[ch]: Remove key press handler, handle focusing
	properly through gtk_clist_focus. Make the title headers a
	single item in the tab-focus chain, and make left-right wrap
	around.

	* gtk/gtkwindow.c (gtk_window_focus): Add a custom
	focus method so that wrapping around works properly.

	* gtk/gtktreeview.c: Remove calls to gtk_container_set_focus_child() - 
	that is handled for the widget now. 

Mon Dec 11 11:41:12 2000  Owen Taylor  <otaylor@redhat.com>

	* gtk/gtkinvisible.c (gtk_invisible_init): Flag invisible
	widgets as TOPLEVEL.

	* gtk/gtkwidget.c (gtk_widget_queue_resize): Don't assume
	TOPLEVEL widgets are containers.

	* gtk/gtkinvisible.h: Remove useless include.

2000-12-11  Havoc Pennington  <hp@redhat.com>

	* gtk/gtktextlayout.c (gtk_text_layout_get_line_display): 
	Handle chopping off \r\n and 0x2029 in addition to \n before
	passing to PangoLayout

	* gtk/gtkimcontextsimple.c
	(gtk_im_context_simple_get_preedit_string): 
	return an empty string if no match is pending

	* gtk/gtkimcontext.c (gtk_im_context_get_preedit_string): add
	assertion that the returned preedit string was sane

	* gtk/gtktext*.[hc], gtk/testtext.c, gtk/testtextbuffer.c:
	s/gtk_text_iter_next_char/gtk_text_iter_forward_char/g;
	s/gtk_text_iter_prev_char/gtk_text_iter_backward_char/g;

Mon Dec 11 10:02:26 2000  Owen Taylor  <otaylor@redhat.com>

	* gtk/gtkimcontextsimple.c (gtk_im_context_simple_finalize): 
	Fix up finalizer to chain to its parent.

2000-12-11  Alexander Larsson  <alexl@redhat.com>

	* docs/README.linux-fb (GDK_KEYBOARD_TYPE):
	Clearified the difference between the keyboard types. Wrote a note
	about the magic sysrq key to get out of raw mode.

2000-12-09  James Henstridge  <james@daa.com.au>

	* gdk/linux-fb/gdkmouse-fb.c (GdkFBMouseDevice): add prot struct
	member to hold masks for detecting the start of a protocol packet.
	(mouse_devs): add packet start masks for ps2 and ms device types.
	Left the mask for fidmour blank, as I have no idea what it should
	be.
	(handle_mouse_io): skip bytes until we get to the start of a
	packet.  My Logitech mouse seems to be passing an extra NULL pad
	byte, and GPM does a similar thing here.
	(gdk_fb_mouse_ms_open): changed error message to not say psaux, as
	this is the ms mouse driver.
	(gdk_fb_mouse_ms_packet): fix up button handling, which was
	completely broken except for button1.  It was checking the wrong
	bit in the packet for the status of the right mouse button, and
	wrongly assuming right == button2 rather than 3.  I fixed that and
	also added support for middle button (button2).

2000-12-08  Havoc Pennington  <hp@redhat.com>

	* gtk/gtktextbtree.c (gtk_text_btree_insert): fix breakage here
	that cause a segfault on text insertion

	* gtk/gtktextchild.c (gtk_text_child_anchor_queue_resize): fix 
	warning

	* gtk/gtktextiter.c (test_log_attrs): use
	_gtk_text_buffer_get_line_log_attrs to speed things up a bit

	* gtk/gtktextbuffer.c (_gtk_text_buffer_get_line_log_attrs): 
	Get log attrs for a line, using a cache stored on the buffer
	
	* gtk/gtkcolorsel.h (GTK_COLOR_SELECTION_GET_CLASS): fix typo,
	reported by Jeff Franks

2000-12-08  Alexander Larsson  <alla@lysator.liu.se>

	* gdk/linux-fb/gdkmouse-fb.c (gdk_fb_mouse_ms_open):
	/dev/ttyS0 -> /dev/mouse

2000-12-08  Alexander Larsson  <alla@lysator.liu.se>

	* gdk/linux-fb/gdkfont-fb.c (gdk_fontset_load):
	Added dummy gdk_fontset_load.

2000-12-08  Alexander Larsson  <alexl@redhat.com>

	* docs/README.linux-fb:
	* docs/Makefile.am:
	Initial GtkFB docs.
	
	* gdk/linux-fb/Makefile.am:
	Define GDK_DATA_PREFIX.

	* gdk/linux-fb/gdkmain-fb.c:
	Fix typo.
	Change default display to /dev/fb0.

	* gdk/linux-fb/gdkpango-fb.c:
	Add $(prefix)/share/fonts/ to font path.
	
2000-12-08  Alexander Larsson  <alla@lysator.liu.se>

	* gdk/linux-fb/gdkkeyboard-fb.c:
	New file containing the abstracted keyboard driver. Most code
	taken from gdkinput-ps2.c

	* gdk/linux-fb/gdkinput-ps2.c:
	Removed file.
	
	* gdk/linux-fb/Makefile.am:
	Added gdkkeyboard-fb.c, removed gdkinput-ps2.c.

	* gdk/linux-fb/gdkcolor-fb.c:
	display->fb was renamed to display->fb_fd.

	* gdk/linux-fb/gdkcursor-fb.c:
	gdk_mouse_get_info -> gdk_fb_mouse_get_info

	* gdk/linux-fb/gdkinput.c:
	Moved gdk_input_init here from gdkinput-ps2.c

	* gdk/linux-fb/gdkmain-fb.c:
	display->fb was renamed to display->fb_fd.
	Now the tty and the console is opened here instead
	of in the keyboard driver. Also check GDK_VT to see what
	tty to open.
	Move gdk_beep () here from gdkinput-ps2.c
	gdk_mouse_get_info -> gdk_fb_mouse_get_info

	* gdk/linux-fb/gdkmouse-fb.c:
	Add header.
	gdk_mouse_get_info -> gdk_fb_mouse_get_info
	Return correct keyboard modifiers.
	GDK_MOUSETYPE -> GDK_MOUSE_TYPE for consistancy

	* gdk/linux-fb/gdkprivate-fb.h:
	Add tty and vt info to display.
	Add orignal modeinfo storage to display
	Update global functions

	* gdk/linux-fb/gdkwindow-fb.c:
	Added gdk_fb_window_find_focus().
	gdk_mouse_get_info -> gdk_fb_mouse_get_info

2000-12-07  Havoc Pennington  <hp@pobox.com>

	* gdk/x11/gdkkeys-x11.c (gdk_keymap_lookup_key): fix name of 
	function, noticed by Alex

2000-12-06  Elliot Lee  <sopwith@redhat.com>

	* configure.in: Detect freetype properly

	* modules/basic/Makefile.am, gdk/linux-fb/Makefile.am: Make use of
	above.

2000-12-06  Alexander Larsson  <alexl@redhat.com>

	* gdk/linux-fb/Makefile.am:
	Add gdkmouse-fb.c
	
	* gdk/linux-fb/gdkmouse-fb.c:
	New file. Abstracted the mouse drivers a bit.

	* gdk/linux-fb/gdkcursor-fb.c:
	The cursor hide/show functions was moved here from gdkinput-ps2.c.

	* gdk/linux-fb/gdkinput-ps2.c:
	Removed old mouse handling code. Moved cursor handling code
	to gdkcursor-fb.c, moved gdk_fb_window_send_crossing_events() to
	gdkwindow-fb.c. gdk_input_get_mouseinfo was renamed to
	gdk_mouse_get_info.

	* gdk/linux-fb/gdkmain-fb.c:
	Pass NULL pointers for x,y in gdk_mouse_get_info call.

	* gdk/linux-fb/gdkprivate-fb.h:
	Removed public gdk_fb_find_common_ancestor, added and renamed
	functions for the new mouse handling code.

	* gdk/linux-fb/gdkwindow-fb.c:
	Moved gdk_fb_window_send_crossing_events here. added global
	variable gdk_fb_window_containing_pointer. made
	gdk_fb_find_common_ancestor static. gdk_input_get_mouseinfo was
	renamed to gdk_mouse_get_info.

2000-12-06  Alexander Larsson  <alexl@redhat.com>

	* gdk/linux-fb/gdkevents-fb.c:
	Update to match latest gmain/gsource changes.

	* gdk/linux-fb/gdkinput-ps2.c:
	Bogus gdk_keymap_get_entries_for_keycode implementation so that
	it links. Will be implemented later.

2000-12-03  Havoc Pennington  <hp@pobox.com>

	* gdk/Makefile.am: add gdkkeys.[hc]

	* gdk/gdkkeys.h, gdk/gdkkeys.c: Move all the keyval stuff to these
	files from gdk.h, gdk.c; add GdkKeymap type and operations on it.

	* acconfig.h, configure.in: add checks and command line options
	for XKB

	* gdk/x11/gdkkeys-x11.c: Implement the above functions
	
	* gdk/x11/gdkevents-x11.c (gdk_event_translate): Put the keycode
	and group in the key event

	* gdk/gdkevents.h (struct _GdkEventKey): Add a hardware_keycode
	field with the low-level hardware key code, and a group
	field with the keyboard group

	* gdk/x11/gdkprivate-x11.h: include config.h for HAVE_XKB,
	and declare a couple globals used for keymap handling
	
	* gtk/gtkimcontextsimple.c: Implement ISO 14755 input method,
	hold down Shift-Control and type a hex number to get a Unicode 
	character corresponding to the hex number
	(gtk_im_context_simple_get_preedit_string): Fix cursor position
	(return bytes not chars)

2000-12-05  Elliot Lee  <sopwith@redhat.com>

	* gdk/gdkcolor.h: Make GdkColor specify element sizes
	to avoid waste on 64-bit platforms.

Tue Dec  5 15:49:31 2000  Owen Taylor  <otaylor@redhat.com>

	* INSTALL: Fix link to PNG home, remove reference
	to fribidi.

	* gdk/x11/gdkevents-x11.c: Fix up for new GMain API.
	
	* gdk/win32/gdkevents-win32.c: Fix up for new GMain API. (Not
	tested.)

	* gtk/gtkcheckmenuitem.c: Permanently turn on
	always_show_toggle.

	* gtk/gtkclist.c (gtk_clist_get_pixtext): Allow mask to 
	be NULL. (Vladimir Klebanov, #26545)

	* gtk/gtkspinbutton.c (gtk_spin_button_insert_text): Fix 
	some signed/unsigned comparison problems. (#6510,
	David Kaelbling)

	* gtk/gtkwidget.[ch] (gtk_widget_is_ancestor): Change
	return type to boolean (Oskar Liljeblad, #18648)

2000-12-05  Alexander Larsson  <alexl@redhat.com>

	* gdk/linux-fb/gdkmain-fb.c (gdk_fb_display_new):
	Remove bogus colormap setting.

2000-12-05  Alexander Larsson  <alexl@redhat.com>

	* gdk/linux-fb/gdkcolor-fb.c:
	More complete colormap handling. Now GdkRGB work in 8 bpp modes.

	* gdk/linux-fb/gdkdrawable-fb2.c (gdk_fb_draw_image):
	Must set colormap.
	
Tue Dec  5 13:17:53 GMT 2000  Tony Gale <gale@gtk.org>

	* docs/tutorial/gtk-tut.sgml: DND updates

2000-12-05  Alexander Larsson  <alla@lysator.liu.se>

	* gdk/linux-fb/gdkdrawable-fb2.c (gdk_fb_draw_drawable_3):
	Remove old debug g_warning().
	(gdk_fb_draw_drawable): The src argument can be either a wrapper
	or an implementation, just pass the implementation to draw_drawable_2.
	
	* gdk/linux-fb/gdkprivate-fb.h:
	Added GDK_IS_DRAWABLE_IMPL_FBDATA()

	* gdk/linux-fb/gdkwindow-fb.c (_gdk_windowing_window_destroy):
	clear and invalidate area when window is destroyed.
	(send_map_events): Remove old commented out code.

2000-12-05  Alexander Larsson  <alexl@redhat.com>

	* gdk/linux-fb/gdkpango-fb.c:
	Use italic instead of oblique in font aliases.
	
	* gdk/linux-fb/gdkrender-fb.c (gdk_fb_fill_span_generic,
	_gdk_fb_gc_calc_state): Support GDK_XOR, add g_warning for
	other unsupported functions.

2000-12-04  Havoc Pennington  <hp@redhat.com>

	* gtk/gtkpaned.c (gtk_paned_expose): fix this to be sane

	* gtk/gtkvpaned.c (gtk_vpaned_expose): Add an expose handler

	* gtk/gtkhpaned.c (gtk_hpaned_expose): Add an expose handler

	* gtk/gtknotebook.c (gtk_notebook_draw_tab): put in a temporary 
	hack to avoid infinite loops (synthetic expose event) - 
	Owen has more appropriate fixes in a branch he'll check in later.

	* gtk/gtktextiter.c (gtk_text_iter_ends_line): handle paragraph
	separator, CR, and CRLF as line ends

	* gtk/gtktextbtree.c (gtk_text_btree_insert): on insertion, break
	into lines using pango_find_paragraph_boundary(); other bits of
	the widget are still going to be broken if the boundary isn't '\n'
	though

2000-12-04  Alexander Larsson  <alexl@redhat.com>

	* gdk/linux-fb/gdkfont-fb.c (gdk_text_width): Divide size by 2, not
	multiply.

	* gdk/linux-fb/gdkpango-fb.c:
	Copied some 26.6 scaling macros from pango to clean up the rounding.
	(pango_fb_font_get_glyph_info): Correct sign on x value.

	* gdk/linux-fb/gdkprivate-fb.h:
	Removed unreferenced external functions.

	* modules/linux-fb/Makefile.am: Use ` instead of '.

	* modules/linux-fb/basic.c:
	Remove dead code. In particular the dummy lang engine which broke all
	pango layouts in GtkFB. Don't include tables-big.i anymore.

	* modules/linux-fb/tables-big.i:
	Upgrade to latest version from pango. Left for reference, basic_ranges
	moved to basic.c.
	
2000-12-04  Havoc Pennington  <hp@redhat.com>

        Fix bugs Alex found:
	
	* gtk/gtktooltips.c (gtk_tooltips_force_window): nuke connection
	to "draw"

	* gtk/gtkdnd.c (gtk_drag_highlight): nuke connection to "draw"

	* gtk/gtkcolorsel.c (palette_new): nuke connection to "draw"

	* gtk/gtklistitem.c (gtk_list_item_expose): Put the old _draw() 
	implementation in here, apparently the expose() implementation was
	dead code.

2000-12-04  Alexander Larsson  <alexl@redhat.com>

	* gdk/linux-fb/gdkpango-fb.c (pango_fb_font_get_metrics):
	Return positive descent.

2000-12-02  Havoc Pennington  <hp@pobox.com>

	* gtk/gtkwidget.h (struct _GtkWidgetClass): Remove "draw" virtual
	method and signal
	
	* gtk/gtkwidget.c (gtk_widget_draw): Now just queues a draw then
	calls gdk_window_process_updates() to push the exposes through
	(gtk_widget_class_init): No more draw signal, no
	gtk_widget_real_draw()	
	
	* gtk/gtkbin.c (gtk_bin_draw): remove

	* gtk/gtkbox.c (gtk_box_draw): remove

	* gtk/gtkbutton.c (gtk_button_draw): remove

	* gtk/gtkcalendar.c (gtk_calendar_draw): remove

	* gtk/gtkcheckbutton.c (gtk_check_button_draw): remove

	* gtk/gtkcheckmenuitem.c (gtk_check_menu_item_draw): remove

	* gtk/gtkclist.c (gtk_clist_draw): remove

	* gtk/gtkentry.c (gtk_entry_draw): remove

	* gtk/gtkeventbox.c (gtk_event_box_draw): remove

	* gtk/gtkfixed.c (gtk_fixed_draw): remove

	* gtk/gtkframe.c (gtk_frame_draw): remove

	* gtk/gtkhandlebox.c (gtk_handle_box_draw): remove

	* gtk/gtkhpaned.c (gtk_hpaned_draw): remove

	* gtk/gtklayout.c (gtk_layout_draw): remove

	* gtk/gtklist.c (gtk_list_draw): remove

	* gtk/gtklistitem.c (gtk_list_item_draw): remove

	* gtk/gtkmenu.c (gtk_menu_draw): remove

	* gtk/gtkmenubar.c (gtk_menu_bar_draw): remove

	* gtk/gtkmenuitem.c (gtk_menu_item_draw): remove

	* gtk/gtknotebook.c (gtk_notebook_draw): remove

	* gtk/gtkoptionmenu.c (gtk_option_menu_draw): remove

	* gtk/gtkpacker.c (gtk_packer_draw): remove

	* gtk/gtkrange.c (gtk_range_draw): remove

	* gtk/gtkscrolledwindow.c (gtk_scrolled_window_draw): remove

	* gtk/gtkspinbutton.c (gtk_spin_button_draw): remove

	* gtk/gtktable.c (gtk_table_draw): remove

	* gtk/gtktearoffmenuitem.c (gtk_tearoff_menu_item_draw): remove

	* gtk/gtktext.c (gtk_text_draw): remove

	* gtk/gtktextview.c (gtk_text_view_draw): remove

	* gtk/gtktogglebutton.c (gtk_toggle_button_draw): remove

	* gtk/gtktoolbar.c (gtk_toolbar_draw): remove

	* gtk/gtktree.c (gtk_tree_draw): remove

	* gtk/gtktreeitem.c (gtk_tree_item_draw): remove

	* gtk/gtktreeview.c (gtk_tree_view_draw): remove

	* gtk/gtkviewport.c (gtk_viewport_draw): remove

	* gtk/gtkvpaned.c (gtk_vpaned_draw): remove

	* gtk/gtkvscale.c (gtk_vscale_draw): remove

	* gtk/gtkwindow.c (gtk_window_draw): remove

2000-20-01  Anders Carlsson  <andersca@gnu.org>

	* gtk/gtktogglebutton.c (gtk_toggle_button_draw): Fix bug when
	a GtkToggleButton is both insensitive and active, it was being
	drawn by the GtkButton draw handler which doesn't check the
	state. Now it's calling gtk_toggle_button_paint instead.
	
2000-12-01  Havoc Pennington  <hp@redhat.com>

	* gtk/gtktextdisplay.c (gtk_text_layout_draw): don't create
	dangling pointers to the appearance attributes from the 
	line display

	* gdk/gdkdraw.c (gdk_drawable_get_image): allow negative
	width/height to mean "full width/height of drawable"

 	* gtk/gtktextview.h, gtk/gtktextview.c: Implement double/triple
	click to select word/line
	
	* gtk/gtktextiter.c (test_log_attrs): include paragraph delimiters 
	when getting log attrs. Get a slice, so that pixmaps and stuff
	are properly handled.

	* gtk/gtktextbuffer.c (paste): Fix pasting to work properly if you
	paste into the selection (replaces selection now, previously
	crashed or added to selection). Reveals longstanding btree bug -
	select multiple lines, middle-click on the selection, boom. This
	isn't related to my changes though.

	* gtk/gtkentry.c (gtk_entry_move_forward_word): Update to reflect
	PangoLogAttrs changes
	(gtk_entry_move_backward_word): ditto

        * gtk/gtktextlayout.h, gtk/gtktextlayout.c: Make the iter motion
 	functions return bool whether the iter moved onto a
 	dereferenceable position.
 
 	* gtk/gtktextview.h, gtk/gtktextview.c: Add a bunch of public
 	functions for motion in terms of display lines.

	* gtk/gtktextmark.c (gtk_text_mark_get_buffer): Add function to
	get the buffer a mark is inside
	
2000-12-01  Alexander Larsson  <alexl@redhat.com>

	* gdk/linux-fb/Makefile.am:
	* modules/linux-fb/Makefile.am:
	Freetype 2 final uses freetype-config

	* gdk/linux-fb/gdkpango-fb.c:
	Upgrade to use Freetype 2 final.
	More flexible support for font aliases, this also fixes a bug with
	GtkFontSelector, as the aliases must be visible in the font/family list,
	or GtkFontSelector reads uninitialized memory.

2000-11-30 Hidetoshi Tajima  <tajima@eng.sun.com>

	* modules/input/gtkimcontextxim.c (setup_im): Add NULL argument to
	XGetIMValues to properly terminate variable argument list, and do
	NULL return check for ic_values and xim_styles.

	* modules/input/gtkimcontextxim.c (gtk_im_context_xim_reset):
	Restore preedit state after XmbResetIC().
	
	* modules/input/gtkimcontextxim.c (gtk_im_context_xim_get_ic):
	XvaCreateNestedList() should take XvaNestedList, but not
	XvaNestedList*.

	* modules/input/gtkimcontextxim.c (gtk_im_context_xim_reset,
	preedit_draw_callback, preedit_caret_callback): Match
	"preedit-changed" signal name to "preedit_changed" to be
	consistent to the spec.

	* gtk/gtkimcontextsimple.c (check_table):
	Match "preedit-changed" to "preedit_changed" to be consistent
	to the spec.

Thu Nov 30 23:03:04 2000  Owen Taylor  <otaylor@redhat.com>

	* gdk/x11/gdkgc-x11.c (gdk_gc_copy): Properly handle
	gc->clip_region == NULL>

2000-11-30  Tor Lillqvist  <tml@iki.fi>

	Changes by Hans Breuer:
	
	* gdk/win32/gdkwindow-win32.c (gdk_window_set_geometry_hints):
	Dont't use negative width and height as max_hints. This fixes
	Owen's recent testgtk changes for win32.

	* gdk/win32/gdkgc-win32.c (gdk_win32_hdc_get,
	gdk_win32_hdc_release): These are exported and may be called with
	other drawable types than our GdkDrawableImplWin32 (?).

	* gdk/gdkwindow.c: Backing store appears to work on Windows now,
	so always #define USE_BACKING_STORE.

	* gtk/gtktextdisplay.c (render_layout_line): Use g_print instead
	of printf for debugging output.

	* gtk/gtktextlayout.c (allocate_child_widgets): Ditto.
	
	* gtk/gtktextview.c (gtk_text_view_child_allocated): Ditto.

	* gtk/gtkmain.h (GTKMAIN_C_VAR): Win32 fix for dllimport
	declaration.

	* gtk/gtktexttypes.h: Ditto.

	* gtk/gtklabel.c (gtk_label_set_markup_with_accel): Return a value
	(GDK_VoidSymbol) also if in case of arg check failure.

	* gtk/gtkimcontextsimple.c
	(gtk_im_context_simple_get_preedit_string): Don't assign cursor
	position to the pointer, but to the variable it points to.

	* gtk/makefile.msc.in (DEFINES): Define GTK_VERSION.

	* gtk/gtk.def: Updates.

2000-11-29  Elliot Lee  <sopwith@redhat.com>

	* gtk/gtkmodelsimple.c: Inherits from GTK_TYPE_OBJECT, not
	GTK_TYPE_TREE_MODEL.

2000-11-29  Alexander Larsson  <alexl@redhat.com>

	* gdk/linux-fb/gdkfont-fb.c (gdk_font_from_description):
	Set the size of the font from the description.
	(gdk_text_width): Gross hack that calculates the width
	of text by text_length * size/2. This is necessary because
	GtkLabel does some ugly gtk_string_width call to calculate
	an good size.
	(linux-fb/gdkprivate-fb.h): Removed unused field FT_Face.

Wed Nov 29 13:39:19 GMT 2000  Tony Gale <gale@gtk.org>

	* docs/tutorial/gtk-tut.sgml: DND updates

2000-11-29  Alexander Larsson  <alexl@redhat.com>

	* gdk/linux-fb/gdkwindow-fb.c (_gdk_windowing_window_clear_area):
	If you pass width or height == 0 to gdk_window_clear_area they
	should be calculated from the window size.

2000-11-29  Alexander Larsson  <alexl@redhat.com>

	* gdk/linux-fb/gdkinput-ps2.c (move_pointer): If there is
	a grab, but no grab-cursor, use the cursor from the grabbed
	window. (gdk_fb_window_send_crossing_events): Send normal
	enter/leave notifications if grab and owner_events == TRUE.

2000-11-29  Alexander Larsson  <alexl@redhat.com>

	* gdk/linux-fb/gdkinput-ps2.c (send_button_event):
	Do implicit button grabs, even if the window doesn't
	want the event.
	(gdk_fb_window_send_crossing_events): If there is a
	grab, only the grabbed window gets normal enter/leave
	notifications. On ungrab go from grabbed window to current.
	Don't send any notification to b when propagating from c -> b.
	If setting a grab on window, don't set prev_window.
	(handle_mouse_input): Send enter/leave events to the window the
	mouse is over, not the grabbed one.
	
2000-11-28  Elliot Lee  <sopwith@redhat.com>

	* gdk/gdkregion-generic.c: Zap warning.
	* modules/input/Makefile.am: Only build im-xim if USE_X11 is enabled
	* gtk/gtkrc.c: s/strcpy/memcpy/ to save a few nanoseconds.

2000-11-28  Alexander Larsson  <alla@lysator.liu.se>

	* gdk/linux-fb/gdkwindow-fb.c (gdk_fb_window_move_resize):
	The cursor should be hidden if it is part of either the
	source or destination region. Not only if it is in both.
	(gdk_window_set_transient_for): Silence warnings.

2000-11-28  Alexander Larsson  <alexl@redhat.com>

	* gdk/linux-fb/mifillarc.c (miFillArcSliceSetup):
	The default mode in X is Pie Arcs, therefore that is
	what Gtk+ uses.

2000-11-28  Alexander Larsson  <alexl@redhat.com>

	* gdk/linux-fb/gdkinput-ps2.c:
	Implement correct EnterNotify/LeaveNotify:
	(gdk_fb_window_send_crossing_events): New function that sends
	all GdkCrossingEvents from the last mouse-window to the specified
	destination.
	(gdk_fb_window_visibility_crossing): Removed function.
	(handle_mouse_input): Use gdk_fb_window_send_crossing_events()
	(send_button_event, gdk_fb_cursor_reset): Use gdk_window_at_pointer
	instead of gdk_window_get_pointer() for	better readability.

	* gdk/linux-fb/gdkmain-fb.c (gdk_fb_pointer_grab,
	gdk_fb_pointer_ungrab): Use gdk_fb_window_send_crossing_events.

	* gdk/linux-fb/gdkprivate-fb.h:
	removed gdk_fb_window_visibility_crossing, added
	gdk_fb_window_send_crossing_events and gdk_fb_find_common_ancestor.

	gdk/linux-fb/gdkwindow-fb.c (gdk_fb_find_common_ancestor):
	New function that finds the least common ancestor of two windows.
	(gdk_window_show, gdk_window_hide):
	Use gdk_fb_window_send_crossing_events.
	(gdk_fb_window_move_resize): Send configure events to toplevel
	windows. Use gdk_fb_window_send_crossing_events.

2000-11-27  Havoc Pennington  <hp@redhat.com>

	* gtk/gtkprivate.h (enum): Remove a trailing comma

2000-11-27  Federico Mena Quintero  <federico@helixcode.com>

	* gtk/gtkspinbutton.c (gtk_spin_button_set_adjustment): Connect to
	the "changed" callback of the adjustment.  We need to redraw the
	spin button's arrows when the adjustment's range changes.
	(adjustment_changed_cb): Draw the arrows.
	(gtk_spin_button_value_changed): Draw the arrows.

2000-11-23  Alexander Larsson  <alexl@redhat.com>

	* gdk/linux-fb/gdkselection-fb.c:
	Initial selection implementation.

	* gtk/gtkselection.c:
	if GDK_WINDOWING_FB defined, include linux-fb/gdkfb.h and look up
	requestor in gtk_selection_request.
	
	* gdk/linux-fb/gdkfb.h, gdk/linux-fb/gdkglobals-fb.c:
	Added gdk_selection_property atom.

	* gdk/linux-fb/gdkprivate-fb.h:
	Export _gdk_selection_window_destroyed.
	Removed mask_off_x/y from GdkCursorPrivateFB.
	Removed hbearing, added top, left to PangoFBGlyphInfo.

	* gdk/linux-fb/gdkwindow-fb.c (_gdk_windowing_window_destroy):
	Call _gdk_selection_window_destroyed
	(_gdk_windowing_window_init): Don't call gdk_cursor_new() before
	the root window has been created.
	(static_dx_hack, static_dy_hack, compare_draw_rects,
	gdk_fb_window_move_resize): Remove unnecessary sort of rectangles
	in region. They are already sorted. Instead just traverse them in
	reverse if draw_direction < 0.
	
	* gdk/linux-fb/gdkinput-ps2.c (send_button_event):
	Double-clicks must be sent after the normal button_press.
	(gdk_fb_cursor_unhide): Remove usage of mask_off_x/y. Clean up.
	
	* gdk/linux-fb/gdkgeometry-fb.c (gdk_window_scroll):
	Pass _gdk_fb_screen_gc instead of NULL.

	* gdk/linux-fb/gdkmain-fb.c (_gdk_windowing_init_check):
	Initialize gdk_selection_property.
	(gdk_event_make): Remove unused code.

	* gdk/linux-fb/gdkcursor-fb.c:
	Make the pixmap for the cursor the same size as the mask. Also remove
	the mask_off_x/y fields in GdkCursorPrivateFB and combine
	_gdk_cursor_new_from_pixmap() and gdk_cursor_new_from_pixmap()
	Now the whole cursor is visible.

	* gdk/linux-fb/gdkdrawable-fb2.c (gdk_fb_draw_drawable_3):
	Fix bug where xdest+height instead of ydest+height was used
	to calculate if the source and dest overlapped. This fixes the
	redraw bug when the main window in testgtk was scrolled when
	partially covered by a tall window.
	Copy rectangles in region in order depending on draw_direction.
	Also moved the draw_direction flipping of start_y and end_y into
	the gc functions, as this might not be what all of them want.
	(gdk_fb_draw_lines): Support dashed lines.
	(gdk_fb_draw_glyphs): Clean up glyph placement. Also fix positioning
	so that the text is positioned correctly (was 1 pixel high).

	gdk/linux-fb/gdkgc-fb.c:
	Initialize cap_style to GTK_CAP_BUTT. This fixes a problem where
	all lines were drawn a pixel to short. Also checked the default of
	the rest of the values, and they're the same as X now.

	* gdk/linux-fb/gdkpango-fb.c (pango_fb_font_get_glyph_info):
	Clean up pixel positioning of the glyphs. Just use bgy->top and
	bgy->left. Also used PANGO_PIXEL where appropriate and added 0.5
	to all divisions to get correct rounding behaviour.

	* gdk/linux-fb/gdkrender-fb.c (gdk_fb_draw_drawable_generic,
	gdk_fb_draw_drawable_memmove, gdk_fb_draw_drawable_aa_24):
	Moved start_y/end_y flip into draw_drawable implementations.
	Flip also x rendering when draw_direction < 0.
	Remove unneccesary multiply with draw_direction.

Wed Nov 22 14:11:19 GMT 2000  Tony Gale <gale@gtk.org>

	* docs/tutorial/gtk-tut.sgml:
	  - get rid of gtk_toggle_button_toggled FUD
	  - start DND section - needs work - based on:
		http://wolfpack.twu.net/docs/gtkdnd/

2000-11-22  Alexander Larsson  <alexl@redhat.com>

	* gdk/linux-fb/gdkpango-fb.c (pango_fb_font_get_metrics):
	Correct calculation of font metrics. Now GtkEntrys have sane
	size.

2000-11-22  Alexander Larsson  <alexl@redhat.com>

        * gdk/gdktypes.h:
	Add new type GdkSpan
	
	* docs/reference/gdk/gdk-sections.txt,
	docs/reference/gdk/tmpl/regions.sgml, gdk/gdkregion-generic.c,
	gdk/gdkregion.h:
	Implement and document gdk_region_spans_intersect_foreach.

	* gdk/linux-fb/Makefile.am, gdk/linux-fb/gdkrender-fb.c:
	Add new file gdkrender-fb.c which contains all core
	rendering code.
	Add gdk_fb_fill_rectangle_generic (old rectangle code) and
	gdk_fb_fill_rectangle_simple_16, gdk_fb_fill_rectangle_simple_32
	(optimized rectangle fillers).

	* gdk/linux-fb/gdkdrawable-fb2.c:
	Move all rendering code to gdkrender-fb.c.
	Change from using GdkRectangles and GdkSegments for spans to GdkSpan.
	Use the new span intersection functions in gdk_fb_fill_spans.
	gdk_fb_draw_rectangle() clips filled rectangles and calls
	gc->fill_rectangle with the result.
	gdk_fb_fill_spans() gets extra argument "sorted".

	* gdk/linux-fb/gdkevents-fb.c:
	Remove unused includes and defines.
	New function gdk_fb_get_time() to get correct time for events.

	* gdk/linux-fb/gdkinput-ps2.c:
	Use gdk method of generating multiple-clicks (gdk_event_button_generate)
	Make sure to set the time of all events.

	* gdk/linux-fb/gdkmain-fb.c:
	Use gdk_fb_get_time ().

	* gdk/linux-fb/gdkprivate-fb.h:
	New virtual GC calls: fill_span & fill_rectangle.
	Export gdk_fb_get_time().
	gdk_fb_fill_spans() gets extra argument "sorted".

	* gdk/linux-fb/mi*.c:
	Use GdkSpan instead of GdkRectangle.
	Pass correct sorted to gdk_fb_fill_spans. (sorted value taken
	from XFree 4 source)
	
2000-11-22    <jrb@redhat.com>

	* gtk/gtktreeview.c (gtk_tree_view_calc_size): It's amazing what
	reversing the order in an if statement will do.  Doing so managed
	to make the treemodelsort half work.  Other half will follow after
	I get the insert function fully fixed.

2000-11-21  Elliot Lee  <sopwith@redhat.com>
	* gtk/gtkmenushell.h: GdkEventButton->button can occupy significantly
	more than 2 bits. Besides, I need to implement an evil hack. :)

Tue Nov 21 14:17:51 GMT 2000  Tony Gale <gale@gtk.org>

	* docs/tutorial/gtk-tut.sgml: minor corrections

2000-11-20  Jonathan Blandford <jrb@redhat.com>
	* gtk/gtktreemodelsort.h: Add convertion functions to let you
	  convert to and from relative path's and iters.

	* gtk/treestoretest.c: move to having a sorted/unsorted view.  Start
	  testing sorting functions a bit better.  Currently broken -- will
	  fix in morning.

2000-11-20  Havoc Pennington  <hp@redhat.com>

	* gtk/gtkwidget.c: Documented a bunch of functions in here
	(gtk_widget_realize): Warn if you try to realize
	a widget with no parent that isn't a toplevel
	(gtk_widget_intersect): return a gboolean

2000-11-20  Havoc Pennington  <hp@redhat.com>

	* gtk/gtktextview.c, gtk/gtktextlayout.c, gtk/gtktextchild.c,
	gtk/testtext.c: Semi-finish widget embedding. Need guffaw
	scrolling to be implemented in GDK to finish. Also, right now
	we just size_allocate all children on every layout change,
	which is pretty lame. Test commented out of testtext.c, 
	until it works better.

2000-11-20  Alexander Larsson  <alla@lysator.liu.se>

	* gdk/linux-fb/gdkdrawable-fb2.c:
	Removed unused arguments from gdk_fb_drawable_get_pixel().

	* gdk/linux-fb/gdkinput-ps2.c (handle_input_ps2):
	Renamed fidur specific mouse packet data in MouseDevice to
	generic. Used it in ps2 mouse handling code to avoid blocking
	reads.

Sat Nov 18 18:00:17 2000  Jonathan Blandford  <jrb@redhat.com>

	* demos/gtk-demo/main.c: Changed to have the list become
	non-italic when the demo window is destroyed through an external
	event (like a close button).  Doing so found three bugs in the
	widget.

	* demos/gtk-demo/*.c (do_*): Changed to return the toplevel window.

	* gtk/gtkliststore.c (gtk_list_store_set_cell): emit "change" when
	we actually set the cell.

	* gtk/gtktreestore.c (gtk_tree_store_set_cell): ditto

	* gtk/gtktreeselection.c (gtk_tree_selection_real_select_node):
	free a leaked path.  Thanks memprof.

Sat Nov 18 11:58:17 2000  Owen Taylor  <otaylor@redhat.com>

	* gdk/gdkrgb.c (gdk_rgb_allocate_images): Fix 
	off-by-one error when destroying allocated segments
	on failure. (Elliot)

Sat Nov 18 11:45:09 2000  Owen Taylor  <otaylor@redhat.com>

	* gtk/gtkcalendar.c: Patch from ChiDeok Hwang to fix
	memleaks found by Evan Martin.

Fri Nov 17 20:14:20 2000  Owen Taylor  <otaylor@redhat.com>

        * Released 1.3.2
	
	* NEWS: Updates for 1.3.2

2000-11-17  Tor Lillqvist  <tml@iki.fi>

	* gdk/gdkevents.h: Add comment that GdkXEvent isn't only for XEvent,
	but in general for window system specific events.

	* gtk/gtk.def
	* gtk/makefile.mingw.in
	* gtk/makefile.msc.in: Update.
	
	* gtk/gtktexttypes.h: Mark variables for export/import from DLL.

Thu Nov 16 16:11:39 2000  Owen Taylor  <otaylor@redhat.com>

	* gtk/Makefile.am (EXTRA_DIST): Do not, in any circumstances,
	distribute gtk.immodules.

	* gtk/Makefile.am (install-data-local): Don't install the
	gtk.immodules file created for the uninstalled modules;
	instead run gtk-query-immodules after install

Wed Nov 15 21:51:31 2000  Owen Taylor  <otaylor@redhat.com>

	* modules/input/Makefile.am (im_xim_la_LDFLAGS): Point
	-rpath to the right install location.

	* modules/input/Makefile.am (im_inuktitut_la_LDFLAGS): Remove
	-export-dynamic.

	* gtk/gtkthemes.c (gtk_theme_engine_get): Set engine->name
	properly.

2000-11-15  Havoc Pennington  <hp@pobox.com>

	* gtk/gtktextview.c (gtk_text_view_start_cursor_blink): Apply
	patch from Mikael Hermansson to temporarily stop blinking while
	the user is using the keyboard to type or navigate. 

	Also, when blinking, stay on for longer than we stay off. Also,
	return from start_cursor_blink if !cursor_visible, to save
	checking that flag all over the place before we call
	start_cursor_blink.

Thu Nov 16 01:25:51 2000  Robert Brady  <robert@suse.co.uk>

	* gtk/gtkrc.*: Remove the locale-specific gtkrc's, as they
	only contain a "fontset" line, which is now ignored.

	* gtk/gtkentry.c (gtk_entry_button_release): Make 
	double-click-to-select-word work.
	
Wed Nov 15 20:16:54 2000  Owen Taylor  <otaylor@redhat.com>

	* gtk/gtktextlayout.c (gtk_text_layout_move_iter_to_line_end): 
	Don't move back one char when we are actually at the end of the 
	paragraph.

2000-11-15  Robert Brady  <robert@suse.co.uk>

	* modules/input/iminuktitut.c (inuktitut_compose_seqs): 
	'o' < 'p'.
	
	* gtk/gtkmain.c: s/CODSET/CODESET/, include <libintl.h> for
	bind_textdomain_codeset.

	(gtk_init_check): Make the warning about translating default:LTR
	sterner.
	
Wed Nov 15 18:39:40 2000  Owen Taylor  <otaylor@redhat.com>

	* **/Makefile.am : remove unecessary rules for win32-specific
	config-substituted targets. If you want these rules, use
	--enable-maintainer-mode (called automatically by autogen.sh).
	Stops a lot of unneccessary make-time warnings.

	* gtk/gtktext{layout,display}.c: Factor in total width as
	well as screen when figuring alignment for word-wrap as well as
	no wrap; this is necessary to handle lines that cannot be wrapped
	at all.

2000-11-15  Havoc Pennington  <hp@redhat.com>

	* gtk/testtext.c: Implement essential color cycling feature

2000-11-15  Havoc Pennington  <hp@redhat.com>

	* gtk/gtktextview.c (changed_handler): Invalidate the side windows
	when we invalidate the main window.

	* gtk/testtext.c (create_view): Get rid of text_changed_callback,
	GtkTextView will now invalidate the side windows for us when text
	changes.

Wed Nov 15 16:02:20 2000  Owen Taylor  <otaylor@redhat.com>

	* gtk/gtktextview.c (changed_handler): Call scroll_calc_now()
	unconditionally, since we may need to update the horizontal
	scrollbars even if the height didn't change.

	* gtk/gtktextlayout.c (add_preedit_attrs): Always get
	the extra attrs, since some of them affect size.

	* gtk/gtktextdisplay.c (gtk_text_layout_draw): Factor in
	x_offset correctly.

2000-11-15  Havoc Pennington  <hp@redhat.com>

	* gtk/gtktextlayout.c (set_para_values): If indent is negative,
	don't move the first line out into the margin, instead move the
	whole paragraph in order to make space for the first line within 
	the margin

2000-11-15  Havoc Pennington  <hp@redhat.com>

	* gtk/gtktextview.c (changed_handler): offset redraw rect by
	xoffset in addition to yoffset, so horizontal scrolling doesn't
	break redraws

2000-11-15  Havoc Pennington  <hp@redhat.com>

	* gtk/gtktextdisplay.c (gtk_text_layout_draw): Remove extra pixel
	from the cursor
	(render_layout_line): fix reversed test that caused weird
	underlines to get drawn

2000-11-15  Alexander Larsson  <alla@lysator.liu.se>

	* gdk/linux-fb/gdkprivate-fb.h:
	Fix debug macros.
	
2000-11-15  Alexander Larsson  <alla@lysator.liu.se>

	* gdk/linux-fb/gdkprivate-fb.h:
	Added virtual functions set_pixel, get_color,
	fill_span and draw_drawable to the GC.
	Added global _gdk_fb_screen_gc to use instead of
	NULL when drawing to the screen.
	Added _gdk_fb_gc_calc_state() prototype.

	* gdk/linux-fb/gdkgc-fb.c:
	Call _gdk_fb_gc_calc_state() on any gc state change.

	* gdk/linux-fb/gdkglobals-fb.c:
	Add _gdk_fb_screen_gc
		
	* gdk/linux-fb/gdkdrawable-fb2.c:
	_gdk_fb_gc_calc_state() calculates best functions
	for the GC state and depth.
	Moved bpp specialized code to separate functions.
	Added optimized 24 bpp AA draw_drawable.

	* gdk/linux-fb/gdkevents-fb.c:
	Silence gcc warning.

	* gdk/linux-fb/gdkimage-fb.c:
	Use _gdk_fb_screen_gc

	* gdk/linux-fb/gdkwindow-fb.c:
	Init and use _gdk_fb_screen_gc

	* gdk/linux-fb/mitypes.h:
	Remove unused types.

2000-11-14  Havoc Pennington  <hp@pobox.com>

	* gtk/gtktextlayout.c (add_cursor): use PANGO_PIXELS() to convert
	to pixels

2000-11-14  Havoc Pennington  <hp@pobox.com>

	* gtk/testtextbuffer.c (fill_buffer): change "offset" to "rise"

	* gtk/gtktexttypes.h (GTK_TEXT_UNKNOWN_CHAR): Add macro for
	unknown char, no real reason we were using a variable. 
	Remove gtk_text_unknown_char variable. Fix all the text widget
	files accordingly.

	* gtk/gtktexttypes.c: Change "unknown character" to 0xFFFC, 
	since the Unicode spec seems to prefer that character for our
	purposes.

Wed Nov 15 02:18:01 2000  Robert Brady  <robert@suse.co.uk>

	* gtk/gtkrc.c (gtk_rc_get_im_module_file): The return 
	value of g_getenv() isn't freeable, so g_strdup it.

	* modules/input/inuktitut.c: Inuktitut input method.

	* modules/input/Makefile.am: Build this.
	
2000-11-14  Elliot Lee  <sopwith@redhat.com>

	* gtk/Makefile.am: Install gtk.immodules, needed for operation
	of gtk programs.

Tue Nov 14 20:13:06 2000  Owen Taylor  <otaylor@redhat.com>

	* gtk/gtktextlayout.c (gtk_text_layout_move_iter_to_line_end): Fix
	reversed > that was causing Home to go to end of previous line.

	* gtk/gtkimcontextsimple.c (gtk_im_context_simple_filter_keypress): Ignore
	modified-keypresses (leave for bindings.)

	* modules/input/Makefile.am: Remove useless -export-dynamic
	from module LDFLAGS.

2000-11-14  Havoc Pennington  <hp@redhat.com>

	* gdk/gdkpango.c (gdk_draw_layout_line): Draw underlines one pixel
	higher.

	* gtk/gtktextdisplay.c (render_layout_line): Take rise into
	account. Also, render rise, underline, background, etc. for
	pixbufs as well as text. Also, draw underlines one pixel higher.

	* gtk/gtktextlayout.c (gtk_text_layout_get_line_display): Add a
	PangoAttribute for the rise, so it gets drawn properly. Also,
	add the GtkTextAppearance attribute for pixbuf/widget segments
	as well; we should go ahead and have rise, underline, background,
	stipple work for those

	* gtk/gtktexttag.c: Rename "offset" property to "rise" to match
	Pango

2000-11-15  Tor Lillqvist  <tml@iki.fi>

	* gtk/makefile.{mingw,msc}.in (gtk_OBJECTS): Add new objects.

	* gtk/gtk.def: Update.

	* gtk/gtkrc.c: Can't check for G_OS_WIN32 until glib.h has been
	included.
	(gtk_rc_get_im_module_file): Use run-time installation directory
	on Win32.

	* gdk/win32/rc/gdk.rc: Remove.
	* gdk/win32/rc/gdk.rc.in: New file.
	* gdk/win32/rc/Makefile.am: New file
	* gdk/win32/Makefile.am: Corresponding changes.

	* gtk/gtk.rc: Remove.
	* gtk/gtk-win32.rc.in: New file.
	* gtk/Makefile.am: Corresponding changes.

	* configure.in: Corresponding changes.

	* gtk/gtkcompat.h.win32: Remove, useless. A distribution already
	has a built gtkcompat.h. Developers using CVS code on Win32 can
	hand-edit it from gtkcompat.h.in.

	* gtk/makefile.{mingw,msc}.in: Correspondingly don't try to make
	gtkcompat.h from gtkcompat.h.win32.

2000-11-14  Havoc Pennington  <hp@redhat.com>

	* gtk/gtktextview.c (gtk_text_view_drag_motion): Fix drag-and-drop
	to default to GDK_ACTION_MOVE if the drag is within a single
	widget. Defaults to GDK_ACTION_COPY between widgets.

Mon Nov 13 14:43:48 2000  Owen Taylor  <otaylor@redhat.com>

	* demos/Makefile.am (test-inline-pixbufs.h): Fix srcdir != builddir

	* gtk/Makefile.am (INCLUDES): Add -I$(builddir)/gtk

	* gtk/stock-icons/Makefile.am (gtkstockpixbufs.h): Handles
	srcdir != builddir

	* modules/input/Makefile.am (INCLUDES): add $(top_srcdir)/gdk

	* configure.in (GTK_VERSION): Up to 1.3.2

	* modules/input/Makefile.am (im_xim_la_SOURCES): Add 
	gtkimcontextxim.h

	* gtk/gtkimcontext.c (gtk_im_context_get_preedit_string): Add
	missing doc comment.

2000-11-14  Alexander Larsson  <alexl@redhat.com>

	* modules/linux-fb/basic.c:
	Use the glib iconv wrappers.

2000-11-13  Havoc Pennington  <hp@pobox.com>

	* demos/gtk-demo/textview.c: spiff up the demo a bit; reveals
	still more bugs.

	* gtk/gtktextview.c (gtk_text_view_value_changed): don't try to
	scroll the GdkWindows before realization.

2000-11-13  Havoc Pennington  <hp@redhat.com>

	* gtk/gtktextdisplay.c (gtk_text_render_state_update): fix bug 
	where GC didn't always get updated properly

	* demos/gtk-demo/textview.c (create_tags): Use subattributes
	of fonts instead of setting the entire font

	* gtk/testtext.c (fill_example_buffer): Use "size" instead of
	setting entire font

	* gtk/gtkdialog.c (gtk_dialog_add_button): Fix some warnings

	* gtk/gtktexttag.h, gtk/gtktexttag.c: Explode font_desc into 
	a bunch of individually-settable font attributes. You can still 
	use the "font" and "font_desc" args, they just set all the font
	attributes at once.

2000-11-13 Elliot Lee <sopwith@redhat.com>

	* gdk/gdk.h: Add a couple of missing G_GNUC_CONST's.

Mon Nov 13 14:29:32 2000  Jonathan Blandford  <jrb@redhat.com>

	* gtk/gtktreemodel.c (gtk_tree_path_copy): confirm path != NULL
	* gtk/gtktreemodel.c (gtk_tree_path_free): ditto

	* gtk/gtktreemodelsort.c (gtk_tree_model_sort_insert_value): make
	work better.

2000-11-13  Havoc Pennington  <hp@redhat.com>

	* gtk/gtkimmodule.c (gtk_im_module_init): Free the filename of 
	the module file.

	* gtk/gtktexttag.c (gtk_text_attributes_copy): fix memory leak of
	dest->language

	* gtk/testtext.c: Test pixels above/below/inside paragraphs
	settings

	* gtk/gtktextview.c: Implement object args and setters/getters for
	all the aspects of the GtkTextAttributes that are not set from
	GtkWidget attributes. This is spacing, justification, margins,
	etc.

	(gtk_text_view_set_arg)
	(gtk_text_view_get_arg): implement get/set for editable, wrap mode
	args
	(gtk_text_view_class_init): Add args for justify, left_margin,
	right_margin, indent, and tabs
	

	* gtk/gtktextlayout.c (set_para_values): fix to display indent
	attribute properly

	* gtk/gtktexttag.c: Remove left_wrapped_line_margin attribute, 
	replace with indent attribute

	* gtk/gtktextlayout.c (set_para_values): multiply indent by
	PANGO_SCALE

	* gtk/gtktextdisplay.c (render_para): Use PangoLayoutIter,
	rearranging code to do that
	(gtk_text_layout_draw): Pass in the y for the whole LineDisplay,
	i.e. don't subtract the top_margin first, just to keep
	all margin-futzing in one place.

	* gdk/gdkpango.c (gdk_draw_layout): Use PangoLayoutIter

	* gtk/gtktextlayout.c (gtk_text_layout_get_iter_location): Remove
	special case of last line, Pango now handles this itself.
	(gtk_text_layout_get_iter_at_pixel): Fix incorrect clamp of the 
	Y coordinate
	(gtk_text_layout_move_iter_to_x): port to use PangoLayoutIter
	(find_display_line_above): wasn't moving the byte index as it
	iterated over lines, so always returned byte 0. Also, port to use
	PangoLayoutIter.
	(find_display_line_below): same problem as
	find_display_line_above. Also, port to use PangoLayoutIter.

2000-11-13  Alexander Larsson  <alexl@redhat.com>

	* gdk/linux-fb/*.[ch]:
	Massive reindent to gtk+ standard. My hands hurt.

	* gdk/linux-fb/gdkcolor-fb.c:
	Move GdkColorPrivateFB from inherited to windowing_data

	* gdk/linux-fb/gdkcursor-fb.c:
	_gdk_cursor_new_from_pixmap made static

	* gdk/linux-fb/gdkdnd-fb.c:
	GdkDragContextPrivate moved to windowing_data

	* gdk/linux-fb/gdkdrawable-fb2.c:
	Removed endian.h, use glib endianness macros instead
	Some cleanups in the usage of GDK_DRAWABLE_FBDATA
	and GDK_DRAWABLE_IMPL_FBDATA

	* gdk/linux-fb/gdkfont-fb.c:
	Add empty gdk_font_load(). Needed for linking of Gtk+.

	* gdk/linux-fb/gdkimage-fb.c:
	Removed endian.h, use glib endianness macros instead
	Moved GdkImagePrivateFB to windowing_data
	gdk_image_new_bitmap didn't always allocate enough
	memory.

	* gdk/linux-fb/gdkinput-ps2.c:
	Added semi-working support for MS serial mice.

	* gdk/linux-fb/gdkprivate-fb.h:
	s/GdkWindowPrivate/GdkWindowObject/
	Removed GdkWindowPrivate typedef
	s/GDK_DRAWABLE_P/GDK_DRAWABLE_FBDATA/
	Removed GDK_DRAWABLE_P
	Move GdkColorPrivateFB from inherited to windowing_data
	Moved GdkImagePrivateFB to windowing_data

	* gdk/linux-fb/gdkvisual-fb.c:
	Removed some unused debug code.

	* gdk/linux-fb/gdkwindow-fb.c:
	Use stock cursors instead of including X headers.
	s/GdkWindowPrivate/GdkWindowObject/

	* gdk/linux-fb/mitypes.h:
	Removed unused types.

	* modules/linux-fb/basic.c:
	Use the pango fribidi wrappers.

2000-11-13  Sebastian Wilhelmi  <wilhelmi@ira.uka.de>

	* gdk/linux-fb/gdkcolor-fb.c, gdk/nanox/gdkmain-nanox.c,
	gdk/win32/gdkcolor-win32.c, gdk/win32/gdkwin32id.c,
	gdk/x11/gdkcolor-x11.c, gdk/x11/gdkvisual-x11.c, gdk/x11/gdkxid.c,
	gtk/gtkgc.c, gtk/gtkrc.c, gtk/gtktext.c: GCompareFunc ->
	GEqualFunc where applicable.
	
	* gdk/linux-fb/gdkpango-fb.c: pango_font_description_compare ->
	pango_font_description_equal as changed in pango.
	
	* gdk/nanox/gdkmain-nanox.c: gdk_xid_compare -> gdk_xid_equal.

	* gdk/win32/gdkcolor-win32.c: gdk_colormap_cmp -> gdk_colormap_equal.

	* gdk/win32/gdkwin32id.c: gdk_handle_compare -> gdk_handle_equal.

	* gdk/x11/gdkcolor-x11.c: gdk_colormap_cmp -> gdk_colormap_equal.

	* gdk/x11/gdkvisual-x11.c: gdk_visual_compare -> gdk_visual_equal.

	* gdk/x11/gdkxid.c: gdk_xid_compare -> gdk_xid_equal.

	* gtk/gtkgc.c: gtk_gc_key_compare -> gtk_gc_key_equal and
	gtk_gc_drawable_compare -> gtk_gc_drawable_equal.

	* gtk/gtkrc.c: gtk_rc_style_compare -> gtk_rc_style_equal and
	gtk_rc_styles_compare -> gtk_rc_styles_equal.

2000-11-12  Havoc Pennington  <hp@pobox.com>

	* demos/gtk-demo/Makefile.am (democodedir): change demo install
	dir to datadir/gtk+-2.0/demo

	* demos/gtk-demo/textview.c: Text widget demo; reveals all 
	sorts of text widget and Pango font bugs. Urgh.

	* demos/gtk-demo/Makefile.am (demos): Add textview.c

	* demos/gtk-demo/main.c (create_tree): Add instructions at top of
	tree that you should double click to see the demo. Fix 
	types of variables to reflect changed return values from 
	GtkTreeStore and GtkTreeViewColumn constructors.

	* gtk/gtktextbuffer.c (gtk_text_buffer_new): ref/sink the
	newly-created buffer to prepare for GObject semantics

	* gtk/testtext.c: don't leak the buffer with GObject semantics

	* gtk/testtextbuffer.c: ditto
	
2000-11-12  Havoc Pennington  <hp@pobox.com>

        Rename this testgtk to gtk-demo to avoid confusion, and 
	install it so people can use it as a supplement to 
	the documentation.
	
        * demos/gtk-demo: Moved from demos/testgtk

	* demos/testgtk: Removed

	* configure.in: make Makefile in gtk-demo
	
	* demos/gtk-demo/Makefile.am: Install sample source to 
	datadir/gtk-demo (maybe there's a better place?), and 
	rename the binary to gtk-demo
	
	* demos/gtk-demo/main.c (load_file): Load installed sample
	source if source isn't found in pwd.

2000-11-09  Havoc Pennington  <hp@pobox.com>

	* gtk/gtkentry.c (gtk_entry_class_init): Add an "invisible_char" 
	argument to set the char displayed when visibility == FALSE
	(gtk_entry_create_layout): If !entry->visible, replace 
	all chars with the "invisible char"

	* gtk/testgtk.c: Test the invisible_char deal
	
Mon Nov 13 02:16:33 2000  Robert Brady  <robert@suse.co.uk>

	* gtk/gtkstyle.c (gtk_style_init): Fall back to "fixed" if we
	can't get a native font in the right encoding.

Mon Nov 13 00:09:29 2000  Robert Brady  <robert@suse.co.uk>

	* configure.in: Chinese .pos have been renamed to zh_CN and zh_TW
	respectively.

Sun Nov 12 19:11:42 2000  Owen Taylor  <otaylor@redhat.com>

	* gtk/gtktextlayout.c (gtk_text_layout_move_iter_to_next_line):
	Fix warning when moving between paragraphs.

	* gtk/gtkentry.[ch]: Change move => move_cursor, 
	delete => delete_from_cursor, insert => insert_at_cursor

Sun Nov 12 22:52:51 2000  Robert Brady  <robert@suse.co.uk>

	* modules/input/imviqr.c: A vietnamese VIQR-based input method.

	* modules/input/imthai-broken.c: A Thai input method for use if
	Thai keys are really generating Latin1 keysyms.

	* modules/input/Makefile.am: Build these.

Sun Nov 12 22:15:35 2000  Robert Brady  <robert@suse.co.uk>

	* gtk/gtkfileselection.c, gdk/win32/gdkfont-win32.c: 
	g_filename_{to,from}_utf8 now takes an extra parameter.

	* gtk/gtkcalendar.c (gtk_calendar_init): Convert output of
	strftime into UTF-8.

	(column_from_x, gtk_calendar_paint_day_names): Support RTL
	calendars.

	(gtk_calendar_paint_day_names): Draw day names in the right 
	place.
	
Sun Nov 12 14:10:09 2000  Owen Taylor  <otaylor@redhat.com>

	* gdk/x11/gdkselection-x11.c (gdk_utf8_to_compound_text): Fix
	problem with using result of g_get_charset() backwards -
	pointed out by Mikael Hermansson <mikeh@bahnhof.se>.

	* gtk/gtkwindow.c (gtk_window_compute_hints): Support
	negative min_width/height and max_width/height to
	mean "requisition"; this allows setting a window
	to be user-resizable in only one direction easily.

	* gtk/testgtk.c (create_main_window): Remove hard-coded
	usize - set a default size in the vertical direction.

Sun Nov 12 13:33:01 2000  Owen Taylor  <otaylor@redhat.com>

	* gtk/gtkrange.c: Add some missing casts. Support 
	2 and 3 button clicks on the arrows to mean 
	"move by pages" and "jump to end". (Like gtkspinbutton)

2000-11-12 Hans Breuer <Hans@Breuer.Org>

	* gdk/win32/makefile.msc : reflect build module changes

	* gdk/win32/gdkcursor-win32.c : can't cast to impl type directly
	from GdkPixmap*, cast implementation member instead.

	* gdk/win32/gdkdrawable-win32.c (gdk_win32_draw_drawable) : The
	passed in drawable is of type GdkDrawableImplWin32, the GdkPixmap *src 
	maybe either GdkDrawable or GdkDrawableImpl. Corrected all casts, add
	more Gdi functions return value checking. 
	(gdk_win32_draw_image) : use IMAGE_PRIVATE_DATA to get on the
	GdkImagePrivateWin32 *.

	* gdk/win32/gdkevents-win32.c : Disable the SetCapture call to make
	menus useable again. Add #pragma message to keep reminded on this issue.
	(gdk_event_translate) : don't generate GDK_EXPOSE events for InputOnly
	windows. This allows to enable backing store on Win32!

	* gdk/win32/gdkimage-win32.c (_gdk_win32_get_image) : the passed
	in drawable is of impl type. Correct specific type checks appropriate.
 
	* gdk/win32/gdkpixmap-win32.c (gdk_pixmap_create_from_data) : check 
	GDK_WINDOW_DESTROYED before allocating new resources.

	* gdk/win32/gdkselection-win32.c : Handle GDK_WINDOW_DESTROYED case

	* gdk/win32/gdkwindow-win32.c : more Gdi return value checking,
	(gdk_window_foreign_new) initialize parent handle.
	(gdk_window_destroy_notify) add GDK_IS_WINDOW check

	* gdk/win32/gdkgeometry-win32.c (_gdk_window_move_resize_child) :
	Let the GDI invalidate the window on MoveWindow call to fix scrolling
	problems (e.g. main buttons in testgtk). 

Sat Nov 11 23:07:30 2000  Owen Taylor  <otaylor@redhat.com>

	* gtk/gtkentry.c (gtk_entry_key_press): Call 
	gtk_widget_activate for GDK_Return.

	* gtk/gtkentry.c (gtk_entry_preedit_changed_cb): Fix handling
	of preedit cursor position.

Sun Nov  5 04:24:53 2000  Owen Taylor  <otaylor@redhat.com>

	* gtk/gtkcellrenderertextpixbuf.c: Make parent_class
	static.

Tue Sep 19 10:54:22 2000  Owen Taylor  <otaylor@redhat.com>

	* modules/input/{gtkimcontextxim.[ch],imxim.c}: Rip
	out support for multiple locales; that simple doesn't
	work reliably with current Xlib

	* gtk/gtkimcontext*.[ch] gtk/gtkimmulticontext.[ch]
	gtk/gtktextlayout.[ch] gtk/gtktextview.c gtk/gtkentry.c: 
	Add support for positioning the cursor within the preedit string.

Mon Sep 18 23:56:32 2000  Owen Taylor  <otaylor@redhat.com>

	* modules/input/{imxim.c,gtkimcontextxim.[ch]}: Start
	at XIM input method module.

	* gtk/gtktextview.c: Check for bindings after passing
	events to im context filter.

Mon Sep 18 11:50:51 2000  Owen Taylor  <otaylor@redhat.com>

	* gtk/gtktextlayout.c (add_preedit_attrs): Handle
	empty attribute lists properly.

Sun Sep 17 10:08:16 2000  Owen Taylor  <otaylor@redhat.com>

	* gtk/queryimmodules.c (main): Return non-zero exit
	status if errors were encountered querying any
	modules.

	* modules/input/Makefile.am (moduledir): remove
	leftover bin program target.

	* docs/make-todo: Fix typo in error message.

Sat Sep 16 14:04:30 2000  Owen Taylor  <otaylor@redhat.com>

	* configure.in: Add modules/input/Makefile

Sat Sep 16 14:01:52 2000  Owen Taylor  <otaylor@redhat.com>

	* gtk/gtk.h: include gtkmodule.h gtkoldeditable.h,
	don't include gtkthemes.h.

	* gtk/testgtk.c gtk/testtext.c: Set environment variables
	to point

	* gtk/Makefile.am: Add new .c and .h files, build 
	gtk-query-immodules and use it to create a gtk.immodules
	file for use of test programs.

	* gtk/gtkpreview.c: remove extra blank line.

Sat Sep 16 13:21:04 2000  Owen Taylor  <otaylor@redhat.com>

	* gtk/gtkimcontextsimple.c (gtk_im_context_simple_add_table): 
	Add the ability to add extra tables beyond the default
	one, and also the ability to have compose sequences 
	that are prefixes of other compose sequences. 

	* gtk/gtkimcontextsimple.c: Export a preedit string which
	consists of possible candidates for keystrokes that have
	been entered but not yet committed.

	* gtk/gtkimcontext.[ch] gtk/immulticontext.[ch]
	gtk/gtkimcontextsimple.[ch]: add gtk_im_context_reset()

	* gtk/gtkmulticontext.[ch] (gtk_im_multicontext_append_menuitems): 
	Add a function to add input-method switching menu items
	to a menu.

	* gtk/gtkimmulticontext.[ch]: Properly handly set_client_window
	when switching input methods.

	* gtk/gtkimcontextsimple.[ch]: Change the format of
	the compose table to allow compose tables of different
	lengths / sequence.

Sat Sep 16 13:05:48 2000  Owen Taylor  <otaylor@redhat.com>

	* gtk/gtkimmodule.[ch]: Support routines for loading
	GtkIMContext implementations dynamically at runtime.

	* modules/input/imcyrillic-translit.c: A sample input
	method (based on GtkIMContextSimple with an extra table),
	which demonstrates preedit strings and the module
	system for input modules

	* gtk/queryimmodules.c: Program to query the available
	input modules and write the results into a file.
	 
	* gtk/gtkrc.[ch] (gtk_rc_get_im_module_file): Add
	extra config options "im_module_file" (cache file for
	input method modules), and "im_module_path" - path
	to look for modules when generating cache file.

	This doesn't scale.

Sat Sep 16 13:09:06 2000  Owen Taylor  <otaylor@redhat.com>

	* gtk/gtkthemes.[ch] gtk/gtkmodule.[ch]: Move most of the 
	generic	code from gtkthemes into a new abstraction
	GtkModule which has the logic for implementing
	a loadable module which implements a number of 
	GObject types.

Sat Sep 16 13:07:13 2000  Owen Taylor  <otaylor@redhat.com>

        * gtk/gtkeditable.[ch]: Convert GtkEditable from
	a class into an interface  
	
	* gtk/gtkoldeditable.[ch]: Move the old editable
	implementation into here, so legacy widgets can
	still rely on the implemenation. GtkOldEditable
	exports GtkEditable. Make selection handling
	code use new text conversion functions (and
	handle UTF-8 as a side-effect). Use GtkClipboard
	for CLIPBOARD.

	* gtk/gtktext.[ch] gtk/gtkcombo.c gtk/gtkspinbutton.c:
	Adopt to match above changes.

	* gtk/gtkentry.[ch]: Implement GtkEditable directly,
	avoid GtkOldEditable implementation. Restructure
        to reduce number of places that modify state directly.
	Move to GtkBindingSet. Display the preedit string.
	Queue recomputation of PangoLayout and scroll position
	to improve effiency of doing complex changes naively.
	Add a menu with cut/copy/paste and input method selection.

Thu Sep 14 22:11:05 2000  Owen Taylor  <otaylor@redhat.com>

	* gtk/gtktextlayout.[ch]: Add gtk_text_layout_set_preedit_string()
	to set preedit string and attributes; display preedit string by
	inserting string and attributes at cursor when creating the
	GtkTextLineDisplay.

	* gtk/gtktextlayout.c: Move all conversions between byte
	positions in PangoLayout and GtkTextIter into new functions
	line_display_iter_to_index/index_to_iter that properly
	handle the preedit string.

	* gtk/gtktextmark.[ch]: Restore gtk_text_mark_get_name, modify
	it to return const char * (eventually will end up
	as GCONST char *, most likely.)

	* gtk/gtktextview.[ch]: Handle the preedit string, call
	gtk_im_context_reset() as necessary, add a menu to switch
	input methods.
	
	* gtk/gtktextlayout.[ch]: Remove useless
	gtk_text_layout_get_log_attrs() function.

2000-11-11  Tor Lillqvist  <tml@iki.fi>

	* gdk/gdk.def
	* gtk/gtk.def: Update.

	* gdk/win32/*.c: Add last argument to g_type_register_static()
	calls.

	* gdk/win32/gdkwindow-win32.c: Silence gcc -Wall.

	* gdk/win32/gdkevents-win32.c: Handle MSH_MOUSEWHEEL messages
	generated by older wheel mouse drivers. Get the correct y
	coordinate from WM_MOUSEWHEEL messages.

	* gdk/win32/gdkgc-win32.c (gdk_win32_cap_style_to_string,
	gdk_win32_fill_style_to_string, gdk_win32_function_to_string,
	gdk_win32_join_style_to_string, gdk_win32_line_style_to_string):
	Debugging functions.

	* gdk/win32/gdkprivate-win32.h: Declare them.

	* gdk/win32/gdkinput-win32.h: Add declaration for
	gdk_input_window_destroy().

	* gtk/makefile.mingw.in: Pass -DGTK_VERSION. Add gtktreemodel.o.

Fri Nov 10 19:06:41 2000  Jonathan Blandford  <jrb@redhat.com>

	* gtk/gtktreemodelsort.c (gtk_tree_model_sort_insert_value): New
	function to help handle keeping things in sync.

Fri Nov 10 12:10:34 2000  Jonathan Blandford  <jrb@redhat.com>

	* gtk/gtkliststore.c (gtk_model_simple_class_init): use the new
	BOXED marshallers.

	* gtk/gtkliststore.c (gtk_list_store_get_column_type): Add this.
	(gtk_list_store_class_init): use the new BOXED marshallers.

	* gtk/gtktreestore.c (gtk_tree_store_new_with_types): change
	new_with_values to new_with_types.
	(gtk_tree_store_get_column_type): add this.
	(gtk_tree_store_class_init): use the new BOXED marshallers.

	* gtk/gtkmarshal.list: Added a number of BOXED marshallers to
	mirror some POINTER marshallers.

Thu Nov  9 11:23:22 2000  Jonathan Blandford  <jrb@redhat.com>

	* gtk/gtktreemodel.h (struct _GtkTreeIter): added more fields to
	allow more interesting iterators.  Also, made the lifecycle of
	iterators more explicit.

	* gtk/gtktreemodelsort.[ch]: New model for sorting.

	* gtk/gtk-boxed.defs (GtkTreeIter, GtkTreePath): Added two boxed
	types.

2000-11-09  Alexander Larsson  <alexl@redhat.com>

	* demos/testgtk/menus.c:
	Changes to make the new testgtk compile after
	gtk_menu_append was removed.

	* gdk/linux-fb/gdkdrawable-fb2.c
	(gdk_fb_get_depth, gdk_fb_get_visual,
	gdk_drawable_impl_fb_class_init): Implement
	these drawable functions. Now GtkImages work again.

	* gdk/linux-fb/gdkimage-fb.c (_gdk_fb_get_image): Change prototype.

	* gdk/linux-fb/gdkprivate-fb.h (_gdk_fb_get_image): Change prototype.
	
	* gdk/linux-fb/gdkmain-fb.c (fb_modes_parse_mode,
	gdk_fb_setup_mode_from_name, gdk_fb_set_mode, gdk_fb_display_new);
	Parse /etc/fb.modes, use the environment variables GDK_DISPLAY_MODE,
	GDK_DISPLAY_DEPTH, GDK_DISPLAY_WIDTH, GDK_DISPLAY_HEIGHT.

2000-11-08  Havoc Pennington  <hp@pobox.com>

	* gtk/gtktexttag.c (gtk_text_tag_class_init): Add visible and
	visible_set args, don't know where these had gone, I thought they
	used to be there

	* gtk/testtext.c: Add a menu item to apply invisibility tag;
	now we can test the feature and see that it's totally broken.

2000-11-08  Havoc Pennington  <hp@pobox.com>

        Make DND copy pixbufs and tags when source and target share a 
	tag table.
	
	* gtk/gtktextview.c (gtk_text_view_drag_data_get): provide the
	in-process GTK_TEXT_BUFFER_CONTENTS target
	(gtk_text_view_drag_data_received): Paste from
	GTK_TEXT_BUFFER_CONTENTS if we receive it.

2000-11-08  Alexander Larsson  <alexl@redhat.com>

	* docs/Changes-2.0.txt: Add note about GtkMenuPositionFunc
	API changes.

	* gtk/gtkmenu.c: Add support for scrolling menus.
	Remove gtk_menu_append/prepend/insert, these have been moved to
	gtkcompat.h as #defines.

	* gtk/gtkcompat.h.in:
	Add compatibility #defines for gtk_menu_append/prepend/insert

	* gtk/gtkmenu.h: Add data needed for scrolling menus.
	GtkMenuPositionFunc gets an extra argument push_in.
	gtk_menu_append/prepend/insert removed.
	
	* gtk/gtkmenuitem.c (gtk_menu_item_position_menu): Change menu
	positioning behaviour to fit to scrolling menus.

	* gtk/gtkmenuitem.c (gtk_menu_item_forall): Don't recurse
	into menuitem->submeny. That is wrong, and broke torn
	off submenus of torn off menus, since they were unrealized
	when the first menu was unrealized.

	* gtk/gtkmenushell.[ch]: Virtualize gtk_menu_shell_insert() and
	gtk_menu_shell_select_item() since these need to be overridden in
	GtkMenu.

	* gtk/gtkoptionmenu.c (gtk_opttion_menu_position): Change menu
	positioning behaviour to fit to scrolling menus.
	(gtk_option_menu_key_press, gtk_option_menu_button_press): Select
	the current item so that it is prelighted when the menu pops up.
	This is a workaround to the fact that the menu doesn't get the
	initial enter event (due to grabs).

	* gtk/gtkfilesel.c, gtk/gtkinputdialog.c, gtk/testgtk.c:
	s/gtk_menu_append/gtk_menu_shell_append/

	* gtk/gtknotebook.c:
	s/gtk_menu_insert/gtk_menu_shell_insert/

	* gtk/testgtk.c (create_menu, create_menus):
	Create the first menu with 50 items so that menu scrolling
	can be tested.
	
	
	Patch from Jonathan Blandford  <jrb@redhat.com>

	* gtk/gtkmenuitem.[ch] (gtk_menu_item_toggle_size_request): new
	system to handle size requests.  First, we ask what the size of
	the toggle is.  Then, when allocating the size, we allocate the
	toggle_size first.  This way we can have multiple menu-item
	classes w/o needing a seperate class for each.

	* gtk/gtkmenu.c (gtk_menu_size_request): Actually use the new system.
	* gtk/gtkmenu.c (gtk_menu_size_allocate): Use the new system.

	* gtk/gtkcheckmenuitem.c
	(gtk_check_menu_item_toggle_size_request): New function to handle
	the toggle size-request.

2000-11-07  Havoc Pennington  <hp@redhat.com>

	* gtk/gtktextlayout.c (gtk_text_layout_get_iter_location):
	Half-ass somewhat fix this function, so that scrolling to the
	insertion point works. Pango hacking is in the future to really
	fix it.

	* gtk/gtktextview.c (gtk_text_view_drag_data_get): Don't calculate
	length of data, no longer used.

	* gtk/gtktextbuffer.c (gtk_text_buffer_finalize): move destroy
	method contents in here, get rid of destroy method
	(gtk_text_buffer_insert_range): Fix some g_return_if_fail checks
	that were backward. Remove debug spew.
	(cut_or_copy): Make the clipboard work with insert_range to
	preserve tags and pixbufs, not just the primary selection.

2000-11-07  Havoc Pennington  <hp@redhat.com>

	* gtk/gtktextmark.c (gtk_text_mark_is_visible): rename 
	to gtk_text_mark_get_visible

	* gtk/gtktextlayout.c (gtk_text_layout_move_iter_to_line_end): fix
	bug that was generating an invalid iterator

	* gtk/gtktextiter.c (gtk_text_iter_get_offset): move call to
	ensure_char_offsets() in front of code placing the iter in an
	invalid state.

	* gtk/gtktextbuffer.c (gtk_text_buffer_paste_primary):
	make override_location arg const
	(paste): Replace the selection if we paste into the 
	current selection

	* gtk/gtkselection.h: Remove "GtkSelectioData"
	(struct _GtkSelectionData): move the definition here.

	* gtk/gtktextbuffer.c (gtk_text_buffer_update_primary_selection):
	Export the GTK_TEXT_BUFFER_CONTENTS target for in-process copies

	* gtk/gtktextiter.c (gtk_text_iter_get_tags): New function

	* gtk/gtktextbuffer.c (gtk_text_buffer_insert_range): implement
	(gtk_text_buffer_insert_range_interactive): implement
	(gtk_text_buffer_get_tags): Remove, replaced by
	gtk_text_iter_get_tags()

	* gtk/gtktextiter.c (gtk_text_iter_forward_search): Add a search
	limit parameter, to avoid infinite linear scan.
	(gtk_text_iter_backward_search): Add search limit
	(gtk_text_iter_forward_find_char): Add search limit
	(gtk_text_iter_backward_find_char): Add search limit

2000-11-07  Alexander Larsson  <alla@lysator.liu.se>

	* gdk/linux-fb/gdkcolor-fb.c, gdk/linux-fb/gdkdnd-fb.c,
	gdk/linux-fb/gdkgc-fb.c, gdk/linux-fb/gdkimage-fb.c,
	gdk/linux-fb/gdkpango-fb.c, gdk/linux-fb/gdkpixmap-fb.c,
	gdk/linux-fb/gdkwindow-fb.c:
	use g_object_new() instead of g_type_create_instance() which
	is a private function for fundamental type implementations.

	* gdk/linux-fb/gdkinput-ps2.c:
	Use MEDIUMRAW instead of RAW keycodes. Remove keyboard state-table
	instead just store the current modifier state. Add a (somewhat broken)
	keyboard input parser for XLATE mode too, if we couldn't use MEDIUMRAW.
	Rename exported function gdk_input_ps2_get_mouseinfo to
	gdk_input_get_mouseinfo.

	* gdk/linux-fb/gdkmain-fb.c, gdk/linux-fb/gdkprivate-fb.h,
	gdk/linux-fb/gdkwindow-fb.c:
	gdk_input_ps2_get_mouseinfo was renamed to gdk_input_get_mouseinfo.
	

2000-11-02  Havoc Pennington  <hp@redhat.com>

	* gtk/gtkfilesel.h, gtk/gtkfilesel.c: Derive from GtkDialog,
