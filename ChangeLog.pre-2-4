Tue Nov 26 14:16:15 2002  HideToshi Tajima  <hidetoshi.tajima@sun.com>

	* modules/input/gtkimcontextxim.c
	(gtk_im_context_xim_filter_keypress):
	Fix #99593: Fix a memory leak when XmbLookupString returns
	XBufferOverflow

2002-11-25  Tor Lillqvist  <tml@iki.fi>

	* gdk/win32/gdkevents-win32.c (print_event_state,
	print_window_state, print_event): Enclose in #ifdef
	G_ENABLE_DEBUG, as they use functions only available with
	G_ENABLE_DEBUG, and are called only when G_ENABLE_DEBUG. (#99494,
	Arnaud Charlet)

2002-11-24  Tor Lillqvist  <tml@iki.fi>

	* gdk/win32/gdkdrawable-win32.c: Remove the already ifdeffed-out
	code that didn't use generic_draw.

	(generic_draw): When drawing into the mask (for tiled/stippled
	fill styles), copy the line attributes from the actual GC. Also
	ask for text drawing setup if needed. Use differently set up HDCs
	in the normal and tiled/stippled cases.

	(draw_segments) Slight code reorg.

	(draw_lines, gdk_win32_draw_lines): Use generic_draw() also for
	lines.

	* gdk/win32/gdkgc-win32.c: Remove ifdeffed-out code.

	(predraw_set_foreground, gdk_win32_hdc_get): Some code moved
	around. Call SetROP2() only if necessary. Call SetTextColor() only
	if GDK_GC_FOREGROUND flag present.

	Remove background color handling from here. The background color
	of a GdkGC is supposed to affect only GDK_OPAQUE_STIPPLED fill style,
	which it is already handled in generic_draw(), and
	GDK_LINE_DOUBLE_DASH lines, which aren't implemented properly
	anyway. Calling SetBkColor() is unnecessary.

	(gdk_win32_hdc_get, gdk_win32_hdc_release): Add doc comments, as
	these are public functions.

2002-11-23  Tor Lillqvist  <tml@iki.fi>

	* gdk/win32/gdkdrawable-win32.c (draw_polygon,
	gdk_win32_draw_polygon, draw_segments, gdk_win32_draw_segments):
	Use generic_draw() also for polygons and segments, thus adding
	support for tiled and stippled polygons and segments.

	(gdk_win32_draw_points): Use Rectangle() instead of
	SetPixel(). Rectangle() uses the function (raster op) set for the
	HDC, SetPixel() doesn't.

	(widen_bounds): New function, refactoring.
	
	* gdk/win32/gdkgc-win32.c (predraw_set_foreground): Ifdef out the
	GDK_OPAQUE_STIPPLED handling here, has been superseded by the code
	in generic_draw(). Always create a solid brush.
	
2002-11-22  Tor Lillqvist  <tml@iki.fi>

	* gdk/win32/gdkdrawable-win32.c (draw_arc, gdk_win32_draw_arc):
	Use generic_draw() also for arcs, thus adding support for tiled
	and stippled arcs.

	* gdk/win32/gdkevents-win32.c (synthesize_expose_events): Don't
	synthesize expose events for GDK_INPUT_ONLY windows.
	(gdk_event_translate): On WM_SIZE, call
	gdk_synthesize_window_state() if window was iconified, restored or
	maximized. (#98983, Arnaud Charlet)

	* gdk/win32/gdkmain-win32.c
	* gdk/win32/gdkpixmap-win32.c: Minor debugging output changes.

	* gdk/win32/gdkwindow-win32.c (gdk_window_new): Revert change from
	2002-11-19: Don't need to set depth of GDK_INPUT_ONLY windows to
	nonzero. It was synthesize_expose_events() (see above) that was
	causing the trouble with them in 256-colour mode.

2002-11-21 15:48:13 2002 Dan Mills  <thunder@ximian.com>

	* configure.in: replace gtk-doc version check with an all-sh
	version that works better (#99216).

Wed Nov 20 20:35:14 2002  Kristian Rietveld  <kris@gtk.org>

	* ==== Released 2.0.9 ====

	* configure.in: Version 2.0.9, interface, binary age 9.

	* NEWS: updated.

Wed Nov 20 19:42:57 2002  Kristian Rietveld  <kris@gtk.org>

	Merged treeview fixes from HEAD.

	* gtk/gtkrbtree.c (gtk_rbtree_reorder_sort_func): return a value
	in the range of [-1, 1] instead [0, 1],
	(gtk_rbtree_reorder_invert_func): ditto,
	This makes treeview reordering working on platforms as FreeBSD and
	solaris, thanks go to Heiner Eichmann for finding this out and
	sending in a patch (#98251). 

	* gtk/gtktreestore.c (node_free): only free the data list if
	node->data is not NULL,
	(gtk_tree_store_remove): free the data list from the node if
	needed. (#94728, pointed out by Peter Bloomfield). 

	* gtk/gtktreeview.c (gtk_tree_view_remove_column): stop editing
	and set the edited_column to NULL if edited_column is set.
	(#91288, modified patch from Josh Parsons). 

	* gtk/gtkcellrenderertext.c (gtk_cell_renderer_text_start_editing):
	only _set_text if celltext->text is not NULL. (#97815, reported
	and testcase provided by Vitaly Tishkov).

	* gtk/gtktreeselection.c (gtk_tree_selection_real_modify_range):
	also update the anchor_path, makes behaviour consistent with the
	other selection modification functions. (#96801, reported and
	testcase provided by Vitaly Tishkov).

2002-11-20  Tor Lillqvist  <tml@iki.fi>

	Fix by Arnaud Charlet (#98983):

	* gtk+/gdk/win32/gdkwindow-win32.c
	(gdk_window_get_frame_extents): Fix typo in setting y.

2002-11-19  Tor Lillqvist  <tml@iki.fi>

	* gdk/win32/gdkwindow-win32.c (gdk_window_new): Yes, my change on
	2002-11-14 to gdkpixmap-win32.c:gdk_pixmap_new() broke palettized
	(256-colour) display slightly: For some reason
	GdkWindowObject::depth of GDK_INPUT_ONLY windows now needs to be
	set to the visual's depth, even if the X11 backend sets it to
	zero. Otherwise, on a palettized display, gdk_pixmap_new() when
	called from gdk_window_begin_paint_region() would get zero from
	gdk_drawable_get_depth(), and fail.

2002-11-15  Tor Lillqvist  <tml@iki.fi>

	* gdk/win32/gdkprivate-win32.h
	* gdk/win32/gdkglobals-win32.c
	* gdk/win32/gdkmain-win32.c
	* gdk/win32/gdkdrawable-win32.c (generic_draw): Don't check if
	MaskBlt() is present in gdi32.dll, it is, even on Win9x. It just
	always returns failure on Win9x. Instead, call MaskBlt() only if
	we are on NT/2k/XP.

2002-11-14  Tor Lillqvist  <tml@iki.fi>

	Start implementing all fill styles (i.e. tiled, stippled, and
	opaque stippled in addition to the plain solid style) in the Win32
	backend in an elegant and generic way. For now only did the
	draw_rectangle() and draw_glyphs() methods. The rest will
	follow. Previously some of the drawing methods implemented opaque
	stippling, but not tiles or non-opaque stippling.

	Seems to work fine, now the check marks show up in check buttons,
	the stippled background and stippled text in gtk-demo's Text
	Widget look as they should, and GtkText's line wrap arrow shows
	correctly instead of an ugly rectangle.

	The implementation does do a lot of pixmap handling and blitting
	back and forth, especially on Win9x. But performance is hopefully
	not an issue. I don't think many applications do a lot of tiled or
	stippled drawing.

	* gdk/win32/gdkprivate-win32.h: Define a new macro, GDI_CALL, that
	calls a GDI function and prints a warning if it failed. Also
	API_CALL for non-GDI calls. Cleans all the the if (!BlaBla())
	WIN32_GDI_FAILED ("BlaBla") snippets, these can now be written
	GDI_CALL (BlaBla, ()).

	* gdk/win32/gdkdrawable-win32.c: Use GDI_CALL macro in lots of places.

	(generic_draw): New function that handles all the blitting
	necessary to implement tiles and stipples. A function that
	actually draws stuff is passed as a parameter to
	generic_draw(). If the fill style is solid, it is called
	directly, to draw on the destination drawable. Otherwise it is
	called to draw on a temporary mask bitmap, which then is used in
	blitting operations. The tiles and/or stipples are rendered into
	another temporary pixmap. If MaskBlt() is available (on NT/2k/XP),
	it is used, otherwise a sequence of BitBlt() is used to do the
	final composition onto the destination drawable.

	(draw_tiles_lowlevel, draw_tiles): Some renaming and code
	reorg. Use BitBlt() to blit each tile, not gdk_draw_drawable().

	(rop2_to_rop3): Instead of bitblt_wrapper, this function does the
	binary->ternary rop mapping.

	(draw_rectangle, gdk_win32_draw_rectangle, draw_glyphs,
	gdk_win32_draw_glyphs): Split functionality into two functions,
	with generic_draw() doing its magic inbetween.

	* gdk/win32/gdkevents-win32.c: Remove the TrackMouseEvent code, it
	was ifdeffed out and wouldn't have done anything even if
	enabled. Remove the GDK_EVENT_FUNC_FROM_WINDOW_PROC code, didn't
	have any effect any more anyway after all the changes GTK+ has
	gone through in the last years. Remove some #if 0 code.

	* gdk/win32/gdkgc-win32.c (gdk_gc_copy): Set the copy's hdc field
	to NULL in case a GC is copied while it has a Windows DC active.

	* gdk/win32/gdkprivate-win32.h
	* gdk/win32/gdkglobals-win32.c: Remove gdk_event_func_from_window_proc.
	Add mask_blt that points to MaskBlt() if available.
	
	* gdk/win32/gdkmain-win32.c: Remove -event-func-from-window-proc
	option. Check if MaskBlt() is available. If there is a
	PRETEND_WIN9X envvar, set windows_version as if on Win9x.

	* gdk/win32/gdkpixmap-win32.c (_gdk_win32_pixmap_new,
	gdk_pixmap_new): Combine these two, _gdk_win32_pixmap_new() wasn't
	used or exported. Make a bit more like the X11 version. Hopefully
	I didn't break the fragile palettized display ("pseudocolor")
	code.

2002-11-13  Christopher James Lahey  <clahey@ximian.com>

	* gdk/x11/gdkwindow-x11.c (gdk_window_impl_x11_get_colormap): Ref
	the colormap returned from gdk_colormap_lookup.

2002-11-13  Tor Lillqvist  <tml@iki.fi>

	* gdk/win32/gdkdrawable-win32.c (bitblt_wrapper): New
	function. Translates the GC's current binary raster op (rop2) to
	the appropriate ternary raster op and calls BitBlt(). Previously
	used SRCCOPY always.
	(blit_from_pixmap, blit_inside_window, blit_from_window): Use
	bitblt_wrapper().

	* gdk/win32/gdkgc-win32.c
	* gdk/win32/gdkmain-win32.c:: Various debugging output improvements.

	* gdk/win32/gdkgc-win32.c (predraw_set_foreground): Check whether
	tile/stipple origins are valid when calling SetBrushOrgEx().
	(gdk_win32_hdc_get): Ifdef out code that tries to handle the
	stipple by converting it into a region, and combining the clip
	region with that. A stipple shouldn't work like that, it should
	replicate in x and y directions. Stipples will have to be handled
	elsewhere.

	* gdk/win32/gdkmain-win32.c: (gdk_win32_gcvalues_mask_to_string,
	gdk_win32_rop2_to_string): New debugging functions.
	(gdk_win32_print_dc): Print also DC's rop2 and text color.

	* gdk/win32/gdkprivate-win32.h: Declare new functions.

2002-11-12  Tor Lillqvist  <tml@iki.fi>

	More work on the Win32 backend. The scrolling problem diagnosis
	from 2002-11-07 was wrong, even if the cure happened to work. The
	problems were not caused by a lack of WM_PAINT messages while
	scrolling. The real issue was that SetWindowPos() and
	ScrollWindowEx() don't blit those parts of the window they think
	are invalid. As we didn't keep Windows's update region in synch
	with GDK's, Windows thought those areas that in fact had been
	updated were invalid. Calling ValidateRgn() in
	_gdk_windowing_window_queue_antiexpose() seems to be an elegant
	and efficient solution, removing from Windows's update region
	those areas we are about to repaint proactively.

	In some cases garbage leftover values were used for the clip
	origin in GdkGCWin32. This showed up as odd blank areas around the
	pixmaps included in the Text Widget in gtk-demo.

	Having the clip region either as a GdkRegion or a HRGN in
	GdkGCWin32 was unnecessary, it's better to just use a HRGN.

	The translation and antiexpose queue handling in
	gdkgeometry-win32.c seems unnecessary (and not implementable in
	the same way as on X11 anyway, no serial numbers) on Windows,
	ifdeffed out.
	
	All of testgtk and gtk-demo except "big windows" now seem to work
	pretty well.

	Bug #79720 should be fixed now.
	
	* gdk/win32/gdkevents-win32.c (gdk_event_translate) In WM_PAINT
	handler: Don't check for empty update rect. When we get a
	WM_PAINT, the update region isn't empty. And if it for some
	strange reason is, that will be handled later anyway. Don't leak
	hrgn.

	* gdk/win32/gdkgc-win32.c:  Set clip origins to zero
	when appropriate.

	(gdk_gc_copy): Increase refcount on colormap if present.

	(gdk_win32_hdc_get): Handle just hcliprgn. If we have a stipple,
	combine it with clip region after selecting into the DC.

	(_gdk_win32_bitmap_to_hrgn): Rename from _gdk_win32_bitmap_to_region.

	(_gdk_win3_gdkregion_to_hrgn): New function, code snippet
	extracted from gdk_win32_hdc_get().

	* gdk/win32/gdkgeometry-win32.c: Ifdef out the translate_queue
	handling.

	(gdk_window_copy_area_scroll): Increase clipRect to avoid
	ScrollWindowEx() not scrolling pixels it thinks are invalid.
	Don't call UpdateWindow().

	(_gdk_window_move_resize_child): Don't call UpdateWindow().

	(gdk_window_premove, gdk_window_postmove,
	gdk_window_clip_changed): Add debugging output.

	(_gdk_windowing_window_queue_antiexpose): Just call ValidateRgn()
	on the region.

	(_gdk_window_process_expose): No use for the serial number
	parameter now. Instead of a rectangle, take a region parameter, as
	Windows gives us one in WM_PAINT.

	* gdk/win32/gdkmain-win32.c (gdk_win32_rect_to_string,
	gdk_win32_gdkrectangle_to_string, gdk_win32_gdkregion_to_string):
	New debugging functions.

	* gdk/win32/*.c: Use above functions.

	* gdk/win32/gdkwindow-win32.c (gdk_propagate_shapes): Plug memory
	leak, free list after use.

	* gdk/win32/gdkprivate-win32.h: Drop the clip_region field from
	GdkGCWin32. Only use the HRGN hcliprgn. Declare new functions.

	* gdk/win32/rc/gdk.rc.in: Update copyright year.

2002-11-10  Matthias Clasen  <maclas@gmx.de>

	* gtk/gtkstatusbar.c (gtk_statusbar_button_press): Don't start
	a drag on double click.  (#98189)

Fri Nov  8 14:44:43 2002  Owen Taylor  <otaylor@redhat.com>

	* ==== Released 2.0.8 ====

	* configure.in: Version 2.0.8, interface, binary age 8.

	* NEWS: Updated.

Thu Nov  7 18:09:42 2002  Owen Taylor  <otaylor@redhat.com>

	* gtk/gtkfilesel.c (open_new_dir): Escape invalid
	filename before printing it out, since it isn't
	a valid UTF-8 string. (#94676)

2002-11-07  Tor Lillqvist  <tml@iki.fi>

	* gdk/win32/gdkgeometry-win32.c (gdk_window_copy_area_scroll,
	_gdk_window_move_resize_child): Call UpdateWindow() after
	scrolling or moving/resizing the window. This causes a WM_PAINT
	message to be sent to the window procedure. Improves scrolling a
	lot, for instance in testgtk's "scrolled windows" dialog or
	gtk-demo's "Text Widget".

	Without calling UpdateWindow(), Windows generates a WM_PAINT only
	when there is no other message in the queue. Thus, while you keep
	moving the scrollbar slider and generating mouse messages, no
	WM_PAINT messages are sent.

Thu Nov  7 17:18:06 2002  Owen Taylor  <otaylor@redhat.com>

	* gdk/x11/gdkdrawable-x11.c (gdk_x11_draw_pixbuf): 
	Don't try to use render if we can't get a picture for 
	the drawable. (Fixes #97220, reported by
	Jamie Zawinski)

	* gtk/gtkimage.c: Force requisition calculation
	when we get a expose prior to size_request().
	(#91711, reported by Sven Neumann, debugging
	help from Matthias Clasen, Soeren Sandmann)

Thu Nov  7 14:59:43 2002  Owen Taylor  <otaylor@redhat.com>

	* tests/testcalendar.c: Back out last change, should have gone in
	on HEAD.

Thu Nov  7 14:51:31 2002  Owen Taylor  <otaylor@redhat.com>

	* tests/testcalendar.c (calendar_date_to_string): 
	Use g_date_strftime(), fixing #74745. (Alper Ersoy)

Mon Nov  4 16:55:37 2002  Owen Taylor  <otaylor@redhat.com>

        * ==== Released 2.0.7 ====

	* configure.in: Version 2.0.7, interface, binary 7.

	* NEWS: Updates.

2002-11-03  Tor Lillqvist  <tml@iki.fi>

	Lots of changes to the Win32 backend:

	One big improvement is that scrolling of windows with background
	pixmaps now works much better. (This can be seen in for instance
	testgtk's "text" test.) Blitting inside a window
	(gdk_draw_drawable) also works much better now (can also seen in
	the "text" test).

	Another major change is we don't (try to) do guffaw scrolling as
	there is no static window gravity on Windows. Guffaw scrolling
	would be unnecessary anyway, as there is the ScrollWindow()
	API. This improves the behaviour of the Text Widget demo in
	gtk-demo a lot. But I have no idea how the lack of static win
	gravity should be handled in other places where the X11 code uses
	it. Especially _gdk_window_move_resize_child().

	Big windows still don't work correctly, I assume.
l
	Another vague area is the translate_queue. I don't think the queue
	items actually ever gets used, at least not in the code as of now.

	There is still some problem in expose handling. By moving an
	obscuring window back and forth over testgtk's main window, for
	instance, every now and then you typically get narrow vertical or
	horizontal strips of pixels that haven't been properly redrawn
	after being exposed. A fencepost error somewhere?

	* gdk/win32/gdkevents-win32.c: Cast known GdkWindowObjects
	directly instead of using GDK_WINDOW_OBJECT(). Remove unused
	latin_locale_loaded variable.

	(_gdk_win32_get_next_tick): New function. Used to make sure
	timestamps of events are always increasing, both in events
	generated from the window procedure and in events gotten via
	PeekMessage(). Not sure whether this is actually useful, but it
	seemed as a good idea.

	(real_window_procedure): Don't use a local GdkEventPrivate
	variable. Don't attempt any compression of configure or expose
	events here, handled elsewhere.

	(erase_background): Accumulate window offsets when traversing up
	the parent chain for GDK_PARENT_RELATIVE_BG, in order to get
	correct alignment of background pixmaps. Don't fill with
	BLACK_BRUSH if GDK_NO_BG.

	(gdk_event_get_graphics_expose): A bit more verbose debugging output.

	(gdk_event_translate): Use _gdk_win32_get_next_tick(). In the
	WM_PAINT handler, call GetUpdateRgn() before calling BeginPaint()
	and EndPaint() (which empty the update region).

	* gdk/win32/gdkdnd-win32.c
	* gdk/win32/gdkinput-win32.c:
	Use _gdk_win32_get_next_tick().
	
	* gdk/win32/gdkfont-win32.c: Use %p to print HFONTs.

	(gdk_text_size): Remove, unused.

	* gdk/win32/gdkgeometry-win32.c
	(_gdk_windowing_window_queue_antiexpose): Always return FALSE for
	now, until figured out whether antiexposes actually can work on
	Win32.

	(gdk_window_copy_area_scroll): Scroll also children with the
	ScrollWindowEx() call. No need to call gdk_window_move() on the
	children.

	(gdk_window_scroll): Don't do guffaw scrolling.

	(gdk_window_compute_position): Fix typo, used win32_y where x was
	intended.

	(gdk_window_queue_append): Use GetTickCount() for serial number,
	not GetMessageTime(), which can be very far back.

	* gdk/win32/gdkwindow-win32.c (gdk_window_gravity_works): Remove,
	we know that there is no such thing on Windows.

	(gdk_window_set_static_bit_gravity,
	gdk_window_set_static_win_gravity): Ditto, remove, they didn't do
	anything anyway.

	(_gdk_windowing_window_init, gdk_window_foreign_new): Call
	_gdk_window_init_position() like in the X11 backend.

	(gdk_window_reparent): Don't call the now nonexistent
	gdk_window_set_static_win_gravity(). No idea what should be done
	instead.

	(gdk_window_get_geometry): The returned x and y should be relative
	to parent. Used to be always zero..

	(gdk_window_set_static_gravities): Return FALSE if trying to set
	static gravity.
	
	* gdk/win32/gdkdrawable-win32.c (_gdk_win32_draw_tiles):
	Rewrite. Make static. Must take tile origin parameters, too.

	(gdk_win32_draw_rectangle): Pass the tile/stipple origin to
	_gdk_win32_draw_tiles(). Remove #if 0 code.

	(blit_inside_window): Don't call ScrollDC(), that didn't work at
	all like I thought. A simple call to BitBlt() is enough.
	
	* gdk/win32/gdkcolor-win32.c (gdk_win32_color_to_string,
	gdk_win32_print_paletteentries, gdk_win32_print_system_palette,
	gdk_win32_print_hpalette)
	* gdk/win32/gdkdrawable-win32.c (gdk_win32_drawable_description)
	* gdk/win32/gdkevents-win32.c (gdk_win32_message_name):
	Move all debugging helper functions to gdkmain-win32.c.

	* gdk/win32/gdkmain-win32.c: (gdk_win32_lbstyle_to_string,
	gdk_win32_pstype_to_string, gdk_win32_psstyle_to_string,
	gdk_win32_psendcap_to_string, gdk_win32_psjoin_to_string): New
	debugging functions.

	(static_printf): Helper function for the above. sprintfs into a
	static circular buffer, return value should be used "soon".

	* gdk/win32/gdkgc-win32.c: Use above debugging functions.

	* gdk/win32/gdkprivate-win32.h: Declare new functions, remove
	obsoleted ones.

Sun Nov  3 21:26:20 2002  Kristian Rietveld  <kris@gtk.org>

	Bah, and of course I broke something ...

	* gtk/gtktreeselection.c (gtk_tree_selection_selected_foreach): fix
	up the mess I caused with my commit of Oct 23 fixing #50263, things
	should be fine now.

Sun Nov  3 13:03:29 2002  Owen Taylor  <otaylor@redhat.com>

 	* gtk/gtkfilesel.c configure.in: Remove check for
 	winsock.h since it might show up on Linux+Wine.
 	Instead just conditionalize of G_OS_WIN32.
 	(#97396, Gaute Lindkvist)
 
Sun Nov  3 01:27:40 2002  Kristian Rietveld  <kris@gtk.org>

	* gtk/gtkcellrendererpixbuf.c (gtk_cell_renderer_pixbuf_get_size):
	check if width isn't zero instead of calc_width ...

Sun Nov  3 01:22:01 2002  Kristian Rietveld  <kris@gtk.org>

	Merge fest from HEAD, note that only a selection of bug fixes on
	HEAD got committed to stable.

	#94868, reported and testcase provided by Daniel Elstner.
	* gtk/gtktreeselection.c (_gtk_tree_selection_internal_select_node):
	free anchor if applicable.

	#92014, fixed with help of detailed traces from Morten Welinder.
	* gtk/gtkliststore.c (gtk_list_store_remove_silently): free the
	actual link after the node has been removed.
	
	* gtk/gtktreeviewcolumn.c (gtk_tree_view_column_column_finalize):
	free the cell_list and the child if it exists.

	#85858, #85859, #85860, #85872, reported by David L. Cooper II.
	* gtk/gtkcellrendererpixbuf.c (gtk_cell_renderer_pixbuf_render):
	s/guint/GtkCellRendererState/.

	* gtk/gtkcellrenderertext.c (gtk_cell_renderer_text_render):
	ditto.

	* gtk/gtkcellrenderertoggle.c (gtk_cell_renderer_toggle_render),
	(gtk_cell_renderer_toggle_activate): ditto.

	* gtk/gtkliststore.c (gtk_list_store_get_flags): a
	s/guint/GtkTreeModelFlags/ on the return type.

	#93629, fixes a really evil GtkTreeModelSort bug. Reported and
	testcase by Hans Petter Jansson.
	* gtk/gtktreemodelsort.c (gtk_tree_model_sort_row_changed): if we
	are swapping two rows (re-insertion on row_changed), also *emit*
	a rows_reordered signal. oops.

	#96851, reported by Jorn Baayen.
	* gtk/gtktreemodelsort.c (gtk_tree_model_sort_set_model): remove
	the second ref command on the child_model, we only have to ref it
	once here. (#96851, reported by Jorn Baayen). 

	#50263, reported by Havoc Pennington.
	* gtk/gtktreeselection.c (model_changed): new function,
	(gtk_tree_selection_selected_foreach): monitor changes in the model,
	bail out if the model has been changed from the foreach func.

2002-10-28  Tor Lillqvist  <tml@iki.fi>

	* gdk/win32/gdkwindow-win32.c (gdk_window_set_decorations,
	gdk_window_set_functions): Don't call GetWindowLong for
	GWL_EXSTYLE, the extended window style wasn't used or
	changed. After setting the window style with SetWindowLong, call
	SetWindowPos with the SWP_FRAMECHANGED flag for the window to
	actually be updated, as Platform SDK docs say one should. (#95812,
	huzheng)

2002-10-25  Dmitry G. Mastrukov  <dmitry@taurussoft.org>

	* configure.in: Added Belorusian (be) translation to ALL_LINGUAS.

Tue Oct 22 20:02:22 2002  Owen Taylor  <otaylor@redhat.com>

	* gtk/gtkcombo.c: When popping up the list without
	any selected items, hack the focus on the list to
	avoid triggering a bug in GtkList when clicking
	on focused-but-not-selected items (#86700,
	Zimler Attila, Matthias Clasen) and to keep
	GtkWindow from selecting the first item.

Tue Oct 22 15:13:59 2002  Owen Taylor  <otaylor@redhat.com>

	* gtk/gtkimmulticontext.c: Include config.h
	(#96441, Morten Welinder)

Tue Oct 22 15:03:41 2002  Owen Taylor  <otaylor@redhat.com>

	* gtk/fnmatch.h: When compiling our on fnmatch.c, 
	#define fnmatch _gtk_fnmatch (#92890, Jacob Berkman)

Mon Oct 21 14:04:39 2002  Owen Taylor  <otaylor@redhat.com>
 
 	* gtk/gtkentry.c (gtk_entry_get_public_chars): Return
 	"" for entry->invisible_char == 0, otherwise N copies
 	of entry->invisible_char. (#95486, Vitaly Tishkov)
 
	* gtk/gtkentry.c: Fix a bunch of places where entry->text
	instead of layout->text was being used for computation
	of offsets/indices in the layout. Using layout->text
	is necessary because when the entry is invisible, it
	doesn't correspond to entry->text.

Sat Oct 12 15:28:06 2002  Manish Singh  <yosh@gimp.org>

	* gtk/gtkitemfactory.c: use GTK_IS_RADIO_MENU_ITEM instead
	of comparing the type directly. This handles possible subclasses
	too. (Recommended by Tim Janik)
 
Thu Oct 10 14:35:31 2002  Owen Taylor  <otaylor@redhat.com>

	* gtk/gtkscrolledwindow.[ch]: Privately export
	_gtk_scrolled_window_get_scrollbar_spacing().

	* gtk/gtkcombo.c: Properly account from scrollbar
	spacing when computing the size of the popup window.
	(#84955, Marco Pesenti Gritti)

2002-10-09  Stanislav Brabec  <sbrabec@suse.cz>

	* gtk/gtkimcontextsimple.c: Added support for hungarian characters
	(addition to bug #93421). Only via dead keys, because compose key
	combinations in X are erratic.

Tue Oct  8 09:41:43 2002  Owen Taylor  <otaylor@redhat.com>

	* Patch from Takuro Ashie to fix updating of open_ims
	list. (#95150)

Mon Oct  7 15:52:13 2002  Owen Taylor  <otaylor@redhat.com>

	* gdk/x11/gdkkeys-x11.c (update_keymaps): Fix infinite
	loop from last change.

2002-10-07  jacob berkman  <jacob@ximian.com>

	* gdk/x11/gdkkeys-x11.c (update_keymaps): fix build

Mon Oct  7 12:40:39 2002  Owen Taylor  <otaylor@redhat.com>

	* gtk/gtkwindow.c (gtk_window_move_resize): Clean
	up the handling of clearing transient state 
	settings, fixing bug #95026, reported by Jami
	Pekannen.

Mon Oct  7 11:45:17 2002  Owen Taylor  <otaylor@redhat.com>
 
 	* gdk/x11/gdkkeys-x11.c (update_keymaps): If Mode_switch
 	is used for a known modifier like Mod1, assume it won't
 	be used to switch group. (#94841, problem reported by
 	Szekeres Istvan)
	
Fri Oct  4 14:49:04 2002  Owen Taylor  <otaylor@redhat.com>

	Patch from Shivram U <shivaram.upadhyayula@wipro.com>
 
  	* gdk/x11/gdkkeys-x11.c (update_keymaps): Increased the keycount to
 	(max_keycode - min_keycode) + 1 from (max_keycode - min_keycode).
 	(update_keymaps), (gdk_keymap_get_entries_for_keyval) looping through
 	less than or equal to max_keycode. (#79184)

2002-10-01  Stanislav Brabec  <sbrabec@suse.cz>

	* gtk/gtkimcontextsimple.c: Fixed alphabetical order (bug #93421).

Mon Sep 30 14:46:49 2002  Owen Taylor  <otaylor@redhat.com>

	* gtk/gtkbindings.c (gtk_binding_set_new): Initialize
	->parsed field. (#94536, patch from Sebastian Ritau. Maybe 
	fixes #87411?)

2002-09-30  Stanislav Brabec  <sbrabec@suse.cz>

	* gtk/gtkimcontextsimple.c: Completed ISO-8859-2 characters
	support (#93421), fixed cacute, umacron, completed dead_key+space
	convention.

Sun Sep 29 12:59:42 2002  Manish Singh  <yosh@gimp.org>

	* gtk/gtktypeutils.h: use #defines instead of enum for
	GtkFundamentalType compat, to prevent 64-bit vs. 32-bit
	confusion (#90400)

2002-09-29  Tor Lillqvist  <tml@iki.fi>

	* configure.in: Instead of forcing -fnative-struct into CFLAGS
	when using gcc for Win32, check for gcc version 3.x which uses
	-mms-bitfields instead. Also check if either of these switches is
	actually available at all, and warn if not. Thanks to Soren
	Andersen for the inspiration. (#93965)

2002-09-28  Matthias Clasen  <maclas@gmx.de>

	* gdk/x11/gdkwindow-x11.c (_gdk_windowing_window_init): Make
	drawing to the root window work.  (#89492)

2002-08-10  Matthias Clasen  <maclas@gmx.de>

	* gdk/gdkrgb.c (gdk_rgb_try_colormap): 
	(gdk_rgb_create_info): 
	(gdk_rgb_select_conv): 
	(gdk_draw_gray_image): 
	(gdk_rgb_cmap_get_info): Changes to support depth 8 StaticColor
	visuals.  (#81631)
	(gdk_rgb_cmap_free): Don't loop forever.

Fri Sep 27 18:14:00 2002  Owen Taylor  <otaylor@redhat.com>

	(#91249, Thomas Leonard)

	* gtk/gtkselection.c (gtk_selection_convert): Initialize
	idle time to 0.

	* gtk/gtkselection.c: Up idle timeout to 5 minutes
	from 5 seconds.

Fri Sep 27 17:40:47 2002  Owen Taylor  <otaylor@redhat.com>

	* modules/input/Makefile.am: Patch from J. Ali Harlow
	to avoid generating gtk.immodules when cross-compiling.
	(#87774)

Fri Sep 27 17:23:31 2002  Owen Taylor  <otaylor@redhat.com>

	* gtk/gtkcolorsel.c: Fix some signed/unsigned warnings.
	(#85863, David L. Cooper II)

Fri Sep 27 16:23:49 2002  Owen Taylor  <otaylor@redhat.com>

 	* gtk/gtklabel.c : Replaced instances where strlen (label->label) is
 	used to get a byte code with strlen (label->text) as label->text 
	contains the actual display text, while label->label contains
	markup / mnemonics. (#92683, Patch from Shivram U  
	<shivaram.upadhyayula@wipro.com>, with some additions.)

	* gtk/gtklabel.c (gtk_label_set_uline_text_internal): 
	Fix a leftover, now incorrect comment.
	
Fri Sep 27 16:15:11 2002  Owen Taylor  <otaylor@redhat.com>

	* gtk/gtknotebook.c (gtk_notebook_get_event_window_position):
	Handle the case where the first page isn't visible.
	(#90336, bug tracked down by Chema Celorio)

Fri Sep 27 15:57:15 2002  Owen Taylor  <otaylor@redhat.com>

	* gtk/gtkstock.c (builtin_items): Change accelerator
	from C_ut to Cu_t. (#82747, Paolo Maggi)

Fri Sep 27 15:27:45 2002  Owen Taylor  <otaylor@redhat.com>

	* gtk/gtkimage.c (gtk_image_unrealize): Reset the
	animation iter on unrealize as well as unmap.
	(#94336)

	* gtk/gtkprogressbar.c: Back out change that should
	have been applied on HEAD.

Tue Sep 24 23:43:10 2002  Manish Singh  <yosh@gimp.org>

	* gtk/gtkfilesel.c: check if last_selected is valid before doing
	a strcmp on it, which may happen if selections happen programmatically
	instead of through the UI (#86566)

Tue Sep 24 23:09:19 2002  Manish Singh  <yosh@gimp.org>

	* gtk/gtkfilesel.c: preserve ordering from gtk_tree_selection_foreach
	when returning filenames for gtk_file_selection_get_selections
	(#86567)

Tue Sep 24 06:39:36 2002  Owen Taylor  <otaylor@redhat.com>

	* gdk/x11/Makefile.am: Add the gxid_* files to
	EXTRA_DIST (#90511, Zenith Lau)

Thu Aug  8 16:58:22 2002  Owen Taylor  <otaylor@redhat.com>

	* gtk/gtkspinbutton.c (gtk_spin_button_real_change_value): 
	Remove the check for editable. (Reported by Brent Fox)

Tue Sep 24 05:12:14 2002  Owen Taylor  <otaylor@redhat.com>

	* gtk/gtkimcontextsimple.c: Fixes to GtkIMContextSimple 
	compose table for us-intl keyboards (Red Hat bugzilla
	#70995, Alexandre Oliva)

Mon Sep 23 14:58:04 2002  Owen Taylor  <otaylor@redhat.com>

	* gtk/gtkhandlebox.h gtk/gtktextbtree.[ch]:
	Use 'signed int' not 'gint' for signed bitfields.
	(#93020, Vitaly Tishkov)

	* gtk/gtktextlayout.h gtk/gtktextbtree.[ch]: 
	Fix some 'gint' bitfields that should have been
	unsigned.

Mon Sep 23 12:12:48 2002  Owen Taylor  <otaylor@redhat.com>

	* gtk/gtkspinbutton.c: Patch from Joshua N Pritikin to
	fix problem where signal connection wasn't removed
	from adjustment on finalize. (#93962)

Fri Sep 20 18:01:26 2002  Owen Taylor  <otaylor@redhat.com>

	* gtk/gtkentry.c (gtk_entry_unrealize): Set the IM
	context client 	window to NULL, not to the window that 
	is about to be destroyed. (#88231)

2002-09-21  Tor Lillqvist  <tml@iki.fi>

	* gdk/win32/gdkmain-win32.c (_gdk_windowing_init_check): Silence a
	gcc warning, use %p to print a HKL.

	* gdk/win32/gdkevents-win32.c (gdk_event_translate):
	WM_SYSKEYDOWN, WM_SYSKEYUP: Need to handle F10 specially here in
	order to be able to handle it normally in the application. Set
	ignore_wm_char also always when handling WM_SYSKEY{DOWN,UP}, this
	way we can generate GDK events also for Alt-Fn keys, for instance.
	
	* gdk/win32/gdkselection-win32.c (sanitize_utf8): Copy from X11
	backend. The old version mishandled consecutive newlines.

	* tests/testgtkrc: Remove obsolete mention of gtk-engines and
	Pixmap theme engine on Win32.

2002-09-20  Tor Lillqvist  <tml@iki.fi>

	* gtk/gtkmain.c (gtk_get_default_language): On Win32, look
	explicitly for LANG, LC_ALL and LC_CTYPE, and if not found, use
	g_win32_getlocale(). The setlocale() in msvcrt.dll would return a
	locale name in the form Swedish_Finland for sv_FI.

2002-09-16  Tor Lillqvist  <tml@iki.fi>

	* gdk/gdkfont.h: Delete leftover declarations of the obsolete
	Win32-only functions gdk_font_full_name_get() and
	gdk_font_full_name_free().

	* gdk/gdk.def: Delete from here, too.

	* gdk/win32/gdkfont-win32.c (logfont_to_xlfd,
	gdk_font_full_name_get, gdk_font_full_name_free): Delete
	implementation, and helper functions.

	(pattern_match, InnerEnumFontFamExProc, EnumFontFamExProc,
	gdk_font_list_new, gdk_font_list_free): Delete unused functions.

	(gdk_text_width, gdk_text_width_wc) Instead of code duplication,
	let gdk_text_extents() and gdk_text_extents_wc() do the job.
	
	* gdk/win32/gdkgc-win32.c (gdk_win32_gc_values_to_win32values):
	Don't use the above removed functions in debugging output.

	* gdk/win32/gdkinput-win32.c (gdk_input_wintab_init): Use correct
	function name in warning messages.

2002-09-14  Sven Neumann  <sven@gimp.org>

	* gdk/gdkpixbuf-drawable.c: fixed my latest change.

2002-09-13  Sven Neumann  <sven@gimp.org>

	* gdk/gdkpixbuf-drawable.c: use the most significant bits of the
	GdkColor components (#89703).

Tue Sep 10 15:39:42 2002  Jonathan Blandford  <jrb@redhat.com>

	* gtk/gtkliststore.c (gtk_list_store_finalize): free the root
	list.

	* gtk/gtktreestore.c (gtk_tree_store_finalize): free the root
	nodes.

Tue Sep 10 11:06:51 2002  HideToshi Tajima  <hidetoshi.tajima@sun.com>

	* modules/input/gtkimcontextxim.c (gtk_im_context_xim_get_ic): 
	(gtk_im_context_xim_get_ic, gtk_im_with_preedit,
	gtk_im_without_preeedit): filter key release events only when
	input methods ask for (#81759)

Tue Sep 10 09:29:00 2002  Owen Taylor  <otaylor@redhat.com>

	* gdk/x11/gdkevents-x11.c (gdk_event_translate): Take
	focus mode into account when tracking FocusIn/Out events,
	so we don't get confused by focus changes while a 
	keyboard grab is in effect. (Probably fixes #90563)

Mon Sep  9 16:16:25 2002  Shivram U  <shivaram.upadhyayula@wipro.com>

	* gtk/gtktextview.c (gtk_text_view_drag_motion): If the end iter
	is also a part of the selection, then we are in the selection.
	(#92768)

2002-09-08  Tor Lillqvist  <tml@iki.fi>

	* configure.in: Add AM_CONDITIONAL calls also in the non-x11
	branch. Otherwise we get "conditional \"$1\" was never defined.
	Usually this means the macro was only invoked conditionally."
	errors when running configure if using automake 1.6a. Yeah, I know
	that autogen.sh says to use automake 1.4, but on Win32 I more or
	less have to use the bleeding edge. I think.

Sat Sep  7 21:24:55 2002  Soeren Sandmann  <sandmann@daimi.au.dk>

	* gtk/gtktoolbar.c (get_button_relief): call
	gtk_widget_ensure_style() before reading "button_relief". Fixes
	(#92741).

Fri Sep  6 15:35:01 2002  Owen Taylor  <otaylor@redhat.com>

	* gdk/gdkgc.c (gdk_gc_new_with_values): Only set
	gc->colormap if it isn't already set. (Alex Larsson,
	#90632)

Fri Sep  6 12:41:16 2002  Owen Taylor  <otaylor@redhat.com>

	* modules/input/gtkimcontextxim.c: Pass the actual input
	keycode to XIM, rather than the result of backconverting
	the keysym. Fixes the <> input problem! (#74922)

	* gtk/gtkimmodule.c: Fix bug where GTK_IM_MODULE environment
	variable couldn't be used to force the input method to
	the default input method.

2002-09-05  jacob berkman  <jacob@ximian.com>

	* autogen.sh: run automake-1.4 when checking version, not automake

2002-09-05  Tor Lillqvist  <tml@iki.fi>

	* gdk/win32/gdkproperty-win32.c (gdk_property_change): Fix braino,
	actually do check each char, not just the first one, when looping
	through the text looking to insert CR in front of each LF. Bug
	noticed and fix provided by Florent Duguet.

	* gdk/win32/gdkwindow-win32.c (gdk_window_set_transient_for): 
	Use HWND_NOTOPMOST instead of HWND_TOPMOST. Suggested by Florent
	Duguet.

2002-08-31  Tor Lillqvist  <tml@iki.fi>

	* gdk/win32/gdkevents-win32.c (_gdk_events_init): On Cygwin, open
	/dev/windows instead of using the magic G_WIN32_MSG_HANDLE fd that
	is implemented (in GLib) only on native Win32. (#91683, Masahiro
	Sakai)

	* gtk/gtkfilesel.c: Include <sys/cygwin.h on Cygwin, for
	cygwin_conv_to_posix_path().
	(translate_win32_path, get_real_filename): Use
	cygwin_conv_to_posix_path().
	(gtk_file_selection_dir_activate): Call get_real_filename() here,
	too. (#91843, Masahiro Sakai)

2002-08-28  Naba Kumar  <naba@gnome.org>

	* configure.in: Added hindi translation (hi) in ALL_LINGUS.
	
2002-08-26  Tor Lillqvist  <tml@iki.fi>

	* gdk/win32/gdkwindow-win32.c (RegisterGdkClass): Use MAX_PATH
	(from windef.h) insted of _MAX_PATH (from stdlib.h in mingw and
	MSVC, but not there in Cygwin) (#91681, Masahiro Sakai).

2002-08-25  Tor Lillqvist  <tml@iki.fi>

	* gtk/gtkfilesel.c: Don't include <winsock.h> on Cygwin (#91654,
	Masahiro Sakai).

	* gtk/gtkmain.c: Compile gtk_init_abi_check and
	gtk_init_check_abi_check when on G_PLATFORM_WIN32, not just on
	G_OS_WIN32, to match gtkmain.h (#91649, Masahiro Sakai).
	(check_sizeof_GtkWindow, check_sizeof_GtkBox): Mention the
	-mms-bitfields swicth in addition to -fnative-struct.

	* gtk/gtkmain.h: Include gtkbox.h and gtkwindow.h on Win32, as the
	defines for struct packing checks use sizeof() on stuff from
	these. (#84211, Andreas Holzmann)

	* gtk/Makefile.am (libgtk_win32_2_0_la_DEPENDENCIES): Add
	gtk_win32res_lo. (#87101, J. Ali Harlow)

	* gdk/win32/gdkevents-win32.c (gdk_event_translate): Let the
	system handle Alt-Space, too. Thanks to Tim Evans (#91477).

2002-08-21  Tor Lillqvist  <tml@iki.fi>

	* gdk/win32/gdkdrawable-win32.c
	* gdk/win32/gdkevents-win32.c
	* gdk/win32/gdkmain-win32.c: Some spacing and indentation cleanup.

	* gdk/win32/gdkdrawable-win32.c (render_line_horizontal,
	render_line_vertical): Return TRUE.
	
	* gdk/win32/gdkevents-win32.c (_gdk_events_init): Search if the
	system has some input locale identifier that uses a Latin
	keyboard. This is needed to be able to get the virtual-key code
	for the latin characters corresponding to ASCII control
	characters. If no such keyboard is present, try to load one
	then. Will this upset users with no wish to ever use a Latin-based
	keyboard layout?

	(vk_from_char): Convert all ASCII control chars to the
	corresponding uppercase char before calling VkKeyScanEx(). Idea by
	Florent Duguet. Makes Control-C work again. To make it hopefully
	work like I think it should on non-Latin keyboards, too, use
	latin_locale when looking for the corresponding keycode.

	* gdk/win32/gdkgeometry-win32.c: Add GDK_NOTE debugging output
	to some functions, related to moving and resizing and expose
	and antiexpose queue processing. Use %p to output HWNDs.

	* gdk/win32/gdkkeys-win32.c (print_keysym_tab): Factor out
	debugging output to new function.

	* gdk/win32/gdkwindow-win32.c (gdk_window_resize,
	gdk_window_move_resize): Make more like X11 versions. Set
	resize_count similarily. Not that I have any idea what this is
	supposed to do.
 
	Fix for #81831 by Tim Evans:
	
	* gdk/win32/gdkevents-win32.c (gdk_event_translate): Don't call
	_gdk_event_button_generate() here, it would append the double- or
	triple-click events too early, before the single-click event.

	(real_window_procedure): If we got a single-click event, call
	_gdk_event_button_generate() to perhaps append the double- or
	triple-click event after that.

	Tentative fix for #79720 based on code by Florent Duguet:
		
	* gdk/win32/gdkgeometry-win32 (gdk_window_queue_append): New
	static function. Checks length of translate_queue, calls
	_gdk_window_process_expose() if length is >= 128. Then appends
	to translate_queue.
	(gdk_window_queue_translation,_gdk_windowing_window_queue_antiexpose):
	Call gdk_window_queue_append().

	* gdk/win32/gdkpixmap-win32.c (gdk_pixmap_impl_win32_finalize):
	Set image->windowing_data to NULL, unref the image.
	
	Merge from gtk-1-3-win32-production branch:

	* gdk/win32/gdkevents-win32.c (propagate): Check for parent being
	NULL before trying to propagate to it, and return FALSE in that
	case. (If parent is NULL, we are handling gdk_parent_root, and
	probably should have noticed that and bailed out earlier. But
	better late than never.)

	* gdk/win32/gdkinput-win32.c (gdk_input_init): Use
	GetSystemMetrics (SM_C[XY]SCREEN) instead of
	gdk_screen_{width,height}().

	* gdk/win32/gdkselection-win32.c (gdk_selection_convert): Don't
	use return value from GlobalSize() as length of string when
	calling MultiByteToWideChar(). Pass -1 instead (zero-terminated
	string). Thanks to Iwasa Kazmi.

2002-08-19  Padraig O'Briain <padraig.obriain@sun.com>

	* gtk/gtkentry.c (gtk_entry_real_delete_text): Use
	gtk_entry_set_positions() to update current_pos and selection_bound
	so notifications are emitted (#90548)

2002-08-18  Havoc Pennington  <hp@pobox.com>

	* autogen.sh: hardcode aclocal-1.4/automake-1.4 so that users with
	both automake 1.6 and 1.4 installed get the right automake. Means
	compilation from CVS will now require the latest automake 1.4
	release, or manually creating symlinks called "automake-1.4" and
	"aclocal-1.4"

2002-08-14 Padraig O'Briain <padraig.obriain@sun.com>

	* gtk/gtktextview.c (gtk_text_view_focus): Move focus to
	children, if they exist, after GtkTextView is focused. (#63844)

2002-08-06  jacob berkman  <jacob@ximian.com>

	* configure.in: link gdk-pixbuf-xlib against x libs (bug #83442)

2002-07-24  Havoc Pennington  <hp@pobox.com>

	* gtk/gtktextview.c: Apply patch from Gustavo
	Giraldez for bug #78513

Mon Aug  5 17:01:30 2002  Owen Taylor  <otaylor@redhat.com>

	* gdk/Makefile.am (LDFLAGS): When overriding LDFLAGS,
	include @LDFLAGS@, otherwise LDFLAGS the users passes
	to configure don't get used. (#89946, Noah Levitt, 
	Albert Chin)

	* gdk/linux-fb/Makefile.am: Remove LDFLAGS setting.

2002-08-01  Sven Neumann  <sven@gimp.org>

	* gdk/gdkrgb.c: trivial changes to some debug code so it compiles
	with VERBOSE being defined.

Wed Jul 31 16:42:03 2002  Owen Taylor  <otaylor@redhat.com>

	* Released 2.0.6

	* configure.in: 2.0.6, binary, interface age 6.
	Require GLib version 2.0.6.

	* NEWS: Updated

2002-07-31  Sven Neumann  <sven@gimp.org>

	* gtk/queryimmodules.c (print_escaped): Fix wrong number of
	parameters in call to escape_string().

Wed Jul 31 12:50:51 2002  Owen Taylor  <otaylor@redhat.com>

	* gtk/queryimmodules.c: Avoid using g_strescape(),
	since it mangles UTF-8, (#89479, Yao Zhang.)

Tue Jul 30 19:09:46 2002  Owen Taylor  <otaylor@redhat.com>

	* gtk/gtkrange.c (gtk_range_scroll_event): Handle 
	inverted ranges correctly (#85436, fix from 
	Norihiro UMEDA)

Tue Jul 30 16:36:53 2002  Owen Taylor  <otaylor@redhat.com>

	* tests/testgtk.c: Fix bug in the selection mode option
	menus which were setting the wrong values. 
	(#85763, Manuel Op de Coul)

Tue Jul 30 15:39:06 2002  Owen Taylor  <otaylor@redhat.com>

	* demos/Makefile.am: Honor GDK_PIXBUF_CSOURCE from
	configure.in when cross-compiling. (#87099,
	J. Ali Harlow)

Mon Jul 29 16:42:30 2002  Owen Taylor  <otaylor@redhat.com>

	* gtk/gtkimcontext.c (gtk_im_context_real_get_surrounding):
	Unset gtk-im-surrounding-info object data again.
	(Fix from Yao Zhang, #86811)

Fri Jul 26 17:59:06 2002  Owen Taylor  <otaylor@redhat.com>

	* configure.in: Replace uses of grep \(A\|B\) ... with
	egrep (A|B). (#84872, Arnaud Charlet)

Fri Jul 26 21:39:21 2002  Kristian Rietveld  <kris@gtk.org>

	* gtk/gtktreestore.c (node_free): return FALSE,
	(gtk_tree_store_finalize): use g_node_traverse instead of
	g_node_children_foreach, so the whole tree will be freed (#88854,
	patch from Emmanuel Briot).

Fri Jul 26 21:24:03 2002  Kristian Rietveld  <kris@gtk.org>

	* gtk/gtktreeview.c (gtk_tree_view_button_press): fix some memleaks,
	(#84426, patch from Matthias Clasen).

Fri Jul 26 17:11:25 2002  Kristian Rietveld  <kris@gtk.org>

	* gtk/gtktreeview.c (gtk_tree_view_unref_tree_helper): _iter_children
	check shouldn't be in g_return_return_val_if_fail (pointed out by
	Josh Green, #88997),
	(gtk_tree_view_set_model): call _gtk_tree_view_column_unset_model
	for each column when we unset the model (part of #82484),
	(gtk_tree_view_get_cell_area): return if we ran out of tree or
	if we got an invalid path (#82376).

	* gtk/gtktreeprivate.h: add _gtk_tree_view_column_unset_model.

	* gtk/gtktreeviewcolumn.c: implement _gtk_tree_view_column_unset_model
	which disconnects the sort_column_changed_signal (part of #82484).

	* gtk/gtkliststore.c (gtk_list_store_insert): append row if the
	given postion is off the end of the tree (#85813).

	* gtk/gtkentry.c (gtk_cell_editable_key_press_event): let's use
	2-space indent, commit changes if up/down keys has been pressed,
	this overrides the focus key foo so the user won't be surprised
	(#84665).

2002-07-25  Matthias Clasen  <maclas@gmx.de>

	* gdk/gdkrgb.c (gdk_rgb_select_conv): Use gdk_rgb_convert_4,
	not gdk_rgb_convert_8 for depth 4, bpp 8, PseudoColor visuals.
	(#88697)
	
Thu Jul 25 14:14:46 2002  Owen Taylor  <otaylor@redhat.com>

        * gtk/gtkmenushell.c: When a menubar is up, use F10 to cycle
	menubars, not Control-Tab (#87159, Calum Benson. Patch from
	Padraig O'Briain.)
	
	* gtk/gtkmenubar.c: When cycling menu bars, cancel
	after the last instead of wrapping around.

Thu Jul 25 11:57:57 2002  Owen Taylor  <otaylor@redhat.com>

	[ Patch from Padraig O'Briain, #87904 ]

	* gtk/gtkwidget.c (gtk_widget_class_init): Cleanup -
	use G_SIGNAL_RUN_LAST not GTK_RUN_LAST when using
	g_signal new.

	* gtk/gtktogglebutton.c (gtk_toggle_button_mnemonic_activate): 
	Always focus the widget, even when we are activating
	as well.

Wed Jul 24 16:43:49 2002  Owen Taylor  <otaylor@redhat.com>

	* gtk/gtkrc.c docs/references/tmpl/gtkrc.sgml: Don't use
	GTK_RC_FILES, since it causes problems with what KDE (etc.)
	does to customize GTK+ themes, use GTK2_RC_FILES instead. (#88987)

2002-07-16  Federico Mena Quintero  <federico@ximian.com>

	* gdk/gdkpixbuf-drawable.c (rgb565lsb): Fixed the LSB -> MSB case.
	Fixes #79463.

2002-07-11  Peteris Krisjanis <pecisk@inbox.lv>

	* configure.in: (ALL_LINGUAS) Added Latvian (lv) support.

2002-07-10  jacob berkman  <jacob@ximian.com>

	* gtk/gtkoptionmenu.c (gtk_option_menu_scroll_event): activate the
	menu item so old apps work properly

Wed Jul 10 14:27:14 2002  Owen Taylor  <otaylor@redhat.com>

	* modules/input/gtkimcontextxim.c gtk/gtkcolorsel.c 
	gtk/gtkdialog.c gtk/gtktextbtree.c: Fix some cases
	where signal connection IDs where being assigned to 
	guint rather than gulong. (part of #87281, Shivram U)

Fri Jul  5 20:18:23 2002  Owen Taylor  <otaylor@redhat.com>

	* gtk/gtkmenushell.[ch] gtk/gtkmenubar.c gtk/gtkmenuitem.c
	gtk/gtkentry.c gtk/gtktextview.c: Add an extra parameter
	to _gtk_menu_item_select_first() to allow us to choose
	whether we want to select the first item predictably
	or to select the first sensitive item. Fixes problem
	with insensitive menu items and keynav. (#85796,
	reported by Bill Haneman and others.)

Fri Jul  5 02:50:24 2002  Jonathan Blandford  <jrb@gnome.org>

	* gtk/gtktreeview.c (gtk_tree_view_collapse_all): fix warning.
	(gtk_tree_view_search_iter): fix warning, #85884

	* gtk/gtktreestore.c (gtk_tree_store_get_flags): change return
	value to GtkTreeModelFlags to fix compiler warning, #85883

	* gtk/gtktreemodelsort.c (gtk_tree_model_sort_get_flags): change
	return value to GtkTreeModelFlags to fix compiler warning, #85882

	* gtk/gtktreemodel.c (gtk_tree_path_prepend_index): fix compiler
	warning, #85881

Thu Jul  4 19:49:08 2002  Kristian Rietveld  <kris@gtk.org>

	* gtk/gtkliststore.c (gtk_list_store_sort): also update ->tail after
	sorting.

Tue Jul  2 00:33:26 2002  Jonathan Blandford  <jrb@gnome.org>

	* gtk/gtktreeview.c (validate_visible_area): only validate the
	visible area if we've ever been requisitioned.

Mon Jul  1 17:04:09 2002  Jonathan Blandford  <jrb@redhat.com>

	* gtk/gtkliststore.c (gtk_list_store_real_set_value): sync up
	white space/variable names to match tree_store equiv.

	* gtk/gtktreestore.c (gtk_tree_store_real_set_value): sort if we
	set the value.

2002-07-01  Bill Haneman <bill.haneman@sun.com>

	* contrib/gdk-pixbuf-xlib/gdk-pixbuf-xlib-drawable.c
	(xlib_window_is_viewable):
	Fix to handle 'root window' drawable case.

2002-06-18  Yanko Kaneti <yaneti@declera.com>

	* configure.in: (ALL_LINGUAS) Added Bulgarian (bg).

Sat Jun 15 23:21:24 2002  Owen Taylor  <otaylor@redhat.com>

	* Released 2.0.5

	* configure.in: Version 2.0.5, binary, interface age 5.

	* NEWS: Updated.

Sat Jun 15 23:53:03 2002  Owen Taylor  <otaylor@redhat.com>

	* gtk/gtkfilesel.c (gtk_file_selection_set_filename): 
	Actually use the UTF-8 filename, so we actually
	fix #77948.

	* tests/testgtk.c: Remember the directory as a
	test of gtk_file_selection_set_filename().

Sat Jun 15 23:05:19 2002  Owen Taylor  <otaylor@redhat.com>

	* gtk/gtkfilesel.c (gtk_file_selection_set_filename):
	Fix backwards asssertion. (#85434)

Sat Jun 15 16:10:00 2002  James M. Cape <jcape@ignore-your.tv>

	* gtk/gtktexttag.c (gtk_text_tag_set_property):
	Notify about "background-full-height-set", not
	"bg_full_height_set". (#83336)

Fri Jun 14 12:50:21 2002  Owen Taylor  <otaylor@redhat.com>

	* Released 2.0.4.

	* configure.in: 2.0.3, interface, binary age 4.

	* gtk/gtktreeselection.c gtk/gtktreeview.c gtk/gtkwindow.c
	  gtk/gtkrc.c: Some doc SGML fixes.

Fri Jun 14 15:41:50 2002  Jonathan Blandford  <jrb@redhat.com>

	* gtk/gtktreeview.c: Fix bug #84268, where validate_rows sometimes
	didn't remove itself correctly.  Thanks to Dave Camp for the fix.

Fri Jun 14 15:09:11 2002  Jonathan Blandford  <jrb@redhat.com>

	* gtk/gtktreeview.c (gtk_tree_view_set_adjustments):
	disconnect_by_func instead of disconnect_by_data.  Someone else
	could use the same data as us.

	* gtk/gtktreeview.c (do_validate_rows): update the adjustment
	immediately after we update the size.  Fixes some scroll_to bugs.
	(validate_visible_area): ditto

Fri Jun 14 10:31:59 2002  Owen Taylor  <otaylor@redhat.com>

	* gdk/x11/gdkevents-x11.c (gdk_check_wm_state_changed): 
	Ignore state change events for windows that aren't
	our toplevels. (#84482, Thomas Leonard)

Fri Jun 14 10:00:29 2002  Owen Taylor  <otaylor@redhat.com>

	* gdk/gdkwindow.c (gdk_window_update_idle): Add
	missing GDK_THREADS_ENTER()/GDK_THREADS_LEAVE().
	(Report of non-thread-safety from Nicholas Allen)

	* gtk/gtkmain.c (rewrite_events_translate): Fix sign
	problem with coordinate translation. (Fix from
	Robin Lu, #85229)

Thu Jun 13 19:41:56 2002  Owen Taylor  <otaylor@redhat.com>

	* gtk/gtkiconfactory.c gtk/gtkselection.c gtk/gtkstyle.c
	gtk/gtktextiter.c gtk/gtktexttag.c gtk/gtktreemodel.c
	gtk/gtkwidget.c: Fix type names for GtkIconSet,
	GtkIconSource, GtkSelectionData, GtkBorder, GtkTextIter,
	GtkTextAttributes, GtkTreePath, GtkTreeIter, 
	GtkRequisition, which were all registered as GtkType*.
	(#84634, James Henstridge; patch from Jonathan Blandford.)

	* NEWS: Updates.
	
Thu Jun 13 18:48:14 2002  Owen Taylor  <otaylor@redhat.com>

 	* gdk/x11/gdkcolor-x11.c: Make work
	gdk_colormap_sync() work for DirectColor visuals 
	as well. Fill in the ->colors array in
	gdk_screen_get_system_colormap () for DirectColor visuals.
	(#81954, Based on a patch from shivaram.upadhyayula@wipro.com)
 
Thu Jun 13 17:50:36 2002  Owen Taylor  <otaylor@redhat.com>

	* gtk/gtktextview.c gtk/gtkentry.c: Add the obsolete
	CUA cut/copy/paste bindings. (#79078)

	* gtk/gtktextview.c gtk/gtkentry.c: Make <Shift>BackSpace
	a synonym for for Backspace. (#80302, Jeff Waugh)

Thu Jun 13 15:02:49 2002  Owen Taylor  <otaylor@redhat.com>

	* gdk/x11/gdkdnd-x11.c: Ignore all client events that
	were sent to a window that we don't know about or
	to a foreign window. (#81543, Young-Ho, Cha)

2002-06-13  Christian Rose  <menthos@menthos.com>

	* Makefile.am (EXTRA_DIST): Remove po/desk.pl and
	po/update.pl.

Thu Jun 13 12:24:09 2002  Owen Taylor  <otaylor@redhat.com>

	* gtk/gtkfilesel.c (gtk_file_selection_set_filename):
	Fix so that the encoding of the filename is handled
	properly in the case of non-UTF-8 filesystems;
	document the encoding. (#77948, Sebastian Ritau)

	* gtk/gtkfilesel.c (filenames_drag_get): Remove
	debug printf. Fix UTF-8 / filename encoding 
	confusion.

Thu Jun 13 12:01:36 2002  Owen Taylor  <otaylor@redhat.com>

	* gtk/gtkentry.c (gtk_entry_drag_motion): Don't return
	a positive status unless there is a text target in
	the drag. (#83386, Thomas Leonard.)

2002-06-13  jacob berkman  <jacob@ximian.com>

	* Makefile.am (EXTRA_DIST): remove po/README.tools

Thu Jun 13 11:36:37 2002  Owen Taylor  <otaylor@redhat.com>

	* gtk/gtkdnd.c (_gtk_drag_source_handle_event): Save
	the initial grab time, use that when changing the
	pointer. (#83052, help from Dave Camp tracking it down.)

Thu Jun 13 16:36:40 2002  Kristian Rietveld  <kris@gtk.org>

	* gtk/gtktreestore.c (gtk_tree_store_finalize): traverse all nodes,
	not just the leafs (pointed out by Josh Parsons)

2002-06-12  Havoc Pennington  <hp@redhat.com>

	* configure.in: check that pango has Xft2 support, instead of
	checking whether Xft2 exists.

Wed Jun 12 17:46:53 2002  Owen Taylor  <otaylor@redhat.com>

	* gtk/gtkentry.c (blink_cb): Add an informative 
	g_warning() when the entry has lost a focus-out-event.
	(#78305, Michel Selten)

Wed Jun 12 17:31:15 2002  Owen Taylor  <otaylor@redhat.com>

	* gtk/gtkmenushell.c (gtk_menu_shell_real_select_item): 
	Check to see if the menu item is selectable before
	setting menu_shell->active_menu_item. This hopefully
	will keep gail from getting confused.
	(#84115, Remus Draica)

Wed Jun 12 17:13:13 2002  Owen Taylor  <otaylor@redhat.com>

	* gtk/gtkwindow.c (gtk_window_move_resize): Fix bug
	where if CENTER_ON_PARENT was set, but there was
	no parent, GDK_HINT_POS would be set, resulting
	in a dialog at 0,0. (#83479, Havoc Pennington)

Wed Jun 12 16:34:13 2002  Owen Taylor  <otaylor@redhat.com>

	* gtk/gtkmenubar.c: When fetching the menubars for
	the window for F10 handling, only add viewable menu
	bars. (Apparently, people sometimes put menu bars
	in notebook pages!) (Tim Janik, #82627)

Wed Jun 12 16:21:38 2002  Owen Taylor  <otaylor@redhat.com>

	* gtk/gtkcheckbutton.c (gtk_check_button_size_allocate): 
	Clamp size of child to at least 1x1. (#82431, 
	Boris Shingarov.)

Wed Jun 12 15:43:38 2002  Owen Taylor  <otaylor@redhat.com>

	* gtk/gtkspinbutton.c (gtk_spin_button_snap): Handle
	0 increment, to fix division-by-zero problem.
	(#82816, George Lebl.)

Wed Jun 12 15:38:01 2002  Owen Taylor  <otaylor@redhat.com>

	* gtk/gtkimmulticontext.c (gtk_im_multicontext_append_menuitems):
	Fix memory leak. (Patch from Matthias Clasen, #84926)

	* gtk/gtkrange.c (gtk_range_init): Initialize
	mouse_x, mouse_y to -1,-1. (#84871, Garrett Lesage)

Wed Jun 12 15:08:37 2002  Owen Taylor  <otaylor@redhat.com>

	* gtk/gtkrc.c (gtk_rc_get_style_by_paths): Allow 
	NULL for widget path or class path as documented.
	(#83150, Sergey Kuzminov)

Wed Jun 12 15:02:30 2002  Owen Taylor  <otaylor@redhat.com>

	* gtk/gtktextutil.c: Fix ZWJ => ZWN typo.
	(#83092, Tino Meinen)

Wed Jun 12 14:41:43 2002  Owen Taylor  <otaylor@redhat.com>

	* configure.in: Fix some problems with case statements
	for checking for omitted deps. (#84202, Jacob Berkman.)

	* configure.in: Remove USE_X11R6_XIM checks since we 
	no longer use them.

Wed Jun 12 14:18:45 2002  Owen Taylor  <otaylor@redhat.com>

	* gtk/gtkimcontextsimple.c: Add compose sequences
	of dead_acute + c/C => C WITH CEDDILLA.
	(Nano Golveia, #83492)

2002-06-09  Matthias Clasen  <maclas@gmx.de>

	* gtk/gtktextbtree.c (_gtk_text_btree_unref): Don't leak
	child_anchor_table.  (#84425)

	* gtk/gtktextlayout.c (gtk_text_layout_finalize): Don't leak
	one_display_cache.  (#84424)

Fri Jun  7 23:11:42 2002  Jonathan Blandford  <jrb@gnome.org>

	* gtk/gtktreeview.c (gtk_tree_view_real_expand_row): Fix sizing
	bug.

	* docs/reference/gtk/tmpl/gtkbutton.sgml: Remove ^M's.

2002-06-07  Matthias Clasen  <maclas@gmx.de>

	* gtk/gtktreeviewcolumn.c
	(gtk_tree_view_column_clear_attributes_by_info): New function,
	split off from gtk_tree_view_column_clear_attributes.
	(gtk_tree_view_column_clear_attributes):
	(gtk_tree_view_column_finalize):  Call the new function, avoid
	recalculating the info from the renderer.  (#84413) 
	
	* gtk/gtktextview.c (text_view_child_new_anchored): Initialize
	vc->type in order to avoid a later UMR.  (#84415)

2002-06-06  Matthias Clasen  <maclas@gmx.de>

	* gdk/x11/gdkevents-x11.c (gdk_event_translate): Set
	hardware_keycode for KeyRelease events.  (#84305)

Thu May 23 15:44:30 2002  Owen Taylor  <otaylor@redhat.com>
 
 	* gtk/gtktextview.c (changed_handler): Don't redraw
 	when the area is completely above the visible area.
 
Thu Jun  6 17:34:00 2002  Kristian Rietveld  <kris@gtk.org>

	* gtk/gtkrbtree.c (_gtk_rbtree_reorder): don't leak the GArray
        (figured out by Matthias Clasen, fixes #82026).

Tue Jun  4 17:39:34 2002  Owen Taylor  <otaylor@redhat.com>

	* configure.in: If we have xft .pc file, use that
	when checking for Xft/Xrender. (Still need to separate
	out HAVE_XFT, HAVE_RENDER)

	* configure.in: Make sure Xft cflags come before X cflags.

2002-06-04  Daniel Elstner  <daniel.elstner@gmx.net>

	* gtk/gtkcellrenderertoggle.c (gtk_cell_renderer_toggle_render):
	Really fix #83796: Revert jrb's last patch, and move the second
	if-clause into the fist one's else-branch.  This is also what
	the other cell renderers do.

2002-06-03  Federico Mena Quintero  <federico@ximian.com>

	* gdk/gdkpixbuf-drawable.c (rgb565msb): Fix the MSB -> MSB case.
	Fixes #79190.

Sat Jun  1 10:38:24 2002  Jonathan Blandford  <jrb@gnome.org>

	* gtk/gtkcellrenderertoggle.c (gtk_cell_renderer_toggle_render):
	add missing flag, #83796

2002-05-30  Michael Meeks  <michael@ximian.com>

	* gtk/gtkmenu.c (gtk_menu_popup): destroy the transfer
	window if the grab fails so we don't get events on this
	window after the menu is finalized with a duff GtkWidget
	pointer: #82366

Mon May 28 13:28:10  Shivram U  <shivaram.upadhyayula@wipro.com>

	* gtk/gtktextbuffer.c (selection_data_get_buffer): Check if the owner
	got is of type GDK_WINDOW_FOREIGN. If so the owner is not in-process,
	and so return NULL.

2002-05-24  Michael Meeks  <michael@ximian.com>

	* gtk/gtkmain.c (_gtk_find_module): don't leak the paths.

Thu May 30 07:27:05 2002  Soeren Sandmann  <sandmann@daimi.au.dk>

	* gdk/gdkwindow.c: revert accidentally committed changes

Thu May 30 07:12:02 2002  Soeren Sandmann  <sandmann@daimi.au.dk>

	* gtk/gtkmenu.c (gtk_menu_style_set): add
	gtk_menu_style_set(). Fixes #79345.
	
2002-05-30  Tor Lillqvist  <tml@iki.fi>

	* gdk/win32/gdkmain-win32.c (gdk_screen_width_mm,
	gdk_screen_height_mm): Use the "logical dpi" to calculate
	(pseudo) physical sizes. Similar to the use of "logical dpi" in
	Pango as suggested by Joaquin Cuenca Abela.

	Two fixes by Florent Duguet:

	* gdk/win32/gdkwindow-win32.c (gdk_window_set_cursor): Correct
	semantics for setting cursor to NULL (should use cursor of parent
	window).

	* gdk/win32/gdkgc-win32.c (gdk_win32_hdc_get): Plug memory
	leak.

2002-05-29  Dave Camp  <dave@ximian.com>

	* gtk/gtkdnd.c (gtk_drag_end): Disconnect from keypress events.

2002-05-27  Daniel Elstner  <daniel.elstner@gmx.net>

	Fixes for #83190

	* gtk/gtktreedatalist.h (_GtkTreeDataList::data): Add missing
	fields to anonymous union: glong, gulong, gint64 and guint64.
	This is an internal header file, so it should not affect ABI
	or API compatibility.

	* gtk/gtktreedatalist.c (_gtk_tree_data_list_node_to_value):
	Implement missing support for glong, gulong, gint64 and guint64
	fundamental types.  Use data.v_uint instead of data.v_int for
	G_TYPE_FLAGS, as GValue does.
	(_gtk_tree_data_list_value_to_node): ditto
	(_gtk_tree_data_list_node_copy): Add case labels for missing
	fundamental types, and reorder them to match the other functions.
	(gtk_tree_data_list_compare_func): Implement comparison for
	glong, gulong, gint64 and guint64.  Use g_value_get_enum()
	for G_TYPE_ENUM and g_value_get_flags() for G_TYPE_FLAGS, rather
	than accessing them as gint/guint.  The G_VALUE_HOLDS() check
	probably won't like this.

2002-05-24  Dave Camp  <dave@ximian.com>

	* gtk/gtktreemodelsort.c (gtk_tree_model_sort_row_inserted): 
	Built an iter directly instead of using
	gtk_tree_model_sort_elt_get_path(), since that returns a path for
	the child model.
	
2002-05-24  Dave Camp  <dave@ximian.com>

	* gtk/gtktreemodelsort.c: Use indices[i] >= level->array->len
	rather than level->array->len > indices[i] in the bounds check.

Thu May 23 17:19:16 2002  Owen Taylor  <otaylor@redhat.com>

	* Released 2.0.3.

	* gtk/gtktooltips.c (gtk_tooltips_event_handler): Disable
	tooltips for menu items with submenus .. they still
	don't really work properly.

	* gtk/gtkwindow.c (gtk_window_move_resize): Clear
	initial_pos_set even if it only causes a move, not
	a resize as well.

	* configure.in: GTK+-2.0.3, interface age, binary age 3.

	* NEWS: Updated.

2002-05-23  Tor Lillqvist  <tml@iki.fi>

	* gtk-zip.sh.in: Use correct path to the loaders and immodules
	directories (GTK_BINARY_VERSION, not GTK_VERSION).

Wed May 22 16:12:38 2002  Owen Taylor  <otaylor@redhat.com>

	* configure.in: Require autoconf-2.52 explicitely,
	since otherwise Debian will process it with 2.13 (ugh!).

Wed May 22 12:29:20 2002  Jonathan Blandford  <jrb@redhat.com>

	* gtk/gtkscrolledwindow.c (gtk_scrolled_window_init): remove
	GTK_RESIZE_QUEUE setting.

Tue May 21 16:46:15 2002  Owen Taylor  <otaylor@redhat.com>

	* gdk/x11/gdkmain-x11.c (gdk_internal_connection_watch): 
	Fix missing dereference. (HideToshi Tajima)

Tue May 21 15:33:32 2002  Owen Taylor  <otaylor@redhat.com>

	* gtk/gtkwindow.c (gtk_window_show): Conditionalize
	GTK_IS_PLUG() check on GDK_WINDOWING_X11. (Problem
	reported by Sven Neumann)

Mon May 20 15:02:21 2002  Owen Taylor  <otaylor@redhat.com>

	* gdk/x11/gdkdisplay-x11.c: Patch from HideToshi Tajima
	to handle Xlib internal connections. (#76681)

Mon May 20 12:59:14 2002  Owen Taylor  <otaylor@redhat.com>

	* gtk/gtktooltips.c: Set the private LEAVE_PENDING
	flag to fix problem where with menu items with
	submenus, tooltips were getting stuck. (Effectively
	disables tooltips for menu items with submenus.)
	(Bug #75961, Soeren Sandmann)

	* tests/testgtk.c: Set a tooltip on a menu item
	with a submenu.

Mon May 20 11:47:59 2002  Owen Taylor  <otaylor@redhat.com>

	* gtk/gtkplug.c: Undo an accidental revert of
	fixes of May 16. (Caught by Padraig O'Briain)

	* gtk/gtkctree.c (cell_size_request): Fix bug where
	size request for text cells was being overwritten.
	(#82264, Graham Swallow.)

2002-05-18  Matthias Clasen  <maclas@gmx.de>

	* configure.in: Check for endianness.

Thu May 16 19:49:24 2002  Owen Taylor  <otaylor@redhat.com>

	* gtk/gtkwindow.c (gtk_window_configure_event): Only 
	optimize out the full configure handling if we got
	a gratuitous configure event(configure_request_count == 0)
	and the size didn't change.

	* gtk/gtkwindow.c (gtk_window_move_resize): Use 
	g_message(), not g_print() for debug spew.

	* gtk/gtkwindow.c (gtk_window_real_set_focus): Ref
	the old and new focus widgets for the scope of
	the function.

	* gtk/gtksocket.c gtkplug.c: Remove various #if 0'd
	bits of old code.

	* gtk/gtksocket.c gtk/gtkplug.c: Enhance debug messages.

Fri May 17 14:40:24 2002  Owen Taylor  <otaylor@redhat.com>

	* gtk/gtkimmulticontext.c (gtk_im_multicontext_set_slave): 
	Protect against reentrancy problems by emitting 
	::preedit_changed at the end, fixing input context
	leak. (Yao Zhang)

	* modules/input/gtkimcontextxim.c (status_window_free): 
	Patch from Federico Mena Quintero to fix problem where
	references to IMContextXIM were kept around after
	module was unloaded. (#77008)

	* gtk/gtkdnd.c (gtk_drag_dest_set): NULL initialize
	proxy window.

Fri May 17 13:56:23 2002  Owen Taylor  <otaylor@redhat.com>

	* gtk/gtkplug.c (gtk_plug_filter_func): Fix a missing
	unref in the local/passive case. (#82067, Michael
	Meeks)

	* gtk/gtkplug.c (_gtk_plug_remove_from_socket): Fix
	reference leak on the plug window.

	* tests/testsocket.c (add_child): Fix memory leak.

	* gtk/gtkdnd.c (gtk_drag_dest_site_destroy): Unref
	the proxy window.

Thu May 16 18:47:29 2002  Owen Taylor  <otaylor@redhat.com>

	* gtk/gtkwindow.c (gtk_window_show): Disable the
	focus-some-one code for GtkPlug descendants.

	* gtk/gtkplug.c (gtk_plug_focus_event): Eat 
	focus-in/out events since they can be generated
	by keyboard grabs, but are spurious for an embeddded
	widget. (#79196, Padraig O'Briain)

	* gtk/gtksocket.c (gtk_socket_size_request): Only
	pay attention to the minimum size hints, and changes
	to that ... ignore the default size.

	* gtk/gtksocket.c (gtk_socket_send_configure_event):
	Pass in root-window relative coordinates as per
	the ICCCM.

	* gtk/gtksocket.c (gtk_socket_size_allocate): Send
	as many synthetic configures as necessary to make
	up for ConfigureRequest events we got. (#78799,
	Dave Camp.)

Thu May 16 23:59:56 2002  Kristian Rietveld  <kris@gtk.org>

	* gtk/gtktreestore.c (gtk_tree_store_sort_iter_changed): set the prev
	of the next node correctly, so we don't corrupt the list and cause
	bad things. (fixes #71374)

Thu May 16 17:29:08 2002  Jonathan Blandford  <jrb@redhat.com>

	* gtk/gtkrbtree.c (_gtk_rbtree_remove): include missing #ifdef G_ENABLE_DEBUG

Thu May 16 15:44:15 2002  Owen Taylor  <otaylor@redhat.com>

	* demos/gtk-demo/editable_cells.c (cell_edited): Fix
	typo in earlier patch.

Tue May  7 15:50:51 2002  Owen Taylor  <otaylor@redhat.com>

	* gtk/gtkimcontextsimple.c (gtk_im_context_simple_filter_keypress):
	Don't filter control-shift+[non-hex]. 
	(#80252, reported by Nalin Dahyabhai)

Thu May 16 14:51:14 2002  Owen Taylor  <otaylor@redhat.com>

	Fixes for #78258

	* gtk/gtkrbtree.c demos/gtk-demo/editable-cells.c:
	Fix some 64-bit warning problems. (Patch from Matthias
	Clasen.)
	
	* gtk/gtkrbtree.c (_gtk_rbtree_debug_spew_helper): Surround
	a bunch of debug code with G_ENABLE_DEBUG.

	* configure.in demos/gtk-demo/main.c: Replace
	#ifndef G_OS_WIN32 with proper #ifdef HAVE_FLOCKFILE.

Thu May 16 12:56:38 2002  Owen Taylor  <otaylor@redhat.com>

	* gtk/gtkrange.c (gtk_range_calc_layout): Fix a missed
	check for division by zero. (#77820, Gareth Pearce)

Thu May 16 12:50:13 2002  Owen Taylor  <otaylor@redhat.com>

	* gdk/x11/gdkevents-x11.c (gdk_xsettings_notify_cb):
	gdk_event_put() copies the event and setting name,
	so we don't have to strdup() it here. (Fix from
	Michael Meeks, #81953)

2002-05-16  Ettore Perazzoli  <ettore@ximian.com>

	* gtk/gtkmenu.c (gtk_menu_paint): If the menu is scrolled down or
	up, and some of the widget area is empty, don't fill it in with
	GTK_SHADOW_IN rectangles that make it looks strange.  Fixes
	#72695.

Wed May 15 18:15:45 2002  Owen Taylor  <otaylor@redhat.com>

	* gtk/gtkdnd.c (_gtk_drag_source_handle_event): Don't
	call gdk_pointer_grab() to change the cursor if we've
	already ungrabbed on button release / escape.
	(#80420, Dave Camp)

Wed May 15 17:12:50 2002  Owen Taylor  <otaylor@redhat.com>

	* gtk/gtktooltips.c: Special case menu items to
	pop down on motion. (#75961)

	* tests/testgtk.c (create_item_factory): Add tooltips
	to the File menu.

	* gtk/gtkentry.c (update_im_cursor_location): Fix 
	cursor locations passed to the IM context.
	(#80027, Yao Zhang)

Wed May 15 16:52:57 2002  Owen Taylor  <otaylor@redhat.com>

	* gtk/gtkfontsel.c: Update from contents of size entry
	on focus out. (#76493, Lauris Kaplinski)

	* gtk/gtkclipboard.c (selection_get_cb): Fix backwads
	info/time arguments. (#80226)

Wed May 15 11:13:19 2002  Owen Taylor  <otaylor@redhat.com>

	* configure.in gtk/stock-icons/Makefile.am: If not
	building libpng, don't rebuild gtkstockpixbufs.h
	(#81819, Bill Janssen)

2002-05-15  Jacob Berkman  <jacob@ximian.com>

	* demos/gtk-demo/Makefile.am: run perl on the file, since it's not
	executable

Tue May 14 19:53:15 2002  Owen Taylor  <otaylor@redhat.com>

	* demos/gtk-demo/geninclude.pl.in configure.in:
	Subsitute in @PERL@ instead of hardcoded 
	/usr/bin/perl. (#78355, Gareth Pearce. Fix based
	on patch from Matthias Clasen)

	* gdk/Makefile.am: Patch from Daniel Elstner to use glib-mkenums
	instead of makeenums.pl.

	* gdk/{x11,linux-fb,win32}/Makefile.am: Hack to
	get gdkenumtypes.h built first.

Tue May 14 18:41:58 2002  Owen Taylor  <otaylor@redhat.com>

	* gtk/stock-icons/Makefile.am (gtkstockpixbufs.h): 
	Remove the result file on error. (#79929, David
	Highley)

	* gtk/gtkoptionmenu.c (gtk_option_menu_remove_menu):
	If the menu is currently active, cancel it before
	setting the new menu. (#79162, Jonathan Blandford.)

Tue May 14 18:13:10 2002  Owen Taylor  <otaylor@redhat.com>

	* gdk/x11/gdkdnd-x11.c (gdk_window_cache_filter): Fix
	prepending at the start of the list. (#56349,
	Thomas Leonard.)

	* gtk/gtksignal.h (gtk_signal_disconnect_by_func): Add
	explicit casts to GSignalMatchType for C++ compatibility.
	(#77601)

Tue May 14 18:02:37 2002  Owen Taylor  <otaylor@redhat.com>

	* gtk/gtkwindow.c (gtk_window_realize): Fix
	frame_right/frame_top screwup. (Detlef Reichl,
	#78111)

	* gtk/Makefile.am (install-data-local): Use
	$(INSTALL_DATA) not $(INSTALL) when installing
	theme files. (#77094, Ben Liblit)

Tue May 14 17:30:57 2002  Owen Taylor  <otaylor@redhat.com>

	* gtk/gtkctree.c gtk/gtkclist.c: Fix format of 
	selection data to be 8 rather than GTK_TYPE_POINTER.
	(#79751, James Henstridge)
	
	* gtk/gtkmenu.c (gtk_menu_key_press): Call 
	gtk_accelerator_valid() with cleaned up
	accel_key/accel_mods, not the raw values from
	the event. (#80513, Havoc Pennington.)

	* gtk/gtkmenu.c (gtk_menu_set_tearoff_state): Remove
	some dead code that set the tearoff window not 
	resizable and removed decorations. (#80235)

Tue May 14 16:44:09 2002  Owen Taylor  <otaylor@redhat.com>

	* gtk/gtklabel.c (gtk_label_ensure_layout): Set
	the width of the layout to the actual wrap width 
	(our requisition) not the width we set when calculating
	the width. This results in the lines being justified
	within the correct area. (#79157, Anders Carlsson)

	* gtk/gtkaccelgroup.c gtk/gtkmarshelers.list: Corrected 
	registered parameter types of "accel_activate" and 
	"accel_changed" signals. (Patch from Murray Cumming, #78798)
	
	* gtk/gtkrc.c (gtk_rc_make_default_dir): Switch
	binary-version and type to correspond to the 
	current ordering in _gtk_get_module_path.
	(#78746, Sergey Kuzminov) 

	* gtk/gtkrc.c (gtk_rc_get_module_dir): Add docs
	pointing to the GTK_PATH documentation.

	* gtk/Makefile.am (uninstall-local): Delete 
	key themes as well. (#81286, Kristian Rietveld.)

Tue May 14 15:09:33 2002  Owen Taylor  <otaylor@redhat.com>

	* gdk/x11/gdkkeys-x11.c: Try adding a #ifndef/#define
	for XkbKeySymEntry to make up for OSF broken 
	XKB extension. (#77819, Gareth Pearce)

	* gtk/gtklayout.c: Clamp the upper values in response
	to ::size-allocate if necessary. (#81290, Christophe Saout)
	
	* gtk/gtkcombo.c (gtk_combo_entry_focus_out): Handle
	combo being destroyed before idle fires.
	(#81396, Timo Sirainen)

Tue May 14 11:21:19 2002  Owen Taylor  <otaylor@redhat.com>

	* gdk/x11/gdkevents-x11.c (gdk_event_translate): 
	Discard configure events from SubstructureNotify.
	(#81760, Rich Burridge)

	* gtk/gtkfontsel.c (cmp_families): Use g_utf8_strcoll(), not
	strcmp().

	* gtk/gtkmenuitem.c (gtk_menu_item_size_allocate): Clamp 
	width of child allocation to >= 1. (Fixes warnings from
	#77639, Martin Schulze)
	
Mon May 13 23:19:20 2002  Kristian Rietveld  <kris@gtk.org>

	* gtk/gtktreeviewcolumn.c (gtk_tree_view_column_cell_process_action):
	PACK_END cells support CELL_ACTION_EVENT too now ...

2002-05-10  Daniel Elstner  <daniel.elstner@gmx.net>

	* gtk/gtktreemodel.c: #define INITIALIZE_TREE_ITER(),
	which zeroes out all GtkTreeIter fields. (#81380)
	(gtk_tree_model_get_iter): Use it.
	(gtk_tree_model_iter_children): ditto
	(gtk_tree_model_iter_nth_child): ditto
	(gtk_tree_model_iter_parent): ditto

Thu May  9 23:33:32 2002  Kristian Rietveld  <kris@gtk.org>

	* gtk/gtktreeview.c (gtk_tree_view_stop_editing): fixup comment,
	so it doesn't screw the docs.

2002-05-08  Michael Natterer  <mitch@gimp.org>

	* configure.in: fixed yesterdays fix for cross compiling: simply
	check the variable "cross_compiling" which gets set by autoconf.

Tue May  7 18:36:03 2002  Owen Taylor  <otaylor@redhat.com>

	* gdk/x11/xsettings-client.c (xsettings_client_process_event): 
	Check for selection_atom, not property name atom.

2002-05-07  Michael Natterer  <mitch@gimp.org>

	* configure.in: added a new conditional CROSS_COMPILING which
	indicates ($build != $host). If it is set, look for
	gdk-pixbuf-csource in PATH. Error out if it was not found.

	* gtk/stock-icons/Makefile.am: use the gdk-pixbuf-csource found at
	configure time if CROSS_COMPILING is set, use the one which was
	just built otherwise.

2002-05-07  Anders Carlsson  <andersca@gnu.org>

	* gdk/x11/xsettings-client.c (xsettings_client_process_event): 
	Only process manager events with the correct atom.

Tue May  7 00:50:20 2002  Kristian Rietveld  <kris@gtk.org>

	Merge TreeView fixes from HEAD:

	(May  6):
	* gtk/gtktreeview.c (gtk_tree_view_map_expanded_rows_helper): call
        func on current node before the child nodes.

	* gtk/gtktreeview.c (gtk_tree_view_motion_draw_column_motion_arrow):
        unset user_data before destroying the window. (fixes #80065).

Tue May  7 00:18:45 2002  Kristian Rietveld  <kris@gtk.org>

	* gtk/gtktreeview.c (gtk_tree_view_start_editing): add neighbor
	size hack to align editable widget.

	* gtk/gtktreeviewcolumn.c (gtk_tree_view_column_pack_end): use g_new0
	here instead of g_new (this triggered some bad crash),
	(gtk_tree_view_column_cell_is_visible): add missing assert

2002-05-07  Matthias Clasen  <maclas@gmx.de>

	Fix for #79248, merged from HEAD:
	
	* gdk/x11/gdkwindow-x11.c (gdk_window_new): 
	(gdk_window_set_events): Always select for property notify for
	maintaining window state.

	* gdk/x11/gdkevents-x11.c (gdk_event_translate): Only propagate
	property notifys if they were selected by gdk_window_set_events.

Mon May  6 11:48:08 2002  Owen Taylor  <otaylor@redhat.com>

	* Makefile.am (EXTRA_DIST): Add ChangeLog.pre-2-0 (#78641)

	* m4macros/gtk-2.0.m4: save CFLAGS/LIBS properly when
	compiling "what went wrong" test case. (#79329)

	* m4macros/gtk-2.0.m4: Remove reference to editing
	pkg-config script. (From Jim Gettys)

2002-05-02  Matthias Clasen  <maclas@gmx.de>

	* gtk/gtknotebook.c (gtk_notebook_set_show_border): Typo fix.

	* gtk/gtkwidget.c (gtk_widget_class_init): Correct the
	composite_child blurb.   

	* gtk/gtknotebook.c (gtk_notebook_set_show_border): Clarify docs.  (#73093)

2002-04-30  Havoc Pennington  <hp@redhat.com>

	* gtk/gtktextlayout.c (gtk_text_layout_real_free_line_data): use
	gtk_text_layout_invalidate_cache instead of cut-and-paste
	(gtk_text_layout_real_invalidate): always invalidate cache, even
	if the line has no stored line data. #78573

	* gtk/gtktextview.c (gtk_text_view_get_iter_location): add call to
	gtk_text_view_ensure_layout, #77388
	(gtk_text_view_get_iter_at_location): ditto
	(gtk_text_view_get_line_yrange): ditto
	(gtk_text_view_get_line_at_y): ditto

2002-04-30  Havoc Pennington  <hp@redhat.com>

	* gtk/gtktextbtree.c (gtk_text_btree_remove_tag_info): assign
	something to "prev" so that removing tag info succeeds.
	Part of #77301

	* gtk/gtktextbtree.c (_gtk_text_btree_unref): reorder so that it
	unrefs the tag table first, so that the btree is in a consistent
	state when we're removing tags from it.	

	* gtk/gtktexttagtable.c (_gtk_text_tag_table_remove_buffer): strip
	all tags in the tag table out of the buffer. #77301

2002-04-29  Alex Larsson  <alexl@redhat.com>

	* gdk/gdkpango.c (gdk_draw_layout_line_with_colors):
	Use tmp also if foreground is set.

Sun Apr 28 22:43:55 2002  Jonathan Blandford  <jrb@gnome.org>

	* gtk/gtktreemodelsort.c (gtk_tree_model_sort_set_sort_func): Fix
	so that you can set a new sort func.

2002-04-27  Matthias Clasen  <maclas@gmx.de>

	* gtk/gtkrange.c (gtk_range_calc_layout): Avoid a possible
	division by zero.  (#77820)

Sat Apr 27 15:48:49 2002  Kristian Rietveld  <kris@gtk.org>

	Merge TreeView fixes from HEAD:

	(Apr 26):
	* gtk/gtktreemodel.c (gtk_tree_row_ref_deleted_callback): if the
        deleted node was "below" this path, then do not unref all nodes
        between the deleted parent and the node this rowref is pointing too
        (see added comment in gtk_tree_row_ref_deleted_callback),
        (fixes #77977)

2002-04-26  Sven Neumann  <sven@gimp.org>

	* tests/testtreecolumns.c
	* tests/testtreeview.c: quit the main loop when the window is
	destroyed. Removed compiler warnings about wrong format in printf().

Fri Apr 26 00:00:00 2002  Kristian Rietveld  <kris@gtk.org>

	Merge TreeView fixes from HEAD up to Apr 26:

	(Apr 25):
        * gtk/gtktreemodelsort.c (gtk_tree_model_sort_reset_default_sort_func):
        resort if we're already in 'unsorted' state, and update the docs
	
        * gtk/gtktreeview.c (gtk_tree_view_search_iter): make the search
        dialog not scroll horizontally (prolly fixes #74806).

	(Also from Apr 25, fixes #74206):
        * gtk/gtktreeprivate.h: add _gtk_tree_view_column_count_special_cells

        * gtk/gtktreeviewcolumn.c (_gtk_tree_view_column_has_editable_cell),
        (_gtk_tree_view_column_get_editable_cell): remove a space which made
        the code look ugly
        (_gtk_tree_view_column_count_special_cells): new function,
        (gtk_tree_view_column_cell_process_action): if there's only one
        activatable cell, the whole column will activate that renderer.

	(Apr 24):
        * gtk/gtktreeview.c (gtk_tree_view_stop_editing): temporarily set
        ->priv->edited_column to NULL. Pleas read the comment in this
        function for an explanation (fixes #79632).

Thu Apr 25 20:24:37 2002  Soeren Sandmann  <sandmann@daimi.au.dk>

	* gtk/gtkmenuitem.c (gtk_menu_item_size_allocate): use the child's
	requisition.height, not allocation.height, as width of submenu
	indicator. (#75948)

2002-04-24  Matthias Clasen  <maclas@gmx.de>

	Merged from HEAD:

	* gtk/gtktextiter.c:
	* gtk/gtktreemodelsort.c:
	* gtk/gtktextview.c: Documentation fixes.  (#62359, #68404, #57929)

2002-04-22  Anders Carlsson  <andersca@gnu.org>

	* gtk/gtkentry.c (gtk_entry_drag_data_get): Use 
	gtk_entry_get_public_chars. 
	Fixes #79532 (Reported by Ovidiu Gheorghioiu)

2002-04-21  Alexander Larsson  <alla@lysator.liu.se>

	Merged from HEAD:
	
	* gdk/x11/gdkwindow-x11.c (gdk_window_reparent):
	Save x and y in window_private.

	* gtk/gtkplug.c (_gtk_plug_add_to_socket):
	Move plug window outside the visible area to avoid flashing until
	the first size_allocate.

Sat Apr 20 16:49:26 2002  Kristian Rietveld  <kris@gtk.org>

        * gdk/x11/gdkpixmap-x11.c (gdk_pixmap_new): replace GDK_IS_WINDOW
        with GDK_IS_DRAWABLE in the assert, only check GDK_WINDOW_DESTROYED
        if window is a GdkWindow,
        (gdk_bitmap_create_from_data): ditto,
        (gdk_pixmap_create_from_data): ditto

Sat Apr 20 01:54:59 2002  Kristian Rietveld  <kris@gtk.org>

	Merge TreeView fixes from HEAD up to Apr 20 2002:

	(All from Apr 19):
        * gtk/gtktreeview.c (gtk_tree_view_size_allocate): subtract
        TREE_VIEW_HEADER_HEIGHT from allocation->height to get the real
        size for the tree (fixes #72729),
        (gtk_tree_view_real_start_editing): correct cell_area->y for
        scrolling due to gtk_tree_view_real_set_cursor (fixes #75687)

	* gtk/gtktreeview.c (gtk_tree_view_row_changed): cancel editing
        if tree_view->priv->edited_column != NULL (fixes #76066)

	(This patch fixes #50310):
	* gtk/gtktreeprivate.h: add _gtk_tree_view_column_autosize

        * gtk/gtktreeview.c: privately export _gtk_tree_view_column_autosize,
        and add a small note about that function,
        (gtk_tree_view_button_press): check for double click and
        "not having an autosize" column before autosizing the column,
        
        * gtk/gtktreeviewcolumn.c (gtk_tree_view_column_set_min_width):
        call _gtk_tree_view_column_autosize to update autosized column width
        (gtk_tree_view_column_set_max_width): ditto

Fri Apr 19 16:49:01 2002  Kristian Rietveld  <kris@gtk.org>

	Merge TreeView fixes from HEAD up to Apr 19 2002:

	(From Apr 16):
        * gtk/gtktreeview.c (gtk_tree_view_real_collapse_row): check
        ->priv->cursor and ->priv->anchor rowrefs before removing
        node->children from the rbtree. Also check the
        ->priv->last_single_clicked and ->priv->last_single_clicked_2 rowrefs
        (I think I really need to rename those two someday).

	(From Apr 17):
        * gtk/gtktreestore.c (gtk_tree_store_insert_before): fix docs

	(From Apr 18):
        * gtk/gtktreemodelsort.c
        (gtk_tree_model_sort_convert_path_to_child_path): so this function
        was completely broken. Fix it and improve readability.

	(From Apr 19):
	* gtk/gtktreeprivate.h, gtk/gtktreeview.c: rename
        last_single_clicked{,_2} to last_button_press{,_2}, as the latter
        is a more sane name.

        * gtk/gtktreeview.c (gtk_tree_view_button_press): use ->priv->anchor
        instead of ->priv->cursor, check for the anchor at another place, as
        you can go in edit mode without having an anchor.

2002-04-18  Tor Lillqvist  <tml@iki.fi>

	* gdk-pixbuf/Makefile.am (uninstall-libtool-import-lib)
	* gdk/Makefile.am (uninstall-libtool-import-lib): Fix typo,
	thanks to David Sterba for noticing.

	* gtk/gtkmain.h
	* gtk/gtkmain.c (gtk_init_abi_check, gtk_init_check_abi_check): In
	GTK+ 2.0 the GtkWindow struct actually is the same size in gcc on
	Win32 whether compiled with -fnative-struct or not. Unfortunately
	this wan't noticed until now. So, from now on, check some other
	struct, too, for which the use of -fnative-struct still
	matters. GtkBox is one such.

Mon Apr 15 15:41:56 2002  Jonathan Blandford  <jrb@redhat.com>

	* gtk/gtkcontainer.c (gtk_container_focus): include internal
	children when doing focus.
	(gtk_container_get_all_children): new static function to include
	internal children when making a list of them.

Sun Apr 14 16:56:59 2002  Kristian Rietveld  <kris@gtk.org>

	* gtk/gtktreeprivate.h: add _gtk_tree_view_column_get_editable_cell and
	_gtk_tree_view_column_get_neighbor_sizes

	* gtk/gtktreeviewcolumn.c (struct _GtkTreeViewColumnCellInfo): add
	real_width field,
	(_gtk_tree_view_column_get_editable_cell): implement,
	(gtk_tree_view_column_cell_process_action): fill info->real_width
	(_gtk_tree_view_column_get_neighbor_sizes): implement

	* gtk/gtktreeview.c (gtk_tree_view_button_press): make the "editable
	widget" show up with the same size as the actual cell, so it doesnt
	cover the complete column if there are any other cells in that column.

2002-04-14  Abigail Brady  <morwen@evilmagic.org>

	* gtk/gtkfilesel.c: Fix typo in message.

2002-04-13  Havoc Pennington  <hp@pobox.com>

	* gdk/gdkpixbuf-drawable.c (gdk_pixbuf_get_from_drawable): create
	the target pixbuf AFTER filling in width/height, so that 
	passing in -1 for width/height will work.
	
Sat Apr 13 22:49:45 2002  Kristian Rietveld  <kris@gtk.org>

	Fixes #75510

	* gtk/gtktreeselection.c (gtk_tree_selection_get_selected): make this
	function work correctly and more sane

	* gtk/gtktreeview.c (gtk_tree_view_real_collapse_row): remove
	node->children from rbtree before emitting GtkTreeSelection::changed

Sat Apr 13 17:15:12 2002  Kristian Rietveld  <kris@gtk.org>

	* gtk/gtkcellrenderertext.c (gtk_cell_renderer_text_init): dont set
	the mode to GTK_CELL_RENDERER_MODE_EDITABLE by default,
	(gtk_cell_renderer_text_class_init): for some reason our default for
	editable was TRUE, of course this is FALSE.
	(gtk_cell_renderer_text_set_property): update mode when editable
	has been changed.

2002-04-12  jacob berkman  <jacob@ximian.com>

	* gdk/x11/xsettings-client.c (fetch_card8): fix cut-n-paste bug
	which breaks big-endian machines (fixes #73585)

2002-04-12  Havoc Pennington  <hp@redhat.com>

	* gtk/gtknotebook.c (gtk_notebook_real_remove): relocate the
	remove_weak_pointer to just before we free the page, to be sure 
	it doesn't get re-added. #75282

Fri Apr 12 18:32:46 2002  Kristian Rietveld  <kris@gtk.org>

	* gtk/gtktreeview.c (gtk_tree_view_real_set_cursor): add
	clamp_node argument
	(toplevel): update usages of gtk_tree_view_real_set_cursor,
	(gtk_tree_view_focus_to_cursor): don't let
	gtk_tree_view_real_set_cursor clamp the node, so you won't get
	unexpected scrolling

2002-04-11  Michael Meeks  <michael@ximian.com>

	* gtk/gtklabel.c
	(gtk_label_parse_uline, gtk_label_set_text),
	(gtk_label_set_text_with_mnemonic): add freeze / thaws
	to stop deluge of 'notify' signals.

Sat Apr  6 06:57:00 2002  Owen Taylor  <otaylor@redhat.com>

	* gtk/gtkmenushell.[ch] gtk/gtkmenuitem.c: Export
	private _gtk_menu_shell_activate() to encapsulate
	cut-and-paste code.

	* gtk/gtkmenubar.c: Select the first item on the menu bar
	for F10	rather than acting as if the user pressed <Alt>F
	to select the file manager.

Tue Apr  9 19:01:28 2002  Owen Taylor  <otaylor@redhat.com>

        Fix problems with HandleBox and focusing - #78232

	* gtk/gtkwidget.c (gtk_widget_translate_coordinates): Handle
	GtkHandleBox / GnomeDock style window heirarchy / widget
	heirarchy disconnects. :-(. 

	* gtk/gtkcontainer.c: Handle failures from
	gtk_widget_translate_coordinates (Focusing is not right, but at
	least it doesn't go into infinite loops.)

Tue Apr  9 18:34:58 2002  Owen Taylor  <otaylor@redhat.com>

	* gtk/gtkcontainer.c (_gtk_container_queue_resize): Always
	set the ALLOC_NEEDED and REQUEST_NEEDED flags up the hierarchy,
	even if we aren't currently in a resize container... we need
	this to properly handle size changes to widgets that are
	being moved from one heirarchy to another. (#78226)

Tue Apr  9 21:41:24 2002  Kristian Rietveld  <kris@gtk.org>

	Fixes #78110

	* gtk/gtktreeselection.c (_gtk_tree_selection_internal_select_node):
	add override_browse_mode argument and implement,
	(gtk_tree_selection_unselect_path): always unselect the path,
	(toplevel): update uses of _gtk_tree_selection_internal_select_node

	* gtk/gtktreeview.c: update uses of
	_gtk_tree_selection_internal_select_node

	* gtk/gtktreeprivate.h (_gtk_tree_selection_internal_select_node):
	update prototype

Tue Apr  9 21:39:44 2002  Kristian Rietveld  <kris@gtk.org>

	Fixes #77862

	* gtk/gtktreeprivate.h: add _gtk_tree_view_column_has_editable_cell

	* gtk/gtktreeviewcolumn.c (_gtk_tree_view_column_has_editable_cell):
	new function

	* gtk/gtktreeview.c (gtk_tree_view_button_press): send cell event
	on first click when cell isn't editable

Tue Apr  9 21:37:31 2002  Kristian Rietveld  <kris@gtk.org>

	* gtk/gtktreedatalist.c (_gtk_tree_data_list_check_type): add some
	types which were missing and useful to use (fixes #77870)

2002-04-09  Anders Carlsson  <andersca@gnu.org>

	* gtk/gtkfilesel.c (open_new_dir): Initialize error to NULL.

2002-04-08  Manish Singh  <yosh@gimp.org>

	* tests/testgtk.c: really revert testgtk.c

Mon Apr  8 20:28:54 2002  Kristian Rietveld  <kris@gtk.org>

	* gtk/gtktreeselection.c (gtk_tree_selection_select_path),
	(gtk_tree_selection_unselect_path),
	(gtk_tree_selection_path_is_selected): check the return value of
	_gtk_tree_view_find_node and return if it's TRUE. This makes those
	functions work somewhat saner on non-expanded trees.

Fri Apr  5 18:28:56 2002  Kristian Rietveld  <kris@gtk.org>

	* gtk/gtktreeselection.c (gtk_tree_selection_set_mode): free
	anchor row reference after unselecting the selection (fixes #76272)

Fri Apr  5 18:27:48 2002  Kristian Rietveld  <kris@gtk.org>

	* gtk/gtktreeview.c (gtk_tree_view_real_expand_row): only return
	when we don't have to open all children (fixes #75736)

Fri Apr  5 18:24:24 2002  Kristian Rietveld  <kris@gtk.org>

	* gtk/gtktreeviewcolumn.c (gtk_tree_view_column_clear): unref
	cellrenderer after clearing the attributes of the renderer (fixes
	#75592)

Fri Apr  5 05:55:14 2002  Jonathan Blandford  <jrb@gnome.org>

	* gtk/gtktreeview.c (gtk_tree_view_grab_focus): implement.
	  (gtk_tree_view_move_cursor_up_down): check for focus
	  (gtk_tree_view_move_cursor_page_up_down): ditto
	  (gtk_tree_view_move_cursor_left_right): ditto
	  (gtk_tree_view_move_cursor_start_end): ditto
	  (gtk_tree_view_real_select_all): ditto
	  (gtk_tree_view_real_unselect_all): ditto
	  (gtk_tree_view_real_select_cursor_row): ditto	
	  (gtk_tree_view_real_toggle_cursor_row): ditto
	  (gtk_tree_view_real_expand_collapse_cursor_row): ditto
	  (gtk_tree_view_real_select_cursor_parent): ditto
	  (gtk_tree_view_real_start_interactive_search): ditto

	* gtk/gtktreeviewcolumn.c: grab focus

2002-04-05  Alex Larsson  <alexl@redhat.com>

	* gdk/linux-fb/gdkkeyboard-fb.c (write_string):
	Fix undefined variable typo.
	Patch from Simon Floery <simon.floery@gmx.at>

Fri Apr  5 01:06:15 2002  Tim Janik  <timj@gtk.org>

	* gdk/x11/gdkwindow-x11.c (set_text_property): fix segfault
	upon NULL return from gdk_utf8_to_string_target().

	* gdk/x11/gdkselection-x11.c (gdk_utf8_to_string_target): fix
	return value comment to mention NULL returns upon EMFILE.

Thu Apr  4 22:35:42 2002  Soeren Sandmann  <sandmann@daimi.au.dk>

	* tests/testgtk.c (menu_items): revert accidentally commited
	change to testgtk.c

Thu Apr  4 22:28:08 2002  Soeren Sandmann  <sandmann@daimi.au.dk>

	* gtk/gtkmenuitem.c (gtk_menu_item_paint): Fix problem with menu
	titles being clipped (#75948)
	
2002-04-04  Tor Lillqvist  <tml@iki.fi>

	* gdk/gdkrgb.c: Fix some bugs, and introduce a minor feature.

	(gdk_rgb_convert_4_pack): New function, for 16-color (4 bits per
	pixel) static visuals (fixes #858).

	(gdk_rgb_convert_gray4_pack, gdk_rgb_convert_gray4_d_pack): Fix
	same bugs in both functions: Odd start coordinate (partial byte)
	was not handled correctly. Also a partial final byte was not
	handled correctly.

	(gdk_rgb_do_colormaps): Use G_N_ELEMENTS.
	(gdk_rgb_create_info): For pseudocolor visuals, use the 2x2x2
	colorcube only for depths 3 and 4. For static color, use it for
	depths 3..7 like before. (Depth 5..7 pseudocolor probably never
	occurs on X11. It doesn't normally occur on Win32 either, but
	there is experimental code in gdkvisual-win32.c to let the user
	restrict the size of palette used.)
	(gdk_rgb_init): Set gdk_rgb_verbose if the GDK_DEBUG_GDKRGB flag
	is set.
	(gdk_rgb_select_conv): Use gdk_rgb_convert_8 also for depths 5, 6
	and 7 (see above). Use gdk_rgb_convert_4_pack for 4 bits per pixel
	static color.

Tue Apr  2 11:10:13 2002  Jonathan Blandford  <jrb@redhat.com>

	* gtk/gtkliststore.c (gtk_list_store_set_sort_func): set the
	sort_func correctly, 77030

Tue Apr  2 13:44:27 2002  Tim Janik  <timj@gtk.org>

	* configure.in: update version to 2.0.2, binary age 2, interface
	age 2.

	* NEWS: updates for 2.0.2.

Mon Apr  1 22:20:24 2002  Kristian Rietveld  <kris@gtk.org>

	* gtk/gtktreeview.c (gtk_tree_view_move_cursor_page_up_down): add
	check for y > tree_view->priv->height (fixes #76974)

Mon Apr  1 22:19:39 2002  Kristian Rietveld  <kris@gtk.org>

	* gtk/gtktreemodelsort.c (gtk_tree_model_sort_sort_level): get
	the stamp changes right this time

Mon Apr  1 22:13:24 2002  Kristian Rietveld  <kris@gtk.org>

	* gtk/gtktreemodel.c (gtk_tree_row_reference_free): only
	disconnect the ref callbacks when model == proxy (Thanks go to
	Manuel Clos Crespo for the remote debugging)

Sat Mar 30 15:19:24 2002  Kristian Rietveld  <kris@gtk.org>

	* gtk/gtktreemodelsort.c: revert the latest stamp increment changes,
	as it broke stuff for trees

Fri Mar 29 18:15:12 2002  Owen Taylor  <otaylor@redhat.com>

	* ===== Released 2.0.1 ======

Fri Mar 29 18:09:18 2002  Owen Taylor  <otaylor@redhat.com>

	* gtk/gtkaccelgroup.c (gtk_accel_group_query): Call 
	gdk_keyval_to_lower() on the key passed in, since we
	lowercase all other key vals passed in, so querying
	keyvals will otherwise fail if the caller used
	an uppercase accelerators (#76899, Vitaly Tishkov)

Fri Mar 29 17:41:21 2002  Owen Taylor  <otaylor@redhat.com>

	* gtk/gtkmain.c (load_modules): Fix screwup in handling
	of module path that was resulting in freed memory being
	accessed when both GTK_MODULES and a theme were set.
	(#76902, Johan Dahlin)

Fri Mar 29 17:57:36 2002  Owen Taylor  <otaylor@redhat.com>

	* gtk/gtkiconfactory.c (get_default_icons): Fix wrong
	stock id's for ADD/REMOVE. (#76915, Vitaly Tishkov)

2002-03-29  Hans Breuer  <hans@breuer.org>

	* gtk/gtkmain.h : fix typo in gtk_init_check macro, which
	caused crashes if argc != 0

	* gtk/stock-icons/makefile.msc : added new icons

Fri Mar 29 20:17:35 2002  Kristian Rietveld  <kris@gtk.org>

	* gtk/gtktreemodelsort.c (gtk_tree_model_sort_rows_reordered):
	remove call to gtk_tree_model_sort_increment_stamp
	(gtk_tree_model_sort_sort_level): always increment the stamp

Fri Mar 29 00:19:41 2002  Owen Taylor  <otaylor@redhat.com>

	* NEWS: Updates

	* configure.in: Version 2.0.1, binary, interface age 1.

	* configure.in (GDK_PIXBUF_VERSION): Up required versions
	of dependencies.

	* gtk/gtkiconfactory.c gtk/stock-icons/Makefile.am:
	Add stock_add/remove_16.

Thu Mar 28 18:38:30 2002  Owen Taylor  <otaylor@redhat.com>

	* gtk/gtk[hv]paned.c (gtk_[hv]paned_size_allocate): 
	Don't show the window unless the widget is mapped.
	(#76742, Dennis Bjrklund, Soeren Sandmann)

2002-03-29  Hans Breuer  <hans@breuer.org>

	Fixed dashed line issues (#74441) to an IMO reasonable extend. 
	That is: use PS_USERSTYLE on WinNT (the next GDI limit appears
	to be with lines width > 50); Render horizontal and vertical
	dashed lines on Win9x 'by hand'. Dotted selection rectangles 
	and Dia look nice ...

	* gdk/win32/gdkprivate-win32.h : add pen_dashes pointer and
	num_pen_dashes to _GdkGCWin32
	* gdk/win32/gdkgc-win32.c : initialize pen_dashes and remove
	the guesses from dashes to windoze line styles.
	(predraw_set_forground) : always ExtCreatePen (PS_SOLID) on
	Win9x, which does not support PS_USERSTYLE.
	* gdk/win32/gdkdrawable-win32.c : new functions render_line_
	<horizontal|vertical>. Use them if not running on NT in
	gdk_win32_draw_<rectangle|segments|lines> ()

	* gdk/win32/gdkkeys-win32.c (gdk_keyval_name) : return NULL
	for keyval == 0 to avoid to have zeros in all menu entries 
	without accelerator.

2002-03-29  Jakub Steiner <jimmac@ximian.com>

	* gtk/stock-icons/stock_add_24.png:
	* gtk/stock-icons/stock_add_16.png:
	* gtk/stock-icons/stock_remove_24.png:
	* gtk/stock-icons/stock_remove_16.png: use a simple '+' and '-',
	  works better. the old box was too clumsy

Thu Mar 28 21:11:04 2002  Tim Janik  <timj@gtk.org>

	* gtk/gtkfilesel.c (open_new_dir): when encountering non-UTF-8 file
	names, alert the user with g_message() instead of g_warning() and
	put out the actual conversion error.

2002-03-28  Dave Camp  <dave@ximian.com>

	* gtk/gtktreeview.c (install_scroll_sync_handler): Don't install
	the handler if the widget isn't realized.

2002-03-28  Jakub Steiner <jimmac@ximian.com>

	* gtk/stock-icons/stock_font*:
	* gtk/stock-icons/stock_align*:
	* gtk/stock-icons/stock_text*: better solution to the dark theme
	  problem. Also looks more pretty IMHO

2002-03-27  Matthias Clasen  <maclas@gmx.de>

	* configure.in: Try to find libpng via pkg-config first,
	since libpng-1.2.2 will come with a .pc file.

Wed Mar 27 11:10:39 2002  Owen Taylor  <otaylor@redhat.com>

	* gtk/gtknotebook.c (gtk_notebook_real_remove): Set
	page->last_focus_child to NULL as well as removing the
	weak reference, to deal with reentrancy in set_focus_child().
	(#76634, Dennis Bjrklund)

2002-03-27  Murray Cumming  <murrayc@usa.net>
 
 	* gtk/gtktreeview.c: Corrected registered return type of
	"move-cursor" signal. Had to add a marshaller to 
 	gtk/gtkmarshalers.list.
	
Tue Mar 26 14:46:50 2002  Owen Taylor  <otaylor@redhat.com>

	* gtk/gtkmenu.c (gtk_menu_popup): Shuffle the ordering around
	some more (position before realizing) fixing problems with 
	arrows popping up at the wrong time (#73386), hopefully not
	introducing other problems. (Reported by Ettore Perrazoli, others)

2002-03-26  Dave Camp  <dave@ximian.com>

	* gtk/gtktreeview.c (gtk_tree_view_button_press): Free the path
	after calling gtk_tree_view_row_activated() rather than before.

2002-03-25  Sven Neumann  <sven@gimp.org>

	* gtk/gtkrc.c (gtk_rc_parse_font_name): free the style's
	font_description before assigning a new one.
	(gtk_rc_parse_stock): always unref the created icon_set. #76289
	
2002-03-25  Mark McLoughlin  <mark@skynet.ie>

	* gtk/gtkbindings.c: (gtk_binding_entry_add_signal),
	kill code duplicated in gtk_binding_entry_add_signall.

Sun Mar 24 10:32:38 2002  Jonathan Blandford  <jrb@redhat.com>

	* gtk/gtktreemodel.c (gtk_tree_path_copy): Make path arg const, #75653

	* gtk/gtkfontsel.c (gtk_font_selection_show_available_styles): fix
	a warning

	* gtk/gtktreeview.c (gtk_tree_view_button_press): remove the grab
	when we emit row_activated so that listeners of this signal can
	grab the mouse, #75629

2002-03-23  Havoc Pennington  <hp@pobox.com>

	* gtk/gtktextlayout.c (gtk_text_layout_real_invalidate):
	invalidate the line containing start, even if the [start,end)
	range is empty (just invalidate [start,end], essentially).
	Partially fixes #72374

2002-03-23  Havoc Pennington  <hp@pobox.com>

	* gtk/gtktextview.c (gtk_text_view_do_popup): end any selection in
	progress, patch from db@zigo.dhs.org, #74620

2002-03-23  Havoc Pennington  <hp@pobox.com>

	* gtk/gtktextview.c (gtk_text_view_move_cursor_internal): extend
	selection for pageup/pagedown and ctrl+pageup/pagedown if 
	shift is held. more of #53934

2002-03-23  Havoc Pennington  <hp@pobox.com>

	* gtk/gtktextview.c (gtk_text_view_destroy_layout): disconnect 
	layout handlers earlier in the function, to avoid possible
	reentrancy screwups
	(gtk_text_view_invalidate): Don't install idle handlers if 
	layout == NULL, otherwise we get problems during finalization 
	since clearing the buffer invalidates and puts the idle handlers
	back after we destroy the layout. #74660
	(gtk_text_view_ensure_layout): Install the validation handlers
	right after creating the layout.

	* gtk/gtktexttagtable.c (foreach_unref): call
	_gtk_text_buffer_notify_will_remove_tag(), #75126

2002-03-22  Havoc Pennington  <hp@pobox.com>

	* gdk/x11/gdkfont-x11.c (gdk_fontset_load): add more explanatory
	text to the error message about missing charsets, and use
	g_printerr() not g_warning() since this is typically not a
	programming error (we do not export any API to ask whether 
	a font set will have missing charsets so apps realistically can't 
	do anything other than try the gdk_fontset_load())

	* gtk/gtktextview.c (gtk_text_view_key_press_event): return FALSE
	if the text view isn't editable and the user presses Return, 
	so default buttons and such can be activated, #74937

	* gtk/gtktextbuffer.c (paste_from_buffer): don't insert 
	if the insertion point is not editable and the paste 
	is interactive, #74125

	* gtk/gtkwindow.c (gtk_window_move_resize): enhance the #if 0
	debug spew

	* gtk/gtktextbuffer.c (cut_or_copy): only remove the previous 
	cut/copied data right before replacing it, when we know we are
	going to replace it. Fixes #74049

2002-03-22  Richard Hult  <rhult@codefactory.se>

	* gdk/gdkevents.c (gdk_event_get_root_coords): Fix typo, where x
	value was assigned to both x and y.

Fri Mar 22 11:29:11 2002  Owen Taylor  <otaylor@redhat.com>

	Partial fix for problem where keypad keys acted
	as shift-arrows in an entry rather than arrows (#74327)

	* gtk/gtkkeyhash.c (_gtk_key_hash_lookup): Sort lookup
	results by number of modifiers in the entry. Fixes
	problem where if a key matched both modified and unmodified
	key bindings ... e.g., the distinguishing key binding
	was consumed, then it was random which was used. 

	* gtk/gtkbindings.c (gtk_binding_entries_sort_patterns): 
	Catch the case where there are multiple entries from the
	same bindingset (with different modifiers), and use only
	the first entry, which, with the change in _gtk_key_hash_lookup()
	will be the preferred value.

Fri Mar 22 10:56:19 2002  Owen Taylor  <otaylor@redhat.com>

	* gtk/gtkaccelmap.c (gtk_accel_map_save_fd): Fix memory
	leak. (#74400, Morten Welinder.)

	* gtk/gtkaccelmap.c: Properly handle short returns from
	write() calls. (Handling EINTR isn't enough... that only
	handles the case where you were interrupted before you
	wrote a single byte.)
	
	* gdk/linux-fb/gdkmouse-fb.c gdk/linux-fb/gdkkeyboard-fb.c:
	Robustify against short returns from write() calls.

Fri Mar 22 10:12:10 2002  Owen Taylor  <otaylor@redhat.com>

	* gtk/gtktextview.c (gtk_text_view_paint): Change
	G_BREAKPOINT() to g_assert_not_reached ().
	(#75865, Ashok Venkiteswaran)
	
2002-03-22  Tor Lillqvist  <tml@iki.fi>

	* gdk/win32/gdkgc-win32.c (gdk_win32_gc_set_dashes): Don't clear
	all of the pen_style, just the PS_STYLE_MASK. Seems to fix #74441,
	but that is just the special case of one-pixel wide one-pixel
	on-off dotted lines. To fully implement generic X11 style dashed
	lines a major rewrite would be needed.

2002-03-21  Matthias Clasen  <maclas@gmx.de>

	* gtk/gtkaccelgroup.c (gtk_accelerator_valid): Trivial typo
	fix. (Vitaly Tishkov, #75726)

Thu Mar 21 10:04:05 2002  Owen Taylor  <otaylor@redhat.com>

	* gdk/gdkwindow.c (gdk_window_real_get_depth): Remove
	some left over debugging code with a G_BREAKPOINT()
	in it.

Wed Mar 20 19:33:31 2002  Owen Taylor  <otaylor@redhat.com>

	* gtk/gtkcalendar.c (gtk_calendar_main_button): When
	changing months when the user clicks on a prev-month
	or next-month day, focus and select the new day.
	Ignore double clicks on prev-month, next-month days.
	(Based on suggestions from Andras Salamon, #74173)

	* gtk/gtkcalendar.c: Implement the focused/unfocused
	selected color change.

2002-03-20  Alex Larsson  <alexl@redhat.com>

	Patches from Carlo E. Prelz <fluido@fluido.as>
	Now gtkfb at least compiles and mostly works. The keyboard
	stuff needs more loving.
	
	* gdk/linux-fb/gdkkeyboard-fb.c (xlate_get_for_keyval,
	xlate_get_for_keycode, raw_get_for_keyval, raw_get_for_keycode):
	At least set the out parameters for these calls.

	* gdk/linux-fb/gdkmain-fb.c:
	(gdk_pointer_grab_info_libgtk_only, gdk_keyboard_grab_info_libgtk_only):
	Implement new functions.
	
Wed Mar 20 19:00:03 2002  Owen Taylor  <otaylor@redhat.com>

	* gtk/gtkentry.c (gtk_entry_set_text): Short-circuit
	the text to the exact same thing, so we don't 
	unexpectedly change the selection or cursor position.
	(#74290, John Ellis.)

Thu Mar 21 00:05:14 2002  Kristian Rietveld  <kris@gtk.org>

	* gtk/gtktreeview.c (gtk_tree_view_get_background_area),
	(gtk_tree_view_get_cell_area): fix logic (fixes #74235, #73593)

Wed Mar 20 17:11:51 2002  Owen Taylor  <otaylor@redhat.com>

	* gtk/gtkrc.c: Patch from Richard Hestilow to fix
	gtk-font-name changes for widgets that get the actual
	default style. (#73709)

Wed Mar 20 22:59:23 2002  Kristian Rietveld  <kris@gtk.org>

	* gtk/gtkrbtree.[ch]: add _gtk_rbtree_set_fixed_height()

	* gtk/gtktreeprivate.h: add fixed_height_check field

	* gtk/gtktreeview.c (gtk_tree_view_init): initialize
	scroll_sync_timer and fixed_height_check
	(do_validate_rows): add fixed_height_check. If all validated rows
	in the first cycle have the same height, then we set that height for
	the entire tree. This is some sort of 'fake' optimization, but helps
	a lot for the common case. We keep validating the entire tree in
	the background though.
	(gtk_tree_view_set_model): reset fixed_height_check

Wed Mar 20 16:36:08 2002  Owen Taylor  <otaylor@redhat.com>

        * gtk/*.c: Patch from Erwann Chenede, #73900 fixing
	a lot of warnings with Forte CC, mostly implicit
	casts between void * and function pointers.
	
	* gdk/gdkevents.c (gdk_event_get_state): GdkEventVisibility's
	state field is not a GdkModifierType. (Also #73900)

Wed Mar 20 12:35:22 2002  Owen Taylor  <otaylor@redhat.com>

	* gtk/gtkwidget.c (gtk_widget_grab_default): Remove
	leftover notification of has-default. (#75508, Jacob
	Berkman.)

Wed Mar 20 12:27:07 2002  Owen Taylor  <otaylor@redhat.com>

	* gtk/gtkaccelgroup.c (gtk_accelerator_valid): Allow
	arrow keys as accelerators, as long as some modifier
	is pressed. (#75495)

	* gtk/gtkaccelgroup.c (gtk_accelerator_valid): Fix
	incorrect example in the docs.

Wed Mar 20 12:06:30 2002  Owen Taylor  <otaylor@redhat.com>

	* gtk/gtkwidget.c (gtk_widget_set_child_visible):
	Fix segfault when widget->parent is NULL. 
	(#75615, Alexey A. Malyshev) 

Wed Mar 20 11:32:07 2002  Owen Taylor  <otaylor@redhat.com>

	* gtk/gtkentry.c: Improve test to prevent infinite
	loop. (#74952, Thomas Leonard)

	* gtk/gtkmenushell.c (gtk_real_menu_shell_cycle_focus):
	Fix warning when toplevel menu shell isn't a menu
	bar. (Thomas Leonard, #75602)

Wed Mar 20 11:00:59 2002  Owen Taylor  <otaylor@redhat.com>

        * configure.in: Use $PKG_CONFIG, not pkg-config.
        (LEE Sau Dan, #75572)

Wed Mar 20 10:55:56 2002  Owen Taylor  <otaylor@redhat.com>

	* gdk/x11/gdkevents-x11.c (gdk_event_translate): Fix assignment
	of time in scroll events. (Sven Neumann, #75574)

2002-03-20  Tor Lillqvist  <tml@iki.fi>

	* gdk/win32/gdkdnd-win32.c (gdk_drag_find_window): Use
	gdk_window_get_toplevel(), as it is the top-level windows that are
	registered for DND.

	* gdk/win32/gdkwin32.h: Don't include gdkinternals.h.

2002-03-19  jacob berkman  <jacob@ximian.com>

	* gtk/gtkcombo.c (gtk_combo_find): fix infinite loop when
	gtk_combo_func() returns NULL (bug #75464)

2002-03-18  jacob berkman  <jacob@ximian.com>

	* gtk/gtkaspectframe.c (gtk_aspect_frame_class_init): set the
	correct min/max values for the ratio property (fixes #75331)

Mon Mar 18 11:55:03 2002  Owen Taylor  <otaylor@redhat.com>

	* gtk/gtkimmulticontext.c (gtk_im_multicontext_get_slave):
	Patch from Yao Zhang fixing reference count leak.

	* gtk/gtkentry.c (gtk_entry_key_release): if (entry->editable),
	not if (!entry->editable).

Mon Mar 18 11:09:17 2002  Owen Taylor  <otaylor@redhat.com>

	* gdk/x11/gdkwindow-x11.c (gdk_window_set_override_redirect): 
	Fix backwards conditional. (#75019, Dan Winship.)

Sun Mar 17 01:11:16 2002  Kristian Rietveld  <kris@gtk.org>

	* gtk/gtktreeview.c (gtk_tree_view_size_request): use
	do_validate_rows instead of validate_rows_handler (fix by
	Mike Pieper, #74126)

Sat Mar 16 23:54:56 2002  Kristian Rietveld  <kris@gtk.org>

	* gdk/x11/gdkwindow-x11.c (gdk_window_set_static_bit_gravity): just
	return when we have an input_only window (fix by Owen Taylor)

	* gtk/gtktreeprivate.h (struct _GtkTreeViewPrivate): add
	scroll_sync_timer

	* gtk/gtktreeview.c (install_scroll_sync_handler): new function,
	(scroll_sync_handler): ditto,
	(gtk_tree_view_unrealize): take scroll_sync_timer into account
	(gtk_tree_view_row_deleted): install scroll_sync_timer instead of
	calling top_row_to_dy/dy_to_top_row directly
	-- this greatly speeds up clearing the model (#73199)

	* gtk/gtktreemodelsort.c
	(gtk_tree_model_sort_convert_path_to_child_path): fix up this function,
	for some reason I really screwed it up (fixes #74663)

2002-03-16  Sven Neumann  <sven@gimp.org>

	* configure.in (GDK_PIXBUF_DEP_CFLAGS) (GDK_PIXBUF_XLIB_DEP_CFLAGS) 
	(GDK_DEP_CFLAGS) (GTK_DEP_CFLAGS): include CFLAGS from gthread-2.0
	so that the libs work correctly in a threaded environment.

Fri Mar 15 12:51:42 2002  Jonathan Blandford  <jrb@redhat.com>

	* gtk/gtktreeviewcolumn.c
	(gtk_tree_view_column_new_with_attributes): add example to docs,
	as people are seeming to have trouble with this function.

2002-03-15  Tor Lillqvist  <tml@iki.fi>

	* configure.in: Set MATH_LIB to empty also on Win32.

Fri Mar 15 15:37:01 2002  Owen Taylor  <otaylor@redhat.com>

	* gdk/x11/gdkdrawable-x11.c (convert_to_format): 
	Fix byte shift arithmetic for big-endian. (Tracked
	down with help from Tuomas Kuosmanen)

Fri Mar 15 11:28:41 2002  Jonathan Blandford  <jrb@redhat.com>

	* gtk/gtktreeview.c (gtk_tree_view_insert_column_with_data_func):
	make args const, 74159
	(gtk_tree_view_insert_column_with_attributes): ditto

	* gtk/gtktreeviewcolumn.c
	(gtk_tree_view_column_cell_process_action): remov unused variables.

Fri Mar 15 13:31:51 2002  Soeren Sandmann  <sandmann@daimi.au.dk>

	* gtk/gtkmenu.c (gtk_menu_leave_notify): Fix test for "active
	submenu".

2002-03-15 Padraig O'Briain <padraig.obriain@sun.com>

	* gdk/x11/gdkkeys-x11.c (update_keymaps): Fudge keymap to have lower
	upper case variants if there is only a single keysym per keycode and
	the key symbol has upper and lower case variants (#74512)

Thu Mar 14 17:09:52 2002  Owen Taylor  <otaylor@redhat.com>

	* gdk/gdkwindow.c (gdk_window_process_all_updates): Fix rather
	improbable reentrancy problem if a window is destroyed
	while updates are being processed on another window. (Noticed
	by Michael Meeks, #74708)

2002-03-14 Vitaly Tishkov <tvv@sparc.spb.su>

        * gtk/gtktreemodelsort.c
	typo in docs for gtk_tree_model_sort_convert_iter_to_child_iter() fixed


Thu Mar 14 11:17:18 2002  Owen Taylor  <otaylor@redhat.com>

	* gtk/gtkkeyhash.c (_gtk_key_hash_remove_entry): When
	removing keys from the key hash, reinsert the right list
	back into the hash. (Dave Camp, #74571)

Wed Mar 13 17:17:40 2002  Owen Taylor  <otaylor@redhat.com>

	* gtk/gtkobject.h: Remove left-over GTK_OBJECT_CONNECTED
	macro that was defined in terms of the now-gone GTK_CONNECTED
	flag. (Seth Burgess, #74028)

Wed Mar 13 17:11:10 2002  Owen Taylor  <otaylor@redhat.com>

	* gtk/gtkaccelgroup.c (accel_group_weak_ref_detach): Unset 
	the acceleratable_groups qdata because qdata isn't removed
	on ->dispose but rather on ->finalize. (#74569, found
	by Matt Wilson.)

Tue Mar 12 23:14:23 2002  Jonathan Blandford  <jrb@redhat.com>

	* gtk/gtktreeselection.c (gtk_tree_selection_unselect_iter): Fix
	cut-n-paste bug.

Sat Mar  9 18:23:25 2002  Richard Hestilow  <hestilow@ximian.com>

	* gtk/gtkimage.c (gtk_image_set_from_filename): Allow NULL
	filenames.
	
Tue Mar 12 10:50:09 2002  Owen Taylor  <otaylor@redhat.com>

	* modules/input/gtkimcontextxim.c (gtk_im_context_xim_filter_keypress):
	Fix incorrect return value, filter out returns of 0x7f for
	the delete key. (#74179, Kang Jeong-He)

Mon Mar 11 23:42:11 2002  Jonathan Blandford  <jrb@redhat.com>

	* gtk/gtktreemodel.c (gtk_tree_model_foreach): fix totally broken
	foreach function.

2002-03-11  Matthias Clasen  <maclas@gmx.de>

	* gtk/gtkitemfactory.c (gtk_item_factory_add_foreign): Document
	gtk_{menu_item,widget}_set_accel_path() as the recommended API.  
	(#69244)

2002-03-11  James Henstridge  <james@daa.com.au>

	* configure.in: set CCAS and CCASFLAGS to get automake 1.6
	compatibility without breaking things for people using 1.4.

Sun Mar 10 21:04:30 2002  Jonathan Blandford  <jrb@redhat.com>

	* gtk/gtktreeview.c (gtk_tree_view_button_press): finally get the
	right behavior.

Mon Mar 11 01:25:14 2002  Kristian Rietveld  <kris@gtk.org>

	* gtk/gtktreeview.c (gtk_tree_view_button_press): compare path with
	cursor path and not with the selected iter in the 'decide to edit'
	check

